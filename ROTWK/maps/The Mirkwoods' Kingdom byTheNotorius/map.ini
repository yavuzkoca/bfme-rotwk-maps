;;;;;;;;;INI FILE BY TheNotorius ---- Don't copy it or part of it and say it's your
;;;;;;;;;If u want use it, e-mail me and ask to use : sevan89@hotmail.it
;;;;;;;;; or at least give me credit for your map!

Object IsengardBerserkerHorde
BuildCost = 450
End

PlayerTemplate FactionWild
Side              			= Isengard
	PlayableSide      			= Yes
	Evil			  		= Yes
	StartMoney        			= 0
	MaxLevelMP				= #DIVIDE( PLAYER_MAX_PURCHASE_POINTS_DEFAULT PLAYER_PURCHASE_POINTS_GRANTED )
	MaxLevelSP				= #DIVIDE( PLAYER_MAX_PURCHASE_POINTS_EVIL PLAYER_PURCHASE_POINTS_GRANTED )
	PreferredColor				= R:216 G:175 B:48
	StartingBuilding			= IsengardFortress
	
	;------------- NO STARTING UNITS FOR YOU -------
	
	StartingUnit0 = IsengardPorter 
	StartingUnitOffset0 = X:1 Y:230 Z:0
	
	StartingUnit1 = IsengardPorter
	StartingUnitOffset1 = X:1 Y:150 Z:0
	
	StartingUnitTacticalWOTR		= IsengardPorter
	StartingUnitTacticalWOTR		= IsengardPorter
	IntrinsicSciences			= SCIENCE_EVIL
	IntrinsicSciencesMP			= SCIENCE_ISENGARD
	DefaultPlayerAIType 			= IsengardSkirmishAI
	SpellBook				= EvilSpellBook
	SpellBookMp				= IsengardSpellBook
	PurchaseScienceCommandSet		= EvilSpellStoreCommandSet
	PurchaseScienceCommandSetMP		= IsengardSpellStoreCommandSet
	DisplayName				= INI:FactionIsengard
	BeaconName				= MultiplayerBeacon
	LightPointsUpSound			= IsengardLightPointsUp
	ObjectiveAddedSound			= Gui_MissionObjectiveNew
	ObjectiveCompletedSound			= Gui_MissionObjectiveCompleted

	// NOTE: It is very important that the create-a-hero be the first buildable hero, to ensure that the create-a-hero and the ring hero are always 
	// attached to the first two buttons in the command set.

	BuildableHeroesMP			= CreateAHero IsengardWormTongue IsengardLurtz IsengardSharku IsengardSaruman 
	BuildableRingHeroesMP			= MordorSauron_RingHero
	InitialUpgrades				= Upgrade_IsengardDualEconomyChoice Upgrade_IsengardFaction Upgrade_EvilDualEconomyChoice;Any upgrades this player template is born with.
	SpellStoreCurrentPowerLabel 		= APT:SpellStoreCurrentRingPower
	SpellStoreMaximumPowerLabel 		= APT:SpellStoreMaximumRingPower
	ResourceModifierObjectFilter 		= RESOURCE_MODIFIER_OBJECT_FILTER
	ResourceModifierValues			= 100 100 100 100 90 85 80 75 71 68 66
	MultiSelectionPortrait			= UPIsengard_Army
	LoadScreenMusic				= Shell2MusicForLoadScreen
End


PlayerTemplate FactionDwarves
Side              		= Elves
	PlayableSide      		= Yes				; Please note: the presence of "SIDE:Elves" in the string file is what makes this appear in MP as a playable side.  And the skirmish scripts are what actually make it function.
	Evil			  	= No
	StartMoney        		= 0
	MaxLevelMP			= #DIVIDE( PLAYER_MAX_PURCHASE_POINTS_DEFAULT PLAYER_PURCHASE_POINTS_GRANTED )
	MaxLevelSP			= #DIVIDE( PLAYER_MAX_PURCHASE_POINTS_GOOD PLAYER_PURCHASE_POINTS_GRANTED )
	PreferredColor			= R:43 G:150 B:179
	StartingBuilding		= ElvenFortress
	
	;------------- NO STARTING UNITS FOR YOU -------
	;StartingUnit0 			= ElvenLorienArcherHorde 
	;StartingUnitOffset0 		= X:-70 Y:220 Z:0
	
	
	StartingUnit1 			= ElvenPorter 
	StartingUnitOffset1 		= X:30 Y:250 Z:0
	StartingUnit0 			= ElvenPorter
	StartingUnitOffset0 		= X:1 Y:160 Z:0
	
	StartingUnitTacticalWOTR	= ElvenPorter
	StartingUnitTacticalWOTR	= ElvenPorter
	IntrinsicSciences		= SCIENCE_GOOD
	IntrinsicSciencesMP 		= SCIENCE_ELVES
	SpellBook			= GoodSpellBook
	SpellBookMp			= ElvesSpellBook
	PurchaseScienceCommandSet	= GoodSpellStoreCommandSet
	PurchaseScienceCommandSetMP	= ElvesSpellStoreCommandSet
	DisplayName			= INI:FactionElves
	DefaultPlayerAIType		= ElvesSkirmishAI		; Needs to exist before I can change it.
	BeaconName			= MultiplayerBeacon
	LightPointsUpSound		= GondorLightPointsUp
	ObjectiveAddedSound		= Gui_MissionObjectiveNew
	ObjectiveCompletedSound		= Gui_MissionObjectiveCompleted
	InitialUpgrades			= Upgrade_ElfFaction		; Any upgrades this player template is born with.

	// NOTE: It is very important that the create-a-hero be the first buildable hero, to ensure that the create-a-hero and the ring hero are always 
	// attached to the first two buttons in the command set.

	BuildableHeroesMP		= CreateAHero ElvenHaldir ElvenGlorfindel ElvenArwen ElvenLegolas ElvenThranduil ElvenElrond 
	BuildableRingHeroesMP		= ElvenGaladriel_RingHero
	SpellStoreCurrentPowerLabel 	= APT:SpellStoreCurrentEvenstarPower
	SpellStoreMaximumPowerLabel 	= APT:SpellStoreMaximumEvenstarPower
	ResourceModifierObjectFilter 	= RESOURCE_MODIFIER_OBJECT_FILTER
	ResourceModifierValues		= 100 100 100 100 90 85 80 75 71 68 66
	MultiSelectionPortrait		= UPElvenArmy
	LoadScreenMusic			= Shell2MusicForLoadScreen
End

PlayerTemplate FactionAngmar
Side					= Mordor
	PlayableSide      			= Yes
	Evil			  		= Yes
	StartMoney        			= 0
	MaxLevelMP				= #DIVIDE( PLAYER_MAX_PURCHASE_POINTS_DEFAULT PLAYER_PURCHASE_POINTS_GRANTED )
	MaxLevelSP				= #DIVIDE( PLAYER_MAX_PURCHASE_POINTS_EVIL PLAYER_PURCHASE_POINTS_GRANTED )
	PreferredColor				= R:175 G:49 B:33
	StartingBuilding			= MordorFortress
	
	;------------- NO STARTING UNITS FOR YOU -------
	StartingUnit0 		= MordorPorter 
	StartingUnitOffset0 	= X:1 Y:240 Z:0
	
	StartingUnit1 		= MordorPorter
	StartingUnitOffset1 	= X:1 Y:190 Z:0
	
	StartingUnitTacticalWOTR		= MordorPorter
	StartingUnitTacticalWOTR		= MordorPorter
	IntrinsicSciences			= SCIENCE_EVIL
	IntrinsicSciencesMP 			= SCIENCE_MORDOR
	SpellBook				= EvilSpellBook
	SpellBookMp				= MordorSpellBook
	PurchaseScienceCommandSet		= EvilSpellStoreCommandSet
	PurchaseScienceCommandSetMP		= MordorSpellStoreCommandSet
	DisplayName				= INI:FactionMordor
	DefaultPlayerAIType			= MordorSkirmishAI
	BeaconName				= MultiplayerBeacon
	LightPointsUpSound			= MordorLightPointsUp
	ObjectiveAddedSound			= Gui_MissionObjectiveNew
	ObjectiveCompletedSound			= Gui_MissionObjectiveCompleted
	InitialUpgrades				= Upgrade_MordorDualEconomyChoice Upgrade_MordorFaction Upgrade_EvilDualEconomyChoice;Any upgrades this player template is born with.

	// NOTE: It is very important that the create-a-hero be the first buildable hero, to ensure that the create-a-hero and the ring hero are always 
	// attached to the first two buttons in the command set.
	BuildableHeroesMP			= CreateAHero MordorGothmog MordorMouthOfSauron KhamulFellBeast MorgomirFellBeast MordorWitchKingOnFellBeast ;// NeutralGollum EvilMenBlackRider EvilMenBlackRider MordorFellBeast MordorFellBeast
	BuildableRingHeroesMP			= MordorSauron_RingHero
	SpellStoreCurrentPowerLabel 		= APT:SpellStoreCurrentRingPower
	SpellStoreMaximumPowerLabel 		= APT:SpellStoreMaximumRingPower
	ResourceModifierObjectFilter 		= RESOURCE_MODIFIER_OBJECT_FILTER
	ResourceModifierValues			= 100 100 100 100 90 85 80 75 71 68 66
	MultiSelectionPortrait			= UPMordor_Army
	LoadScreenMusic				= Shell2MusicForLoadScreen
End

ChildObject WildAzog ElvenThranduil
RemoveModule ModuleTag_Camouflage
RemoveModule ModuleTag_MoveUnseenEnabler
RemoveModule ModuleTag_MoveUnseen
End
CommandButton Command_CreateAHero_BerserkerRage_Level1
	Command				= OBJECT_UPGRADE
	Options				= NEED_UPGRADE OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_WildForgedBlades
	NeededUpgrade		= Upgrade_TechnologyWildForgedBlades
	NeededUpgradeAny		= Yes
	TextLabel			= mega+furia
	ButtonImage			= BWTreasureTrove_ForgedBlades
	ButtonBorderType	= UPGRADE
	DescriptLabel		= mega+furiaDesc
	InPalantir			= Yes
	LacksPrerequisiteLabel		= mega+furiaLack
End

CommandButton Command_CreateAHero_BerserkerRage_Level2
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE NEED_UPGRADE
	Upgrade				= Upgrade_TechnologyWildForgedBlades
	NeededUpgrade		= Upgrade_IsengardArmoryLevel3 
	NeededUpgrade		= Upgrade_TechnologyIsengardForgedBlades
	NeededUpgrade		= Upgrade_TechnologyIsengardHeavyArmor
	;NeededUpgradeAny		= Yes
	TextLabel			= megafuria
	ButtonImage			= BWTreasureTrove_ForgedBlades
	ButtonBorderType	= UPGRADE
	DescriptLabel		= megafuriaDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= megafuriaLack
	
End

CommandSet NewIsengardFighterHordeCommandSet
	1	= Command_ToggleStance		
	2	= Command_ToggleFormationIsengardFighter
	3	= Command_CreateAHero_BerserkerRage_Level1
	4	= Command_PurchaseUpgradeIsengardBasicTraining
	5	= Command_IsengardBloodThirstySacrifice 
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandButton Command_SpecialAbilityWordOfPower
    Command                 = SPECIAL_POWER
  SpecialPower            = SpecialAbilityFakeLeadership2
  Options				  = NONPRESSABLE
  TextLabel               = CONTROLBAR:Pillage0
  ButtonImage             = UCCommon_Pillage
  RadiusCursorType        = TrainingRadiusCursor
  ;Upgrade		= Upgrade_LurtzPillage
  ButtonBorderType        = ACTION
  DescriptLabel           = CONTROLBAR:ToolTipLurtzPillage0
  InPalantir		  = Yes
End

CommandSet NewIsengardBeserkerCommandSet
	1	= Command_ToggleStance	
	2	= Command_SpecialAbilityLightTorch
        3       = Command_SpecialAbilityWordOfPower
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
End

Object IsengardBeserker
CommandSet = NewIsengardBeserkerCommandSet
AddModule
  Behavior = FireWeaponWhenDeadBehavior ModuleTag_DIELIKETHIS
    TriggeredBy = Upgrade_ObjectLevel2
    StartsActive = No
    DeathWeapon = IsengardExplosiveMineExplosionWeapon
  End
  End
 End


Object IsengardFighter
	ArmorSet
		Conditions      = None
		Armor           = UrukHaiArmor
		DamageFX        = NormalDamageFX
	End
	ArmorSet
		Conditions		= PLAYER_UPGRADE
		Armor			= UrukHaiHeavyArmor
		DamageFX		= NormalDamageFX
	End
	ArmorSet
		Conditions		= PLAYER_UPGRADE PLAYER_UPGRADE_2
		Armor			= UrukHaiHeavyArmor2
		DamageFX		= NormalDamageFX
	End
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee7
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf67866
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperIsengardSword

	End
      End

AddModule
	Behavior = ArmorUpgrade ArmorUpgradeModuleTag777
		TriggeredBy				= Upgrade_WildForgedBlades
		ArmorSetFlag			= PLAYER_UPGRADE_2
	End
End
End
Object IsengardFighterHorde
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp456778
		TriggeredBy			= Upgrade_IsengardForgedBlades Upgrade_IsengardHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= NewIsengardFighterHordeCommandSet
	End 
End
;CommandSet 		= NewIsengardFighterHordeCommandSet
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee7
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf67866
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperIsengardSword
	End
      End
End

Object IsengardPikeman
 	ArmorSet
    	  	Conditions      = None
    	  	Armor           = UrukPikeArmor
    	  	DamageFX        = NormalDamageFX
  	End
  	ArmorSet
	  	Conditions      = PLAYER_UPGRADE
	  	Armor           = UrukPikeHeavyArmor
		DamageFX        = NormalDamageFX	
  	End

  	ArmorSet
	  	Conditions      = PLAYER_UPGRADE PLAYER_UPGRADE_2
	  	Armor           = UrukPikeHeavyArmor2
		DamageFX        = NormalDamageFX	
  	End

AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee7
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf67866
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperIsengardSword

	End
      End

AddModule
	Behavior = ArmorUpgrade ArmorUpgradeModuleTag788
		TriggeredBy				= Upgrade_WildForgedBlades
		ArmorSetFlag			= PLAYER_UPGRADE_2
	End
End
End

CommandSet NewIsengardPikemanHordeCommandSet
	1	= Command_ToggleStance
	2	= Command_IsengardPikemanPorcupineFormation
	3	= Command_PurchaseUpgradeIsengardForgedBlades
	4	= Command_PurchaseUpgradeIsengardHeavyArmor
	5	= Command_PurchaseUpgradeIsengardBasicTraining
        6       = Command_CreateAHero_BerserkerRage_Level1
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

Object IsengardPikemanHorde
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567786
		TriggeredBy			= Upgrade_IsengardForgedBlades Upgrade_IsengardHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= NewIsengardPikemanHordeCommandSet
	End 
End
;CommandSet 		= NewIsengardFighterHordeCommandSet
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee7
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf67866
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperIsengardSword
	End
      End
End

CommandSet NewWargRiderHordeCommandSet	
	1	= Command_ToggleStance	
	2  	= Command_SpecialAbilityWargHowl
	3 	= Command_PurchaseUpgradeIsengardForgedBlades
	4 	= Command_PurchaseUpgradeIsengardHeavyArmor
	5 	= Command_PurchaseUpgradeIsengardBasicTraining
        6       = Command_CreateAHero_BerserkerRage_Level1
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

;-------------

Object IsengardWargRider
	ArmorSet
		Conditions      = None
		Armor           = WargArmor
		DamageFX        = NormalDamageFX
	End
	ArmorSet
		Conditions      = PLAYER_UPGRADE
		Armor           = WargHeavyArmor
		DamageFX        = NormalDamageFX	
	End
	ArmorSet
		Conditions      = PLAYER_UPGRADE PLAYER_UPGRADE_2
		Armor           = WargHeavyArmor2
		DamageFX        = NormalDamageFX	
	End
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee7
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf67866
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperIsengardSword

	End
      End

AddModule
	Behavior = ArmorUpgrade ArmorUpgradeModuleTag7878
		TriggeredBy				= Upgrade_WildForgedBlades
		ArmorSetFlag			= PLAYER_UPGRADE_2
	End
End
End

Object IsengardWargRiderHorde
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567786
		TriggeredBy			= Upgrade_IsengardForgedBlades Upgrade_IsengardHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet		= NewWargRiderHordeCommandSet
	End 
End
;CommandSet 		= NewIsengardFighterHordeCommandSet
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee7
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf67866
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperIsengardSword
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf6786688
		TriggeredBy				= Upgrade_WildSpiderVenomSackScience
		AttributeModifier		= WargAttack
	End
      End
End

Object IsengardWargPackHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf6786688
		TriggeredBy				= Upgrade_WildSpiderVenomSackScience
		AttributeModifier		= WargAttack
	End
      End
End


;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


CommandButton Command_CreateAHero_HowlOfRage_Level1
		Command				= OBJECT_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_WildHeavyArmor
	NeededUpgrade		= Upgrade_TechnologyWildHeavyArmor
        ;NeededUpgradeAny        = Yes
	TextLabel			= beastP
	ButtonImage			= BWTreasureTrove_BannerCarrier
	ButtonBorderType	= UPGRADE
	DescriptLabel		= beastPDesc
	InPalantir			= Yes
	LacksPrerequisiteLabel		= beastPLack
End


Armor WargHeavyArmor2
  Armor = DEFAULT        	 17%   	; 100%	originally 50%
  Armor = SLASH          	 14%   	; 100%	originally 40%
  Armor = PIERCE          	 10%   	;  50%	originally 25%
  Armor = SPECIALIST      	37%   	;  50%	originally 100%
  Armor = CRUSH           	  1%   	; 200%
  Armor = CAVALRY	 	34%   	; 	Originally 50%
  Armor = SIEGE          	 17%   	;
  Armor = FLAME          	 17%   	;  30%
  Armor = FROST          	 17%   ;
  Armor = MAGIC          	 17%   	;
  Armor = HERO            	34%   	;
  Armor = HERO_RANGED     	34%   	; 
  Armor = STRUCTURAL   		 10%    ;	originally 20%
  FlankedPenalty 	       = 50%   
End

Armor UrukPikeHeavyArmor2		; Newly added for the expansion
  Armor = DEFAULT            	 20% 	;  
  Armor = SLASH              	34% 	;  
  Armor = PIERCE             	 20% 	;	RotWK originally 90%  
  Armor = SPECIALIST         	 19% 	;	
  Armor = CAVALRY	 	 9% 	;	
  Armor = CRUSH             	 17% 	;  
  Armor = SIEGE              	 17% 	; 
  Armor = FLAME              	 17% 	;  
  Armor = FROST          	 17%   ;
  Armor = MAGIC              	 17% 	;
  Armor = HERO                	34% 	; 
  Armor = HERO_RANGED         	34% 	;     
  Armor = STRUCTURAL	 	7%	;
  FlankedPenalty 	       = 50%  
End

Armor UrukHaiHeavyArmor2
  Armor = DEFAULT            	 12% 	;  40%	originally 50%
  Armor = SLASH              	 12% 	;  40%	originally 50%
  Armor = PIERCE             	 10% 	;  20%	originally 75%		RotWK originally 35%
  Armor = SPECIALIST         	 4% 	;	originally 20%
  Armor = CAVALRY	 	 30% 	;	originally 75%
  Armor = CRUSH             	 22% 	;  	originally 50%
  Armor = SIEGE              	 17% 	; 100%
  Armor = FLAME              	 17% 	;   0%
  Armor = FROST          	 17%   ;
  Armor = MAGIC              	 17% 	; 100%
  Armor = HERO                	34% 	;  50%
  Armor = HERO_RANGED         	34% 	;  50%   
  Armor = STRUCTURAL	 	 7%	;	originally 20%
  FlankedPenalty 	       = 50%  
End


FXParticleSystem WizardTowerStormClouds1
  System
    Priority = VERY_LOW_OR_ABOVE
    Shader = ALPHA
    ParticleName = EXsmokeplume2.tga
    Lifetime = 100 100
    SystemLifetime = 100
    SortLevel = 1
    Size = 15 15
    StartSizeRate = 1 1
    BurstDelay = 8 8
    BurstCount = 1 1
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color1 = R:232 G:247 B:253 0
    Color2 = R:134 G:156 B:168 50
    Color3 = R:235 G:247 B:254 100
    ColorScale = -15 10
  End
  Alpha = DefaultAlpha
    Alpha2 = 1 1 50
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 0.5 0.5
    SizeRateDamping = 0.98 0.99
    AngleZ = 0 7
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1.03 1.03
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.05 0.05
    Y = -0.05 0.05
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 25
    Length = 3
    Offset = X:0 Y:0 Z:5
  End
  Draw = DefaultDraw
  End
End

Weapon MegaUrukSword ; BALANCE Rohirrim Weapon
	RadiusDamageAffects	= ENEMIES 
  LeechRangeWeapon      = Yes
  AttackRange           = STANDARD_MELEE_ATTACK_RANGE
  MeleeWeapon           = Yes
  FireFX                = FX_GondorSwordHit
  FireFlankFX		= FX_Flanking
  DelayBetweenShots     = ANGMAR_SNOWTROLL_DELAYBETWEENSHOTS           ; time between shots, msec
  PreAttackDelay        = ANGMAR_SNOWTROLL_PREATTACKDELAY             ; 400 is sword swing delay time before contact with target.
  PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
  FiringDuration        = ANGMAR_SNOWTROLL_FIRINGDURATION     ; Duration of the sword swing

	DamageNugget                        ; A basic Nugget that just does damage
		Damage					= ANGMAR_SNOWTROLL_PICK_DAMAGE_UPGRADE
		Radius					= 0.0
		DelayTime				= 0
		DamageType				= SIEGE
		DamageFXType				= SWORD_SLASH
		DeathType				= NORMAL
		ForbiddenUpgradeNames			= Upgrade_AngmarDarkIronBlades
		FlankingBonus = 50%
	End


   	DamageNugget
		Damage					= ANGMAR_SNOWTROLL_PICK_DAMAGE_UPGRADE
		Radius					= 0.0
		DelayTime				= 0
		DamageType				= SIEGE
		DamageFXType				= SWORD_SLASH
		DeathType				= NORMAL
		RequiredUpgradeNames    		= Upgrade_AngmarDarkIronBlades
		FlankingBonus = 50%
	End
End


FXParticleSystem DrogothBreathProxy+
  System
    Priority = MEDIUM_OR_ABOVE
    ParticleName = EXFireScroll3.tga
    Lifetime = 0 0
    SystemLifetime = 85
    SortLevel = 1
    Size = 1 1
    BurstDelay = 1 1
    BurstCount = 1 1
    InitialDelay = 30 30
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color1 = R:0 G:2 B:9 0
    Color2 = R:16 G:11 B:7 6
    Color3 = R:14 G:10 B:7 15
    Color4 = R:0 G:0 B:0 40
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 0.99 0.99
    AngleZ = -3 3
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = -0.1
    VelocityDamping = 0.93 0.95
    DriftVelocity = X:0 Y:0 Z:0.05
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 12 12
    Y = -4 4
    Z = -10 1
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:5 Y:-5 Z:0
    EndPoint = X:5 Y:-5 Z:0
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindStrength = 0.1
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
    TurbulenceAmplitude = 0.02
    TurbulenceFrequency = 25
  End
  Event = TerrainCollision
    HeightOffset = 0 0
    EventFX = FX_SummonDragonImpact
    OrientFXToTerrain = No
    PerParticle = Yes
    KillAfterEvent = Yes
  End
End

FXParticleSystem balrogBreathSmoke+
  System
    Priority = MEDIUM_OR_ABOVE
    Shader = ALPHA
    ParticleName = EXCloud03.tga
    Lifetime = 0 0
    SystemLifetime = 85
    SortLevel = 1
    Size = 1 5
    BurstCount = 1 5
    InitialDelay = 40 40
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color1 = R:247 G:150 B:62 15
    Color2 = R:0 G:0 B:0 30
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.5 0.5 0
    Alpha2 = 0 0 30
  End
  Update = DefaultUpdate
    SizeRate = 2 3
    SizeRateDamping = 0.9 0.99
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.8 0.85
    DriftVelocity = X:0 Y:0 Z:0.24
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 3 5
    Y = 5 10
    Z = 0.024 0.04
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.1
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
    TurbulenceAmplitude = 0.02
    TurbulenceFrequency = 25
  End
End

FXParticleSystem balrogBreathEmbers+
  System
    Priority = VERY_LOW_OR_ABOVE
    ParticleName = EXEmbersLight.tga
    Lifetime = 0 0
    SystemLifetime = 85
    Size = 25 25
    BurstCount = 1 3
    InitialDelay = 40 40
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color1 = R:250 G:216 B:114 0
    Color2 = R:0 G:0 B:0 40
  End
  Update = DefaultUpdate
    SizeRate = -1 1
    SizeRateDamping = 0.99 0.99
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.6 0.7
    DriftVelocity = X:0 Y:0 Z:0.4
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 10 10
    Y = 20 20
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.1
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
    TurbulenceAmplitude = 0.02
    TurbulenceFrequency = 25
  End
End

FXParticleSystem DrogothFireBreath+
  System
    Priority = VERY_LOW_OR_ABOVE
    IsOneShot = Yes
    ParticleName = EXFireScroll3.tga
    Lifetime = 0 0
    SystemLifetime = 85
    SortLevel = 1
    Size = 10 20
    BurstCount = 7 7
    InitialDelay = 30 30
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color1 = R:12 G:3 B:171 0
    Color2 = R:97 G:69 B:51 6
    Color3 = R:97 G:69 B:51 15
    Color4 = R:0 G:0 B:0 40
  End
  Update = DefaultUpdate
    SizeRate = 1 2
    SizeRateDamping = 1 1
    AngleZ = -3 3
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.93 0.95
    DriftVelocity = X:0 Y:0 Z:0.05
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 12 12
    Y = -4 4
    Z = -1 5
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:5 Y:-5 Z:0
    EndPoint = X:5 Y:-5 Z:0
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindStrength = 0.1
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
    TurbulenceAmplitude = 0.02
    TurbulenceFrequency = 25
  End
End

FXParticleSystem DragonStrikeFireBreath+
  System
    Priority = VERY_LOW_OR_ABOVE
    ParticleName = EXFire01.tga
    PerParticleAttachedSystem = DragonStrikeFireBreathSlave+
    Lifetime = 0 0
    SystemLifetime = 170
    SortLevel = 1
    Size = 1 1
    BurstCount = 0 2
    InitialDelay = 68 68
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color1 = R:48 G:34 B:5 0
    Color2 = R:226 G:149 B:71 0
    Color3 = R:125 G:43 B:15 0
  End
  Update = DefaultUpdate
    SizeRateDamping = 0.99 0.99
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -1 1
    Y = -1 1
    Z = -10 -10
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.1
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
    TurbulenceAmplitude = 0.02
    TurbulenceFrequency = 25
  End
  Event = TerrainCollision
    HeightOffset = 0 0
    EventFX = FX_DragonStrikeGround
    OrientFXToTerrain = No
    PerParticle = Yes
    KillAfterEvent = Yes
  End
End

FXParticleSystem DragonStrikeFireBreath02+
  System
    Priority = VERY_LOW_OR_ABOVE
    ParticleName = EXFire01.tga
    PerParticleAttachedSystem = DragonStrikeFireBreathSlave02+
    Lifetime = 0 0
    SystemLifetime = 170
    SortLevel = 1
    Size = 1 1
    BurstCount = 0 2
    InitialDelay = 68 68
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color1 = R:48 G:34 B:5 0
    Color2 = R:226 G:149 B:71 0
    Color3 = R:125 G:43 B:15 0
  End
  Update = DefaultUpdate
    SizeRateDamping = 0.99 0.99
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -1 1
    Y = -1 1
    Z = -10 -10
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.1
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
    TurbulenceAmplitude = 0.02
    TurbulenceFrequency = 25
  End
  Event = TerrainCollision
    HeightOffset = 0 0
    EventFX = FX_DragonStrikeGround
    OrientFXToTerrain = No
    PerParticle = Yes
    KillAfterEvent = Yes
  End
End

FXParticleSystem DragonStrikeFireBreathSlave+
  System
    Priority = VERY_LOW_OR_ABOVE
    IsOneShot = Yes
    ParticleName = EXexplo03.tga
    Lifetime = 0 0
    SystemLifetime = 25
    SortLevel = 1
    Size = 10 15
    BurstCount = 1 1
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color2 = R:126 G:77 B:39 5
    Color3 = R:107 G:65 B:33 15
    Color4 = R:0 G:0 B:0 20
  End
  Update = DefaultUpdate
    SizeRate = 2 2
    SizeRateDamping = 0.99 0.99
    AngleZ = 0 7
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
    DriftVelocity = X:0 Y:0 Z:-1
  End
  EmissionVelocity = OrthoEmissionVelocity
    Z = -1 -1
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem DragonStrikeFireBreathSlave02+
  System
    Priority = VERY_LOW_OR_ABOVE
    IsOneShot = Yes
    Shader = ALPHA
    ParticleName = EXfireballC.tga
    Lifetime = 0 0
    SystemLifetime = 50
    SortLevel = 1
    Size = 10 15
    BurstCount = 1 1
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
    Color3 = R:107 G:65 B:33 0
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.1 0.25 5
    Alpha3 = 0 0 20
  End
  Update = DefaultUpdate
    SizeRate = 2 2
    SizeRateDamping = 0.99 0.99
    AngleZ = 0 7
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
    DriftVelocity = X:0 Y:0 Z:-1
  End
  EmissionVelocity = OrthoEmissionVelocity
    Z = -1 -1
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
End

;//Fire Arrow technology to be purchased by a building
CommandButton Command_DominateTroll
Command				= PLAYER_UPGRADE
	Options				= CANCELABLE NEED_UPGRADE
	Upgrade				= Upgrade_TechnologyWildHeavyArmor
        NeededUpgradeAny                = Yes
	NeededUpgrade		= Upgrade_MordorTrollCageLevel3
	TextLabel			= beastpowergeneral
	ButtonImage			= BWTreasureTrove_BannerCarrier
	ButtonBorderType	= UPGRADE
	DescriptLabel		= beastpowergeneralDesc
	Radial				= Yes
	InPalantir			= Yes
End

CommandSet NewMordorMumakilCommandSet
	1	= Command_ToggleStance	
	2	= Command_ChargeAttack
	3	= Command_PurchaseUpgradeMordorFireArrows
	4	= Command_PurchaseUpgradeMordorBasicTraining
        5       = Command_CreateAHero_HowlOfRage_Level1
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

Object MordorMumakil
CommandSet = NewMordorMumakilCommandSet

      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality378
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3785
		TriggeredBy = Upgrade_TechnologyWildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= BeastPower
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End
End

;-----------Alcune Cose Mordor-----------------------------
FXList FX_MeglioAbbondare
	ParticleSystem
		Name = LevelUpGlow
	End
End



ModifierList Boost
	Category					= SPELL
	Modifier					= HEALTH 50 // Additive. Sum of these are subtracted from all entries in armor.ini
	Modifier					= DAMAGE_ADD 50	// Multiplicative.  Should make you do less damage
	FX							= FX_LevelUp; FX_MeglioAbbondare
	Duration					= 0
	;ReplaceInCategoryIfLongest	= Yes
	;IgnoreIfAnticategoryActive	= Yes	
End

;-----------------------------------
Weapon MordorEasterlingPikeSword     ; BALANCE Mordor Easterling Pike
  LeechRangeWeapon      = Yes
  AttackRange           = 30
  MeleeWeapon           = Yes ; Melee means to square off next to opponent.  This is more of a ranged weapon with no projectile
  PreAttackDelay        = MORDOR_SOLDIERRHUN_PREATTACKDELAY             ; 867 is lance pierce delay time before contact with target.
  FiringDuration        = MORDOR_SOLDIERRHUN_FIRINGDURATION    ; Duration of the lance pierce attack
  DelayBetweenShots     = MORDOR_SOLDIERRHUN_DELAYBETWEENSHOTS            ; time between shots, msec
  PreAttackType         = PER_SHOT ; Do the delay each time we attack
  FireFX                = FX_GondorSwordHit
  
  AcceptableAimDelta	= 15.0 
  RequireFollowThru		= Yes

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        			= MORDOR_SOLDIERRHUN_DAMAGE
    Radius        			= 10.0
    DelayTime     			= 0
    DamageType    			= SLASH
    DamageFXType  			= SWORD_SLASH
    DeathType     			= NORMAL
    DamageScalar  = 200% ANY +STRUCTURE
    ForbiddenUpgradeNames	= Upgrade_MordorForgedBlades
  End

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        			= MORDOR_SOLDIERRHUN_DAMAGE_UPGRADED
    Radius        			= 10.0
    DelayTime     			= 0
    DamageType    			= SLASH
    DamageFXType  			= SWORD_SLASH
    DeathType     			= NORMAL
    DamageScalar  = 200% ANY +STRUCTURE
    RequiredUpgradeNames	= Upgrade_MordorForgedBlades
  End
End

CommandSet NewMordorEasterlingHordeCommandSet
	1 	= Command_ToggleStance
	2 	= Command_PurchaseUpgradeMordorBasicTraining
	3	= Command_PurchaseUpgradeMordorHeavyArmor
	4	= Command_PurchaseUpgradeMordorForgedBlades
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

ChildObject GoblinArcher MordorHaradrimOverlordObsolete
	LocomotorSet
		Locomotor			=	HumanLocomotor
		Condition			=	SET_NORMAL 
		Speed				=	NORMAL_FOOT_SLOW_MEMBER_SPEED
	End
	ArmorSet
		Conditions	= None
		Armor		= RhunArmor
		DamageFX	= NormalDamageFX
	End
	ArmorSet 
		Conditions	= PLAYER_UPGRADE
		Armor		= RhunHeavyArmor
		DamageFX	= NormalDamageFX
	End

	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY MordorEasterlingPike
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	ButtonImage	= WOR_Easterling
	SelectPortrait	= UPMordor_Eastering
	CommandSet 		= NewMordorEasterlingHordeCommandSet

  CommandPoints = 6
ReplaceModule ModuleTag_02
  Body = ActiveBody ModuleTag_026
    MaxHealth         = 400 ;BALANCE Overlord Health
    MaxHealthDamaged  = 5
    ;RecoveryTime      = 5000
  End
End
AddModule
	Behavior = ArmorUpgrade ArmorUpgradeModuleTag
		TriggeredBy = Upgrade_MordorHeavyArmor
		ArmorSetFlag			= PLAYER_UPGRADE
	End
End
AddModule	
	Behavior = SubObjectsUpgrade ForgedBlades_Upgrade
		TriggeredBy		= Upgrade_MordorForgedBlades
		ShowSubObjects	= Forged_Blade
	End
	End
AddModule
	Behavior = StatusBitsUpgrade ForgedBlades_UpgradeDetection
		TriggeredBy		= Upgrade_MordorForgedBlades
	End
End
End

Object GoblinArcherHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced26
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
	End
	ButtonImage	= WOR_Easterling
	SelectPortrait	= UPMordor_Eastering
	KindOf 			= SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND;UNATTACKABLE
	BuildCost = 550
	BuildTime = MORDOR_SOLDIERRHUN_BUILDTIME  
	WeaponSet
		Conditions 	= None 
		Weapon 		= PRIMARY    TowerGuardHordeRangefinder
	End
	DisplayName		= OBJECT:HordeMordorEasterlings
	CommandSet 		= NewMordorEasterlingHordeCommandSet
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain6
		FrontAngle = 270
		FlankedDelay = 2000
		ObjectStatusOfContained = 
		InitialPayload	= GoblinArcher 15
		Slots			= 15
		PassengerFilter = NONE +INFANTRY
		ShowPips		= No

		; Banner Carrier info		
		BannerCarriersAllowed	= MordorBannerOrc		; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:GoblinArcher		Pos:X:75.0 Y:0.0	; (DEFAULT) position of banner carrier for fighter horde
		
		RandomOffset = X:5 Y:5
		
		
		
		RankInfo = RankNumber:1 UnitType:GoblinArcher Position:X:50 Y:0			Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:GoblinArcher Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:GoblinArcher Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		;RankInfo = RankNumber:3 UnitType:GoblinArcher Position:X:-10 Y:0 Leader 3 0	Position:X:-10 Y:20 Leader 3 1	Position:X:-10 Y:-20 Leader 3 2	Position:X:-10 Y:40 Leader 3 3	Position:X:-10 Y:-40 Leader 3 4
		



		RanksToReleaseWhenAttacking = 1 2 3 
		;MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
		
	End
End
End

;------------------------------------
Weapon AngmarSwordUpgradedWithPlus
RadiusDamageAffects		= NEUTRALS SELF ENEMIES
LeechRangeWeapon      = Yes
  AttackRange           = STANDARD_MELEE_ATTACK_RANGE
  MeleeWeapon           = Yes
  DelayBetweenShots     = ANGMAR_SWORD_DELAYBETWEENSHOTS  ; Bad Things happen if delay between shots is less than Preattack+Firing times.  You are ready to fire before you are done firing.
  PreAttackDelay        = ANGMAR_SWORD_PREATTACKDELAY             ; 400 is sword swing delay time before contact with target.
  PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
  FireFX                = FX_GondorSwordHit
  FireFlankFX		= FX_Flanking
  FiringDuration        = ANGMAR_SWORD_FIRINGDURATION    ; Duration of the sword swing

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        = ANGMAR_SWORD_DAMAGE_UPGRADE
    Radius        = 10.0
    DelayTime     = 0
    DamageType    = SIEGE
    DamageFXType  = SWORD_SLASH
    DeathType     = NORMAL
    FlankingBonus = 50%
  End
	AttributeModifierNugget
		AttributeModifier        = Boost
		Radius			 = 150
		SpecialObjectFilter      = ALL ;-HORDE
		AffectHordeMembers 	= Yes		//This will propagate the effect down to the horde members
	End 
End


ChildObject WildSpiderlingHordeMember MordorFighter
RemoveModule ModuleTag_01
AddModule
  Draw = W3DScriptedModelDraw ModuleTag_01y
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    DefaultModelConditionState
      Model               = CineOrcMorA_SKN
;      Model               = CineOrcMorB_SKN  ExtraMesh:Yes
;     ShareAnimation      = Yes
    End

	IdleAnimationState
		StateName = STATE_Idle
		Flags = RANDOMSTART
		Animation = IDLL
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLL ;<- gentle crouch----------------
			AnimationPriority = 20
			AnimationBlendTime = 30
		End
		Animation = IDLN
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLN ;<- gentle crouch------------------
			AnimationPriority = 20
			AnimationBlendTime = 30
		End
		Animation = IDLC
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLC ;<- nod over shoulder
		End
;			Animation = IDLK
;				AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLK ;<-- scratch back this anim has a glitch
;			End
	End
  
    AnimationState = THROWN_PROJECTILE
		Animation = Thrown
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_FLYA
		    AnimationMode = LOOP
		End
		Animation = Thrown
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_FLYB
		    AnimationMode = LOOP
		End
		Animation = Thrown
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_FLYC
		    AnimationMode = LOOP
		End
    End    
  
    AnimationState = PASSENGER SIEGE_CONTAIN
		Animation = IDLP
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLS ;<- gentle crouch----------------
			AnimationBlendTime = 5
			AnimationMode = LOOP
		End
    End
    
    AnimationState				=	MOVING BACKING_UP
		Animation				=	BackingUpA
			AnimationName		=	MUOrcWarr_SKL.MUOrcWarr_BAKA
			AnimationMode		=	LOOP
		End
		Animation				=	BackingUpB
			AnimationName		=	MUOrcWarr_SKL.MUOrcWarr_BAKB
			AnimationMode		=	LOOP
		End
		Flags					=	RANDOMSTART 
	End

    AnimationState = MOVING DAMAGED
		Animation = Move_Damaged
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IWKA ;32
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
    End
    
    AnimationState = MOVING WANDER
		Animation = Walk
			;AnimationName = MUOrcWarr_SKL.MUOrcWarr_WLKD
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_WLKE
			AnimationSpeedFactorRange = 1.5 1.5
			AnimationMode = LOOP
		End
    End
    

    AnimationState = MOVING
		Flags		= RANDOMSTART
		Animation = RUNA
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_RUNA 
			AnimationMode = LOOP
;		    ShareAnimation = Yes
		End
		Animation = RUNB
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_RUNB 
			AnimationMode = LOOP
;		    ShareAnimation = Yes
		End
		Animation = WLKA
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_WLKA 
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 1.5 1.5
		End
		Animation = WLKB
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_WLKB 
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 1.5 1.5
		End
		Animation = WLKC
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_WLKC 
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 1.5 1.5
		End
    End

;    ConditionState        = MOVING WANDER
;      Animation           = MUOrcWarr_SKL.MUOrcWarr_WLKA ;32
;      Animation           = MUOrcWarr_SKL.MUOrcWarr_WLKB
;      Animation           = MUOrcWarr_SKL.MUOrcWarr_WLKC
;      Animation           = MUOrcWarr_SKL.MUOrcWarr_WLKD
;      AnimationMode       = LOOP
;      ParticleSysBone     = None InfantryDustTrails
;    End
;    AliasConditionState   = MOVING WANDER DAMAGED
 
    AnimationState = MOVING CLIMBING BACKING_UP
		Animation = Climbing_Down
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_CLMA
			AnimationMode = LOOP_BACKWARDS
		End
    End
    
    AnimationState = MOVING WANDER
		Animation = Walk
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_WLKD
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_WLKE
			AnimationSpeedFactorRange = 0.1 0.1
			AnimationMode = LOOP
		End
    End

    AnimationState = MOVING CLIMBING
		Animation = Climbing_Up
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_CLMA
			AnimationMode = LOOP
		End
    End

    AnimationState = FIRING_OR_PREATTACK_A
		Animation = ATKA
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_ATKA
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		Animation = ATKB
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_ATKB
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		Animation = ATKC
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_ATKC
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
    End

    AnimationState = DYING SPLATTED
		Animation = Splatted_On_Ground
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_LNDA
			AnimationMode = ONCE
		End
		EnteringStateFX = FX_OrcHitGround
    End

    AnimationState = DYING AFLAME
		Animation = Flaming_Death
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_MFDA
			AnimationMode = LOOP
		End
    End

    AnimationState = DYING
		Animation = Dying_1
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_DIEA
			AnimationMode = ONCE
		End
		Animation = Dying_2
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_DIEB
			AnimationMode = ONCE
		End
    End

    AnimationState = PASSENGER
		Animation = Wiggle
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_FLLA
		    AnimationMode = LOOP
		End
    End

    ; --- stunned anims
    AnimationState = STUNNED_FLAILING
		Animation = Flying_1
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_FLYA
			AnimationMode = ONCE
		End
		Animation = Flying_2
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_FLYB
			AnimationMode = ONCE
		End
		Animation = Flying_3
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_FLYC
			AnimationMode = ONCE
		End
		Flags = RANDOMSTART
    End

    AnimationState = STUNNED
		Animation = Splatted_On_Ground
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_LNDA
			AnimationMode = ONCE
		End
		EnteringStateFX = FX_OrcHitGround
    End

    AnimationState = STUNNED_STANDING_UP  
		Animation = Standing_Back_Up
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_GTPA
			AnimationMode = ONCE
		End
    End
    
    AnimationState = SELECTED
		StateName			= STATE_Selected
		SimilarRestart		=   Yes
		Flags				= RESTART_ANIM_WHEN_COMPLETE 
		Animation = IDLO
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLO ;<- doin the locomotion
			AnimationMode		= ONCE
			AnimationBlendTime = 10
			AnimationSpeedFactorRange = 0.6 0.8
		End
		Animation = IDLM
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLM ;<- stand with axe raised
			AnimationMode		= ONCE
			AnimationBlendTime = 10
			AnimationSpeedFactorRange = 0.6 0.8
		End
		Animation = SelectedIDLA
			AnimationName		= MUOrcWarr_SKL.MUOrcWarr_IDLA ;<- gentle stand
			AnimationMode		= ONCE
			AnimationBlendTime	= 10
			AnimationSpeedFactorRange = 0.6 0.8
		End
		Animation = IDLE
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLE ;<- gentle
			AnimationMode		= ONCE
			AnimationBlendTime	= 10
			AnimationSpeedFactorRange = 0.6 0.8
		End
		Animation = IDLH
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLH ;<- check-out blade
			AnimationMode		= ONCE
			AnimationBlendTime	= 10
			AnimationSpeedFactorRange = 0.6 0.8
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
		EndScript
    End
    
    TransitionState = TRANS_Idle_to_Selected
		Animation = IDLD
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLD ;<- chop the ground
			AnimationSpeedFactorRange = 0.9 1.1
		End
		Animation = IDLB
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLB ;<- both arms in air
			AnimationSpeedFactorRange = 0.9 1.1
		End
		Animation = IDLJ
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLJ ;<- swing axe up
			AnimationSpeedFactorRange = 0.9 1.1
		End
		Animation = IDLG
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLG ;<- throws axe in air
			AnimationSpeedFactorRange = 0.9 1.1
		End
		Animation = IDLF
			AnimationName = MUOrcWarr_SKL.MUOrcWarr_IDLF ;<- stretch & shake
			AnimationSpeedFactorRange = 0.9 1.1
		End
		Flags					= RESTART_ANIM_WHEN_COMPLETE RANDOMSTART
    End
    
    ;-emotions--
  		AnimationState					= EMOTION_MORALE_HIGH ;EMOTION_ALERT
			Animation					= Taunting
				AnimationName			= MUOrcWarr_SKL.MUOrcWarr_IDLB
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.8 1.2			
			End
			Animation					= Taunting2
				AnimationName			= MUOrcWarr_SKL.MUOrcWarr_IDLF
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.8 1.2			
			End
			Animation					= Taunting3
				AnimationName			= MUOrcWarr_SKL.MUOrcWarr_IDLG
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.8 1.2			
			End
			Flags						= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End

    	AnimationState					= EMOTION_AFRAID
			Animation					= FERA
				AnimationName			= MUOrcWarr_SKL.MUOrcWarr_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= MUOrcWarr_SKL.MUOrcWarr_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= MUOrcWarr_SKL.MUOrcWarr_FERC
				AnimationMode			= LOOP
			End
		End
		
		AnimationState				=	EMOTION_CELEBRATING
			Animation           =	CHRA
				AnimationName   =	MUOrcWarr_SKL.MUOrcWarr_CHRA
				AnimationMode   =	ONCE
				AnimationPriority	=	10
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE	
		End
End
End

  ; ***DESIGN parameters ***
  Side = Mordor
  EditorSorting = UNIT
  Browser = CINEMATICS UNIT
  ThingClass = HORDE_UNIT
  TransportSlotCount = 1
  EmotionRange = 240
  
  WeaponSet
    Conditions = None 
    Weapon = PRIMARY    AngmarSwordUpgradedWithPlus
    AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
  End
  ArmorSet
    Conditions      = None
    Armor           = HeroArmor
    DamageFX        = NormalDamageFX
  End
ReplaceModule ModuleTag_02
	Body = ActiveBody ModuleTag_026
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = 600
		MaxHealthDamaged  = MORDOR_FIGHTER_HEALTH_DAMAGED
		BurningDeathBehavior = Yes
		BurningDeathFX       = FX_InfantryBurningFlame
	End
End
AddModule
	Behavior = CreateObjectDie ModuleTag_06
		DeathTypes = ALL
		CreationList = OCL_TaintSeed
	End
;AddModule
	;Behavior = FireWeaponUpdate ModuleTag_WeaponFiringu
		;FireWeaponNugget
			;\\WeaponName = TaintAttack
			;\\Offset = X:0 Y:0 Z:0
			;\\FireDelay = 10000
			;\\OneShot = No
		;\\End
	;\\End
;\\End
End
End

CommandButton Command_BloodThirstySacrifice
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= poteiznapk
  ButtonImage             	= HSFaramirLeadership
  RadiusCursorType        	= TrainingRadiusCursor
  ;Upgrade			= Upgrade_AragornLeadership
  ButtonBorderType        	= ACTION
  DescriptLabel           	= poteiznapkDesc
  InPalantir		  	= Yes
End

;--------------
CommandSet EliteMordorCommandset
	1 	= Command_ToggleStance	
	2 	= Command_BloodThirstySacrifice
	;3 	= Command_PurchaseUpgradeMordorBasicTraining
;	;4	= Command_PurchaseUpgradeMordorHeavyArmor	; BFME2 Expansion Faction Enhancement
;	5	= Command_PurchaseUpgradeMordorForgedBlades	; BFME2 Expansion Faction Enhancement
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

Object WildSpiderlingHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced26
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_MED_HORDE_SPEED
	End
CommandSet = EliteMordorCommandset
BuildCost = 800

ReplaceModule ModuleTag_HordeContain
		Behavior = HordeContain ModuleTag_HordeContain5
	
		FrontAngle 		= 270
		FlankedDelay 		= 2000
		
		ObjectStatusOfContained	= 
		InitialPayload		= WildSpiderlingHordeMember 15
		Slots			= 15
		PassengerFilter		= ANY +WildSpiderlingHordeMember +WildBannerSpiderling
		ShowPips		= No
		
		RandomOffset		= X:2 Y:2	
		
		MeleeBehavior		 = Amoeba
		End
		
		;RankInfo		= RankNumber:1 UnitType:WildSpiderlingHordeMember	Position:X:25 Y:-25 	Position:X:25 Y:0 	Position:X:25 Y:25 Position:X:25 Y:50 Position:X:25 Y:-50		

		; Banner Carrier info		
		BannerCarriersAllowed	= MordorBannerOrc								; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:WildSpiderlingHordeMember	Pos:X:50.0 Y:0.0	; (DEFAULT) position of banner carrier for fighter horde

		RankInfo = RankNumber:1 UnitType:WildSpiderlingHordeMember Position:X:25 Y:-25		Position:X:25 Y:0		Position:X:25 Y:25		Position:X:25 Y:50		Position:X:25 Y:-50 
		RankInfo = RankNumber:2 UnitType:WildSpiderlingHordeMember Position:X:0 Y:-25 Leader 1 0	Position:X:0 Y:0 Leader 1 1	Position:X:0 Y:25 Leader 1 2	Position:X:0 Y:50 Leader 1 3	Position:X:0 Y:-50 Leader 1 4
                RankInfo = RankNumber:2 UnitType:WildSpiderlingHordeMember Position:X:-25 Y:-25 Leader 2 0	Position:X:-25 Y:0 Leader 2 1	Position:X:-25 Y:25 Leader 2 2	Position:X:-25 Y:50 Leader 2 3	Position:X:-25 Y:-50 Leader 2 4
	

		RanksToReleaseWhenAttacking = 1

		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End
End
End

;-------------------Oggetti mordor fine------------------------


CommandButton Command_SpecialAbilityBalrogBreath
  Command                 = SPECIAL_POWER NEED_UPGRADE
  NeededUpgrade           = Upgrade_MiniHordeLvl7
  NeededUpgradeAny           = Yes
  SpecialPower            = SpecialAbilityBalrogBreath
  Options                 = NEED_TARGET_POS CONTEXTMODE_COMMAND
  TextLabel               = CONTROLBAR:SpecialAbilityBalrogBreath
  ButtonImage             = HSBalrogBreathFire
  ButtonBorderType        = ACTION 
  RadiusCursorType        = FireBreathRadiusCursor   
  DescriptLabel           = CONTROLBAR:ToolTipSpecialAbilityBalrogBreath
;  UnitSpecificSound       	= 
  InPalantir			= Yes
End

Object MordorBalrog_NOFIRE
Scale = 0.50
End

ChildObject Elven_Female_Peasant MordorBalrogDeath
Scale = 0.50
End

ObjectCreationList OCL_BalrogDie2
	CreateObject
		ObjectNames	= Elven_Female_Peasant
		Count		= 1
		Disposition = LIKE_EXISTING
	    Offset		= X:75.0 Y:-10.0 Z:0.0
	End
End

Armor NewBalrogArmor
  Armor = DEFAULT		  1%	; Likes to have things think they can attack him
  Armor = SIEGE			 25%	; siege weapons can hurt him
  Armor = STRUCTURAL		 10%	; Structural damage (Ent rocks)
  Armor = FROST          	100%   ;
  Armor = MAGIC			100%	; Gandalf can really hurt him.
  Armor = HERO			 50%	; Other heroes can hurt him too.  Watch out for heroes Mr. Balrog!
  Armor = HERO_RANGED   	  1%    ; Hero bow damage
  Armor = FLAME 1%
  
End

CommandSet NewBalrogCommandSet
	1  	= Command_ToggleStance
	2  	= Command_SpecialAbilityBalrogBreath
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

Object GondorKnightsofDolHorde
BuildCost = 900
End

Object NoldorWarriorHorde
BuildCost = 500
End

Armor TowerGuardSpecialArmor
  Armor = DEFAULT         	 20%   	; 100%	originally 100%
  Armor = SLASH           	30%   	; 	originally 200%
  Armor = PIERCE          	 19%   	;  50% 	originally 125%
  Armor = SPECIALIST      	 27%   	;	originally 100%
  Armor = CAVALRY	   	 7%   	;	originally 20%
  Armor = CRUSH            	 3%   	;  50%
  Armor = SIEGE           	25%   	;
  Armor = FLAME           	25%   	;  30%
  Armor = FROST          	25%   ;
  Armor = MAGIC           	25%   	;
  Armor = HERO            	50%   	;
  Armor = HERO_RANGED     	50%   	;
  Armor = STRUCTURAL	  	 12%	;	originally 100%
  FlankedPenalty 	       = 75%         
End

Armor TowerGuardSpecialArmorHA
  Armor = DEFAULT             	 10%  	;  40%	originally 50%
  Armor = SLASH               	 15% 	; 	originally 150%
  Armor = PIERCE             	 9%  	;  20% 	originally 65%
  Armor = SPECIALIST         	 11% 	;	originally 50%
  Armor = CRUSH              	  2% 	;  40%
  Armor = CAVALRY	     	 3% 	;	originally 10%
  Armor = SIEGE              	 13% 	; 100%
  Armor = FLAME              	 13% 	;   0%
  Armor = FROST          	 13%   ;
  Armor = MAGIC              	 13% 	; 100%
  Armor = HERO                	25% 	;  50%
  Armor = HERO_RANGED         	25% 	;  50%  
  Armor = STRUCTURAL		 5%	;	
  FlankedPenalty 	       = 75%     
End

Armor RivendellLancerHeavyArmorSuperShield
  Armor = DEFAULT        	 10%   ; 100%	
  Armor = SLASH          	 8%   ; 100%	
  Armor = PIERCE         	 6%   ; 100%	originally 25%
  Armor = SPECIALIST      	22%   ; 200%	originally 100%
  Armor = CRUSH           	  1%   ; 100%
  Armor = SIEGE          	 10%   ; 100%
  Armor = FLAME          	 10%   ;  50%
  Armor = FROST          	 10%   ;
  Armor = MAGIC          	 10%   ; 100%
  Armor = HERO            	20%   ; 100%
  Armor = HERO_RANGED     	20%   ; 100%  
  Armor = CAVALRY		 18%   ; 	originally 50%
  Armor = STRUCTURAL   		 6%   ;	originally 20% 
  FlankedPenalty 	       = 50%      
End

Armor PikemenHeavyArmorSuperShield
  Armor = DEFAULT            	 12% 	; 40%	originally 50%
  Armor = SLASH               	20% 	; 	
  Armor = PIERCE            	 18% 	; 20% 	originally 65%
  Armor = SPECIALIST         	 12% 	;	originally 50%
  Armor = CAVALRY	     	 6% 	;	originally 10%
  Armor = CRUSH             	  2% 	;  40%
  Armor = SIEGE              	 10% 	; 100%
  Armor = FLAME              	 10% 	;   0%
  Armor = FROST          	 16%   ;
  Armor = MAGIC              	 10% 	; 100%
  Armor = HERO                	20% 	;  50%
  Armor = HERO_RANGED         	20% 	;  50%  
  Armor = STRUCTURAL	 	 6%	;	
  FlankedPenalty 	      = 100%     
End

Armor LorienWarriorHeavyArmorSuperShield		; Newly Added
  Armor = DEFAULT            	 10% 	; 
  Armor = SLASH             	 10% 	; 
  Armor = PIERCE             	 10% 	; 
  Armor = SPECIALIST         	 6% 	; 
  Armor = CRUSH              	 14% 	; originally 100%
  Armor = SIEGE              	 10% 	;
  Armor = FLAME              	 10% 	;
  Armor = FROST          	 10%   ;
  Armor = MAGIC              	 10% 	;
  Armor = HERO                	20% 	;
  Armor = HERO_RANGED         	20% 	;
  Armor = CAVALRY		26% 	; 
  Armor = STRUCTURAL	 	 8%	; 
  FlankedPenalty 	       = 50%    
End


Object HaldirGoldenArrowProjectile
RemoveModule ModuleTag_GoldenArrow 
	;Behavior = CreateObjectDie ModuleTag_GoldenArrow7
		;DeathTypes = ALL
		;CreationList = OCL_ElvenWoodTree
	;End
;End
AddModule
  Behavior = FireWeaponWhenDeadBehavior ModuleTag_DIELIKETHIS8
  StartsActive = Yes
  TriggeredBy = Upgrade_TechnologyDwarvenSiegeHammer
    DeathWeapon = MenLongShotWeaponReal
  End
  End
End



ModifierList SlowEnt
	Category = SPELL
        Modifier = SPEED 20%
        Modifier = ARMOR 500%
        Modifier = DAMAGE_MULT 200%
        Modifier = HEALTH_MULT 200%
	Duration = 0; ;
        ;FX		 = FX_DwarvenFortressUpgrade
End

ModifierList GN
	Category = SPELL
        Modifier = DAMAGE_STRUCTURE_BOUNTY_ADD 100%
	Duration = 0; ;
        ;FX		 = FX_DwarvenFortressUpgrade
End

ModifierList Repair
	Category = SPELL
        Modifier = HEALTH_MULT 200%
        Modifier = DAMAGE_MULT 200%
	Duration = 0; ;
        FX		 = FX_DwarvenFortressUpgrade
End

ModifierList Moneymodifier
	Category = SPELL
	Modifier = PRODUCTION 125%
	Modifier = RECHARGE_TIME 75%
	Duration = 0; ;	
	FX		 = FX_DwarvenFortressUpgrade
End

ModifierList SuperMoneymodifier
	Category = SPELL
	Modifier = PRODUCTION 150%
	;Modifier = RECHARGE_TIME 75%
	Duration = 0; ;	
	FX		 = FX_DwarvenFortressUpgrade
End

ModifierList SuperEnt
        Category = SPELL
        Modifier = ARMOR 50%			
	Modifier = DAMAGE_MULT 150%	
        Modifier = SPEED 150%
        Modifier = RANGE 125%
	Duration = 0// if you mess with this value, you must also change the times in FX_TheodenGloriousChargeFX
        FX		 = FX_LevelUp
End

ModifierList KillResources
        Category = WEAPON
	Modifier = BOUNTY_PERCENTAGE 100.0%	// Percentage of victim bounty value to build granted to slaying member's player.
	Duration = 0						// lasts for 2.5 seconds
        FX		 = FX_LevelUp
End

ModifierList SuperExperience
	Category = SPELL
        Modifier = EXPERIENCE 1000%
	Duration = 0; ;
        FX		 = FX_LevelUp
End

ModifierList BetterCavalry
        Category = SPELL
	;Modifier = CRUSHER_LEVEL 3
        Modifier = ARMOR 50%			// Additive, high value has same effect as invulnerability
	Modifier = DAMAGE_MULT 150%	
	Modifier = CRUSH_DECELERATE 0%	// Multiplicitive.  Zero would be no deceleration.
	Duration = 0// if you mess with this value, you must also change the times in FX_TheodenGloriousChargeFX
        FX		 = FX_LevelUp
End

ModifierList WargAttack
        Category = SPELL
	;Modifier = CRUSHER_LEVEL 3
        ;Modifier = ARMOR 50%			// Additive, high value has same effect as invulnerability
	Modifier = DAMAGE_MULT 200%	
	Modifier = CRUSH_DECELERATE 0%	// Multiplicitive.  Zero would be no deceleration.
	Duration = 0// if you mess with this value, you must also change the times in FX_TheodenGloriousChargeFX
        FX		 = FX_LevelUp
End


ModifierList BeastPower
	Category = SPELL
        Modifier = ARMOR 500%
	Modifier = DAMAGE_MULT 500%
	Modifier = HEALTH_MULT 200%
        Modifier = SPEED 150%
	Duration = 0; ;
        FX		 = FX_LevelUp
End

ModifierList AttackTroll
	Category = SPELL
        Modifier = ARMOR -25%%
	Modifier = DAMAGE_MULT 75%
	Modifier = HEALTH_MULT 75%
       ; Modifier = SPEED 150%
	Duration = 0; ;
       ; FX		 = FX_LevelUp
End

ModifierList SuperSiege
        Category = SPELL
	Modifier = DAMAGE_MULT 125%
        Modifier = SPEED 150%
	Modifier = RANGE 125%		
   	;Modifier = VISION 400%			
	Duration = 0
        FX		 = FX_LevelUp
End

Weapon ElvenSpecialSword ; BALANCE CaveTroll Weapon Normal
  LeechRangeWeapon      = Yes
  AttackRange           = 0.8
  MeleeWeapon           = Yes
  DelayBetweenShots     = ARAGORN_DELAYBETWEENSHOTS 		; time between shots, msec
  PreAttackDelay        = ARAGORN_PREATTACKDELAY 			; 400 is sword swing delay time before contact with target.
  PreAttackType         = PER_SHOT						; Do the delay each time we attack a new target
  FireFX                = FX_GondorSwordHit
  FireFX                = FX_IsildurSword
  FireFX						= FX_SarumanLightning
  FiringDuration        = ARAGORN_FIRINGDURATION 			; Duration of the sword swing
  RadiusDamageAffects = ENEMIES 
  DamageNugget              ; A basic Nugget that just does damage
    Damage        			= 5
    DamageScalar  		= 5% ANY +HERO +STRUCTURE
    Radius        			= 5.0
    ;DamageArc     			= 45
    DamageType    			= SLASH
    DamageFXType  			= CLUBBING
    DeathType     			= NORMAL
		;DrainLife     		= Yes
		;DrainLifeMultiplier	= 0.1
  End
  MetaImpactNugget          ; A Nugget that throws things back with force
    ShockWaveAmount   		= 5.0
    ShockWaveRadius   		= 5.0
    ShockWaveTaperOff 		= 1.0
    ;ShockWaveArc      		= 45
    ShockWaveZMult    		= 1.00
 ;  HeroResist		  		= 0.90		; 90% resistance to heroes
  End
	DamageNugget                        ; A basic Nugget that just does damage
		Damage        		= SARUMAN_LIGHTNING_DAMAGE_FLAME
                DamageScalar  		= 5% ANY +HERO +STRUCTURE			
		DamageType    		= FLAME
		DamageFXType  		= BOLT
		DeathType     		= BURNED
		Radius				 = SARUMAN_LIGHTNING_RADIUS
		DelayTime			 = 200  
		;DrainLife     		= Yes
		;DrainLifeMultiplier	= 0.1
	End

	DamageNugget                        ; A basic Nugget that just does damage
		Damage        		= 1000
                DamageScalar  		= 5% NONE +HERO +STRUCTURE			
		DamageType    		= MAGIC
		DamageFXType  		= ELECTRIC
		DeathType     		= BURNED
		Radius				 = SARUMAN_LIGHTNING_RADIUS
		;DrainLife     		= Yes
		;DrainLifeMultiplier	= 0.1
	End
	
	MetaImpactNugget                    ; A Nugget that throws things back with force
		HeroResist          =   2.00
		ShockWaveAmount		= 25.0
		ShockWaveRadius		= 25
		ShockWaveTaperOff	= 0.2
		DelayTime			= 200		;The target is dying before the laser appears in the new laser tweak, so try to kill when the laser turns on
	End
  WeaponOCLNugget						; A Nugget that should only be used for the rarest of super special weapons.  I better not catch a Fire Field in here.
    WeaponOCLName = OCL_SarumanLightningBlastLighting
   ; WeaponOCLName = OCL_ElvenWoodSeed
  End
 ; StealMoneyNugget
    ;AmountStolenPerAttack = 5
 ; End
End


;------------------------------------------------------------------------------
Weapon FloodHorseRadiusWeaponRefresh ; Shot out every DelayBetweenShots
	RadiusDamageAffects = ENEMIES NOT_SIMILAR
	LeechRangeWeapon      = Yes
	AttackRange           = 9999999.0
	MeleeWeapon           = No
	DelayBetweenShots     = 0            ; time between shots, msec
	PreAttackDelay        = 0 ;PreAttackDelay+FiringDuration = UseWeaponTiming = Yes duration
	PreAttackType         = PER_SHOT 
	FiringDuration        = 0 

	DamageNugget                  ; A basic Nugget that just does damage
		Damage        = 0; A whole lot of damage.
		DamageScalar  = 0% NONE +COMMANDCENTER
		Radius        = 5.0
		DelayTime     = 0
		DamageType    = MAGIC
		DamageFXType  = FLOOD_HORSE
		DeathType     = CRUSHED
	End

	FireLogicNugget
		LogicType		= DECREASE_BURN_RATE
		Radius			= ARWEN_FLOOD_DECREASEBURNRATE_RADIUS
		Damage			= ARWEN_FLOOD_DECREASEBURNRATE_AMOUNT
		DelayTime		= 200  
	End
	
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .75
		ShockWaveAmount   = 0.0
		; ShockWaveArc	  = 75
		ShockWaveRadius   = 0.0
		ShockWaveTaperOff = 0.75
		ShockWaveZMult    = 1.000
		ShockWaveSpeed	  = 700.0 
	End
End


FXParticleSystem BalrogSwordFlareWhite
  System
    Priority = VERY_LOW_OR_ABOVE
    ParticleName = EXLnzFlar1.tga
    Lifetime = 30 30
    SortLevel = 1
    Size = 2.5 3.5
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color2 = R:17 G:64 B:111 5
    Color3 = R:0 G:0 B:0 30
    ColorScale = -5 0
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 0 1
    Y = 0 1
    Z = 0 1
  End
  EmissionVolume = LineEmissionVolume
    IsHollow = Yes
    EndPoint = X:0 Y:0 Z:70
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = Circular
    WindStrength = 1
    WindAngleChangeMin = 0.872665
    WindAngleChangeMax = 2.61799
  End
End

FXParticleSystem BalrogSwordEmbersWhite
  System
    Priority = VERY_LOW_OR_ABOVE
    ParticleName = EXEmbersLight.tga
    Lifetime = 50 50
    SortLevel = 1
    Size = 1.5 1.5
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:79 G:185 B:255 0
    Color2 = R:0 G:0 B:0 50
    ColorScale = -5 0
  End
  Update = DefaultUpdate
    SizeRate = 2 4
    SizeRateDamping = 0.8 0.85
    AngleZ = -0.3 0.3
    AngularRateZ = -0.03 0.03
    AngularDamping = 0.99 0.99
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = 0.008
    VelocityDamping = 0.9 0.9
    DriftVelocity = X:0 Y:0 Z:0.32
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 0 1
    Y = 0 1
    Z = 0 1
  End
  EmissionVolume = LineEmissionVolume
    EndPoint = X:0 Y:0 Z:70
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.5
    WindAngleChangeMin = 0.017453
    WindAngleChangeMax = 0.034907
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
  End
End

FXParticleSystem BalrogManeFlareWhite
  System
    Priority = VERY_LOW_OR_ABOVE
    ParticleName = EXLnzFlar1.tga
    Lifetime = 20 20
    SortLevel = 1
    Size = 2 2
    BurstCount = 1 2
  End
  Color = DefaultColor
    Color2 = R:28 G:51 B:89 2
    Color3 = R:0 G:0 B:0 20
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 1
    DriftVelocity = X:0 Y:0 Z:1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.4 -0.4
    Y = -0.4 -0.4
  End
  EmissionVolume = BoxEmissionVolume
    HalfSize = X:12 Y:7 Z:5
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem BalrogManeEmbersWhite
  System
    Priority = HIGH_OR_ABOVE
    ParticleName = EXEmbersLight.tga
    Lifetime = 50 50
    SortLevel = 1
    Size = 1 2
    BurstDelay = 2 5
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:79 G:185 B:255 0
    Color2 = R:0 G:0 B:0 50
    ColorScale = -5 0
  End
  Update = DefaultUpdate
    SizeRate = 3 6
    SizeRateDamping = 0.8 0.85
    AngleZ = -0.3 0.3
    AngularRateZ = -0.03 0.03
    AngularDamping = 0.99 0.99
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = 0.008
    VelocityDamping = 0.9 0.9
    DriftVelocity = X:0 Y:0 Z:0.64
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    IsHollow = Yes
    StartPoint = X:-12 Y:0 Z:4
    EndPoint = X:15 Y:0 Z:5
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.5
    WindAngleChangeMin = 0.017453
    WindAngleChangeMax = 0.034907
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
  End
End

FXParticleSystem BalrogManeFireWhite
  System
    Priority = VERY_LOW_OR_ABOVE
    ParticleName = EXFireScroll3.tga
    Lifetime = 10 10
    SortLevel = 1
    Size = 1 1.5
    BurstCount = 5 5
  End
  Color = DefaultColor
    Color2 = R:51 G:69 B:98 2
    Color3 = R:0 G:0 B:0 10
    ColorScale = -5 -5
  End
  Update = DefaultUpdate
    SizeRate = -0.5 -0.25
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 1
    DriftVelocity = X:0 Y:0 Z:1
  End
  EmissionVelocity = OutwardEmissionVelocity
    Speed = -0.4 -0.4
    OtherSpeed = -0.4 -0.4
  End
  EmissionVolume = BoxEmissionVolume
    HalfSize = X:18 Y:7 Z:5
  End
  Draw = DefaultDraw
  End
End

Weapon SunflareWeaponBlast	
	RadiusDamageAffects		= ENEMIES 

	//Turn the troll effectively to stone
	AttributeModifierNugget
		AttributeModifier        = SunFlareTrollToStone
		Radius					 = 9999999
		SpecialObjectFilter      = ANY +MordorAttackTroll +MordorDrummerTroll +MordorMountainTroll +MordorCaveTroll +GoblinCaveTroll +GoblinCaveTroll_FromTrollLair +CaveTroll_Slaved
	End            	

	// A basic Nugget that just does damage
	DamageNugget                
		Damage        = 1000 ;a little depowered
                DamageScalar  = 1% NONE +STRUCTURE
		Radius        = 9999999
		DelayTime     = 0
		DamageType    = FLAME
		DamageFXType  = FLAME
		DeathType     = BURNED
	End

	//Start a fire - Removed at the request of Wes "Ensign Crusher" Eckhart
	FireLogicNugget 
		LogicType	=	INCREASE_BURN_RATE
		Radius		=	9999999
		Damage		=	SPELL_SUNFLARE_FIRE_DAMAGE
	End
	//Design knob
	FireLogicNugget
		LogicType		=	INCREASE_FUEL
		Radius			=	9999999
		Damage			=	SPELL_SUNFLARE_FIRE_FUEL
		MinMaxBurnRate	=	SPELL_SUNFLARE_FIRE_MINMAX_BURNRATE
		MinDecay		=	1
		MaxResistance	=	0
	End

	//Paralyze everything that's light sensitive
	ParalyzeNugget				
		Radius					= 9999999
		Duration				= SPELL_SUNFLARE_DURATION
		SpecialObjectFilter     = ANY +MordorFighter +MordorBlackOrc +MordorArcher +MordorBannerOrc +WildBannerGoblin +WildBannerMarauder +WildBannerSpiderling +GoblinFighter +GoblinArcher +WildSpiderling +GoblinSpiderRider +WildShelob +MordorGoblinSwordsman +MordorGoblinArcher +BarrowWight ENEMIES
	End

End

FXList FX_SuperWizardTelekinesis
  Sound
    Name = GandalfWizardBlast
  End

  ParticleSystem
    Name = GandalfWaveBlastProxy
     OrientToObject = Yes
  End
  ParticleSystem
    Name = WizardWaveBlastWave
     OrientToObject = Yes
  End
  ParticleSystem
    Name = WizardBlast01_Proxy
     OrientToObject = Yes
  End
  ParticleSystem
    Name = WizardBlast02_Proxy
     OrientToObject = Yes
  End
  ParticleSystem
    Name = WizardBlast03_Proxy
     OrientToObject = Yes
  End
  ParticleSystem
    Name = WizardTowerStormFlashes
     OrientToObject = Yes
  End

  CameraShakerVolume
    Radius = 500
    Duration_Seconds = 1.5
    Amplitude_Degrees = 0.5
  End
End

//------------------------------------------------------------------------------
Weapon ForcePush_Level30 // small microwave push
	IdleAfterFiringDelay	  =	0
	LeechRangeWeapon		  =	Yes
	AttackRange				  =	CREATE_A_HERO_FORCE_PUSH_RANGE_L3
	WeaponSpeed				  =	401			// dist/sec 
	RadiusDamageAffects		  =	ENEMIES	NEUTRALS NOT_SIMILAR
	DelayBetweenShots		  =	5000			   // time between shots, msec
	PreAttackDelay			  =	100
	PreAttackType			  =	PER_ATTACK // Do	the	delay each time	we attack a	new	target
	FireFX					  =	FX_SuperWizardTelekinesis	// CASEY TODO New FX for this power
	FiringDuration			  =	100
	DamageDealtAtSelfPosition =	Yes	
	IsAimingWeapon			  =	Yes
	AcceptableAimDelta		  =	15
	AntiAirborneVehicle		  =	No
	AntiAirborneMonster		  =	No

	DamageNugget                        // A basic Nugget that just does damage
		Damage		 = 400
		DamageArc	 = 75
		Radius		 = 200.0
		DamageType	 = MAGIC
		DamageFXType = MAGIC
		DeathType	 = EXPLODED
		DamageSpeed	 = 700.0 // must	match the ShockWaveSpeed below
	End
	MetaImpactNugget                    // A Nugget that throws things back with force
//		HeroResist		  =	.75
		ShockWaveAmount	  =	100.0
		ShockWaveArc	  =	100
		ShockWaveRadius	  =	195.0
		ShockWaveTaperOff =	0.75
		ShockWaveZMult	  =	1.000
		ShockWaveSpeed	  =	700.0 
	End
End

ObjectCreationList OCL_SuperBolts
 CreateObject
    ObjectNames = SarumanLightning
    Count = 3
    ParticleSystem = SarumanLightningHit02
  End
End


CommandButton Command_SpecialAbilityTerribleFury
	Command			= UNIT_BUILD
	Object			= WildMarauderHorde
	Options			= CANCELABLE NEED_UPGRADE 
	TextLabel		= ValarsWizards
	ButtonImage		= BWFissure_SwordsmanIcon
	ButtonBorderType	= BUILD											
	DescriptLabel		= ValarsWizardsDesc
	NeededUpgrade		= Upgrade_ElvenBarracksLevel2
	Radial			= Yes
	InPalantir	   	= Yes
	ShowProductionCount	= Yes
	LacksPrerequisiteLabel		= ValarsWizardsLack
End

FXParticleSystem SferaMagica 
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXSphere.tga
    Lifetime = 2 2
    SystemLifetime = 900
    Size = 16 28
    StartSizeRate = 3 3
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:79 G:79 B:79 0
    Color2 = R:0 G:0 B:0 3
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    IsHollow = Yes
    StartPoint = X:0 Y:0 Z:0
    EndPoint = X:0 Y:0 Z:0
  End
  Draw = DefaultDraw
  End
End

FXList FX_SFERA
  ParticleSystem
    Name = SferaMagica ; GandalfCrystalSphere2; SferaMagica 
    ;Offset = X:0.0 Y:0.0 Z:0.0
    AttachToObject = Yes
  End
End

ModifierList MagicianInvulnerability
	Category	 = SPELL
	Modifier	 = INVULNERABLE CREATE_A_HERO_INVULNERABILITY_MODIFIER
	Duration	 = 60000					// Matches RefreshRate of giving	module
	FX			 = FX_SFERA

End



CommandButton Command_SpecialAbilityIgnite
  Command                 	= SPECIAL_POWER 
  SpecialPower            	= SpecialAbilityWordOfPower
;  Options                 	= 
  TextLabel               	= SunflareSuper
  ButtonImage             	= Gandolf_radcircle;HSGandalfWordOfPower
  ButtonBorderType        	= ACTION 
  DescriptLabel           	= SunflareSuperDesc
  AutoAbility			= Yes
  PresetRange			= 120.0
;  UnitSpecificSound       	= 
  InPalantir			= Yes
LacksPrerequisiteLabel		= SunflareSuperLack
End

CommandSet NewValarCommandSet
	1	= Command_ToggleStance; Command_ZealotAxeThrow; Command_ToggleStance
	2	= Command_CreateAHero_SpecialAbilityForcePush_Level3
	3	= Command_CreateAHero_Invulnerability_Level3
	4	= Command_SarumanThunderBolt
	5 	= Command_CreateAHero_WordOfPoultry_Level2
        6       = Command_SpecialAbilityIgnite
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End


;-------------------------
;elfi
;-------------------------

CommandButton Command_ConstructElvenMirkwoodArcherHorde
	Command				= UNIT_BUILD
	Object				= ElvenMirkwoodArcherHorde
	TextLabel			= CONTROLBAR:ConstructElvenMirkwoodArcherHorde
	ButtonImage			= BEElvenBarracks_MirkwoodArcher
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildElvenMirkwoodArcherHorde
	Radial				= Yes
	InPalantir	   		= Yes
	IsClickable			= Yes
	Options				= NEED_UPGRADE CANCELABLE
	NeededUpgrade			= Upgrade_ElvenBarracksLevel2
        NeededUpgradeAny                = Yes
	ShowProductionCount		= Yes    
End

CommandButton Command_CreateAHeroStealMoney_Level1
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE ; ;NEED_UPGRADE
	Upgrade				= Upgrade_TechnologyMordorHeavyArmor 
	TextLabel			= Monete
	ButtonImage			= BIArmory_HeavyArmor
	ButtonBorderType	= UPGRADE
	DescriptLabel		= MoneteDesc
	Radial				= Yes
	InPalantir			= Yes
	;LacksPrerequisiteLabel		= MoneteLack; ;TOOLTIP:LackLevel2OrcPitHeavyArmor
	;UnitSpecificSound	= TrollVoxFindTree
End

CommandButton Command_CreateAHero_SpecialAbilityArrowBonus_Level1
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE NEED_UPGRADE 
	Upgrade				= Upgrade_TechnologyDwarvenFlamingShot
	NeededUpgrade		= Upgrade_EregionForgeLevel3
	NeededUpgrade		= Upgrade_TechnologyElvenSilverthornArrows
	TextLabel			= GoldenArrow
	ButtonImage			= BGWorkshop_FireStone
	ButtonBorderType	= UPGRADE
	DescriptLabel		= GoldenArrowDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= GoldenArrowLack
	;UnitSpecificSound	= TrollVoxFindTree
End

CommandButton Command_HaldirGoldenArrow	;upgrade for units
	Command				= OBJECT_UPGRADE 
	Options				= OK_FOR_MULTI_SELECT CANCELABLE NEED_UPGRADE 
	Upgrade				= Upgrade_DwarvenFlamingShot
	NeededUpgrade		= Upgrade_TechnologyDwarvenFlamingShot
	TextLabel			= Oropotenziamento
	ButtonImage			= BGWorkshop_FireStone
	ButtonBorderType	= UPGRADE ;ACTION
	DescriptLabel		= OropotenziamentoDesc
	InPalantir			= Yes
	LacksPrerequisiteLabel		= OropotenziamentoLack
	;FlagsUsedForToggle	= WEAPONSET_TOGGLE_1
	;UnitSpecificSound	= TrollVoxFindTree
End

CommandButton Command_SpellBookRebuild
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyMordorBasicTraining 
	NeededUpgrade		= Upgrade_EregionForgeLevel2
	TextLabel			= SuperBuild
	ButtonImage			= BMOrcPit_RedEyeBanner
	ButtonBorderType	= UPGRADE
	DescriptLabel		= SuperBuildDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= SuperBuildLack
	;UnitSpecificSound	= TrollVoxFindTree
End



CommandButton Command_CreateAHero_ShieldCrush_Level1
	Command				= PLAYER_UPGRADE
	Upgrade				= Upgrade_TechnologyWildHeavyArmor 
	Options				= CANCELABLE NEED_UPGRADE
	;NeededUpgrade		= Upgrade_TechnologyGondorHeavyArmor
	NeededUpgrade		= Upgrade_TechnologyElvenHeavyArmor
        NeededUpgrade		= Upgrade_EregionForgeLevel3
	TextLabel			= Superscudo
	ButtonImage			= BIArmory_HeavyArmor
	ButtonBorderType	= UPGRADE
	DescriptLabel		= SuperscudoDesc
	Radial				= Yes
	InPalantir	   		= Yes
	LacksPrerequisiteLabel		= SuperscudoLack
End

CommandButton Command_CreateAHero_EowynShieldMaiden
Command				= OBJECT_UPGRADE
	Options				= NEED_UPGRADE OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_WildHeavyArmor
	NeededUpgrade		= Upgrade_TechnologyWildHeavyArmor
	TextLabel			= SuperscudoPotenziametno
	ButtonImage			= BWTreasureTrove_ScavengedArmor
	ButtonBorderType	= UPGRADE
	DescriptLabel		= SuperscudoPotenziametnoDesc
	InPalantir			= Yes
	LacksPrerequisiteLabel		= SuperscudoPotenziametnoLack
End

CommandButton Command_PurchaseTechnologyElvenHeavyArmor
	Command				= PLAYER_UPGRADE 
	Options				= CANCELABLE NEED_UPGRADE 
	Upgrade				= Upgrade_TechnologyElvenHeavyArmor 
	NeededUpgrade		= Upgrade_EregionForgeLevel3
        NeededUpgradeAny        = Yes
	TextLabel			= CONTROLBAR:PurchaseTechnologyElvenHeavyArmor
	ButtonImage			= BEEregionForge_ElvenArmor
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CONTROLBAR:ToolTipPurchaseTechnologyElvenHeavyArmor
	Radial				= Yes
	InPalantir	   		= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackSilverthornTechnology
End

CommandSet NewEregionForgeCommandSet
	1 = Command_PurchaseTechnologyElvenBasicTraining
	2 = Command_PurchaseTechnologyElvenHeavyArmor
	3 = Command_PurchaseTechnologyElvenForgedBlades
	4 = Command_PurchaseTechnologyElvenSilverthornArrows
	;5 = Command_PurchaseUpgradeEregionForgeLevel2
	6 = Command_Sell
        7 = Command_CreateAHeroStealMoney_Level1
        8 = Command_SpellBookRebuild
        9 = Command_CreateAHero_SpecialAbilityArrowBonus_Level1
        10 = Command_CreateAHero_ShieldCrush_Level1
End

CommandSet NewEregionForgeCommandSetLevel2-
	1 = Command_PurchaseTechnologyElvenBasicTraining
	2 = Command_PurchaseTechnologyElvenHeavyArmor
	3 = Command_PurchaseTechnologyElvenForgedBlades
	4 = Command_PurchaseTechnologyElvenSilverthornArrows
	5 = Command_PurchaseUpgradeEregionForgeLevel2
	6 = Command_Sell
        7 = Command_CreateAHeroStealMoney_Level1
        8 = Command_SpellBookRebuild
        9 = Command_CreateAHero_SpecialAbilityArrowBonus_Level1
        10 = Command_CreateAHero_ShieldCrush_Level1
End

CommandSet NewEregionForgeCommandSetLevel2
	1 = Command_PurchaseTechnologyElvenBasicTraining
	2 = Command_PurchaseTechnologyElvenHeavyArmor
	3 = Command_PurchaseTechnologyElvenForgedBlades
	5 = Command_PurchaseTechnologyElvenSilverthornArrows
	;5 = Command_PurchaseUpgradeEregionForgeLevel3
	6 = Command_Sell
        7 = Command_CreateAHeroStealMoney_Level1
        8 = Command_SpellBookRebuild
        9 = Command_CreateAHero_SpecialAbilityArrowBonus_Level1
        10 = Command_CreateAHero_ShieldCrush_Level1
End

CommandSet NewEregionForgeCommandSetLevel3-
	1 = Command_PurchaseTechnologyElvenBasicTraining
	2 = Command_PurchaseTechnologyElvenHeavyArmor
	3 = Command_PurchaseTechnologyElvenForgedBlades
	4 = Command_PurchaseTechnologyElvenSilverthornArrows
	5 = Command_PurchaseUpgradeEregionForgeLevel3
	6 = Command_Sell
        7 = Command_CreateAHeroStealMoney_Level1
        8 = Command_SpellBookRebuild
        9 = Command_CreateAHero_SpecialAbilityArrowBonus_Level1
        10 = Command_CreateAHero_ShieldCrush_Level1
End


CommandSet NewEregionForgeCommandSetLevel3
	1 = Command_PurchaseTechnologyElvenBasicTraining
	2 = Command_PurchaseTechnologyElvenHeavyArmor
	3 = Command_PurchaseTechnologyElvenForgedBlades
	5 = Command_PurchaseTechnologyElvenSilverthornArrows
	6 = Command_Sell
        7 = Command_CreateAHeroStealMoney_Level1
        8 = Command_SpellBookRebuild
        9 = Command_CreateAHero_SpecialAbilityArrowBonus_Level1
        10 = Command_CreateAHero_ShieldCrush_Level1
End

;----------------------------------------------------------------------
;MEN
;----------------------------------------------------------------------

ModifierList LessTime
        Category = STRUCTURE
	Modifier = PRODUCTION 2.00		
        Duration = 0 
        FX		 = FX_DwarvenFortressUpgrade
End

FXList FX_MetalDefence
  TintDrawable
	Color				= R:20 G:20 B:150
	PreColorTime		= 0				; these numbers must add up to the (30 * number of seconds) of gloriious charge
	PostColorTime		= 0
	SustainedColorTime	= 0
	Frequency			= 0
	Amplitude			= 0
  End
End

FXParticleSystem balrogGroundGlowF
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXFire01.tga
    Lifetime = 50 50
    SystemLifetime = 999999999
    SortLevel = 1
    Size = 10 10
    BurstDelay = 1 1
    BurstCount = 1 1
    IsGroundAligned = Yes
    UseMaximumHeight = Yes
  End
  Color = DefaultColor
    Color1 = R:21 G:12 B:0 0
    Color2 = R:255 G:135 B:83 10
    Color3 = R:0 G:0 B:0 50
    ColorScale = -1 -1
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 1 1
    AngleZ = -6 6
    AngularRateZ = -0.1 0.1
    AngularDamping = 0.98 0.98
    Rotation = ROTATE_Z
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.99 0.99
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 1 3
    Y = -3 3
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 10
    Length = 15
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = Circular
    WindStrength = 0.1
    TurbulenceAmplitude = 0.03
    TurbulenceFrequency = 5
  End
End

FXParticleSystem balrogGroundHeatWaveF
  System
    Shader = ALPHA_TEST
    ParticleName = SMUDGE.tga
    Lifetime = 50 50
    SystemLifetime = 999999999
    Size = 50 50
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
  End
  Alpha = DefaultAlpha
    Alpha2 = 1 1 25
    Alpha3 = 0 0 50
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = 0.005 0.015
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.96 0.97
    DriftVelocity = X:0 Y:0 Z:1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 4 8
    Y = -2 -2
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 32
    Length = 50
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem balrogGroundSmokeF
  System
    Priority = VERY_LOW_OR_ABOVE
    Shader = ALPHA
    ParticleName = EXCloud02.tga
    Lifetime = 30 30
    SystemLifetime = 999999999
    SortLevel = 1
    Size = 10 20
    BurstCount = 1 1
    InitialDelay = 10 10
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color1 = R:247 G:150 B:62 15
    Color2 = R:0 G:0 B:0 30
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.5 0.5 0
    Alpha2 = 0 0 30
  End
  Update = DefaultUpdate
    SizeRate = 2 3
    SizeRateDamping = 0.9 0.99
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.95 0.98
    DriftVelocity = X:0 Y:0 Z:0.24
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 3 5
    Y = -3 3
    Z = 0.1 0.2
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.1
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
    TurbulenceAmplitude = 0.02
    TurbulenceFrequency = 25
  End
End

FXParticleSystem balrogGroundGlowF
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXFire01.tga
    Lifetime = 50 50
    SystemLifetime = 999999999
    SortLevel = 1
    Size = 10 10
    BurstDelay = 1 1
    BurstCount = 1 1
    IsGroundAligned = Yes
    UseMaximumHeight = Yes
  End
  Color = DefaultColor
    Color1 = R:21 G:12 B:0 0
    Color2 = R:255 G:135 B:83 10
    Color3 = R:0 G:0 B:0 50
    ColorScale = -1 -1
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 1 1
    AngleZ = -6 6
    AngularRateZ = -0.1 0.1
    AngularDamping = 0.98 0.98
    Rotation = ROTATE_Z
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.99 0.99
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 1 3
    Y = -3 3
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 10
    Length = 15
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = Circular
    WindStrength = 0.1
    TurbulenceAmplitude = 0.03
    TurbulenceFrequency = 5
  End
End

FXList FX_Fireverywhere
  ParticleSystem
    Name = DrogothFireBreath FollowBone:Yes
    ;OnlyIfOnLand = Yes
    OrientToObject = Yes
  End
  ParticleSystem
    Name = balrogBreathEmbers FollowBone:Yes
    ;OnlyIfOnLand = Yes
    OrientToObject = Yes
  End
  ParticleSystem
    Name = balrogBreathSmoke FollowBone:Yes
    ;OnlyIfOnLand = Yes
    OrientToObject = Yes
  End
 // ParticleSystem
  //  Name = DrogothBreathProxy FollowBone:Yes
    ;OnlyIfOnLand = Yes
  //  OrientToObject = Yes
  //End
 // ParticleSystem
   // Name = DrakeGroundGlow FollowBone:Yes
   ; OnlyIfOnLand = Yes
   // OrientToObject = Yes
  //End
  ParticleSystem
    Name = DrakeGroundHeatWave FollowBone:Yes
    ;OnlyIfOnLand = Yes
   OrientToObject = Yes
  End
  ParticleSystem
    Name = DrakeGroundSmoke FollowBone:Yes
    ;OnlyIfOnLand = Yes
    OrientToObject = Yes
  End
  ParticleSystem
    Name = DrakeGroundFire FollowBone:Yes
    ;OnlyIfOnLand = Yes
   ; OrientToObject = Yes
End

End

ModifierList FireDefencebonus
	Category = STRUCTURE
        ;Modifier = ARMOR 200%
        Duration = 0
        FX		 = FX_Fireverywhere
						
End

ModifierList MetalDefencebonus
	Category = STRUCTURE
        Modifier = ARMOR 2000%
        Duration = 0
      ;  FX		 = FX_MetalDefence
						
End

ExperienceLevel	GondorFarmLevel1
	TargetNames				= GOOD_FARM
	RequiredExperience		= 1
	ExperienceAward			= GONDOR_FARM_LVL1_EXP_AWARD
	Rank					= 1
	AttributeModifiers		= BasicLevelUpProduction1
	Upgrades				= Upgrade_StructureLevel1	
End

ExperienceLevel	GoodEliteLevel2
	TargetNames							=	GOOD_ELITE
	RequiredExperience					=	EXPERIENCE_REQUIRED_GOOD_ELITE_2
	ExperienceAward						=	EXPERIENCE_AWARD_GOOD_ELITE_2
	AttributeModifiers					=	GoodEliteBonusRank2
	InformUpdateModule					=	Yes
	Rank								=	2
	LevelUpFx							=	FX:GenericLevelUp2FX
	LevelUpTintColor					=	R:255 G:255	B:255
	LevelUpTintPreColorTime				=	500	
	LevelUpTintPostColorTime			=	3000
	LevelUpTintSustainColorTime			=	500	
        Upgrades                                        = Upgrade_ObjectLevel2
	SelectionDecal
		Texture							=	decal_G_level4
		Texture2						=	decal_good_CO
		Style							=	SHADOW_MERGE_DECAL
		OpacityMin						=	80%
		OpacityMax						=	100%
		MinRadius			  			=	HORDE_DECAL_MIN_RADIUS
		MaxRadius						=	200
		MaxSelectedUnits	  			=	40
	End	
END

FXParticleSystem SferaMagica2 
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXSphere.tga
    Lifetime = 2 2
    SystemLifetime = 1800000
    Size = 13 14
    StartSizeRate = 3 3
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:150 G:79 B:79 0
    Color2 = R:0 G:0 B:0 3
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    IsHollow = Yes
    StartPoint = X:0 Y:0 Z:0
    EndPoint = X:0 Y:0 Z:0
  End
  Draw = DefaultDraw
  End
End

FXList FX_SFERAIsen
  ParticleSystem
    Name = SferaMagica2 ; GandalfCrystalSphere2; SferaMagica 
    ;Offset = X:0.0 Y:0.0 Z:0.0
    AttachToObject = Yes
  End
End
	

ModifierList YesHeal
        Category = SPELL
	Modifier = AUTO_HEAL 30
	Duration = 0	
        FX = FX_LevelUp 
End

ModifierList SuperIsengardSword
        Category = WEAPON
        Modifier = DAMAGE_MULT 300%
	Duration = 0	
        FX = FX_SFERAIsen
End

ModifierList SuperSword
        Category = WEAPON
        Modifier = DAMAGE_MULT 500%
	Duration = 0	
        FX = FX_LevelUp 
End

ModifierList SuperIsengardShield
        Category = SPELL
        ;Modifier = ARMOR 1800%
	Duration = 0	
        FX = FX_LevelUp 
End

FXParticleSystem SferaMagica3
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXSphere.tga
    Lifetime = 2 2
    SystemLifetime = 1800000
    Size = 13 14
    StartSizeRate = 3 3
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:79 G:79 B:150 0
    Color2 = R:0 G:0 B:0 3
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    IsHollow = Yes
    StartPoint = X:0 Y:0 Z:0
    EndPoint = X:0 Y:0 Z:0
  End
  Draw = DefaultDraw
  End
End

FXList FX_SFERAElfi
  ParticleSystem
    Name = SferaMagica3 ; GandalfCrystalSphere2; SferaMagica 
    ;Offset = X:0.0 Y:0.0 Z:0.0
    AttachToObject = Yes
  End
End

ModifierList SuperShield
        Category = SPELL
        ;Modifier = ARMOR 1800%
	Duration = 0	
        FX = FX_SFERAElfi
End

CommandButton Command_CreateAHero_SpecialAbilityAthelas
Command				= PLAYER_UPGRADE
	Options				= CANCELABLE NEED_UPGRADE
	Upgrade				= Upgrade_TechnologyWildBasicTraining 
        NeededUpgrade                   = Upgrade_GondorBarracksLevel2
        NeededUpgradeAny                = Yes
        TextLabel			= Cura
	ButtonImage			= BWTreasureTrove_BannerCarrier
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CuraDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= CuraLack
	;UnitSpecificSound	= TrollVoxFindTreelack
End

ModifierList AdvancedCavalry
        Category = SPELL
	Modifier = CRUSHER_LEVEL 4 
	Modifier = ARMOR 200%			// Additive, high value has same effect as invulnerability
	Modifier = DAMAGE_MULT 200%	
        Modifier = CRUSH_DECELERATE 0%
        Modifier = HEALTH_MULT 200%
	Duration = 0// if you mess with this value, you must also change the times in FX_TheodenGloriousChargeFX
	FX		 = FX_TheodenGloriousChargeFX
End

CommandButton Command_SpecialAbilityCreateAHeroHeroicCharge
	Command				= OBJECT_UPGRADE
	Options				= NEED_UPGRADE OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_DwarvenForgedBlades
	NeededUpgrade			= Upgrade_TechnologyDwarvenForgedBlades
	TextLabel			= CaricaGloriosapot
	ButtonImage			= BDForgeWorks_ForgedBlades
	ButtonBorderType		= UPGRADE
	DescriptLabel			= CaricaGloriosapotDesc
	InPalantir			= Yes
	LacksPrerequisiteLabel		= CaricaGloriosapotDesc
End

CommandButton Command_ChargeofGlory
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyDwarvenForgedBlades
	NeededUpgrade			= Upgrade_GondorStableLevel2
        NeededUpgradeAny                = Yes
	TextLabel			= CaricaGloriosa
	ButtonImage			= BDForgeWorks_ForgedBlades
	ButtonBorderType		= UPGRADE
	DescriptLabel			= CaricaGloriosaDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= CaricaGloriosaLack
End

FXList FX_GenericLeadershipBlue
  BuffNugget
	BuffType = Buff
	;BuffInfantryTemplate = LeadershipBuffInfantryLvl1
	;;BuffCavalryTemplate = LeadershipBuffCavalryLvl1
	;BuffTrollTemplate = LeadershipBuffTrollLvl1
   ; BuffOrcTemplate = LeadershipBuffOrcLvl1
	IsComplexBuff = No
	BuffLifeTime = 3000
        Color = R:40 G:40 B:150
  End
End


ModifierList SuperArcherMen
	Category					= SPELL
	;Modifier					= DAMAGE_MULT 125%   Too much OP: eliminated
	;Modifier					= ARMOR 25%
	Modifier					= RANGE 125%
        Modifier                                        = VISION 125%
	Modifier                                        = SHROUD_CLEARING 125%		// Multiplicitive.  Damage multiplied by this, will compound in multiple bonuses
	Duration					= 0
	;FX							= FX_LevelUp 
	;ReplaceInCategoryIfLongest	= Yes
	;IgnoreIfAnticategoryActive	= Yes
End

ModifierList GenericHeroLeadershipRanger
	Category					= LEADERSHIP
	Modifier					= EXPERIENCE 300%
	;Modifier					= ARMOR 50%
	;Modifier					= DAMAGE_MULT 150%		// Multiplicitive.  Damage multiplied by this, will compound in multiple bonuses
	Duration					= 3000
	FX							= FX_GenericLeadershipBlue
	;ReplaceInCategoryIfLongest	= Yes
	IgnoreIfAnticategoryActive	= Yes
End

CommandButton Command_SpecialAbilityWoundArrow
	Command				= PLAYER_UPGRADE
	Upgrade				= Upgrade_TechnologyIsengardForgedBlades 
	Options				= CANCELABLE NEED_UPGRADE
	NeededUpgrade			= Upgrade_GondorArcheryRangeLevel2
        NeededUpgradeAny                = Yes
	TextLabel			= Frecciagittata
	ButtonImage			= BIArmory_ForgedBlades
	ButtonBorderType		= UPGRADE
	DescriptLabel			= FrecciagittataDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= FrecciagittataLack
End

CommandButton Command_ToggleFaramirWeapon
	Command			=	TOGGLE_WEAPONSET
	Options			=	UNMOUNTED_ONLY TOGGLE_IMAGE_ON_WEAPONSET NEED_UPGRADE
        NeededUpgrade           = Upgrade_TechnologyElvenHeavyArmor
        NeededUpgradeAny        = Yes
	FlagsUsedForToggle	=	WEAPONSET_TOGGLE_1
	TextLabel               =	RaminghiPugni RaminghiArchi
	ButtonImage             =	HSFaramirSword UCElven_Bow 
	ButtonBorderType        =	ACTION 
	DescriptLabel           =	RaminghiPugniDesc RaminghiArchiDesc
	InPalantir		=	Yes
	LacksPrerequisiteLabel		= RaminghiCambiolack
End

  
CommandButton Command_ConstructInnGondorRangerHorde
	Command				= UNIT_BUILD
	Object				= DwarvenAxeThrowerHorde
	Options				= CANCELABLE NEED_UPGRADE
	NeededUpgrade			= Upgrade_GondorStableLevel2
	NeededUpgradeAny		= Yes
	TextLabel			= cavvaleriaramingsa
	ButtonImage			= BDHallofWarriors_DwarvenAxeThrower
	ButtonBorderType    		= BUILD 
	DescriptLabel       		= cavvaleriaramingsaDesc
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= Yes  
  ;UnitSpecificSound       	= TheodenVoiceGloriousCharge  
	LacksPrerequisiteLabel		= cavvaleriaramingsaLack
End

CommandButton Command_ConstructGondorRangerHorde
Command				= UNIT_BUILD
	Object				= LindonWarriorHorde
	Options				= NEED_UPGRADE CANCELABLE
	NeededUpgrade			= Upgrade_GondorArcheryRangeLevel2
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:ConstructGondorRangerHorde
	ButtonImage			= BEElvenBarracks_LorienWarrior
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildGondorRangerHorde
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
;    UnitSpecificSound   	= GondorArcherVoiceBuy  
;	Options				= NEED_UPGRADE			
;	Upgrade				= Upgrade_StructureLevel2
End

;------------------------------------------------------------------------------
Weapon ElvenLindonWarriorSword 
	LeechRangeWeapon      = Yes
	AttackRange           = STANDARD_MELEE_ATTACK_RANGE
	MeleeWeapon           = Yes
	DelayBetweenShots     = 800            ; time between shots, msec
	PreAttackDelay        = 700             ; 567 is sword swing delay time before contact with target.
	PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
	FireFX                = FX_GondorSwordHit
	FireFlankFX			= FX_Flanking
	FiringDuration        = 800    ; Duration of the sword swing
	;OverrideVoiceAttackSound = ElvenWarriorVoiceAttack

	DamageNugget                        ; A basic Nugget that just does damage
	    Damage        = ELVEN_LINDONWARRIOR_MELEE_DAMAGE
	    Radius        = 0.0
	    DelayTime     = 0
	    DamageType    = SLASH
	    DamageFXType  = SWORD_SLASH
	    DeathType     = NORMAL
	    FlankingBonus = 50%
	   	ForbiddenUpgradeNames      = Upgrade_ElvenForgedBlades
    DrainLife     		= Yes
    DrainLifeMultiplier	= 1.0
	End

	;DamageNugget                        ; A basic Nugget that just does damage
		;Damage        = ELVEN_LINDONWARRIOR_MELEE_DAMAGE_UPGRADE
		;Radius        = 0.0
		;DelayTime     = 0
		;DamageType    = HERO
		;DamageFXType  = SWORD_SLASH
		;DeathType     = NORMAL
		;FlankingBonus = 50%
		;RequiredUpgradeNames      = Upgrade_ObjectLevel3
	;End
End

ObjectCreationList OCL_SpawnDunedainRangers1
	CreateObject
		ObjectNames = GondorRangerHorde_Summoned
		Count = 2
		FadeIn = Yes
		FadeTime = 8000
		IgnoreCommandPointLimit = Yes
		Disposition = SPAWN_AROUND
		DispositionAngle = 90	;SpawnAround uses this as the arc between guys
		DispositionIntensity = 300 ; and this for distance from center
	End
End

CommandButton Command_SpellBookDunedainAllies
	Command			   = SPECIAL_POWER
	SpecialPower	   = SpecialAbilityCreateAHeroHotWSummonAllies_Level2
	TextLabel		   = CONTROLBAR:HotWSummonAllies_Level2
	ButtonImage		   = CAHSummonAllies
	Options			   = NEED_TARGET_POS CONTEXTMODE_COMMAND
	RadiusCursorType   = SummonOathBreakersRadiusCursor
	CursorName		   = Bombard
	InvalidCursorName  = GenericInvalid	 
	ButtonBorderType   = ACTION	
	DescriptLabel	   = CONTROLBAR:TooltipHotWSummonAllies_Level2
	InPalantir		   = Yes
//	UnitSpecificSound  = AragornVoiceSummonOathbreakers
//	AutoAbility		   = Yes //
//	TriggerWhenReady   = Yes //

End

CommandSet NewGondorDamrodCommandSet
	1	= Command_ToggleStance
	2	= Command_SpecialAbilityDeadEye; Command_SpecialAbilityDamrodDeadlySniper
	3	= Command_SpellBookDunedainAllies
	;4	= Command_SpecialAbilityDamrodDeadlySniper
	;5	= Command_SpecialPowerRallyRangers
	12 = Command_CaptureBuilding
	13 = Command_AttackMove
	14 = Command_Stop
	16  = Command_SetStanceBattle
	17  = Command_SetStanceAggressive
	18  = Command_SetStanceHoldGround
End

Weapon DamrodBowDeadlySniper2
	AttackRange         = DAMROD_DEADLYSHOT_RANGE
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= #MULTIPLY( GONDOR_RANGER_RANGE .01 )
	
    LeechRangeWeapon    = Yes
  WeaponSpeed = 561         ; dist/sec 
  MinWeaponSpeed = 481
  MaxWeaponSpeed = 641      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
  FireFX = FX_RohanArcherBowWeapon
  HitPercentage     = 100     ;When this weapon is used it will hit exactly all of the time.

  ProjectileNugget                    ; Default arrow
    ProjectileTemplateName = LegolasBowArrowStormProjectile
    WarheadTemplateName = LegolasBowArrowStormWarhead
  End
End

ModifierList RangerDebuff
	Category					= DEBUFF
	Modifier					= ARMOR	-25%		// Additive. Sum of these are subtracted from all entries in armor.ini
	Modifier					= DAMAGE_MULT 75%	// Multiplicative.  Should make you do less damage
	FX							= FX_GenericDebuff30
	Duration					= 30000
	ReplaceInCategoryIfLongest	= Yes
End

ExperienceLevel	GoodEliteLevel5
	TargetNames							=	GOOD_ELITE	;// defined at top of file
	RequiredExperience					=	EXPERIENCE_REQUIRED_GOOD_ELITE_5
	ExperienceAward						=	EXPERIENCE_AWARD_GOOD_ELITE_5
	AttributeModifiers					=	GoodEliteBonusRank5
	InformUpdateModule					=	Yes
	Rank								=	5
	LevelUpFx							=	FX:GenericLevelUp4FX
	LevelUpTintColor					=	R:255 G:255	B:255
	LevelUpTintPreColorTime				=	500	
	LevelUpTintPostColorTime			=	3000
	LevelUpTintSustainColorTime			=	500	
        Upgrades                                         = Upgrade_ObjectLevel3
	SelectionDecal      
		Texture						=	decal_G_level4
		Texture2					=	decal_good_CO
		Style						=	SHADOW_MERGE_DECAL
		OpacityMin					=	80%
		OpacityMax					=	100%
		MinRadius			  		=	HORDE_DECAL_MIN_RADIUS
		MaxRadius					=	200
		MaxSelectedUnits	  			=	40
	End	
END

Weapon RangerFear ; Shot out every DelayBetweenShots
	RadiusDamageAffects = ENEMIES NOT_SIMILAR
	LeechRangeWeapon      = Yes
	AttackRange           = 50.0
	MeleeWeapon           = No
	DelayBetweenShots     = 200            ; time between shots, msec
	PreAttackDelay        = 0 ;PreAttackDelay+FiringDuration = UseWeaponTiming = Yes duration
	PreAttackType         = PER_SHOT 
	FiringDuration        = 0 

	DamageNugget                  ; A basic Nugget that just does damage
		Damage        = 0		; A whole lot of damage.
		DamageScalar  = 0% NONE +STRUCTURE
		Radius        = 200
		DelayTime     = 0
		DamageType    = MAGIC
		DamageFXType  = MAGIC
		DeathType     = CRUSHED
	End
	AttributeModifierNugget
		AttributeModifier = RangerFear
		DamageFXType = SWORD_SLASH  ;used to cross with their DamageFX listing to determine what effect to play
	End

End

ModifierList RangerFear
	Category					= DEBUFF
    	Modifier                    			= SPEED 50%			; originally 70% which contradicted the tooltip 50%
	Duration					= 30000
	FX						= FX_GenericDebuff
	ReplaceInCategoryIfLongest			= Yes
End



;------------------------------------------------------------------------------
Weapon FaramirSword1
   LeechRangeWeapon      = Yes
  AttackRange           = STANDARD_MELEE_ATTACK_RANGE
  MeleeWeapon           = Yes
  FireFX                = FX_GondorSwordHit
  DelayBetweenShots     = FARAMIR_DELAYBETWEENSHOTS 			; time between shots, msec
  PreAttackDelay        = FARAMIR_PREATTACKDELAY 	; 400 is sword swing delay time before contact with target.
  PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
  FiringDuration        = FARAMIR_FIRINGDURATION 	; Duration of the sword swing

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        = FARAMIR_DAMAGE
    Radius        = 0.0
    DelayTime     = 0
    DamageType    = HERO
    DamageFXType  = SWORD_SLASH
    DeathType     = NORMAL
    DrainLife     		= Yes
    DrainLifeMultiplier	= 1.0
  End
End

SpecialPower SpecialAbilityGloinSmash
Enum						= SPECIAL_WORD_OF_POWER
ReloadTime					   = 360000			
End

; This is Gloin's Shatter Hammer attack
FXList FX_GloinShatterhammer1
  ParticleSystem
    Name = BalrogSummonChunksSmall
    Offset = X:15.0 Y:0.0 Z:15.0
  End
  ParticleSystem
    Name = GloinBlastFinalLight
    Offset = X:15.0 Y:0.0 Z:60   ;Z:8.0
  End

  ;ParticleSystem
    ;Name = BalrogSummonCracks
    ;Offset = X:15.0 Y:0.0 Z:15.0
 ; End

;ParticleSystem
    ;Name = BalrogSummonExplosionChunks
   ; Offset = X:15.0 Y:0.0 Z:15.0
  ;End

;ParticleSystem
   ; Name = BalrogSummonExplosionChunks2
   ; Offset = X:15.0 Y:0.0 Z:15.0
  ;End

  ParticleSystem
    Name = GloinShatterShockwave
    Offset = X:15.0 Y:0.0 Z:20.0
  End
  ParticleSystem
    Name = GloinShatterwave
    Offset = X:15.0 Y:0.0 Z:15.0
  End

ParticleSystem
    Name = GloinShatterwave2
    ;Offset = X:15.0 Y:0.0 Z:15.0
  End

  Sound
    Name = GloinShatterHammer
  End
 DynamicDecal	; A decal that belongs to nobody, but updates internally to fade and tint and such
		DecalName		= EXCracks04
		Size			= 120
		Color			= R:105 G:105 B:105
		Offset			= X:15 Y:00
		OpacityStart		= 0
		OpacityFadeTimeOne	= 200
		OpacityPeak			= 220	
		OpacityPeakTime		= 250
		OpacityFadeTimeTwo	= 30000
		OpacityEnd			= 0

		StartingDelay	= 350
		Lifetime		= 34000
	End
	ViewShake 
    Type = NORMAL ; NORMAL and SUBTLE are the next choices
  End

End

;-------------------------

; ----------------------------------------------
; This is Gloins's Pre Attack Energy Gathering (version)

FXList FX_GloinShatterPre1
  ParticleSystem
    Name = Necro_Acolyte_soul
    Offset = X:0.0 Y:0.0 Z:20.0
  End
  ParticleSystem
    Name = TornadoDebris01
    Offset = X:0.0 Y:0.0 Z:20.0
  End
  ParticleSystem
    Name = TornadoSpinningDust
    Offset = X:0.0 Y:0.0 Z:20.0
  End
  ParticleSystem
    Name = SummonedDragonDust     ;SummonCitadelRocks
    Offset = X:0.0 Y:0.0 Z:0.0
  End

  ParticleSystem
    Name = SummonCitadelRocks
    Offset = X:0.0 Y:0.0 Z:0.0
  End


  ;Sound
  ;  Name = GandalfSpellVoice
  ;End
End


Weapon GloinSmashWeapon ; Big Blue Ring Blast
	IdleAfterFiringDelay = 0
	RadiusDamageAffects = ENEMIES NOT_SIMILAR
	DelayBetweenShots = 5000               ; time between shots, msec
	PreAttackDelay        = 2600
	PreAttackType         = PER_ATTACK ; Do the delay each time we attack a new target
	PreAttackFX           = FX_GloinShatterPre1
	FireFX                = FX_GloinShatterhammer1
	FiringDuration      = 1400
	DamageNugget                        ; A basic Nugget that just does damage
		Damage			= GANDALF_WORD_OF_POWER_DAMAGE
		Radius			= GLOIN_SMASH_WEAPON_RADIUS
		DamageType		= MAGIC
		DamageFXType	= MAGIC
		DeathType		= EXPLODED
		DamageSpeed		= 700.0 ; must match the ShockWaveSpeed below
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .75
		ShockWaveAmount   = 100.0
		ShockWaveRadius   = 500.0
		ShockWaveTaperOff = 1.0
		ShockWaveZMult    = 1.20
		ShockWaveSpeed	  = 700.0 
	End
End

Weapon EliteSword  ; BALANCE CaveTroll Weapon Normal
  LeechRangeWeapon      = Yes
  AttackRange           = 0.8
  MeleeWeapon           = Yes
  DelayBetweenShots     = ARAGORN_DELAYBETWEENSHOTS 		; time between shots, msec
  PreAttackDelay        = ARAGORN_PREATTACKDELAY 			; 400 is sword swing delay time before contact with target.
  PreAttackType         = PER_SHOT						; Do the delay each time we attack a new target
  FireFX                = FX_GondorSwordHit
  ;FireFX                = FX_IsildurSword
  FiringDuration        = ARAGORN_FIRINGDURATION 			; Duration of the sword swing
  RadiusDamageAffects = ENEMIES 
  DamageNugget              ; A basic Nugget that just does damage
    Damage        			= 250
    Radius        			= 50.0
    ;DamageArc     			= 45
    DamageType    			= SLASH
    DamageFXType  			= CLUBBING
    DeathType     			= NORMAL
  End
  MetaImpactNugget          ; A Nugget that throws things back with force
    ShockWaveAmount   		= 25.0
    ShockWaveRadius   		= 25.0
    ShockWaveTaperOff 		= 1.0
    ;ShockWaveArc      		= 45
    ShockWaveZMult    		= 1.00
 ;  HeroResist		  		= 0.90		; 90% resistance to heroes
  End
End

;----------------------
;Gondor Barrack
;---------------




CommandButton Command_DwarvenChargeAttack
  Command				= UNIT_BUILD
	Object				= DwarvenGuardianHorde
        NeededUpgrade                   = Upgrade_GondorBarracksLevel3
        NeededUpgradeAny		= Yes
	Options				= CANCELABLE NEED_UPGRADE
	TextLabel			= Specialisoldier
	ButtonImage			= BDHallofWarriors_DwarvenGuardian
	ButtonBorderType    		= BUILD 
	DescriptLabel       		= SpecialisoldierDesc
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= Yes  ;lack 
	LacksPrerequisiteLabel		= SpecialisoldierLack
End


CommandButton Command_SpecialAbilityCaptainOfGondor
	Command				= UNIT_BUILD
	Object				= DwarvenMenOfDaleHorde
        NeededUpgrade                   = Upgrade_GondorArcheryRangeLevel3
        NeededUpgradeAny		= Yes
	Options				= CANCELABLE NEED_UPGRADE
	;NeededUpgrade			= Upgrade_DwarvenArcheryRangeLevel2
	TextLabel			= Speciazlhvarchers
	ButtonImage			= BDArcheryRange_MenofDale
	ButtonBorderType		= BUILD 
	DescriptLabel			= SpeciazlhvarchersDesc
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
   	UnitSpecificSound   		= GondorArcherVoiceBuy    
	LacksPrerequisiteLabel		= SpeciazlhvarchersLack
End

CommandButton Command_SpecialAbilityStubbornPride
  Command                 	= SPECIAL_POWER 
  SpecialPower            	= SpecialAbilityGloinSmash
  Options               	= OK_FOR_MULTI_SELECT OK_FOR_MULTI_EXECUTE
  TextLabel               	= CONTROLBAR:WordofPower
  ButtonImage             	= Gandolf_radcircle;HSGandalfWordOfPower
  ButtonBorderType        	= ACTION 
  DescriptLabel           	= CONTROLBAR:ToolTipWordofPower
  AutoAbility			= Yes
  PresetRange			= 120.0
;  UnitSpecificSound       	= 
  InPalantir			= Yes
End

CommandSet EliteWarriorCommandset
  	1	= Command_ToggleStance
	2	= Command_SpecialAbilityStubbornPride
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End


CommandSet NewGondorBarracksCommandSet
  	1	= Command_ConstructGondorFighterHorde
	2 	= Command_ConstructRohanSpearmenHorde
  	3	= Command_ConstructGondorTowerShieldGuardHorde
  	;4 	= Command_PurchaseUpgradeGondorBarracksLevel2
  	6	= Command_Sell
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
        7       = Command_DwarvenChargeAttack
        8       = Command_CreateAHero_SpecialAbilityAthelas
        9       = Command_ConstructRohanPeasantHorde
End

CommandSet NewGondorBarracksLevel1CommandSet
  	1	= Command_ConstructGondorFighterHorde
	2 	= Command_ConstructRohanSpearmenHorde
  	3	= Command_ConstructGondorTowerShieldGuardHorde
  	4 	= Command_PurchaseUpgradeGondorBarracksLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
  	6	= Command_Sell
        7       = Command_DwarvenChargeAttack
        8       = Command_CreateAHero_SpecialAbilityAthelas
        9       = Command_ConstructRohanPeasantHorde
End

CommandSet NewGondorBarracksLevel2CommandSet
  	1	= Command_ConstructGondorFighterHorde
	2 	= Command_ConstructRohanSpearmenHorde
  	3	= Command_ConstructGondorTowerShieldGuardHorde
  	;4 	= Command_PurchaseUpgradeGondorBarracksLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
  	6	= Command_Sell
        7       = Command_DwarvenChargeAttack
        8       = Command_CreateAHero_SpecialAbilityAthelas
        9       = Command_ConstructRohanPeasantHorde
End

CommandSet NewGondorBarracksCommandSetLevel3-
  	1	= Command_ConstructGondorFighterHorde
	2 	= Command_ConstructRohanSpearmenHorde
  	3	= Command_ConstructGondorTowerShieldGuardHorde
  	4 	= Command_PurchaseUpgradeGondorBarracksLevel3
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
  	6	= Command_Sell
        7       = Command_DwarvenChargeAttack
        8       = Command_CreateAHero_SpecialAbilityAthelas
        9       = Command_ConstructRohanPeasantHorde
End

CommandSet NewGondorBarracksCommandSetLevel3
  	1	= Command_ConstructGondorFighterHorde
	2 	= Command_ConstructRohanSpearmenHorde
  	3	= Command_ConstructGondorTowerShieldGuardHorde
  	4 	= Command_ConstructRohanPeasantHorde
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
  	6	= Command_Sell
        7       = Command_DwarvenChargeAttack
        8       = Command_CreateAHero_SpecialAbilityAthelas
        ;9       = Command_ConstructRohanPeasantHorde
End

CommandSet NewGondorStablesCommandSet
	1	 = Command_ConstructGondorKnightHorde
	2	 = Command_ConstructRohanRohirrimHorde
	3	 = Command_ConstructGondorKnightsofDolHorde
	;4	 = Command_PurchaseUpgradeGondorStableLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6	 = Command_Sell
        7        = Command_ConstructInnGondorRangerHorde
        8        = Command_ChargeofGlory
End

CommandSet NewGondorStablesCommandSet2-
	1	 = Command_ConstructGondorKnightHorde
	2	 = Command_ConstructRohanRohirrimHorde
	3	 = Command_ConstructGondorKnightsofDolHorde
	4	 = Command_PurchaseUpgradeGondorStableLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6	 = Command_Sell
        7        = Command_ConstructInnGondorRangerHorde
        8        = Command_ChargeofGlory
End

CommandSet NewGondorStablesCommandSet2
	1	 = Command_ConstructGondorKnightHorde
	2	 = Command_ConstructRohanRohirrimHorde
	3	 = Command_ConstructGondorKnightsofDolHorde
	;4	 = Command_PurchaseUpgradeGondorStableLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6	 = Command_Sell
        7        = Command_ConstructInnGondorRangerHorde
        8        = Command_ChargeofGlory
End

CommandSet NewGondorStablesCommandSet3-
	1	 = Command_ConstructGondorKnightHorde
	2	 = Command_ConstructRohanRohirrimHorde
	3	 = Command_ConstructGondorKnightsofDolHorde
	4	 = Command_PurchaseUpgradeGondorStableLevel3
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6	 = Command_Sell
        7        = Command_ConstructInnGondorRangerHorde
        8        = Command_ChargeofGlory
End

CommandSet NewGondorStablesCommandSet3
	1	 = Command_ConstructGondorKnightHorde
	2	 = Command_ConstructRohanRohirrimHorde
	3	 = Command_ConstructGondorKnightsofDolHorde
	;4	 = Command_PurchaseUpgradeGondorStableLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6	 = Command_Sell
        7        = Command_ConstructInnGondorRangerHorde
        8        = Command_ChargeofGlory
End

CommandSet NewGondorArcheryCommandSet
	1 	= Command_ConstructGondorArcherHorde
	2 	= Command_ConstructGondorRangerHorde; Command_ConstructGondorRangerHorde
	3 	= Command_PurchaseTechnologyGondorFireArrows
	;4 	= Command_PurchaseUpgradeGondorArcheryRangeLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6 	= Command_Sell
        7       = Command_SpecialAbilityWoundArrow
        8       = Command_SpecialAbilityCaptainOfGondor
        9       = Command_ConstructRohanArcherHorde

End
CommandSet NewGondorArcheryCommandSet2-
	1 	= Command_ConstructGondorArcherHorde
	2 	= Command_ConstructGondorRangerHorde; Command_ConstructGondorRangerHorde;Command_ConstructGondorRangerHorde
	3 	= Command_PurchaseTechnologyGondorFireArrows
	4 	= Command_PurchaseUpgradeGondorArcheryRangeLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6 	= Command_Sell
        7       = Command_SpecialAbilityWoundArrow
        8       = Command_SpecialAbilityCaptainOfGondor
        9       = Command_ConstructRohanArcherHorde

End

CommandSet NewGondorArcheryCommandSet2
	1 	= Command_ConstructGondorArcherHorde
	2 	= Command_ConstructGondorRangerHorde; Command_ConstructGondorRangerHorde
	3 	= Command_PurchaseTechnologyGondorFireArrows
	;4 	= Command_PurchaseUpgradeGondorArcheryRangeLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6 	= Command_Sell
        7       = Command_SpecialAbilityWoundArrow
        8       = Command_SpecialAbilityCaptainOfGondor
        9       = Command_ConstructRohanArcherHorde

End


CommandSet NewGondorArcheryCommandSet3-
	1 	= Command_ConstructGondorArcherHorde
	2 	= Command_ConstructGondorRangerHorde; Command_ConstructGondorRangerHorde
	3 	= Command_PurchaseTechnologyGondorFireArrows
	4 	= Command_PurchaseUpgradeGondorArcheryRangeLevel3
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6 	= Command_Sell
        7       = Command_SpecialAbilityWoundArrow
        8       = Command_SpecialAbilityCaptainOfGondor
        9       = Command_ConstructRohanArcherHorde

End

CommandSet NewGondorArcheryCommandSet3
	1 	= Command_ConstructGondorArcherHorde
	2 	= Command_ConstructGondorRangerHorde; Command_ConstructGondorRangerHorde
	3 	= Command_PurchaseTechnologyGondorFireArrows
	;4 	= Command_PurchaseUpgradeGondorArcheryRangeLevel2
	5	= Command_PurchaseUpgradeDwarvenMithrilMail
	6 	= Command_Sell
        7       = Command_SpecialAbilityWoundArrow
        8       = Command_SpecialAbilityCaptainOfGondor
        9       = Command_ConstructRohanArcherHorde

End

CommandButton Command_PurchaseTechnologyDwarvenMithrilMail
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyDwarvenMithrilMail
	NeededUpgrade		= Upgrade_GondorForgeLevel2
	NeededUpgradeAny		= Yes
	TextLabel			= Metaldefence
	ButtonImage			= BDForgeWorks_MithrilMail
	ButtonBorderType	= UPGRADE
	DescriptLabel		= MetaldefenceDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= MetaldefenceLack
 	;UnitSpecificSound	= TrollVoxFindTree
End

CommandButton Command_PurchaseUpgradeDwarvenMithrilMail
	Command				= OBJECT_UPGRADE
	Options				= NEED_UPGRADE OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_DwarvenMithrilMail
	NeededUpgrade		= Upgrade_TechnologyDwarvenMithrilMail
	TextLabel			= Metaldefencepot
	ButtonImage			= BDForgeWorks_MithrilMail
	ButtonBorderType	= UPGRADE
	DescriptLabel		= MetaldefencepotDesc
	InPalantir			= Yes
	LacksPrerequisiteLabel		= MetaldefencepotLack
End


CommandButton  Command_SpecialAbilityWildmanPillage
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE ;NEED_UPGRADE 
	Upgrade				= Upgrade_TechnologyMordorForgedBlades 
        ;NeededUpgrade			= Upgrade_DwarvenForgeWorksLevel2
	TextLabel			= Menrisorse
	ButtonImage			= BIArmory_ForgedBlades
	ButtonBorderType	= UPGRADE
	DescriptLabel		= MenrisorseDesc
	Radial				= Yes
	InPalantir			= Yes
	;LacksPrerequisiteLabel		= MenrisorseLack
	;UnitSpecificSound	= TrollVoxFindTree
End

CommandButton Command_HourOfTheWitchKing
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE NEED_UPGRADE
	Upgrade				= Upgrade_TechnologyIsengardHeavyArmor 
        NeededUpgrade			= Upgrade_GondorForgeLevel2
        NeededUpgradeAny		= Yes
	TextLabel			= Mentempo
	ButtonImage			= UCCommon_BarbedArrows
	ButtonBorderType	= UPGRADE
	DescriptLabel		= MentempoDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= MentempoLack
	;UnitSpecificSound	= TrollVoxFindTree
End

CommandButton Command_SpecialAbilityBladeMaster
Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyWildForgedBlades
	NeededUpgrade		= Upgrade_TechnologyGondorForgedBlades
        NeededUpgrade		= Upgrade_GondorForgeLevel3
	TextLabel			= megaspade
	ButtonImage			= BWTreasureTrove_ForgedBlades
	ButtonBorderType	= UPGRADE
	DescriptLabel		= megaspadeDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= megaspadeLack
	
End

CommandButton Command_CreateAHero_SpecialAbilityBladeMaster
Command				= OBJECT_UPGRADE
	Options				= NEED_UPGRADE OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_WildForgedBlades
	NeededUpgrade		= Upgrade_TechnologyWildForgedBlades
	TextLabel			= megaspade2
	ButtonImage			= BWTreasureTrove_ForgedBlades
	ButtonBorderType	= UPGRADE
	DescriptLabel		= megaspade2Desc
	InPalantir			= Yes
	LacksPrerequisiteLabel		= megaspade2Lack
End



;-------------------------------------------
CommandSet NewGondorForgeCommandSet
	1 	= Command_PurchaseTechnologyGondorBasicTraining 
	2 	= Command_PurchaseTechnologyGondorForgedBlades
	3 	= Command_PurchaseTechnologyGondorHeavyArmor
	;4 	= Command_PurchaseUpgradeGondorForgeLevel2
	6 	= Command_Sell
        7       = Command_SpecialAbilityWildmanPillage
        8       = Command_SpecialAbilityBladeMaster
        9       = Command_HourOfTheWitchKing
        10      = Command_PurchaseTechnologyDwarvenMithrilMail
       ; 11      = Command_CreateAHero_ShieldCrush_Level1
End

CommandSet NewGondorForgeCommandSet2-
	1 	= Command_PurchaseTechnologyGondorBasicTraining 
	2 	= Command_PurchaseTechnologyGondorForgedBlades
	3 	= Command_PurchaseTechnologyGondorHeavyArmor
	4 	= Command_PurchaseUpgradeGondorForgeLevel2
	6 	= Command_Sell
        7       = Command_SpecialAbilityWildmanPillage
        8       = Command_SpecialAbilityBladeMaster
        9       = Command_HourOfTheWitchKing
        10      = Command_PurchaseTechnologyDwarvenMithrilMail
      ;  11      = Command_CreateAHero_ShieldCrush_Level1
End

CommandSet NewGondorForgeCommandSet2
	1 	= Command_PurchaseTechnologyGondorBasicTraining 
	2 	= Command_PurchaseTechnologyGondorForgedBlades
	3 	= Command_PurchaseTechnologyGondorHeavyArmor
	;4 	= Command_PurchaseUpgradeGondorForgeLevel3
	6 	= Command_Sell
        7       = Command_SpecialAbilityWildmanPillage
        8       = Command_SpecialAbilityBladeMaster
        9       = Command_HourOfTheWitchKing
        10      = Command_PurchaseTechnologyDwarvenMithrilMail
       ; 11      = Command_CreateAHero_ShieldCrush_Level1
End

CommandSet NewGondorForgeCommandSet3-
	1 	= Command_PurchaseTechnologyGondorBasicTraining 
	2 	= Command_PurchaseTechnologyGondorForgedBlades
	3 	= Command_PurchaseTechnologyGondorHeavyArmor
	4 	= Command_PurchaseUpgradeGondorForgeLevel3
	6 	= Command_Sell
        7       = Command_SpecialAbilityWildmanPillage
        8       = Command_SpecialAbilityBladeMaster
        9       = Command_HourOfTheWitchKing
        10      = Command_PurchaseTechnologyDwarvenMithrilMail
      ;  11      = Command_CreateAHero_ShieldCrush_Level1
End

CommandSet NewGondorForgeCommandSet3
	1 	= Command_PurchaseTechnologyGondorBasicTraining 
	2 	= Command_PurchaseTechnologyGondorForgedBlades
	3 	= Command_PurchaseTechnologyGondorHeavyArmor
	6 	= Command_Sell
        7       = Command_SpecialAbilityWildmanPillage
        8       = Command_SpecialAbilityBladeMaster
        9       = Command_HourOfTheWitchKing
        10      = Command_PurchaseTechnologyDwarvenMithrilMail
       ; 11      = Command_CreateAHero_ShieldCrush_Level1
End

;---------------------------------------------------


Object GondorStable
    AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedZuio
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor
		AttributeModifier		= LessTime
	End
      End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= GBStable.tga 0 IBWargPit_A.tga ;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End
CommandSet = NewGondorStablesCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades 
		;ConflictsWith		= Upgrade_GondorStableLevel3
		CommandSet			= NewGondorStablesCommandSet2-
	End 
End
ReplaceModule ModueTag_StableLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_BarracksLevel2CommandSet1
		TriggeredBy			= Upgrade_GondorStableLevel2
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewGondorStablesCommandSet2
	End   
End

ReplaceModule ModueTag_StableLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_ThirdAgeUp452
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		CommandSet			= NewGondorStablesCommandSet3-
	End
End

AddModule 
Behavior = CommandSetUpgrade ModueTag_ThirdAgeUp456
		TriggeredBy			= Upgrade_GondorStableLevel3
		CommandSet			= NewGondorStablesCommandSet3
	End
End
End

Object GondorBarracks
    AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedZuio
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor
		AttributeModifier		= LessTime
	End
      End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= GBBarracks_New.tga 0 IBWargPit_A.tga ;MB
		UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End
CommandSet = NewGondorBarracksCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewGondorBarracksLevel1CommandSet
	End 
End
ReplaceModule ModueTag_BarracksLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_BarracksLevel2CommandSet1
		TriggeredBy			= Upgrade_GondorBarracksLevel2
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewGondorBarracksLevel2CommandSet
	End   
End

ReplaceModule ModueTag_BarracksLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_ThirdAgeUp3
		TriggeredBy			= Upgrade_GondorBarracksLevel3 
		CommandSet			= NewGondorBarracksCommandSetLevel3
	End
End

AddModule 
Behavior = CommandSetUpgrade ModueTag_ThirdAgeUp4
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		CommandSet			= NewGondorBarracksCommandSetLevel3-
	End
End
End

Object GondorArcherRange
    AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedZuio
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor
		AttributeModifier		= LessTime
	End
      End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		;UpgradeTexture	= GBArcheryN_A.tga 0 IBWargPit_A.tga ;MB
		UpgradeTexture	= GBArcheryN_L.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End
CommandSet = NewGondorArcheryCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewGondorArcheryCommandSet2-
	End 
End
ReplaceModule ModueTag_ArcheryRangeLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_BarracksLevel2CommandSet1
		TriggeredBy			= Upgrade_GondorArcheryRangeLevel2
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewGondorArcheryCommandSet2
	End   
End

ReplaceModule ModueTag_ArcheryRangeLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_ThirdAgeUp5
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		CommandSet			= NewGondorArcheryCommandSet3-
	End
End

AddModule 
Behavior = CommandSetUpgrade ModueTag_ThirdAgeUp3
		TriggeredBy			= Upgrade_GondorArcheryRangeLevel3
		CommandSet			= NewGondorArcheryCommandSet3
	End
End
End

Object GondorForge
    AddModule 
      Behavior = CostModifierUpgrade ModuleTag_CostModifier1
		TriggeredBy				= Upgrade_TechnologyMordorForgedBlades
		ObjectFilter			= ANY +STRUCTURE 
		Percentage				= -25%
	End
      End
      
    AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedZ
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor
		AttributeModifier		= LessTime
	End
      End
CommandSet = NewGondorForgeCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewGondorForgeCommandSet2-
	End 
End
ReplaceModule ModueTag_CaveLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_BarracksLevel2CommandSet1
		TriggeredBy			= Upgrade_GondorForgeLevel2
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewGondorForgeCommandSet2
	End   
End

ReplaceModule ModueTag_CaveLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_ThirdAgeUp3
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		CommandSet			= NewGondorForgeCommandSet3-
	End
End

AddModule 
Behavior = CommandSetUpgrade ModueTag_ThirdAgeUp6
		TriggeredBy			= Upgrade_GondorForgeLevel3
		CommandSet			= NewGondorForgeCommandSet3
	End
End
End

;-----------------------------------------
;Altro uso dei soldati-immagine
;-------------------------------------------

CommandButton Command_SpecialAbilityArrowStorm
  Command                 	= SPECIAL_POWER 
  SpecialPower            	= SpecialAbilityArrowStorm
  Options                 	= NEED_TARGET_POS CONTEXTMODE_COMMAND ;NEED_UPGRADE
  ;NeededUpgrade                 = Upgrade_ObjectLevel2
  TextLabel               	= RangerVolley
  ButtonImage             	= HSLegolasArrowWind
  CursorName              	= Bombard
  RadiusCursorType        	= ArrowStormRadiusCursor
  InvalidCursorName       	= GenericInvalid
  ButtonBorderType        	= ACTION 
  DescriptLabel           	= RangerVolleyDesc
  InPalantir			= Yes
  AutoAbility			= No
;  UnitSpecificSound       	= LegolasVoiceModeArrowWind
  DisableOnModelCondition 	= WEAPONLOCK_SECONDARY					; disable if currently using swords
End

;-----------------------------------------------------------------

CommandButton Command_CreateAHero_HotW_SummonAllies_Level1
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= GSP1
  ButtonImage            	= HSKingDainStubbornPride
  RadiusCursorType        	= IronHandRadiusCursor ;SpeechCraftRadiusCursor
  ButtonBorderType        	= ACTION
  DescriptLabel           	= GSP1Desc
  InPalantir		  	= Yes
End

CommandSet NewGondorFighterHordeCommandSet
	1 	= Command_ToggleStance	
	2	= Command_ToggleFormationGondorFighter
	3 	= Command_PurchaseUpgradeGondorForgedBlades
	4	= Command_PurchaseUpgradeGondorHeavyArmor
	5	= Command_PurchaseUpgradeGondorBasicTraining
        6       = Command_CreateAHero_HotW_SummonAllies_Level1
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandButton Command_CreateAHero_HotW_SummonAllies_Level1
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= GSP2
  ButtonImage            	= HSKingDainStubbornPride
  RadiusCursorType        	= IronHandRadiusCursor ;SpeechCraftRadiusCursor
  ButtonBorderType        	= ACTION
  DescriptLabel           	= GSP2Desc
  InPalantir		  	= Yes
End

CommandSet NewNewGondorFighterHordeCommandSet
	1 	= Command_ToggleStance	
	2	= Command_ToggleFormationGondorFighter
	3 	= Command_PurchaseUpgradeGondorForgedBlades
	4	= Command_PurchaseUpgradeGondorHeavyArmor
	5	= Command_PurchaseUpgradeGondorBasicTraining
        6       = Command_CreateAHero_HotW_SummonAllies_Level1
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandButton Command_CreateAHero_HotW_SummonAllies_Level1
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= GSP3
  ButtonImage            	= HSKingDainStubbornPride
  RadiusCursorType        	= IronHandRadiusCursor ;SpeechCraftRadiusCursor
  ButtonBorderType        	= ACTION
  DescriptLabel           	= GSP3Desc
  InPalantir		  	= Yes
End

CommandSet NewNewNewGondorFighterHordeCommandSet
	1 	= Command_ToggleStance	
	2	= Command_ToggleFormationGondorFighter
	3 	= Command_PurchaseUpgradeGondorForgedBlades
	4	= Command_PurchaseUpgradeGondorHeavyArmor
	5	= Command_PurchaseUpgradeGondorBasicTraining
        6       = Command_CreateAHero_HotW_SummonAllies_Level1
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandSet SuperNewNewNewGondorFighterHordeCommandSet
	1 	= Command_ToggleStance	
	2	= Command_ToggleFormationGondorFighter
	3 	= Command_CreateAHero_SpecialAbilityBladeMaster
	4	= Command_PurchaseUpgradeGondorHeavyArmor
	5	= Command_PurchaseUpgradeGondorBasicTraining
        6       = Command_CreateAHero_HotW_SummonAllies_Level1
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

;--------------------------------------------------------------
;Fine soldier of gondor - inizio arcieri
;------------------------------------------------------.........

CommandButton Command_CreateAHero_A_ToggleWeapon
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= GAP1
  ButtonImage            	= HSKingDainStubbornPride
  RadiusCursorType        	= IronHandRadiusCursor ;SpeechCraftRadiusCursor
  ButtonBorderType        	= ACTION
  DescriptLabel           	= GAP1Desc
  InPalantir		  	= Yes
End

CommandSet NewGondorArcherHordeCommandSet
	1 	= Command_ToggleStance	
	2	= Command_ArcherBombard
	3 	= Command_PurchaseUpgradeGondorFireArrows
	4 	= Command_PurchaseUpgradeGondorHeavyArmor
	5 	= Command_PurchaseUpgradeGondorBasicTraining
        6       = Command_CreateAHero_A_ToggleWeapon
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandButton Command_CreateAHero_A_ToggleWeapon
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= GAP2
  ButtonImage            	= HSKingDainStubbornPride
  RadiusCursorType        	= IronHandRadiusCursor ;SpeechCraftRadiusCursor
  ButtonBorderType        	= ACTION
  DescriptLabel           	= GAP2Desc
  InPalantir		  	= Yes
End

CommandSet NewNewGondorArcherHordeCommandSet
	1 	= Command_ToggleStance	
	2	= Command_ArcherBombard
	3 	= Command_PurchaseUpgradeGondorFireArrows
	4 	= Command_PurchaseUpgradeGondorHeavyArmor
	5 	= Command_PurchaseUpgradeGondorBasicTraining
        6       = Command_CreateAHero_A_ToggleWeapon
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandButton Command_CreateAHero_A_ToggleWeapon
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= GAP3
  ButtonImage            	= HSKingDainStubbornPride
  RadiusCursorType        	= IronHandRadiusCursor ;SpeechCraftRadiusCursor
  ButtonBorderType        	= ACTION
  DescriptLabel           	= GAP3Desc
  InPalantir		  	= Yes
End

CommandSet NewNewNewGondorArcherHordeCommandSet
	1 	= Command_ToggleStance	
	2	= Command_ArcherBombard
	3 	= Command_PurchaseUpgradeGondorFireArrows
	4 	= Command_PurchaseUpgradeGondorHeavyArmor
	5 	= Command_PurchaseUpgradeGondorBasicTraining
        6       = Command_CreateAHero_A_ToggleWeapon
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

;----------------------------------------------------------------------------------
;Fine arcieri - Inizio Cavalieri di g
;----------------------------------------------------------------------------------

;--------------------------------------------------------------
;Fine soldier of gondor - inizio arcieri
;------------------------------------------------------.........

CommandButton Command_RohanEomerOutlawLeadership
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= GCP1
  ButtonImage            	= HSKingDainStubbornPride
  RadiusCursorType        	= IronHandRadiusCursor ;SpeechCraftRadiusCursor
  ButtonBorderType        	= ACTION
  DescriptLabel           	= GCP1Desc
  InPalantir		  	= Yes
End

CommandSet NewGondorKnightHordeCommandSet
	1 	= Command_ToggleStance
	2 	= Command_PurchaseUpgradeGondorForgedBlades
	3 	= Command_PurchaseUpgradeGondorHeavyArmor
	4 	= Command_PurchaseUpgradeGondorBasicTraining
        5       = Command_RohanEomerOutlawLeadership
        6       = Command_SpecialAbilityCreateAHeroHeroicCharge
	12  	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandButton Command_RohanEomerOutlawLeadership
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= GCP2
  ButtonImage            	= HSKingDainStubbornPride
  RadiusCursorType        	= IronHandRadiusCursor ;SpeechCraftRadiusCursor
  ButtonBorderType        	= ACTION
  DescriptLabel           	= GCP2Desc
  InPalantir		  	= Yes
End

CommandSet NewNewGondorKnightHordeCommandSet
	1 	= Command_ToggleStance
	2 	= Command_PurchaseUpgradeGondorForgedBlades
	3 	= Command_PurchaseUpgradeGondorHeavyArmor
	4 	= Command_PurchaseUpgradeGondorBasicTraining
        5       = Command_RohanEomerOutlawLeadership
        6       = Command_SpecialAbilityCreateAHeroHeroicCharge
	12  	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandButton Command_RohanEomerOutlawLeadership
Command                 	= SPECIAL_POWER
  SpecialPower            	= SpecialAbilityFakeLeadership
  Options			= NONPRESSABLE
  TextLabel               	= GCP3
  ButtonImage            	= HSKingDainStubbornPride
  RadiusCursorType        	= IronHandRadiusCursor ;SpeechCraftRadiusCursor
  ButtonBorderType        	= ACTION
  DescriptLabel           	= GCP3Desc
  InPalantir		  	= Yes
End

CommandSet NewNewNewGondorKnightHordeCommandSet
	1 	= Command_ToggleStance
	2 	= Command_PurchaseUpgradeGondorForgedBlades
	3 	= Command_PurchaseUpgradeGondorHeavyArmor
	4 	= Command_PurchaseUpgradeGondorBasicTraining
        5       = Command_RohanEomerOutlawLeadership
        6       = Command_SpecialAbilityCreateAHeroHeroicCharge
	12  	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandSet SuperNewNewNewGondorKnightHordeCommandSet
	1 	= Command_ToggleStance
	2 	= Command_CreateAHero_SpecialAbilityBladeMaster
	3	= Command_PurchaseUpgradeGondorHeavyArmor
	4 	= Command_PurchaseUpgradeGondorBasicTraining
        5       = Command_RohanEomerOutlawLeadership
        6       = Command_SpecialAbilityCreateAHeroHeroicCharge
	12  	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

;-------------------------------------------------------------------
;Fine Cavalieri di gondor
;----------------------------------------------------------

CommandSet NewGondorTowerShieldGuardCommandSet
	1 	= Command_ToggleStance		
	;2	= Command_TowerGuardPorcupineFormation
	3 	= Command_PurchaseUpgradeGondorForgedBlades
	4 	= Command_PurchaseUpgradeGondorHeavyArmor
	5 	= Command_PurchaseUpgradeGondorBasicTraining
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandButton Command_ToggleFormationGondorFighter
	Command			= HORDE_TOGGLE_FORMATION				; Gondor Soldier
	Options			= TOGGLE_IMAGE_ON_FORMATION OK_FOR_MULTI_SELECT
        NeededUpgrade           = Upgrade_technologyElvenSilverthornArrows
	ButtonImage		= UCSoldier_ShieldWall   UCSoldier_ShieldWallOff
	ButtonBorderType	= ACTION 
	TextLabel		= UseShield1			UsePike1
	DescriptLabel		= UseShield2	UsePike2
	InPalantir		= Yes
	DoubleClick		= Yes
	UnitSpecificSound	= GondorSoldierVoiceBlockFormationOn GondorSoldierVoiceLineFormation
End

CommandSet NewGondorTowerShieldGuardCommandSet2Shield
	1 	= Command_ToggleStance		
	2	= Command_ToggleFormationGondorFighter
	3 	= Command_PurchaseUpgradeGondorForgedBlades
	4 	= Command_PurchaseUpgradeGondorHeavyArmor
	5 	= Command_PurchaseUpgradeGondorBasicTraining
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandSet SuperNewGondorTowerShieldGuardCommandSet2Shield
	1 	= Command_ToggleStance		
	2	= Command_ToggleFormationGondorFighter
	3 	= Command_CreateAHero_SpecialAbilityBladeMaster
	4	= Command_PurchaseUpgradeGondorHeavyArmor
	5 	= Command_PurchaseUpgradeGondorBasicTraining
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

;CommandButton Command_RohanEomerSpear
;Command			= HORDE_TOGGLE_FORMATION				; Gondor Soldier
	;Options			= TOGGLE_IMAGE_ON_FORMATION OK_FOR_MULTI_SELECT
	;ButtonImage		= UCSoldier_ShieldWall   ;UCSoldier_ShieldWallOff
	;ButtonBorderType	= ACTION 
	;TextLabel		= UsePike1
	;DescriptLabel		= UsePike2
	;InPalantir		= Yes
	;;DoubleClick		= Yes
	;UnitSpecificSound	= GondorSoldierVoiceBlockFormationOn GondorSoldierVoiceLineFormation
;End

;CommandSet NewGondorTowerShieldGuardCommandSet2Pike
	;1 	= Command_ToggleStance		
	;2	= Command_RohanEomerSpear
	;3 	= Command_PurchaseUpgradeGondorForgedBlades
	;4 	= Command_PurchaseUpgradeGondorHeavyArmor
	;5 	= Command_PurchaseUpgradeGondorBasicTraining
	;12 	= Command_CaptureBuilding
	;13 	= Command_AttackMove
	;14 	= Command_Stop
	;16  	= Command_SetStanceBattle
	;17  	= Command_SetStanceAggressive
	;18  	= Command_SetStanceHoldGround
;End



ModifierList TwrModifier
	Category 	= FORMATION
  	Modifier					= ARMOR	300%		// Additive. Sum of these are subtracted from all entries in armor.ini	// Multiplicative.  Should make you do damage
    	Modifier					= DAMAGE_MULT 150%
	Modifier                                        = SPEED 75%		
       	FX		= FX_SparkBounce
        ;FX							= FX_GenericLeadership ;FX_LevelUp ;FX_ElectricityHit ;FX_GenericDebuff
	Duration					= 0
	;ReplaceInCategoryIfLongest	= Yes  	
	ModelCondition	= ALTERNATE_FORMATION
End

ModifierList ThirdAgeBonusKnight
  	Category					= SPELL
  	Modifier					= ARMOR	15%		// Additive. Sum of these are subtracted from all entries in armor.ini
  	Modifier					= DAMAGE_MULT 115%	// Multiplicative.  Should make you do damage
  	Modifier                                        = HEALTH_MULT 115%
      ;  Modifier                                        = SPEED 150%		
        FX							= FX_LevelUp ;FX_ElectricityHit ;FX_GenericDebuff
	Duration					= 0
	;ReplaceInCategoryIfLongest	= Yes  	
End

ModifierList SecondAgeBonusKnight
  	Category					= SPELL
  	Modifier					= ARMOR	10%		// Additive. Sum of these are subtracted from all entries in armor.ini
  	Modifier					= DAMAGE_MULT 110%	// Multiplicative.  Should make you do damage
  	Modifier                                        = HEALTH_MULT 110%
       ; Modifier                                        = SPEED 200%
        FX							= FX_LevelUp ;FX_ElectricityHit ;FX_GenericDebuff
	Duration					= 0
	;ReplaceInCategoryIfLongest	= Yes  	
End

ModifierList SecondAgeBonus
  	Category					= SPELL
  	Modifier					= ARMOR	10%		// Additive. Sum of these are subtracted from all entries in armor.ini
  	Modifier					= DAMAGE_MULT 110%	// Multiplicative.  Should make you do damage
  	Modifier                                        = HEALTH_MULT 110%		
        FX							= FX_LevelUp ;FX_ElectricityHit ;FX_GenericDebuff
	Duration					= 0
	;ReplaceInCategoryIfLongest	= Yes  	
End

ModifierList SecondAgeBonusArcher
  	Category					= SPELL
  	Modifier					= ARMOR	10%		// Additive. Sum of these are subtracted from all entries in armor.ini
  	Modifier					= DAMAGE_MULT 110%	// Multiplicative.  Should make you do damage
  	Modifier                                        = HEALTH_MULT 110%
  	;Modifier                                        = RANGE 110%		
        FX							= FX_LevelUp ;FX_ElectricityHit ;FX_GenericDebuff
	Duration					= 0
	;ReplaceInCategoryIfLongest	= Yes  	
End

ModifierList ThirdAgeBonus
  	Category					= SPELL
  	Modifier					= ARMOR	15%		// Additive. Sum of these are subtracted from all entries in armor.ini
  	Modifier					= DAMAGE_MULT 115%	// Multiplicative.  Should make you do damage
  	Modifier                                        = HEALTH_MULT 115%		
        FX							= FX_LevelUp ;FX_ElectricityHit ;FX_GenericDebuff
	Duration					= 0
	;ReplaceInCategoryIfLongest	= Yes  	
End

ModifierList ThirdAgeBonusArcher
  	Category					= SPELL
  	Modifier					= ARMOR	15%		// Additive. Sum of these are subtracted from all entries in armor.ini
  	Modifier					= DAMAGE_MULT 115%	// Multiplicative.  Should make you do damage
  	Modifier                                        = HEALTH_MULT 115%
  	;Modifier                                        = RANGE 110%			
        FX							= FX_LevelUp ;FX_ElectricityHit ;FX_GenericDebuff
	Duration					= 0
	;ReplaceInCategoryIfLongest	= Yes  	
End

;---------------------
; INIZIO
;------------------------

CommandButton Command_PurchaseTechnologyElvenBasicTraining
  	Command           	= OBJECT_UPGRADE
  	Upgrade           	= Upgrade_DwarvenFortressOilCasks 
	NeededUpgrade	  = Upgrade_TechnologyElvenBasicTraining
	NeededUpgradeAny		= Yes
	Options			  = CANCELABLE NEED_UPGRADE 
  	TextLabel         	= SecondAge
  	ButtonImage       	= BDFortress_OilCasks
  	ButtonBorderType  	= UPGRADE
  	DescriptLabel     	= SecondAgeDesc
  	Radial            	= Yes
  	InPalantir	   	= No
LacksPrerequisiteLabel  =  SecondAgeMenPrerequisite
End

CommandButton Command_SpecialAbilityBoromirForGondor
  Command           = OBJECT_UPGRADE
  Upgrade           = Upgrade_DwarvenFortressDwarvenStoneworkTrigger
	NeededUpgrade	  = Upgrade_TechnologyElvenSilverthornArrows 
	;NeededUpgrade	  = Upgrade_TechnologyElvenBasicTraining
	NeededUpgradeAny		= Yes
	Options			  = CANCELABLE NEED_UPGRADE  
  TextLabel         = Thirdage
  ButtonImage       = BDFortress_DwarvenStonework
  ButtonBorderType  = UPGRADE
  DescriptLabel     = ThirdageDesc
  Radial            = Yes
 InPalantir	   	= No
LacksPrerequisiteLabel  =  ThirdAgeMenPrerequisite
End

;CommandButton Command_PurchaseUpgradeGondorBasicTraining
;Command           = OBJECT_UPGRADE
	;Options			  = NEED_UPGRADE CANCELABLE
	;Upgrade           = Upgrade_DwarvenFortressMightyCatapult
	;NeededUpgrade	  = Upgrade_GondorBarraksLevel2
	;NeededUpgrade	  = Upgrade_GondorForgeLevel2
	;NeededUpgrade	  = Upgrade_GondorArcheryRangeLevel2
	;NeededUpgrade	  = Upgrade_GondorStableLevel2
	;NeededUpgradeAny		= Yes
	;TextLabel         = CONTROLBAR:PurchaseUpgradeDwarvenFortressMightyCatapult
	;ButtonImage       = BDFortress_MightyCatapult
	;ButtonBorderType  = UPGRADE
	;DescriptLabel     = CONTROLBAR:ToolTipPurchaseUpgradeDwarvenFortressMightyCatapult
	;Radial            = Yes
	;InPalantir	   	  = No
	;LacksPrerequisiteLabel		= TOOLTIP:LackMightyCatapultDwarvenStonework
;End


CommandSet NewMenFortressCommandSet
	InitialVisible = 7
	//Main Menu
	1	= Command_ConstructMenPorter
;	2	= Command_ConstructGondorKnightsofDolHorde
	2   	= Command_SelectRevivablesMenFortress	
	3	= Command_FireWeaponMenFortressBoilingOil
	4	= Command_SpecialAbilityIvoryTowerVision
	6	= Command_Sell
	5   	= Command_SelectUpgradesMenFortress

	//Upgrades Menu
        7       = Command_PurchaseTechnologyElvenBasicTraining;Command_PurchaseUpgradeElvenBasicTraining
	8	= Command_PurchaseUpgradeMenFortressBanners
	9	= Command_PurchaseUpgradeMenFortressHouseOfHealing
	10	= Command_PurchaseUpgradeMenFortressFlamingMunitions
	11	= Command_PurchaseUpgradeMenFortressBoilingOil
	;12	= Command_PurchaseUpgradeMenFortressNumenorStonework
	;13	= Command_PurchaseUpgradeMenFortressIvoryTower
	14	= Command_RadialBack

	//Hero Menu
	15	= Command_RingHeroReviveSlot
	16	= Command_CreateAHeroReviveSlot		// Note we also need an extra slot for the Create A Hero
	17	= Command_GenericReviveSlot1		//Revives any hero. keep them UNIQUE within the same commandset! 
	18	= Command_GenericReviveSlot2		
	19	= Command_GenericReviveSlot3		
	20	= Command_GenericReviveSlot4		
	21	= Command_GenericReviveSlot5		
	22	= Command_GenericReviveSlot6		
	23	= Command_GenericReviveSlot7		
	24	= Command_RadialBack				
End	

CommandSet NewMenFortressCommandSetThirdAge
	InitialVisible = 7
	//Main Menu
	1	= Command_ConstructMenPorter
;	2	= Command_ConstructGondorKnightsofDolHorde
	2   	= Command_SelectRevivablesMenFortress	
	3	= Command_FireWeaponMenFortressBoilingOil
	4	= Command_SpecialAbilityIvoryTowerVision
	6	= Command_Sell
	5   	= Command_SelectUpgradesMenFortress

	//Upgrades Menu
        7       = Command_SpecialAbilityBoromirForGondor;Command_PurchaseUpgradeElvenBasicTraining
	8	= Command_PurchaseUpgradeMenFortressBanners
	9	= Command_PurchaseUpgradeMenFortressHouseOfHealing
	10	= Command_PurchaseUpgradeMenFortressFlamingMunitions
	11	= Command_PurchaseUpgradeMenFortressBoilingOil
	;12	= Command_PurchaseUpgradeMenFortressNumenorStonework
	;13	= Command_PurchaseUpgradeMenFortressIvoryTower
	14	= Command_RadialBack

	//Hero Menu
	15	= Command_RingHeroReviveSlot
	16	= Command_CreateAHeroReviveSlot		// Note we also need an extra slot for the Create A Hero
	17	= Command_GenericReviveSlot1		//Revives any hero. keep them UNIQUE within the same commandset! 
	18	= Command_GenericReviveSlot2		
	19	= Command_GenericReviveSlot3		
	20	= Command_GenericReviveSlot4		
	21	= Command_GenericReviveSlot5		
	22	= Command_GenericReviveSlot6		
	23	= Command_GenericReviveSlot7		
	24	= Command_RadialBack				
End	

CommandSet NewMenPorterCommandSet2 
   1  = Command_Stop
   2  = Command_PorterExtinguishFire
   3  = Command_PorterConstructMenFarm
   4  = Command_PorterConstructMenBarracks
   5  = Command_PorterConstructMenArcheryRange
   6  = Command_PorterConstructMenStable
   ;7  = Command_PorterConstructMenWorkshop
   8  = Command_PorterConstructMenSentryTower
   9  = Command_PorterConstructMenWell
   10 = Command_PorterConstructMenStatue
   11 = Command_PorterConstructMenBlacksmith
   ;12 = Command_PorterConstructMenMarketPlace
   13 = Command_PorterConstructMenWallHub
   14 = Command_PorterConstructMenFortress 
End

CommandSet NewMenPorterCommandSet3
   1  = Command_Stop
   2  = Command_PorterExtinguishFire
   3  = Command_PorterConstructMenFarm
   4  = Command_PorterConstructMenBarracks
   5  = Command_PorterConstructMenArcheryRange
   6  = Command_PorterConstructMenStable
   7  = Command_PorterConstructMenWorkshop
   8  = Command_PorterConstructMenSentryTower
   9  = Command_PorterConstructMenWell
   10 = Command_PorterConstructMenStatue
   11 = Command_PorterConstructMenBlacksmith
   12 = Command_PorterConstructMenMarketPlace
   13 = Command_PorterConstructMenWallHub
   14 = Command_PorterConstructMenFortress 
  ; 15 = Command_ConstructGondorStoneMaker
End


CommandSet NewMenPorterCommandSet 
   1  = Command_Stop
   2  = Command_PorterExtinguishFire
   3  = Command_PorterConstructMenFarm
   4  = Command_PorterConstructMenBarracks
   5  = Command_PorterConstructMenArcheryRange
   6  = Command_PorterConstructMenStable
  ; 7  = Command_PorterConstructMenWorkshop
   ;8  = Command_PorterConstructMenSentryTower
   ;9  = Command_PorterConstructMenWell
   ;10 = Command_PorterConstructMenStatue
   11 = Command_PorterConstructMenBlacksmith
   ;12 = Command_PorterConstructMenMarketPlace
   ;13 = Command_PorterConstructMenWallHub
   14 = Command_PorterConstructMenFortress 
End


Object MenPorter
CommandSet = NewMenPorterCommandSet 
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades  ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMenPorterCommandSet2 
	End 
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp3
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor  ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMenPorterCommandSet3
	End 
End
End

Object MenFortressCitadel
RemoveModule AutoDepositModuleTag
CommandSet = NewMenFortressCommandSet
ReplaceModule ModuleTag_PassOutNumenorStoneworkUpgrade
Behavior = CastleUpgrade ModuleTag_PassOutNumenorStoneworkUpgrade1
		TriggeredBy	= Upgrade_DwarvenFortressOilCasks
		Upgrade		= Upgrade_MenFortressNumenorStonework ;Upgrade_MenFortressNumenorStonework
		WallUpgradeRadius = MEN_FORTRESS_WALL_EFFECTIVE_RADIUS
	End
End

;----------------
AddModule
Behavior = CastleUpgrade ModuleTag_PassOutNumenorStoneworkUpgrade100
		TriggeredBy	= Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		Upgrade		= Upgrade_MenFortressIvoryTower  ;Upgrade_MenFortressNumenorStonework
		;WallUpgradeRadius = MEN_FORTRESS_WALL_EFFECTIVE_RADIUS
	End
End
;---------------------
	ReplaceModule ModuleTag_Reinforced
	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced1
		TriggeredBy				= Upgrade_MenFortressNumenorStonework
		AttributeModifier		= NumenorStoneworkKeep_Bonus
	End
End
ReplaceModule ModuleTag_ShowTheStones
	Behavior = ModelConditionUpgrade ModuleTag_ShowTheStones1
		TriggeredBy			= Upgrade_MenFortressNumenorStonework		
		AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK
		Permanent			= Yes
	End
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp
		TriggeredBy			= Upgrade_MenFortressNumenorStonework ;Upgrade_TechnologyElvenForgedBlades ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMenFortressCommandSetThirdAge
	End 
End
ReplaceModule ModuleTag_IvoryTowerBonus
	Behavior = AttributeModifierUpgrade ModuleTag_IvoryTowerBonus1
		AttributeModifier	= MenFortressIvoryTowerBonus
		TriggeredBy			= Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;RequiresAllTriggers = Yes
	End
End	
	
ReplaceModule ModuleTag_IvoryTowerVisionEnabler
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_IvoryTowerVisionEnabler1
		SpecialPowerTemplate = SpecialAbilityMenFortressIvoryTowerVision
		TriggeredBy = Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;RequiresAllTriggers = Yes
	End
End

	ReplaceModule ModuleTag_IvoryTowerBuildLoop
	Behavior = AudioLoopUpgrade ModuleTag_IvoryTowerBuildLoop1
		; Play a "build loop" while the IvoryTower is building up
		TriggeredBy			= Upgrade_DwarvenFortressDwarvenStoneworkTrigger;Upgrade_MenFortressNumenorStonework
		;ConflictsWith		= Upgrade_PosternGate Upgrade_WallBanner
		SoundToPlay			= BuildingBigConstructionLoop
		KillOnDeath         = Yes
		KillAfterMS			= 2500  ; Should match the length of the build-up animation [Or a little shorter since sounds take a little while to die]
	End
End
ReplaceModule ModuleTag_ShowTheTower
	Behavior = ModelConditionUpgrade ModuleTag_ShowTheTower1
		TriggeredBy				= Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;RequiresAllTriggers 	= Yes
		AddConditionFlags		= UPGRADE_IVORY_TOWER
		AddTempConditionFlag	= ModelConditionState:USER_2 //For buildup
		TempConditionTime		= 10.0						 //try to match buildup anim time
		Permanent				= Yes
	End
End
End

Object GondorFighter
RemoveModule ModuleTag_01
AddModule 
	Draw = W3DHordeModelDraw ModuleTag_012
		OkToChangeModelColor = Yes	
		StaticModelLODMode = Yes
		
		// specify options for static LODs
		LodOptions							= LOW
			AllowMultipleModels				= ALLOW_MULTIPLE_MODELS_LOW
			MaxRandomTextures				= MAX_RANDOM_TEXTURES_LOW
			MaxRandomAnimations				= MAX_RANDOM_ANIMATIONS_LOW
			MaxAnimFrameDelta				= MAX_ANIM_FRAME_DELTA_LOW
		End
		
		LodOptions							= MEDIUM
			AllowMultipleModels				= ALLOW_MULTIPLE_MODELS_MED
		        MaxRandomTextures				= MAX_RANDOM_TEXTURES_MED
			MaxRandomAnimations				= MAX_RANDOM_ANIMATIONS_MED
		        MaxAnimFrameDelta				= MAX_ANIM_FRAME_DELTA_MED
		End
		
		LodOptions							= HIGH
			AllowMultipleModels				= ALLOW_MULTIPLE_MODELS_HIGH
			MaxRandomTextures				= MAX_RANDOM_TEXTURES_HIGH
			MaxRandomAnimations				= MAX_RANDOM_ANIMATIONS_HIGH
			MaxAnimFrameDelta				= MAX_ANIM_FRAME_DELTA_HIGH
		End

		WadingParticleSys = WaterRipplesTrail  // used when the unit is wading in shallow water.
//================ MODELS =================================================================
		DefaultModelConditionState
			Model							= GUNumnrean_SKN  ;GUMAArms_SKN
			Skeleton						= GUMAArms_SKL
		End

		ModelConditionState WEAPONSET_PLAYER_UPGRADE
			Model							= GUMAArms_SKN
			Skeleton						= GUMAArms_SKL
		End
		
		ModelConditionState = USER_4		// This state is used in cinematics to get the old style armor
			Model							= GUMAArms_SKN
			Skeleton						= GUMAArms_SKL
		Texture	= GUManAtArms.tga 0 GuNumnrean.tga ;GUManAtArms.tga;	
		End

                ModelConditionState = UPGRADE_NUMENOR_STONEWORK
			 Model               = GUMAArms_SKN ;CineMAArms_SKN
			 Skeleton            = GUMAArms_SKL
                ;Texture           = GUManAtArms.tga 0 GUPorterUpgrades.tga
		End
                

		;ModelConditionState = UPGRADE_NUMENOR_STONEWORK
			;Model               = CineMAArms_SKN
			;Skeleton            = GUMAArms_SKL
                  ;Texture           = GUManAtArms.tga 0 GBFortress1_U.tga
		;End

   
//=============== ANIMATIONS ===============================================================

//======= FALLING & FLYING

		AnimationState						= PASSENGER
			Animation						= Grabbed
				AnimationName				= GUMAArms_FLLA
				AnimationMode				= LOOP
			End
		End
		
		AnimationState        				= THROWN_PROJECTILE
			Animation           			= FlyA
				AnimationName      	 		= GUMAARMS_FLYA
				AnimationMode       		= LOOP
			End
			Animation           			= FlyB
				AnimationName       		= GUMAARMS_FLYB
				AnimationMode       		= LOOP
			End
			Animation           			= FlyC
				AnimationName       		= GUMAARMS_FLYC
				AnimationMode       		= LOOP
			End
			Animation           			= FlyD
				AnimationName       		= GUMAARMS_FLYD
				AnimationMode       		= LOOP
			End
			Flags               			= RANDOMSTART
		End
		
		AnimationState						= FREEFALL
			Animation						= Falling
				AnimationName				= GUMAArms_FLYD
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
			Animation						= Falling
				AnimationName				= GUMAArms_FLYC
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
				AnimationSpeedFactorRange	= 0.5	0.5
			End
		End

		
		
		AnimationState        				= STUNNED_FLAILING 
			Animation           			= FlyA
				AnimationName       		= GUMAARMS_FLYA
				AnimationMode       		= LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Animation           			= FlyB
				AnimationName       		= GUMAARMS_FLYB
				AnimationMode       		= LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Animation           			= FlyC
				AnimationName       		= GUMAARMS_FLYC
				AnimationMode       		= LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Animation           			= FlyD
				AnimationName      		 	= GUMAARMS_FLYD
				AnimationMode       		= LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags               			= RANDOMSTART
		End

		AnimationState						= DYING BURNINGDEATH
			Animation
				AnimationName				= GUManMocap_DIEB
				AnimationMode				= ONCE
				AnimationBlendTime			= 10
			End
			Animation
				AnimationName				= GUManMocap_DIEC
				AnimationMode				= ONCE
				AnimationBlendTime			= 10
			End
			Animation
				AnimationName				= GUManMocap_DIED
				AnimationMode				= ONCE
				AnimationBlendTime			= 10
			End
			Animation
				AnimationName				= GUManMocap_DIEE
				AnimationMode				= ONCE
				AnimationBlendTime			= 10
			End
		End
		AnimationState 						= DYING SPLATTED
			Animation 						= Splatted_On_Ground
				AnimationName 				= GUMAARMS_LNDA
				AnimationMode 				= ONCE
			End
			EnteringStateFX					= FX_OrcHitGround
		End
		AnimationState						= DYING AFLAME
			Animation						= MFDA
				AnimationName				= GUManMocap_MFDA
				AnimationMode				= LOOP
			End
		End
		AnimationState						= DYING
			//Animation						= DIEA
			
			//	AnimationName				= GUManMocap_DIEA
			//	AnimationMode				= ONCE
			//End
			Animation						= DIEB
				AnimationName				= GUManMocap_DIEB
				AnimationMode				= ONCE
			End
			Animation						= DIEC
				AnimationName				= GUManMocap_DIEC
				AnimationMode				= ONCE
			End
			Animation						= DIED
				AnimationName				= GUManMocap_DIED
				AnimationMode				= ONCE
			End
			Animation						= DIEE
				AnimationName				= GUManMocap_DIEE
				AnimationMode				= ONCE
			End
		End

		AnimationState						= BURNINGDEATH
			Animation
				AnimationName				= GUManMocap_MFDA
				AnimationMode				= LOOP
				Distance					= 50
			End
		End

		AnimationState						= PARALYZED
			Animation
				AnimationName				= GUManMocap_IDLB
				AnimationMode				= LOOP
			End
		End

//======= LANDING & STANDING

		AnimationState						= STUNNED_STANDING_UP
			Animation						= GTPA
				AnimationName				= GUMAArms_GTPA
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 2.0 2.0
			End
			Animation						= GTPB
				AnimationName				= GUMAArms_GTPD
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 2.0 2.0
			End
		End


	
		AnimationState			=	 STUNNED
			Animation			=	 Slatted_On_Ground
			AnimationName 				= GUMAARMS_LNDA
				AnimationMode 				= ONCE
			End
			EnteringStateFX					= FX_OrcHitGround

       End 
       
		AnimationState        = MOVING FIRING_OR_PREATTACK_A
			ShareAnimation		= Yes
			Animation           = RunAndFire
				AnimationName       = GUManMocap_ATRA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART  
		End
		
//====== TERROR
		
		AnimationState						= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
			//@@@KM Add distance
			Animation					= TerrorFromTheSky
				AnimationName			= GUManMocap_RUND
				AnimationMode			= LOOP
			End
			Animation					= TerrorFromTheSky
				AnimationName			= GUManMocap_RUNE
				AnimationMode			= LOOP
			End
			Flags = RANDOMSTART
		End
		AnimationState						= MOVING EMOTION_TERROR
			//@@@KM Add distance
			Animation						= TerrorFromTheSky
				AnimationName				= GUManMocap_RUND
				AnimationMode				= ONCE
			End
			Animation						= TerrorFromTheSky
				AnimationName				= GUManMocap_RUNE
				AnimationMode				= ONCE
			End
			Flags							= RESTART_ANIM_WHEN_COMPLETE
		End
		
//======= BACK UP
		
		AnimationState						= MOVING BACKING_UP
			//@@@KM Add distance
			Animation						= BAKA
				AnimationName				= GUManMocap_BAKA
				AnimationMode				= LOOP
			End
			Animation						= BAKB
				AnimationName				= GUManMocap_BAKB
				AnimationMode				= LOOP
			End
			Animation						= BAKC
				AnimationName				= GUManMocap_BAKC
				AnimationMode				= LOOP
			End
			Flags = RANDOMSTART
		End

		AnimationState						= MOVING PANICKING
			//@@@KM - Add Distance
			Animation						= MFDA
				AnimationName				= GUManMocap_MFDA
				AnimationMode				= LOOP
			End
			Flags							= RANDOMSTART
			//ParticleSysBone				= None InfantryDustTrails
		End
		
		AnimationState						= MOVING ATTACKING
			ShareAnimation					= Yes//
			Animation						= RUNA
				AnimationName				= GUManMocap_RUNA
				AnimationMode				= LOOP
				Distance					= 25
			End
			Flags							= RANDOMSTART
			//ParticleSysBone				= None InfantryDustTrails
		End
		
		AnimationState				= MOVING ALTERNATE_FORMATION
			Animation
				AnimationName				= GUMAArms_SPCA
				AnimationMode				= LOOP
				Distance					= 20
			End
			Flags							= RANDOMSTART
		End

		
		AnimationState						= MOVING
			//@@@KM - Add Distance
			ShareAnimation					= Yes//
			Animation						= RUNB
				AnimationName				= GUManMocap_RUNB
				AnimationMode				= LOOP
				Distance					= 30
			End
			Animation						= RUNC
				AnimationName				= GUManMocap_RUNC
				AnimationMode				= LOOP
				Distance					= 30
			End
			Flags							= RANDOMSTART
			//ParticleSysBone				= None InfantryDustTrails
		End
//======= UNCONTROLLABLY AFRAID
	// This is before Attacking so it overrides it.  Normal fear is below so you don't go to little-fear in between swings.
		AnimationState						= EMOTION_UNCONTROLLABLY_AFRAID
			Animation						= FERA
				AnimationName				= GUManMocap_FERA
				AnimationMode				= LOOP
			End 
			Animation						= FERB
				AnimationName				= GUManMocap_FERB
				AnimationMode				= LOOP
			End
			Animation						= FERC
				AnimationName				= GUManMocap_FERC
				AnimationMode				= LOOP
			End
			Animation						= FERD
				AnimationName				= GUManMocap_FERD
				AnimationMode				= LOOP
			End
			Animation						= FERE
				AnimationName				= GUManMocap_FERE
				AnimationMode				= LOOP
			End
			Animation						= FERF
				AnimationName				= GUManMocap_FERF
				AnimationMode				= LOOP
			End
		End

;-------------------------------------------------------------

		AnimationState        =  FIRING_OR_PREATTACK_A
			Animation           = ATA1
				AnimationName     = GUMAArms_ATKA
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			Animation           = ATB1
				AnimationName     = GUMAArms_ATKB
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			Animation           = ATC1
				AnimationName     = GUMAArms_ATKC
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			;ParticleSysBone     = None MeleeDust
		End

;------------------------------------------------------------------

//----------------- HIT REACTIONS -------------------------------------------------------------------------

;		AnimationState						= HIT_REACTION
			//Animation						= HITA
			//	AnimationName				= GUManMocap_HITA
			//	AnimationMode				= ONCE
			//End
;			Animation						= HITB
;				AnimationName				= GUManMocap_HITB
;				AnimationMode				= ONCE
;			End
;		End

//----------------- EMOTIONS ----------------------------------------------------------------
//======= APPREHENSIVE

		AnimationState						= EMOTION_ALERT EMOTION_AFRAID
			Animation						= APPA
				AnimationName				= GUManMocap_APPA
				AnimationMode				= ONCE
			End
			Animation						= APPB
				AnimationName				= GUManMocap_APPB
				AnimationMode				= ONCE
			End
			Flags							= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End
		
//======= AFRAID

		AnimationState						= EMOTION_AFRAID
			Animation						= FERA
				AnimationName				= GUManMocap_FERA
				AnimationMode				= LOOP
			End 
			Animation						= FERB
				AnimationName				= GUManMocap_FERB
				AnimationMode				= LOOP
			End
			Animation						= FERC
				AnimationName				= GUManMocap_FERC
				AnimationMode				= LOOP
			End
			Animation						= FERD
				AnimationName				= GUManMocap_FERD
				AnimationMode				= LOOP
			End
			Animation						= FERE
				AnimationName				= GUManMocap_FERE
				AnimationMode				= LOOP
			End
			Animation						= FERF
				AnimationName				= GUManMocap_FERF
				AnimationMode				= LOOP
			End
			Flags							= RANDOMSTART
		End
		
//======== POINTING

		AnimationState						= EMOTION_POINTING
			Animation						= Pointing1
				AnimationName				= GUManMocap_RCTA
				AnimationMode				= LOOP
			End
			Flags							= RANDOMSTART
		End
		
//======= TAUNTING

		AnimationState						= EMOTION_TAUNTING
			Animation						= Taunting1
				AnimationName				= GUManMocap_TNTA
				AnimationMode				= ONCE
			End
			Animation						= Taunting2
				AnimationName				= GUManMocap_TNTB
				AnimationMode				= ONCE
			End
			Animation						= Taunting3
				AnimationName				= GUManMocap_TNTC
				AnimationMode				= ONCE
			End
			Animation						= Taunting4
				AnimationName				= GUManMocap_IDLC
				AnimationMode				= ONCE
			End
			Animation						= Taunting5
				AnimationName				= GUManMocap_IDLA
				AnimationMode				= ONCE
			End
			Animation						= Taunting6
				AnimationName				= GUManMocap_IDLH
				AnimationMode				= ONCE
			End
			Flags							= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End

//======= CELEBRATING

		AnimationState						= EMOTION_CELEBRATING
			Animation						= CHRB
				AnimationName				= GUManMocap_CHRB
				AnimationMode				= ONCE
			End
			Animation						= CHRC
				AnimationName				= GUManMocap_CHRC
				AnimationMode				= ONCE
			End
			Animation						= IDLD
				AnimationName				= GUManMocap_IDLD
				AnimationMode				= ONCE
			End
			Flags							=	RESTART_ANIM_WHEN_COMPLETE
		End

//----------------- ALERT STATE ---------------------------------------------------------------------------

		AnimationState						= ATTACKING
			Animation						= ALERT_1
				AnimationName				= GUManMocap_IDLA
				AnimationMode				= LOOP
			End
		End	

		AnimationState						= EMOTION_ALERT
			Animation						= ALERT_1
				AnimationName				= GUManMocap_IDLA
				AnimationMode				= LOOP//ONCE
				AnimationPriority			= 10
			End
			Flags							= RESTART_ANIM_WHEN_COMPLETE // acts like an idle animation & keeps running the animations.
		End
		
		AnimationState						= RAISING_FLAG
			Animation						= CHRB
				AnimationName				= GUManMocap_CHRB
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Animation						= CHRC
				AnimationName				= GUManMocap_CHRC
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Flags							=	RESTART_ANIM_WHEN_COMPLETE
		End
		
//----------------- SELECTED STATES -----------------------------------------------------------------------
		AnimationState        = SELECTED
			StateName           = STATE_Selected
			Animation           = ATNB
				AnimationName     = GUManMocap_ATNB
				AnimationMode     = LOOP
			End
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" 
				then 
					CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") 
				end
				if CurDrawableModelcondition("ATTACKING")
				then
					return "IDLA"
				else
					return "ATNA"
				end
			EndScript
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
			EndScript
		End
		
//----------------- IDLE STATES ---------------------------------------------------------------------------
		AnimationState				= WEAPONSET_PLAYER_UPGRADE
			StateName				= STATE_Idle
			Animation				= IDLI
				AnimationName       = GUManMocap_IDLH
				AnimationMode       = ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation				= IDLD
				AnimationName       = GUManMocap_IDLD
				AnimationMode       = ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation				= IDLH
				AnimationName       = GUManMocap_IDLH
				AnimationMode       = ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation				= CHRB
				AnimationName       = GUManMocap_CHRB
				AnimationMode       = ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation				= CHRC
				AnimationName       = GUManMocap_CHRC
				AnimationMode       = ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Flags					= RESTART_ANIM_WHEN_COMPLETE			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
			EndScript
		End		
		AnimationState				= USER_3
			StateName				= STATE_User_3
			Animation				= GUARD_STANCE
				AnimationName		= GUManMocap_IDLA
				AnimationMode		= LOOP
			End
		End
		IdleAnimationState
			StateName				= STATE_Idle
			Animation				= IDLB
				AnimationName       = GUManMocap_IDLB
				AnimationMode       = ONCE
				AnimationPriority   = 20
				AnimationSpeedFactorRange = 0.9 1.1
				AnimationBlendTime	= 15
			End
			Animation				= IDLF
				AnimationName       = GUManMocap_IDLF
				AnimationMode       = ONCE
				AnimationPriority   = 1
				AnimationSpeedFactorRange = 0.9 1.1
				AnimationBlendTime	= 15
			End
			Animation				= IDLG
				AnimationName       = GUManMocap_IDLG
				AnimationMode       = ONCE
				AnimationPriority   = 1
				AnimationSpeedFactorRange = 0.9 1.1
				AnimationBlendTime	= 15
			End
			Animation				= IDLJ
				AnimationName       = GUManMocap_IDLJ
				AnimationMode       = ONCE
				AnimationPriority   = 1
				AnimationSpeedFactorRange = 0.9 1.1
				AnimationBlendTime	= 15
			End
			Animation				= IDLK
				AnimationName       = GUManMocap_IDLK
				AnimationMode       = ONCE
				AnimationPriority   = 1
				AnimationSpeedFactorRange = 0.9 1.1
				AnimationBlendTime	= 15
			End
			Animation				= IDLL
				AnimationName       = GUManMocap_IDLL
				AnimationMode       = ONCE
				AnimationPriority   = 1
				AnimationSpeedFactorRange = 0.9 1.1
				AnimationBlendTime	= 15
			End
			Animation				= IDLN
				AnimationName       = GUManMocap_IDLN
				AnimationMode       = ONCE
				AnimationPriority   = 1
				AnimationSpeedFactorRange = 0.9 1.1
				AnimationBlendTime	= 15
			End
			Animation				= IDLO
				AnimationName       = GUManMocap_IDLO
				AnimationMode       = ONCE
				AnimationPriority   = 1
				AnimationSpeedFactorRange = 0.9 1.1
				AnimationBlendTime	= 15
			End
			Animation				= IDLP
				AnimationName       = GUManMocap_IDLP
				AnimationMode       = ONCE
				AnimationPriority   = 1
				AnimationSpeedFactorRange = 0.9 1.1
				AnimationBlendTime	= 15
			End		
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
			EndScript
		End
//--------------- TRANSITIONS ---------------------------------------------------------------------------
		TransitionState       = TRANS_TO_USER_1
			Animation
				AnimationName     = GUManMocap_RCTA
				AnimationMode     = ONCE
			End
		End
		TransitionState       = TRANS_IdleToSelected
			Animation           = ATNA
				AnimationName     = GUManMocap_ATNA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.9 1.0
				
			End
		End
		TransitionState		= TRANS_SelectedToIdle
			Animation			= ATND
				AnimationName	= GUManMocap_ATND
				AnimationMode	= ONCE
				AnimationSpeedFactorRange = 0.9 1.0
			End
		End
//-----------------------------------------------------------------------------------------------------------
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades		
		AttributeModifier		= SecondAgeBonus
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		AttributeModifier		= ThirdAgeBonus
	End
End

AddModule 
	Behavior = SubObjectsUpgrade Armor_Upgrade7776
		TriggeredBy		= Upgrade_TechnologyElvenForgedBlades	
		UpgradeTexture	= GUManAtArms.tga 0 GuNumnrean.tga ;0 GuNumnrean.tga ;GUManAtArms.tga;
		;RecolorHouse	= Yes
                ;OkToChangeModelColor = No
		ExcludeSubobjects = Forged_Blade
	End
End

;AddModule
	;Behavior = ModelConditionUpgrade ModuleTag_EliteSoldiers
		;TriggeredBy		= Upgrade_TechnologyElvenHeavyArmor
		;AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK
		;Permanent		= Yes
	;End;
;End

AddModule 
	Behavior = SubObjectsUpgrade Armor_Upgrade777
		TriggeredBy		= Upgrade_TechnologyElvenHeavyArmor ;Upgrade_MenFaction
		UpgradeTexture	= GuNumnrean.tga 0 GUManAtArms.tga;0 GuNumnrean.tga ;GUManAtArms.tga;
		UpgradeTexture	= GUManAtArms.tga 0 GUManAtArms.tga;0 GuNumnrean.tga ;GUManAtArms.tga;
		;RecolorHouse	= Yes
                ;OkToChangeModelColor = No
		ExcludeSubobjects = Forged_Blade
	End
End

AddModule 
	Behavior = ModelConditionUpgrade ModuleTag_SuperSoldiers2
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades	
		;Texture	= GUManAtArms.tga 0 GuNumnrean.tga ;GUManAtArms.tga;	
		AddConditionFlags	= USER_4
		Permanent			= Yes
	End
End
End

Object GondorFighterHorde
CommandSet = NewGondorFighterHordeCommandSet
;----------------------------------------
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee7
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf67866
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperSword
	End
      End

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee778
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf66766
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End

;---------------------------------------------------
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades		
		AttributeModifier		= SecondAgeBonus
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		AttributeModifier		= ThirdAgeBonus
	End
End
AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewGondorFighterHordeCommandSet
	End 
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_TirdAgeUp
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewNewGondorFighterHordeCommandSet
	End 
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp456778
		TriggeredBy			= Upgrade_GondorForgedBlades Upgrade_TechnologyElvenHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= SuperNewNewNewGondorFighterHordeCommandSet
	End 
End
End

Object GondorArcher 
RemoveModule ModuleTag_01
AddModule
Draw =	W3DScriptedModelDraw ModuleTag_012
		OkToChangeModelColor = Yes
	; --- test entries for attachable submodels
	AttachModel =
		Bone = BAT_Head
		Model = GU_Helmet001
	End
	
	AttachModel = ATTACKING
		Bone = BAT_FarmL
		Model = GU_Shield001
	End

	AttachModel = NOT_ATTACKING		
                Bone = B_HandR
		Model = GU_Sword001
	End

	ParticlesAttachedToAnimatedBones = yes
// --------- With Bow ------------
		DefaultModelConditionState
			Model						=	GUNumnArch_SKN	 ;GUArcher_SKN
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
			WeaponLaunchBone			=	TERTIARY ARROW
		End

		// --------- With Bow Upgrade  ------------
		ModelConditionState = WEAPONSET_PLAYER_UPGRADE
			Model						=	GUNumnArch_SKN	 ;GUArcher_SKN
			Skeleton					=   GUArcher_SKL
			WeaponLaunchBone			=	PRIMARY ARROW
//			ParticleSysBone				=   FireArowTip arrowFire FollowBone:Yes
//			ParticleSysBone				=   FireArowTip arrowFire FollowBone:Yes
			WeaponLaunchBone			=	TERTIARY ARROW
		End
	
		ModelConditionState = USER_4		// This state is used in cinematics to get the old style armor
			Model							= GUArcher_SKN 
			Skeleton						= GUArcher_SKL ;GUMAArms_SKL ;;GUArcher_SKL ;
			Texture	= GUArcher.tga 0 GuNumnrean.tga ;0 GuNumnrean.tga ;GUManAtArms.tga;
			Texture	= GuNumnrean.tga 0 GuNumnrean.tga ;0 GuNumnrean.tga ;GUManAtArms.tga;
                End

                ModelConditionState = USER_3
	        Model               = GUArcher_SKN ;CineMAArms_SKN
	        Skeleton            = GUArcher_SKL
                Texture           = GUNumnrean.tga 0 GUArcher.tga
                Texture           = GUArcher.tga 0 GUArcher.tga
		End

		//-----------------
		IdleAnimationState
			StateName					=   STATE_Idle
			Animation = IdleA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			//*** Repeat IDLA because animation priorities will not choose same animation twice so it can alternate between first two mostly.
			Animation = IdleA	
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	6
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation = IdleH
				AnimationName			=	GUArcher_IDLH
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleI
				AnimationName			=	GUArcher_IDLI
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			Animation = IdleJ
				AnimationName			=	GUArcher_IDLJ
				AnimationPriority		=	1
				AnimationSpeedFactorRange = 0.7 1.3
				AnimationBlendTime		= 8
			End
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
		End
		
		AnimationState        = THROWN_PROJECTILE
			Animation           = FLYA
				AnimationName     = GUArcher_FLYA
				AnimationMode     = LOOP
			End
		End
		
		AnimationState        = PASSENGER FREEFALL
			Animation           = FLLA
				AnimationName     = GUArcher_FLLA
				AnimationMode     = LOOP
			End
		End

		AnimationState			= FREEFALL
			Animation			= Flying_1
				AnimationName	= GUARCHER_FLYA
				AnimationMode	= LOOP
				AnimationSpeedFactorRange = 0.35 0.35 //Very slow
				AnimationBlendTime		  = 10		//Very slow
			End
		End

		// --- stunned anims
		AnimationState					=	STUNNED_FLAILING 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_FLYA 
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags						=	RANDOMSTART
		End

		AnimationState					= DYING BURNINGDEATH
			Animation
				AnimationName			= GUArcher_DIEA
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
			Animation
				AnimationName			= GUArcher_DIEB
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
			Animation
				AnimationName			= GUArcher_DIED
				AnimationMode			= ONCE
				AnimationBlendTime		= 10
			End
		End
		AnimationState					=	DYING SPLATTED
			Animation					=	Fire
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
            EnteringStateFX = FX_SoldierHitGround
		End

		AnimationState					=	DYING AFLAME
			Animation					=	Fire
				AnimationName			=	GUArcher_MFDA 
				AnimationSpeedFactorRange = 0.9 1.1
			End
		End

		AnimationState					=	DYING
			Animation					=	Die1
				AnimationName			=	GUArcher_DIEA 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
			Animation					=	Die2
				AnimationName			=	GUArcher_DIEB 
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End

		AnimationState						= BURNINGDEATH
			Animation
				AnimationName				= GUArcher_MFDA
				AnimationMode				= LOOP
				Distance					= 50
			End
		End

		AnimationState						= PARALYZED
			Animation
				AnimationName				= GUArcher_IDLA
				AnimationMode				= LOOP
			End
		End

		AnimationState					=	STUNNED_STANDING_UP 
			Animation					=	GTPA
				AnimationName			=	GUArcher_GTPA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.7 1.1
			End
		End

		AnimationState					=	STUNNED 
			Animation					=	StunFlail
				AnimationName			=	GUArcher_LNDA 
				AnimationMode			=	ONCE
			End
            EnteringStateFX = FX_SoldierHitGround
		End

		AnimationState						= EMOTION_UNCONTROLLABLY_AFRAID
			ShareAnimation = Yes
			Animation						= FERA
				AnimationName				= GUArcher_FERA
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERB
				AnimationName				= GUArcher_FERB
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERC
				AnimationName				= GUArcher_FERC
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERD
				AnimationName				= GUArcher_FERD
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Flags							= RANDOMSTART			
		End
		
  		AnimationState					=	FIRING_OR_PREATTACK_B
  			Animation					=	BowPunchWhenClose
  				AnimationName			=	GUArcher_ATKD 
  				AnimationMode			=	ONCE
  				UseWeaponTiming			=	Yes
  			End
 		End

		//---------------------------------------------------
		//New style firing
		AnimationState					=	PREATTACK_A
			StateName					=	STATE_PreFiring
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_A
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.2 1.3		// Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0
			End
			Flags = START_FRAME_FIRST
		End
		
		AnimationState					=	PREATTACK_C
			StateName					=	STATE_PreFiring
			Animation					=	ReadyToDrawn
				AnimationName			=	GUArcher_ATKF1
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_C
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.2 1.3		// Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				AnimationBlendTime		=	0
			End
			Flags = START_FRAME_FIRST
		End
		
		//End New style firing
		//---------------------------------------------------

		AnimationState					=	MOVING WANDER
			ShareAnimation = Yes
			Animation					=	Wander1
				AnimationName			=	GUArcher_WLKA 
			End
			Animation					=	Wander2
				AnimationName			=	GUArcher_WLKB //20
			End
			Flags						=	RANDOMSTART
		End
		
		AnimationState					= MOVING EMOTION_LOOK_TO_SKY
			ShareAnimation = Yes
			Animation					= TerrorFromTheSky
				AnimationName			= GUArcher_RUNC
				AnimationMode			= LOOP
			End
		End

		AnimationState				=	MOVING BACKING_UP
			ShareAnimation = Yes
			Animation				=	BackingUp
				AnimationName		=	GUArcher_BAKA
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
		End
		
		AnimationState					=	ATTACKING MOVING
			ShareAnimation = Yes
			Animation					=	Move2
				AnimationName			=	GUArcher_RUNB
				Distance				=	28
			End
			Flags						=	RANDOMSTART
		End

		AnimationState					=	MOVING
			ShareAnimation = Yes
			Animation					=	Move1
				AnimationName			=	GUArcher_RUNA 
				Distance				=	28
			End
			Flags						=	RANDOMSTART
		End

		AnimationState					= RAISING_FLAG
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRC
				AnimationMode			= Once
				AnimationSpeedFactorRange	= 0.9 1.1
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState					= CONTINUOUS_FIRE_MEAN
			StateName					=	STATE_Coasting
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUArcher_ATKF2
				AnimationMode			=	MANUAL
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Firing" then CurDrawableAllowToContinue() return end
			EndScript
		End
		
		AnimationState						= CONTINUOUS_FIRE_SLOW
			StateName						= STATE_Idle
			Animation						= PutAwayArrow
				AnimationName				= GUArcher_ATKF3
				AnimationMode				= ONCE
			End
		End

//------------ HIT REACTION -----------------------------------------------------

// --------- Click and Hit Reactions ------------	
;		AnimationState = HIT_REACTION
;			Animation = Hit_Level_1_a
;				AnimationName = GUArcher_HITA
;				AnimationMode = ONCE
;			End
;		End

//------------ EMOTIONS ---------------------------------------------------------

//======= AFRAID

		AnimationState						= EMOTION_AFRAID
			ShareAnimation = Yes
			Animation						= FERA
				AnimationName				= GUArcher_FERA
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERB
				AnimationName				= GUArcher_FERB
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERC
				AnimationName				= GUArcher_FERC
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Animation						= FERD
				AnimationName				= GUArcher_FERD
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	=	0.7 1.3								
			End
			Flags							= RANDOMSTART			
		End
		
//======= CELEBRATING
		
		AnimationState					= EMOTION_CELEBRATING
			Animation					= CHRB
				AnimationName			= GUArcher_CHRB
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= SLTA
				AnimationName			= GUArcher_SLTA
				AnimationMode			= Once
				AnimationBlendTime		= 15
				AnimationPriority		= 2
			End
			Animation					= CHRA
				AnimationName			= GUArcher_CHRA
				AnimationMode			= Once
				AnimationBlendTime		= 15		
				AnimationPriority		= 1//Use least often of cheers (Eugene)
			End
			Flags						=	RESTART_ANIM_WHEN_COMPLETE
		End

//======== TAUNTING

		AnimationState					= EMOTION_TAUNTING
			Animation					= Taunting2
				AnimationName			= GUArcher_IDLE
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting3
				AnimationName			= GUArcher_IDLF
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Animation					= Taunting4
				AnimationName			= GUArcher_IDLG
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End

			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End

//======== POINTING

		AnimationState						= EMOTION_POINTING
			ShareAnimation					= Yes
			Animation						= pointing
				AnimationName				= GUArcher_PNTA
				AnimationPriority			= 2
				AnimationSpeedFactorRange	= 0.9 1.1
				AnimationMode				= LOOP
			End
		End
		
//======= ALERT

		AnimationState					= EMOTION_ALERT
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Ready
				AnimationName			= GUArcher_IDLA
				AnimationMode			= LOOP
				AnimationPriority		= 3
				AnimationBlendTime		= 15
			End
			Animation					= Point
				AnimationName			= GUArcher_PNTA
				AnimationMode			= LOOP
				AnimationPriority		= 1
				AnimationBlendTime		= 15
			End
		End
			
//----------------- SELECTED --------------------------------------------
		AnimationState					=	SELECTED
			ShareAnimation = Yes
			StateName					=	STATE_Selected
			Animation					=	ATNB
				AnimationName			=	GUArcher_ATNB
				AnimationMode			=	LOOP
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					=	IDLA
				AnimationName			=	GUArcher_IDLA 
				AnimationPriority		=	10
				AnimationSpeedFactorRange = 0.7 1.3
			End

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle" 
				then 
					CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected")
				end
				if CurDrawableModelcondition("ATTACKING")
				then
					return "IDLA"
				else
					return "ATNB"
				end
			EndScript
		End

//----------------- Transitions ------------------------------------------------------

		TransitionState	= TRANS_Idle_to_Selected
			Animation	= ATNA
				AnimationName			  =	GUArcher_ATNA
				AnimationMode			  =	ONCE
				AnimationSpeedFactorRange =	0.8	1.2
				AnimationPriority		  =	8
			End
			Animation					=	SLTA
				AnimationName			  =	GUArcher_SLTA
				AnimationMode			  =	ONCE
				AnimationSpeedFactorRange =	1.0	1.5
				AnimationPriority		  =	1
			End
		End
		TransitionState					=	TRANS_Selected_To_Idle
			Animation					=	ATNC
				AnimationName			=	GUArcher_ATNC
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.5 2.0
			End
		End
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades		
		AttributeModifier		= SecondAgeBonusArcher
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		AttributeModifier		= ThirdAgeBonusArcher
	End
End

AddModule 
	Behavior = SubObjectsUpgrade Armor_Upgrade777
		TriggeredBy		= Upgrade_MenFaction
		UpgradeTexture	= GUArcher.tga 0 GUNumnrean.tga ;GUManAtArms.tga;
		;RecolorHouse	= Yes
                ;OkToChangeModelColor = No
		ExcludeSubobjects = Forged_Blade
	End
End


AddModule 
	Behavior = SubObjectsUpgrade Armor_Upgrade77766
		TriggeredBy		= Upgrade_TechnologyElvenForgedBlades
		UpgradeTexture	= GUArcher.tga 0 GuNumnrean.tga ;0 GuNumnrean.tga ;GUManAtArms.tga;
		UpgradeTexture	= GuNumnrean.tga 0 GuNumnrean.tga  ;GUManAtArms.tga;
		;RecolorHouse	= Yes
                ;OkToChangeModelColor = No
		ExcludeSubobjects = Forged_Blade
	End
End

AddModule 
	Behavior = SubObjectsUpgrade Armor_Upgrade7776
		TriggeredBy		= Upgrade_TechnologyElvenHeavyArmor
		UpgradeTexture	= GUNumnrean.tga 0 GUArcher.tga ;GUManAtArms.tga;
		UpgradeTexture	= GUArcher.tga 0 GUArcher.tga ;GUManAtArms.tga;
		;RecolorHouse	= Yes
                ;OkToChangeModelColor = No
		ExcludeSubobjects = Forged_Blade
	End
End

AddModule
	Behavior = ModelConditionUpgrade ModuleTag_EliteSoldiers
		TriggeredBy		= Upgrade_TechnologyElvenHeavyArmor
		AddConditionFlags	= USER_3
		Permanent		= Yes
	End
End

AddModule 
	Behavior = ModelConditionUpgrade ModuleTag_SuperSoldiers2
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades		
		AddConditionFlags	= USER_4
		Permanent			= Yes
	End
End
End

Object GondorArcherHorde
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades		
		AttributeModifier		= SecondAgeBonusArcher
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		AttributeModifier		= ThirdAgeBonusArcher
	End
End
;AddModule
	;Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567
		;TriggeredBy			= Upgrade_GondorForgedBlades; Upgrade_GondorHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		;CommandSet			= SuperNewNewNewGondorArcherHordeCommandSet
	;End 
;End
AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedFA
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades
		AttributeModifier		= SuperArcherMen
		;RefreshDelay		= 2000	; 2 secs
	End
      End
CommandSet = NewGondorArcherHordeCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewGondorArcherHordeCommandSet
	End 
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_TirdAgeUp
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewNewGondorArcherHordeCommandSet
	End 
End
End

Object GondorTowerShieldGuard
RemoveModule ModuleTag_01
AddModule
	Draw = W3DHordeModelDraw ModuleTag_013
		OkToChangeModelColor = Yes

		StaticModelLODMode = Yes
		
		// specify options for static LODs
		LodOptions	= LOW
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_LOW
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_LOW
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_LOW
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_LOW
		End
		
		LodOptions	= MEDIUM
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_MED
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_MED
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_MED
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_MED
		End
		
		LodOptions	= HIGH
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_HIGH
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_HIGH
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_HIGH
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_HIGH
		End

		DefaultModelConditionState
			Model               = GUTwrGrd_SKN ;GUTowerGrd_SKN
			Skeleton            = GUTwrGrd_SKL ;GUTowerGrd_SKL
		End

		ModelConditionState		= ALTERNATE_FORMATION
			Model				= GUTowerGrd_SKN 
			Skeleton            = GUTowerGrd_SKL ;GUTowerGrd_SKL
		End

		ModelConditionState WEAPONSET_PLAYER_UPGRADE
			Model               = GUTowerGrd_SKN
			Skeleton            = GUTowerGrd_SKL
		End
		
AnimationState							= PASSENGER FREEFALL ALTERNATE_FORMATION
			Animation							= Grabbed
				AnimationName					= GUoTwerGrd_FLLA
				AnimationMode					= LOOP
			End
		End
		
		AnimationState							= FREEFALL ALTERNATE_FORMATION
			Animation							= Falling
				AnimationName					= GUTowerGrd_FLYA
				AnimationMode					= LOOP
				AnimationBlendTime				= 10
			End
		End

		
		AnimationState						= PARALYZED ALTERNATE_FORMATION
			Animation
				AnimationName				= GUTowerGrd_IDLA
				AnimationMode				= LOOP
			End
		End

		AnimationState				= DYING BURNINGDEATH ALTERNATE_FORMATION
			Animation				= DIEA
				AnimationName     	= GUTowerGrd_DIEA
				AnimationMode     	= ONCE
				AnimationBlendTime	= 10
			End
			Animation				= DIEA 
				AnimationName     	= GUTowerGrd_DIEB
				AnimationMode     	= ONCE
				AnimationBlendTime	= 10
			End
			Animation				= DIEA 
				AnimationName     	= GUTowerGrd_DIEC
				AnimationMode     	= ONCE
				AnimationBlendTime	= 10
			End
		End

		AnimationState        = DYING SPLATTED ALTERNATE_FORMATION
			Animation           = LNDA
				AnimationName     = GUTowerGrd_LNDA
				AnimationMode     = ONCE
			End
		End
		
		AnimationState        = DYING ALTERNATE_FORMATION
			Animation           = DIEA
				AnimationName     = GUTowerGrd_DIEA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation           = DIEA
				AnimationName     = GUTowerGrd_DIEB
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation           = DIEA
				AnimationName     = GUTowerGrd_DIEC
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
		End
		

		AnimationState						= BURNINGDEATH ALTERNATE_FORMATION
			Animation
				AnimationName				= GUTowerGrd_MFDA
				AnimationMode				= LOOP
				Distance					= 60
			End
		End
		
		
		AnimationState        = MOVING FIRING_OR_PREATTACK_A ALTERNATE_FORMATION
			ShareAnimation		= Yes
			Animation           = RunAndFire
				AnimationName       = GUTowerGrd_ATRA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART  
		End

//=======TERROR
		AnimationState					= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY ALTERNATE_FORMATION
			ShareAnimation				= Yes
			Animation					= TerrorFromTheSky
				AnimationName			= GUTowerGrd_RUNE
				AnimationMode			= LOOP
			End
		End
		AnimationState					= MOVING EMOTION_TERROR ALTERNATE_FORMATION
			ShareAnimation				= Yes
			Animation					= Terror
				AnimationName			= GUTowerGrd_RUNE
				AnimationMode			= LOOP
			End
		End
//----------------
//=======BACK UP
		AnimationState				=	MOVING BACKING_UP ALTERNATE_FORMATION
			ShareAnimation = Yes
			Animation				=	BackingUp
				AnimationName		=	GUTowerGrd_BAKA
				AnimationMode		=	LOOP
			End
			Animation				=	BackingUp
				AnimationName		=	GUTowerGrd_BAKB 
				AnimationMode		=	LOOP
			End			
			Flags					=	RANDOMSTART 
		End
//--------------------
		

		AnimationState        = MOVING ALTERNATE_FORMATION
			ShareAnimation = Yes
			Animation           = RUNA
				AnimationName     = GUTowerGrd_RUNA
				AnimationMode     = LOOP
			End
			Animation
				AnimationName     = GUTowerGrd_RUNA ;GUTowerGrd_RUNB
				AnimationMode     = LOOP
			End
			Flags               = RANDOMSTART
			//ParticleSysBone     = None InfantryDustTrails
		End

		AnimationState        =  FIRING_OR_PREATTACK_A ALTERNATE_FORMATION
			Animation           = ATKA
				AnimationName     = GUTowerGrd_ATKA
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			Animation           = ATKA
				AnimationName     = GUTowerGrd_ATKB
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			//ParticleSysBone     = None MeleeDust
		End


		AnimationState        = STUNNED_FLAILING ALTERNATE_FORMATION
			Animation           = FLYA
				AnimationName     = GUTowerGrd_FLYA
				AnimationMode     = LOOP
			End
			Flags               = RANDOMSTART
		End

		AnimationState        = STUNNED_STANDING_UP ALTERNATE_FORMATION
			Animation           = GTPA
				AnimationName     = GUTowerGrd_GTPA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		AnimationState        = STUNNED ALTERNATE_FORMATION
			Animation           = LNDA
				AnimationName     = GUTowerGrd_LNDA
				AnimationMode     = ONCE
			End
		End

		TransitionState       = TRANS_Plant ALTERNATE_FORMATION
			Animation           = PLTA
				AnimationName     = GUTowreGrd_PLTA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
		End

		TransitionState       = TRANS_Unplant ALTERNATE_FORMATION
			Animation           = PLTB
				AnimationName     = GUTowerGrd_PLTC
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.5 1.2
			End
		End
//------------------ Hit Reaction ---------------------------------------
		AnimationState						= HIT_REACTION ALTERNATE_FORMATION
			Animation						= HIT REACTION
				AnimationName				= GUTowerGrd_HITA
				AnimationMode				= ONCE
			End
		End
//------------------ EMOTIONS -------------------------------------------
//======= APPREHENSIVE
		AnimationState					= EMOTION_ALERT EMOTION_AFRAID ALTERNATE_FORMATION
			ShareAnimation				= Yes
			Animation					= Apprehensive
				AnimationName			= GUTowerGrd_FERA
				AnimationMode			= LOOP	//Change this to ONCE if adding additional anims
			End
			Flags						= RANDOMSTART
		End

//======= AFRAID

		AnimationState					= EMOTION_AFRAID ALTERNATE_FORMATION
			ShareAnimation				= Yes
			Animation					= FERA
				AnimationName			= GUTowerGrd_FERA
				AnimationMode			= LOOP
			End
			Flags						= RANDOMSTART
		End

//======= TAUNTING
		AnimationState					= EMOTION_TAUNTING ALTERNATE_FORMATION
			Animation					= Taunting
				AnimationName			= GUTowerGrd_TNTA
				AnimationMode			= ONCE
			End
			Animation					= Taunting2
				AnimationName			= GUTowerGrd_TNTB
				AnimationMode			= ONCE
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End

//======= POINTING

		AnimationState					= EMOTION_POINTING ALTERNATE_FORMATION
			Animation					= Pointing1
				AnimationName			= GUTowerGrd_PNTA
				AnimationMode			= LOOP
			End
			Animation					= Pointing1
				AnimationName			= GUTowerGrd_PNTB
				AnimationMode			= LOOP
			End
			Flags						= RANDOMSTART
		End

//======= CELEBRATING

		AnimationState					= EMOTION_CELEBRATING ALTERNATE_FORMATION
			Animation					= CHRA
				AnimationName			= GUTowerGrd_CHRA
				AnimationMode			= LOOP
			End
			Animation					= CHRA
				AnimationName			= GUTowerGrd_CHRB
				AnimationMode			= LOOP
			End
			Animation					= CHRA
				AnimationName			= GUTowerGrd_CHRC
				AnimationMode			= LOOP
			End
		End
//-------------- ALERT STATE ------------------------------------------------------------

		AnimationState					= EMOTION_ALERT ALTERNATE_FORMATION
			Animation					= CHRA
				AnimationName			= GUTowerGrd_IDLA
				AnimationMode			= LOOP
			End
		End
		
//-------------- SELECTED & IDLE --------------------------------------------------------
//======== SELECTED


		AnimationState					= RAISING_FLAG ALTERNATE_FORMATION
			Animation					= CHRA
				AnimationName			= GUTowerGrd_CHRA
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= CHRA
				AnimationName			= GUTowerGrd_CHRB
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= CHRA
				AnimationName			= GUTowerGrd_CHRC
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End
		
		AnimationState					= SELECTED ALTERNATE_FORMATION
			StateName					= STATE_Selected
			
			ShareAnimation				= Yes
			Animation					= ATNB
				AnimationName			= GUTowerGrd_ATNB
				AnimationMode			= LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
			EndScript
		End

//======== IDLE

		IdleAnimationState
			StateName					= STATE_Idle ALTERNATE_FORMATION
			Animation					= IDLB ALTERNATE_FORMATION
				AnimationName			= GUTowerGrd_IDLB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation					= IDLC ALTERNATE_FORMATION
				AnimationName			= GUTowerGrd_IDLC
				AnimationMode			= ONCE
				AnimationBlendTime		= 9
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation					= IDLD ALTERNATE_FORMATION
				AnimationName			= GUTowerGrd_IDLD
				AnimationMode			= ONCE
				AnimationBlendTime		= 9
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation					= IDLE ALTERNATE_FORMATION
				AnimationName			= GUTowerGrd_IDLE
				AnimationMode			= ONCE
				AnimationBlendTime		= 9
				AnimationSpeedFactorRange = 0.8 1.2
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
			EndScript
		End

;-----------------------------aggiu8nte 

		AnimationState        = MOVING ALTERNATE_FORMATION
			//ShareAnimation = Yes
			StateName			= STATE_EnrouteToPorcupine
			Animation
				AnimationName     = GUTowerGrd_RUNA
				AnimationMode     = LOOP
			End
			Animation
				AnimationName     = GUTowerGrd_RUNB
				AnimationMode     = LOOP
			End
			Flags               = RANDOMSTART
			//ParticleSysBone     = None InfantryDustTrails
		End
		AnimationState					= SELECTED ALTERNATE_FORMATION
			//ShareAnimation				= Yes
			StateName					= STATE_SelectedAlternateFormation
			Animation
				AnimationName			= GUTowerGrd_ATNB
				AnimationMode			= LOOP
			End
		End
		AnimationState					= EMOTION_TAUNTING ALTERNATE_FORMATION
			Animation					= TNTA
				AnimationName			= GUTowerGrd_TNTA
				AnimationMode			= LOOP
			End
			Animation					= TNTA
				AnimationName			= GUTowerGrd_TNTB
				AnimationMode			= LOOP
			End
		End
		AnimationState					= SELECTED ALTERNATE_FORMATION PORCUPINE
			//ShareAnimation				= Yes
			StateName					= STATE_SelectedAlternateFormation
			Animation
				AnimationName			= GUTowerGrd_PLTB
				AnimationMode			= LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
			EndScript
		End
		AnimationState					= ALTERNATE_FORMATION PORCUPINE	//	aka Porcupine formation
			StateName					= STATE_Planted
			
			//ShareAnimation				= Yes
			Animation					= IDLB
				AnimationName			= GUTowerGrd_PLTB
				AnimationMode			= LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
			EndScript
		End

;------------------------------------------------------------------------------------
;------------------------------------------------------------------------------------------
;---------------------------------------------------------------------------------------
;L'altro
;-----------------------------------------------

		AnimationState							= PASSENGER FREEFALL
			Animation							= Grabbed
				AnimationName					= GUTwrGrd_FLLA
				AnimationMode					= LOOP
			End
		End
		
		AnimationState							= FREEFALL
			Animation							= Falling
				AnimationName					= GUTwrGrd_FLYA
				AnimationMode					= LOOP
				AnimationBlendTime				= 10
			End
		End

		
		AnimationState						= PARALYZED
			Animation
				AnimationName				= GUTwrGrd_IDLA
				AnimationMode				= LOOP
			End
		End

		AnimationState				= DYING BURNINGDEATH
			Animation				= DIEA
				AnimationName     	= GUTwrGrd_DIEA
				AnimationMode     	= ONCE
				AnimationBlendTime	= 10
			End
			Animation				= DIEA
				AnimationName     	= GUTwrGrd_DIEB
				AnimationMode     	= ONCE
				AnimationBlendTime	= 10
			End
			Animation				= DIEA
				AnimationName     	= GUTwrGrd_DIEC
				AnimationMode     	= ONCE
				AnimationBlendTime	= 10
			End
		End

		AnimationState        = DYING SPLATTED
			Animation           = LNDA
				AnimationName     = GUTwrGrd_LNDA
				AnimationMode     = ONCE
			End
		End
		
		AnimationState        = DYING
			Animation           = DIEA
				AnimationName     = GUTwrGrd_DIEA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation           = DIEA
				AnimationName     = GUTwrGrd_DIEB
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation           = DIEA
				AnimationName     = GUTwrGrd_DIEC
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
		End
		

		AnimationState						= BURNINGDEATH
			Animation
				AnimationName				= GUTwrGrd_MFDA
				AnimationMode				= LOOP
				Distance					= 60
			End
		End
		
		
		AnimationState        = MOVING FIRING_OR_PREATTACK_A
			ShareAnimation		= Yes
			Animation           = RunAndFire
				AnimationName       = GUTwrGrd_ATRA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART  
		End

//=======TERROR
		AnimationState					= ALTERNATE_FORMATION MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY ALTERNATE_FORMATION
			ShareAnimation				= Yes
			Animation					= TerrorFromTheSky
				AnimationName			= GUTowerGrd_RUNE
				AnimationMode			= LOOP
			End
		End
		AnimationState					= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
			ShareAnimation				= Yes
			Animation					= TerrorFromTheSky
				AnimationName			= GUTwrGrd_RUNE
				AnimationMode			= LOOP
			End
		End
		AnimationState					= MOVING EMOTION_TERROR
			ShareAnimation				= Yes
			Animation					= Terror
				AnimationName			= GUTwrGrd_RUNE
				AnimationMode			= LOOP
			End
		End
//----------------
//=======BACK UP
		AnimationState				=	MOVING BACKING_UP
			ShareAnimation = Yes
			Animation				=	BackingUp
				AnimationName		=	GUTwrGrd_BAKA
				AnimationMode		=	LOOP
			End
			Animation				=	BackingUp
				AnimationName		=	GUTwrGrd_BAKB
				AnimationMode		=	LOOP
			End			
			Flags					=	RANDOMSTART 
		End
//--------------------
		

		AnimationState        = ALTERNATE_FORMATION MOVING
			ShareAnimation = Yes
			Animation           = RUNA
				AnimationName     = GUTowerGrd_RUNA
				AnimationMode     = LOOP
			End
			;Animation
				;AnimationName     = GUTowerGrd_RUNB
				;AnimationMode     = LOOP
			;End
			Flags               = RANDOMSTART
			//ParticleSysBone     = None InfantryDustTrails
		End
		AnimationState        = MOVING
			ShareAnimation = Yes
			Animation           = RUNA
				AnimationName     = GUTwrGrd_RUNA
				AnimationMode     = LOOP
			End
			;Animation
				;AnimationName     = GUTwrGrd_RUNB
				;AnimationMode     = LOOP
			;End
			Flags               = RANDOMSTART
			//ParticleSysBone     = None InfantryDustTrails
		End

		AnimationState        =  FIRING_OR_PREATTACK_A
			Animation           = ATKA
				AnimationName     = GUTwrGrd_ATKA
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			Animation           = ATKA
				AnimationName     = GUTwrGrd_ATKB
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
			End
			//ParticleSysBone     = None MeleeDust
		End


		AnimationState        = STUNNED_FLAILING
			Animation           = FLYA
				AnimationName     = GUTwrGrd_FLYA
				AnimationMode     = LOOP
			End
			Flags               = RANDOMSTART
		End

		AnimationState        = STUNNED_STANDING_UP
			Animation           = GTPA
				AnimationName     = GUTwrGrd_GTPA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		AnimationState        = STUNNED
			Animation           = LNDA
				AnimationName     = GUTwrGrd_LNDA
				AnimationMode     = ONCE
			End
		End

		TransitionState       = TRANS_Plant
			Animation           = PLTA
				AnimationName     = GUTwrGrd_PLTA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
		End

		TransitionState       = TRANS_Unplant
			Animation           = PLTB
				AnimationName     = GUTwrGrd_PLTC
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.5 1.2
			End
		End
//------------------ Hit Reaction ---------------------------------------
		AnimationState						= HIT_REACTION
			Animation						= HIT REACTION
				AnimationName				= GUTwrGrd_HITA
				AnimationMode				= ONCE
			End
		End
//------------------ EMOTIONS -------------------------------------------
//======= APPREHENSIVE
		AnimationState					= EMOTION_ALERT EMOTION_AFRAID
			ShareAnimation				= Yes
			Animation					= Apprehensive
				AnimationName			= GUTwrGrd_FERA
				AnimationMode			= LOOP	//Change this to ONCE if adding additional anims
			End
			Flags						= RANDOMSTART
		End

//======= AFRAID

		AnimationState					= EMOTION_AFRAID
			ShareAnimation				= Yes
			Animation					= FERA
				AnimationName			= GUTwrGrd_FERA
				AnimationMode			= LOOP
			End
			Flags						= RANDOMSTART
		End

//======= TAUNTING
		AnimationState					= EMOTION_TAUNTING
			Animation					= Taunting
				AnimationName			= GUTwrGrd_TNTA
				AnimationMode			= ONCE
			End
			Animation					= Taunting2
				AnimationName			= GUTwrGrd_TNTB
				AnimationMode			= ONCE
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End

//======= POINTING

		AnimationState					= EMOTION_POINTING
			Animation					= Pointing1
				AnimationName			= GUTwrGrd_PNTA
				AnimationMode			= LOOP
			End
			Animation					= Pointing1
				AnimationName			= GUTwrGrd_PNTB
				AnimationMode			= LOOP
			End
			Flags						= RANDOMSTART
		End

//======= CELEBRATING

		AnimationState					= EMOTION_CELEBRATING
			Animation					= CHRA
				AnimationName			= GUTwrGrd_CHRA
				AnimationMode			= LOOP
			End
			Animation					= CHRA
				AnimationName			= GUTwrGrd_CHRB
				AnimationMode			= LOOP
			End
			Animation					= CHRA
				AnimationName			= GUTwrGrd_CHRC
				AnimationMode			= LOOP
			End
		End
//-------------- ALERT STATE ------------------------------------------------------------

		AnimationState					= EMOTION_ALERT
			Animation					= CHRA
				AnimationName			= GUTwrGrd_IDLA
				AnimationMode			= LOOP
			End
		End
		
//-------------- SELECTED & IDLE --------------------------------------------------------
//======== SELECTED


		AnimationState					= RAISING_FLAG
			Animation					= CHRA
				AnimationName			= GUTwrGrd_CHRA
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= CHRA
				AnimationName			= GUTwrGrd_CHRB
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= CHRA
				AnimationName			= GUTwrGrd_CHRC
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End
		
		AnimationState					= SELECTED
			StateName					= STATE_Selected
			
			ShareAnimation				= Yes
			Animation					= ATNB
				AnimationName			= GUTwrGrd_ATNB
				AnimationMode			= LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
			EndScript
		End

//======== IDLE

		IdleAnimationState
			StateName					= STATE_Idle
			Animation					= IDLB
				AnimationName			= GUTowerGrd_IDLB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation					= IDLC
				AnimationName			= GUTwrGrd_IDLC
				AnimationMode			= ONCE
				AnimationBlendTime		= 9
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation					= IDLD
				AnimationName			= GUTowerGrd_IDLD
				AnimationMode			= ONCE
				AnimationBlendTime		= 9
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Animation					= IDLE
				AnimationName			= GUTwrGrd_IDLE
				AnimationMode			= ONCE
				AnimationBlendTime		= 9
				AnimationSpeedFactorRange = 0.8 1.2
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
			EndScript
		End

		
//-------------------------------------------------------------------------------------------------------------
	End

End
	ArmorSet
		Conditions		= ALTERNATE_FORMATION
		Armor			= TowerGuardSpecialArmor
		DamageFX		= NormalDamageFX
	End
	ArmorSet
		Conditions		= ALTERNATE_FORMATION PLAYER_UPGRADE
		Armor			= TowerGuardSpecialArmorHA
		DamageFX		= NormalDamageFX
	End
End
Object GondorTowerShieldGuardHorde
CommandSet = NewGondorTowerShieldGuardCommandSet
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee78
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf786
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperSword
	End
      End

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee486
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf467
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End

AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End
AddModule
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality00
		TriggeredBy = Upgrade_GondorForgedBlades
	End
End
	AddModule
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality20
		TriggeredBy = Upgrade_GondorHeavyArmor
	End
End
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain1
		FrontAngle 		= 180
		FlankedDelay 		= 4000
		ObjectStatusOfContained = 
		InitialPayload 		= GondorTowerShieldGuard GOOD_MEN_GIANT_HORDE_SIZE
		Slots 			= 15
		PassengerFilter		= NONE +INFANTRY
		ShowPips 		= No
		ThisFormationIsTheMainFormation = Yes	//Used to determine which armorset to use (and anything else we want!)
		RandomOffset		= X:0 Y:0
		MeleeBehavior = Amoeba
			FacingBonus	= 30.0
			AngleLimitCos	= -0.17
			InnerRange	= 30
			OuterRange	= 80
			OuterRangeBuildings	= 140
		End

		// Banner Carrier info		
		BannerCarriersAllowed	= GondorInfantryBanner										// types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:GondorFighter	Pos:X:70.0 Y:0.0		// (DEFAULT) position of banner carrier
		
		RankInfo = RankNumber:1 UnitType:GondorTowerShieldGuard Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:GondorTowerShieldGuard Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:GondorTowerShieldGuard Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		
		RanksToReleaseWhenAttacking = 1 

		AlternateFormation = GondorTowerShieldGuardHordePorcupine
		;AlternateFormation = GondorTowerShieldGuardHordeFormation
		MeleeAttackLeashDistance = 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		 = 1	//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		 = 3000	//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		 = 1	//The minimum number of	cells to backup
		BackUpMaxDistance		 = 3	//The maximum number of	cells to backup
		BackupPercentage		 = 80%	//The amount of	chance that	a unit will	back up.
	End
End 
AddModule
	Behavior = CommandSetUpgrade ModueTag_Thirdageup
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewGondorTowerShieldGuardCommandSet2Shield
	End 
End
;AddModule
	;Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper
                ;AttributeModifier = TwrModifier
		;BonusName		= TwrModifier
		;WeaponSetFlags			= WEAPONSET_TOGGLE_1
		;WeaponToggleCommandSet	= NewGondorTowerShieldGuardCommandSet2Pike
	;End
;End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp45674e
		TriggeredBy			= Upgrade_GondorForgedBlades Upgrade_TechnologyElvenHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= SuperNewGondorTowerShieldGuardCommandSet2Shield
	End 
End
End

ChildObject GondorTowerShieldGuardHordePorcupine GondorTowerShieldGuardHorde
CommandSet = NewGondorTowerShieldGuardCommandSet2Shield
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain1
		FrontAngle 		= 180
		FlankedDelay 		= 4000
		ObjectStatusOfContained = 
		InitialPayload 		= GondorTowerShieldGuard GOOD_MEN_GIANT_HORDE_SIZE
		Slots 			= 15
		PassengerFilter		= NONE +INFANTRY
		ShowPips 		= No
		ThisFormationIsTheMainFormation = No
                ;AttributeModifiers = TwrModifier	//Used to determine which armorset to use (and anything else we want!)
		RandomOffset		= X:0 Y:0
		MeleeBehavior = Amoeba
			FacingBonus	= 30.0
			AngleLimitCos	= -0.17
			InnerRange	= 30
			OuterRange	= 80
			OuterRangeBuildings	= 140
		End
		
		// Banner Carrier info		
		BannerCarriersAllowed	= GondorInfantryBanner										// types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:GondorFighter	Pos:X:70.0 Y:0.0		// (DEFAULT) position of banner carrier
		
		RankInfo = RankNumber:1 UnitType:GondorTowerShieldGuard Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:GondorTowerShieldGuard Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:GondorTowerShieldGuard Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		
		RanksToReleaseWhenAttacking = 1 

		;AlternateFormation = GondorTowerShieldGuardHordePorcupine
		AlternateFormation = GondorTowerShieldGuardHorde
		MeleeAttackLeashDistance = 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		 = 1	//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		 = 3000	//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		 = 1	//The minimum number of	cells to backup
		BackUpMaxDistance		 = 3	//The maximum number of	cells to backup
		BackupPercentage		 = 80%	//The amount of	chance that	a unit will	back up.
	End
End 
End

Object GondorCavalry
ReplaceModule ModuleTag_01
Draw = W3DHordeModelDraw ModuleTag_011
		OkToChangeModelColor = Yes

		WadingParticleSys = EntRipples

		StaticModelLODMode = Yes
		
		; specify options for static LODs
		LodOptions	= LOW
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_LOW
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_LOW
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_LOW
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_LOW
		End
		
		LodOptions	= MEDIUM
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_MED
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_MED
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_MED
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_MED
		End
		
		LodOptions	= HIGH
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_HIGH
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_HIGH
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_HIGH
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_HIGH
		End

		;Removed non-armored horse textures
		;--------------------------------------------------
		RandomTexture = CUHorse_WtBkA.tga	0 CUHorse_WtBkA.tga
		RandomTexture = CUHorse_BnA.tga		0 CUHorse_WtBkA.tga
		RandomTexture = CUHorse_BnWtA.tga	0 CUHorse_WtBkA.tga
		RandomTexture = CUHorse_WtA.tga		0 CUHorse_WtBkA.tga; only heros have white horses
		RandomTexture = CUHorse_WtBkA.tga	0 CUHorse_WtBkA.tga

		DefaultModelConditionState
			Model               = GUCavalry_SKN
			Skeleton			= GUCavalry_SKL
		End

		ModelConditionState WEAPONSET_PLAYER_UPGRADE
			Model               = GUCavalry_SKN
			Skeleton			= GUCavalry_SKL
		End
		
		IdleAnimationState
			StateName				= Idle
			Animation				= IdleA
				AnimationName       = GUCavalry_IDLA
				AnimationPriority   = 20
				AnimationMode       = ONCE
				AnimationBlendTime  = 15
			End
			Animation           = IdleB
				AnimationName       = GUCavalry_IDLB
				AnimationMode       = ONCE
				AnimationBlendTime  = 15
			End
			Animation           = IdleC
				AnimationName       = GUCavalry_IDLC
				AnimationMode       = ONCE
				AnimationBlendTime  = 15
			End
			Animation           = IdleD
				AnimationName       = GUCavalry_IDLD
				AnimationMode       = ONCE
				AnimationBlendTime  = 15
			End
			Animation           = IdleE
				AnimationName       = GUCavalry_IDLE
				AnimationMode       = ONCE
				AnimationBlendTime  = 15
			End
			Animation           = IdleG
				AnimationName       = GUCavalry_IDLG
				AnimationMode       = ONCE
				AnimationBlendTime  = 15
			End
			Flags						= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
			EndScript
		End
		
		AnimationState        = PASSENGER
			Animation           = grabbed
				AnimationName       = GUCavalry_GBDA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART
		End
		
		; --- stunned anims
		AnimationState        = FREEFALL
			Animation           = freefall
				AnimationName       = GUCavalry_FLYB
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART
		End
		
		AnimationState        = STUNNED_FLAILING 
			Animation           = JustDie
				AnimationName       = GUCavalry_FLYB
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART
		End

		AnimationState				= DYING BURNINGDEATH
			Animation
				AnimationName		= GUCavalry_DIEA
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
			End
			Animation
				AnimationName		= GUCavalry_DIEC
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
			End
			Animation
				AnimationName		= GUCavalry_DIEE
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
			End
		End
		
		AnimationState				=	DYING SPLATTED
			Animation				=	splatted
				AnimationName		=	GUCavalry_LNDA
				AnimationMode		=	ONCE
			End
		End
		
		AnimationState				= DYING     ; DEATH_2 Normally has DEATH_2, but just as a backup don't insist
			Animation				
				AnimationName       = GUCavalry_DIEA
				AnimationMode       = ONCE
			End
			Animation				
				AnimationName		= GUCavalry_DIEC 
				AnimationMode		= ONCE
			End
			Animation				
				AnimationName		= GUCavalry_DIEE
				AnimationMode		= ONCE
			End
		End
		
		AnimationState        = STUNNED_STANDING_UP
			Animation           = StandUp
				AnimationName       = GUCavalry_GTPA
				AnimationMode       = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		AnimationState        = STUNNED 
			Animation           = Land
				AnimationName       = GUCavalry_LNDA
				AnimationMode       = ONCE
			End
		End


		AnimationState						= BURNINGDEATH
			Animation
				AnimationName				= GUCavalry_MFDA
				AnimationMode				= LOOP
				Distance					= 100
			End
		End

		AnimationState						= PARALYZED
			Animation
				AnimationName				= GUCavalry_IDLA
				AnimationMode				= LOOP
			End
		End

		
		
				; This is the no-spawn-horse type of death
		

		

		AnimationState				=	TURN_LEFT_HIGH_SPEED
			Animation				=	TurnLeft
				AnimationName		=	GUCavalry_TNL1
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange= .8 .8
				AnimationBlendTime	=	20
			End
		End
		
		AnimationState        = MOVING FIRING_OR_PREATTACK_A
			ShareAnimation		= Yes
			Animation           = TrotAndFire
				AnimationName       = GUCavalry_ATRA
				AnimationMode       = LOOP
				Distance			= 70; 35
			End
			Flags               = RANDOMSTART
		End

		AnimationState				=	TURN_RIGHT_HIGH_SPEED
			Animation				=	TurnLeft
				AnimationName		=	GUCavalry_TNR1
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange= .8 .8
				AnimationBlendTime	=	20
			End
		End
		
;;======= TERROR
		AnimationState				= MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
			Animation				= RUNB
				AnimationName		= GUCavalry_RUNB
				AnimationMode		= LOOP
			End
		End
		AnimationState				= MOVING EMOTION_TERROR
			Animation				= RUNB
				AnimationName		= GUCavalry_RUNB
				AnimationMode		= LOOP
			End
			Animation				= RUNC
				AnimationName		= GUCavalry_RUNC
				AnimationMode		= LOOP
			End
			Animation				= RUND
				AnimationName		= GUCavalry_RUND
				AnimationMode		= LOOP
			End
		End
;;===== BACKUP
		AnimationState				=	MOVING BACKING_UP
			Animation				=	BackingUp
				AnimationName		=	GUCavalry_BAKA
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
		End
	
		AnimationState        = MOVING TURN_LEFT 
			Animation				=	TurnLeft
				AnimationName		=	GUCavalry_TRNL
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange= .8 .8
;				AnimationBlendTime	=	20
			End
		End

		AnimationState        = MOVING TURN_RIGHT 
			Animation				=	TurnLeft
				AnimationName		=	GUCavalry_TRNR
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange= .8 .8
;				AnimationBlendTime	=	20
			End
		End
	
;		AnimationState        = MOVING WALKING
;			Animation           = Walk1
;				AnimationName       = GUCavalry_WLKA
;				AnimationMode       = LOOP
;				Distance			= 28
;			End
;		End
	
		AnimationState			= MOVING ACCELERATE
			Animation           = Accelerate
				AnimationName   = GUCavalry_ACCL
				AnimationMode   = ONCE ; was LOOP
			End
		End

		AnimationState			= DECELERATE
			Animation           = Decelerate
				AnimationName   = GUCavalry_DECL
				AnimationMode   = ONCE
				AnimationSpeedFactorRange = 0.5 0.5
			End
		End

		AnimationState        = MOVING
			ShareAnimation		= Yes
			Animation           = RunA
				AnimationName       = GUCavalry_RUNA
				AnimationMode       = LOOP
				Distance			= 35
			End
			Animation           = RunB
				AnimationName       = GUCavalry_RUNB
				AnimationMode       = LOOP
				Distance			= 35
			End
			Animation           = RunC
				AnimationName       = GUCavalry_RUNC
				AnimationMode       = LOOP
				Distance			= 35
			End
			Animation           = RunD
				AnimationName       = GUCavalry_RUND
				AnimationMode       = LOOP
				Distance			= 35
			End
			Flags               = RANDOMSTART
		End


		AnimationState        = FIRING_OR_PREATTACK_A
			Animation           = ATKA
				AnimationName       = GUCavalry_ATKA
				AnimationMode       = ONCE
			End
			Animation           = ATKB
				AnimationName       = GUCavalry_ATKB
				AnimationMode       = ONCE
			End
			Animation           = ATKC
				AnimationName       = GUCavalry_ATKC
				AnimationMode       = ONCE
			End
			Animation           = ATKD
				AnimationName       = GUCavalry_ATKD
				AnimationMode       = ONCE
			End
			Animation           = Defend
				AnimationName       = GUCavalry_DFDA
				AnimationMode       = ONCE
			End
			Flags               = RESTART_ANIM_WHEN_COMPLETE
		End
		
		; --------- Click and Hit Reactions ------------
		AnimationState = HIT_REACTION HIT_LEVEL_1
			Animation = Hit_Level_1_a
				AnimationName = GUCavalry_HFMA
				AnimationMode = ONCE
			End
		End
	;;------------- EMOTIONS ---------------------------------------------
		AnimationState					=	EMOTION_ALERT EMOTION_AFRAID
			ShareAnimation				= Yes
			Animation					=	Apprehensive
				AnimationName			=	GUCavalry_APPA
				AnimationMode			=	LOOP	;Change this to ONCE if adding additional anims
			End
		End
		
		AnimationState					= EMOTION_AFRAID
			ShareAnimation				= Yes
			Animation					= FERA
				AnimationName			= GUCavalry_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= GUCavalry_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= GUCavalry_FERC
				AnimationMode			= LOOP
			End
		End
		
		AnimationState					= EMOTION_TAUNTING
			ShareAnimation				= Yes
			Animation					= TauntingA
				AnimationName			= GUCavalry_TNTA
				AnimationMode			= ONCE
			End
			Animation					= TauntingB
				AnimationName			= GUCavalry_TNTB
				AnimationMode			= ONCE
			End
			Animation					= Taunting2C
				AnimationName			= GUCavalry_TNTC
				AnimationMode			= ONCE
			End
			Animation					= Taunting2D
				AnimationName			= GUCavalry_TNTD
				AnimationMode			= ONCE
			End
			Flags						= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState					= EMOTION_POINTING
			Animation					= Pointing1A
				AnimationName			= GUCavalry_PNTA
				AnimationMode			= LOOP
			End
			Animation					= Pointing1B
				AnimationName			= GUCavalry_PNTB
				AnimationMode			= LOOP
			End
			Animation					= Pointing1C
				AnimationName			= GUCavalry_PNTC
				AnimationMode			= LOOP
			End
		End

		AnimationState					= EMOTION_CELEBRATING
			ShareAnimation				= Yes
			Animation					= CHRA
				AnimationName			= GUCavalry_CHRA
				AnimationMode			= ONCE
			End
			Animation					= CHRB
				AnimationName			= GUCavalry_CHRB
				AnimationMode			= ONCE
			End
			Animation					= CHRC
				AnimationName			= GUCavalry_CHRC
				AnimationMode			= ONCE
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End
		
		AnimationState					= EMOTION_ALERT
			Animation					= IDLA
				AnimationName			= GUCavalry_IDLA
				AnimationMode			= LOOP
			End
		End
		
		AnimationState					= RAISING_FLAG
			ShareAnimation				= Yes
			Animation					= CHRA
				AnimationName			= GUCavalry_CHRA
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= CHRB
				AnimationName			= GUCavalry_CHRB
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Animation					= CHRC
				AnimationName			= GUCavalry_CHRC
				AnimationMode			= ONCE
				AnimationSpeedFactorRange = 0.9 1.1
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
		End
		
		AnimationState				=	SELECTED
			StateName				=	State_Selected
			Animation				=	AtAttention
				AnimationName		=	GUCavalry_IDLG
				AnimationMode		=	Loop
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
			EndScript
		End
		
		TransitionState					=	TRANS_Idle_to_Selected
			Animation					=	ATNA
				AnimationName			=	GUCavalry_ATNA
				AnimationMode			=	ONCE
				AnimationSpeedFactorRange = 0.8 1.2
			End
		End
		
		
		TransitionState					=	TRANS_Selected_to_Idle
			Animation					=	ATNA
				AnimationName			=	GUCavalry_ATNA
				AnimationMode			=	ONCE_BACKWARDS
				AnimationSpeedFactorRange = 0.8 1.2
			End
			Flags						= START_FRAME_LAST
		End
	End
End
AddModule
	Behavior = SubObjectsUpgrade Armor_Subitupgrade
		TriggeredBy		= Upgrade_MenFaction
		UpgradeTexture	= GUManAtArms.tga 0 GUNumnrean.tga 
		UpgradeTexture	= GUNumnrean.tga 0 GUNumnrean.tga
		UpgradeTexture	= CUHorse_BnWtA.tga 0 CUHorse_WtBkA.tga
		UpgradeTexture	= CUHorse_BnA.tga 0 CUHorse_WtBkA.tga	
		UpgradeTexture	= CUHorse_BnWtA.tga 0 CUHorse_WtBkA.tga	
		UpgradeTexture	= CUHorse_WtBkA.tga 0 CUHorse_WtBkA.tga	
		;ShowSubObjects	= sshield
		RecolorHouse	= Yes
		ExcludeSubobjects = Forged_Blade
	End
End
AddModule
	Behavior = SubObjectsUpgrade Armor_SecondAge
		TriggeredBy		= Upgrade_TechnologyElvenForgedBlades
		UpgradeTexture	= GUNumnrean.tga 0 GUManAtArms_HA.tga
		UpgradeTexture	= GUManAtArms_HA.tga 0 GUManAtArms_HA.tga
		UpgradeTexture	= CUHorse_BnWtA.tga 0 CUHorse_WtA.tga 
		UpgradeTexture	= CUHorse_BnA.tga 0 CUHorse_WtA.tga 
		UpgradeTexture	= CUHorse_WtA.tga 0 CUHorse_WtA.tga 
		;ShowSubObjects	= sshield
		RecolorHouse	= Yes
		ExcludeSubobjects = Forged_Blade
	End
End
AddModule
	Behavior = SubObjectsUpgrade Armor_SecondAge6
		TriggeredBy		= Upgrade_TechnologyElvenHeavyArmor
		UpgradeTexture	= GUManAtArms_HA.tga 0 GUManAtArms.tga 
		UpgradeTexture	= GUManAtArms.tga 0 GUManAtArms.tga 
		UpgradeTexture	= CUHorse_BnWtA.tga 0 CUHorse_BnA.tga 
		UpgradeTexture	= CUHorse_BnA.tga 0 CUHorse_BnA.tga 
		UpgradeTexture	= CUHorse_WtA.tga 0 CUHorse_BnA.tga 
		;ShowSubObjects	= sshield
		RecolorHouse	= Yes
		ExcludeSubobjects = Forged_Blade
	End
End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades		
		AttributeModifier		= SecondAgeBonusKnight
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		AttributeModifier		= ThirdAgeBonusKnight
	End
End
End

Object GondorKnightHorde
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee7h
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf7gg
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperSword
	End
      End

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee6ff
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfty7
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades		
		AttributeModifier		= SecondAgeBonus
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		AttributeModifier		= ThirdAgeBonus
	End
End
AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers4
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt56
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End
    AddModule
        Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3AA
		TriggeredBy = Upgrade_DwarvenForgedBlades
	End
      End

      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced156
		TriggeredBy				= Upgrade_DwarvenForgedBlades
		AttributeModifier		= AdvancedCavalry
	End
      End
CommandSet = NewGondorKnightHordeCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp
		TriggeredBy			= Upgrade_TechnologyElvenForgedBlades ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewGondorKnightHordeCommandSet
	End 
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_TirdAgeUp
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewNewGondorKnightHordeCommandSet
	End 
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567
		TriggeredBy			= Upgrade_GondorForgedBlades Upgrade_TechnologyElvenHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= SuperNewNewNewGondorKnightHordeCommandSet
	End 
End
End

Object DwarvenGuardian 	
	SelectPortrait = HPArgelebPortrait
	ButtonImage = HIArgelebIcon
RemoveModule ModuleTag_01
AddModule 
Draw = W3DScriptedModelDraw ModuleTag_014
		DefaultModelConditionState
			Model               = GUCaptain_SKN
		End

		IdleAnimationState
			Animation       = Idle
				AnimationName   = GUCaptain_SKL.GUCaptain_IDLB
				AnimationMode   = ONCE
			End
		End
	
		; --- stunned anims
		AnimationState      = STUNNED_FLAILING 
			Animation         = FlyNDie
				AnimationName     = GUCaptain_SKL.GUCaptain_FLYA
				AnimationMode     = LOOP
			End
			Flags             = RANDOMSTART
		End

		

		AnimationState        = MOVING WANDER
			Animation           = WanderWalk
				AnimationName       = GUCaptain_SKL.GUCaptain_WALK 
				AnimationMode       = LOOP
			End
			;ParticleSysBone     = None InfantryDustTrails
		End

		AnimationState        = MOVING DAMAGED
			Animation           = DamagedWalk
				AnimationName       = GUCaptain_SKL.GUCaptain_WALK 
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART
			;ParticleSysBone     = None InfantryDustTrails
		End

		AnimationState        = MOVING
			Animation           = Run
				AnimationName       = GUCaptain_SKL.GUCaptain_RUN 
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART
			;ParticleSysBone     = None InfantryDustTrails
		End

		AnimationState        = ATTACKING
			Animation           = Attack
				AnimationName       = GUCaptain_SKL.GUCaptain_ATKA
				AnimationMode       = LOOP
			End
		End
	

		AnimationState      = DYING SPLATTED
			Animation         = Splattered
				AnimationName     = GUCaptain_SKL.GUCaptain_SPLTA
				AnimationMode     = ONCE
			End
		End

		AnimationState      = DYING
			Animation         = Die
				AnimationName     = GUCaptain_SKL.GUCaptain_DIEA
				AnimationMode     = ONCE
			End
		End
		
		AnimationState      = STUNNED 
			Animation         = Stun
				AnimationName     = GUCaptain_SKL.GUCaptain_SPLTA
				AnimationMode     = ONCE
			End
		End

		AnimationState        = SPECIAL_WEAPON_THREE
			Animation
				AnimationName     = GUCaptain_SKL.GUCaptain_ATKA
				AnimationMode     = LOOP
			End
		End
	
;;---------- EMOTIONS -------------------------------------------------

		AnimationState				= EMOTION_TAUNTING
			Animation				= TNTA
				AnimationName		= GUCaptain_SKL.GUCaptain_TNTA
				AnimationMode		= LOOP
			End
		End

		AnimationState				= EMOTION_POINTING
			Animation				= Pointing1
				AnimationName		= GUCaptain_SKL.GUCaptain_PNTA
				AnimationMode		= LOOP
			End
		End

		AnimationState				= EMOTION_CELEBRATING
			Animation				= CHRA
				AnimationName	    = GUCaptain_SKL.GUCaptain_CHRA
				AnimationMode		= LOOP
			End
		End
	End
End
CommandPoints = 10
WeaponSet
Conditions = None 
Weapon     = PRIMARY  EliteSword
End	
	ArmorSet
		Conditions      = None
		Armor           = ToughHeroArmor
		DamageFX        = NormalDamageFX
	End

	VoiceAttack				= ArgelebVoiceAttack
	VoiceAttackCharge			= ArgelebVoiceAttackCharge
	VoiceAttackMachine		= ArgelebVoiceAttack
	VoiceAttackStructure		= ArgelebVoiceAttackBuilding
	VoiceCreated			= ArgelebVoiceSalute	;this conflicts with his respawn dialogue line -- rehooked to spawn FX
	VoiceFullyCreated 		= ArgelebVoiceSalute	;this conflicts with his respawn dialogue line -- rehooked to spawn FX
	;VoiceFear 				= ArgelebVoiceHelpMe
	VoiceMove				= ArgelebVoiceMove
	VoiceMoveToCamp			= ArgelebVoiceMoveCamp
	;VoiceMoveWhileAttacking		= ArgelebVoiceHelpMe
	VoicePriority			= 84
	VoiceRetreatToCastle		= ArgelebVoiceMoveCamp
	VoiceSelect				= ArgelebVoiceSelect
	VoiceSelectBattle 		= ArgelebVoiceSelectBattle
	VoiceGuard				= ArgelebVoiceMove

	SoundImpact				= ImpactHorse

;BoromirVoiceJoinAnybody

	UnitSpecificSounds
		VoiceGarrison						= ArgelebVoiceGarrison
		VoiceEnterUnitElvenTransportShip	= ArgelebVoiceMove
		VoiceInitiateCaptureBuilding		= ArgelebVoiceCaptureBuilding
	End

	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ATTACK_NEEDS_LINE_OF_SIGHT NOTIFY_OF_PREATTACK GRAB_AND_DROP
ReplaceModule ModuleTag_03
	Behavior = AIUpdateInterface ModuleTag_030
		AutoAcquireEnemiesWhenIdle	=	Yes ATTACK_BUILDINGS
		MoodAttackCheckRate			=	500
		AILuaEventsList				=	DwarvenGuardianFunctions
		MinCowerTime				=	3000
		MaxCowerTime				=	5000
		AttackPriority				= 	AttackPriority_Cavalry
		BurningDeathTime			=	BURNINGDEATH_DURATION_INFANTRY
	End
End

      ReplaceModule ModuleTag_02
		Body = ActiveBody ModuleTag_020
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = 1000;BALANCE Archer Health
		MaxHealthDamaged  = DWARVEN_MENOFDALE_HEALTH_DAMAGED			
		BurningDeathBehavior	=	Yes
		BurningDeathFX       	=	FX_InfantryBurningFlame
   		DodgePercent      		= 50%
	End
End

	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = 60
	End

	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End

ReplaceModule ModuleTag_04
	Behavior = PhysicsBehavior ModuleTag_040
		GravityMult = 1.0
		ShockStunnedTimeLow		= 1400	//msec
		ShockStunnedTimeHigh	= 2400	//msec
		ShockStandingTime		= 1233	//msec
	End 
End

ReplaceModule ModuleTag_05
	Behavior = SlowDeathBehavior ModuleTag_050
		DeathTypes = ALL -KNOCKBACK -FADED
		SinkDelay = 3000
		SinkRate = 0.60     // in Dist/Sec
		DestructionDelay = 10000
		Sound = INITIAL HumanVoiceDie //GondorSoldierVoiceDie
	End
End
ReplaceModule ModuleTag_08 
	Behavior = BezierProjectileBehavior ModuleTag_080 // Module starts asleep, and wakes up when thrown.
		// To tweak a Bezier path
		FirstHeight = 24  // Height of Bezier control points above highest intervening terrain
		SecondHeight = 24
		FirstPercentIndent = 30% // Percentage of shot distance control points are placed
		SecondPercentIndent = 70%
		TumbleRandomly = Yes

		CrushStyle = Yes // I don't detonate, I just hit
		DieOnImpact = Yes
		BounceCount = 1   // When I hit the ground, I'll arc again
		BounceDistance = 40 // this far
		BounceFirstHeight = 24  // Height of Bezier control points above highest intervening terrain
		BounceSecondHeight = 24
		BounceFirstPercentIndent = 20% // Percentage of shot distance control points are placed
		BounceSecondPercentIndent = 80%

		GroundHitFX       = FX_ThrownRockGroundHit
		GroundBounceFX    = FX_ThrownRockBounceHit
	End
End


	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 19//
    ShadowSizeY = 19//
    ShadowTexture = ShadowI
End


Object DwarvenGuardianHorde
AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End
AddModule
           Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
     
		IdleSpawnRate				= 10000; ;5000							; spawn a new member every n seconds when idle (in miliseconds)		
		UnitSpawnFX					= FX_BannerCarrierSpawnUnit		; name of particle FX to use when the BannerCarrier spawns a new unit		

		; This well object acts like a banner carrier except it spawns unit on nearby hordes instead of itself.
		;MUpgradeRequired			= Upgrade_ObjectLevel3            
            ReplenishNearbyHorde		= Yes
		ReplenishAllNearbyHordes	= Yes
		ScanHordeDistance			= 0 ;only themselves
	End
End
CommandSet = EliteWarriorCommandset
BuildCost = 1500
BuildTime = 30
CommandPoints = 100
;CommandSet = NewChosenSoldierHordeCommandSet
;WeaponSet
;Conditions = None 
;Weapon     = PRIMARY  GloinAxe  
;End
DisplayName = EliteGondorWarrior
ReplaceModule ModuleTag_HordeContain
Behavior = HordeContain ModuleTag_HordeContain0
		FrontAngle = 270
		FlankedDelay = 2000
		ObjectStatusOfContained	= 
		InitialPayload					= DwarvenGuardian 10
		Slots							= 10
		PassengerFilter					= NONE +INFANTRY
		ShowPips						= No
		ThisFormationIsTheMainFormation = Yes	;//Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:0 Y:0

		
		MeleeBehavior = Amoeba
		End					

		; Banner Carrier info		
		
		RankInfo = RankNumber:1 UnitType:DwarvenGuardian Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:DwarvenGuardian Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:DwarvenGuardian Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		
		
		;// Positions for 5
		
		RanksToReleaseWhenAttacking		= 1 
		
		MeleeAttackLeashDistance		= 25	;// How far the hordes can move from the center of the horde when melee attacking.				
		BackUpMinDelayTime				= 1		;// The minimum amount of time to delay before backing up
		BackUpMaxDelayTime				= 3000	;// The maximum amount of time to delay before backing up
		BackUpMinDistance				= 1		;// The minimum number of cells to backup
		BackUpMaxDistance				= 3		;// The maximum number of cells to backup
		BackupPercentage				= 80%	;// The amount of chance that a unit will back up.
	End
End


	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = 60
	End
AddModule
		Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SmashEnabler
		SpecialPowerTemplate = SpecialAbilityGloinSmash
		TriggeredBy = Upgrade_ObjectLevel5
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_SmashStarter       
		SpecialPowerTemplate      = SpecialAbilityGloinSmash
		UpdateModuleStartsAttack  = Yes
		StartsPaused		  	  = Yes
		InitiateSound				= GloinVoiceGenericSpecialAbility
	End
End
AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SmashWeaponFireUpdate   
		SpecialPowerTemplate    = SpecialAbilityGloinSmash
		SpecialWeapon			= GloinSmashWeapon
		WhichSpecialWeapon		= 3			; Corresponds to SPECIAL_WEAPON_THREE
		StartAbilityRange		= 10.0
		
		SkipContinue			= Yes
		UnpackTime				= 2000		; Trigger on frame 60 (of 100)
		PackTime				= 1333		; Remaining 40 frames (of 100)
		MustFinishAbility		= Yes
	End
End
End

Object DwarvenMenOfDale ;ArnorCaptain
RemoveModule ModuleTag_01
AddModule
Draw = W3DScriptedModelDraw ModuleTag_DRAW
	OkToChangeModelColor = Yes
 	StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

	ExtraPublicBone = arrow
	ExtraPublicBone = PASSENGERBONE
		
	 DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP

;;====================== MODELS ================================================================
		DefaultModelConditionState
			Model               = GUCarthCap_SKN
			WeaponLaunchBone    = PRIMARY arrow
			ParticleSysBone	= NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
			ParticleSysBone	= NONE Predator02 FollowBone:Yes Persist:HOLD PersistID:100
		End
		ModelConditionState = WEAPONSET_HERO_MODE INVISIBLE_STEALTH
			ParticleSysBone = BAT_HEAD ThranDeadEye FollowBone:Yes
			ParticleSysBone	= NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
			ParticleSysBone	= NONE Predator02 FollowBone:Yes Persist:SPAWN PersistID:100
		End
		ModelConditionState = WEAPONSET_HERO_MODE
			ParticleSysBone = BAT_HEAD ThranDeadEye FollowBone:Yes
			ParticleSysBone	= NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
			ParticleSysBone	= NONE Predator02 FollowBone:Yes Persist:HOLD PersistID:100
		End
		ModelConditionState	= INVISIBLE_STEALTH
			ParticleSysBone	= NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
			ParticleSysBone	= NONE Predator02 FollowBone:Yes Persist:SPAWN PersistID:100
		End

;;================== ANIMATIONS =================================================================
	
;;----------- Captain of Gondor - Sword
		AnimationState        = PACKING_TYPE_2 WEAPONSET_TOGGLE_1
			StateName		  =	CaptainPower
			Animation           = GUFaramir_CHRC
				AnimationName     = GUFaramir_SKL.GUFaramir_CHRC
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.2 1.2
			End
		End

;;----------- Captain of Gondor - Bow
		AnimationState        = PACKING_TYPE_2
			StateName		  =	STATE_CaptainBow
			Animation           = GUFaramir_CHRD
				AnimationName     = GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.75 0.75
			End
		End


;;------------------  DYING -------------------------------------------------------------

; --- Flying through the air.
		AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_FLYB
				AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode     = LOOP
			End
			Flags               = RANDOMSTART
		End
		
		AnimationState        = STUNNED_FLAILING 
			StateName           = STATE_Bow
			Animation           = GUFaramir_FLYA
				AnimationName     = GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode     = LOOP
			End
			Flags               = RANDOMSTART
		End
		
; --- Dying anims
		AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_LNDB
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode     = ONCE
			End
		End

		AnimationState        = DYING SPLATTED
			StateName           = STATE_Bow
			Animation           = GUFaramir_LNDA
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode     = ONCE
			End
		End
		
		; with sword
		AnimationState        = DYING WEAPONSET_TOGGLE_1	;WEAPONSTATE_CLOSE_RANGE
			StateName           = STATE_Sword

			Animation           = GUFaramir_DIEA
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
				AnimationMode     = ONCE
			End
			
			Animation           = GUFaramir_DIEB
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
				AnimationMode     = ONCE
			End
		End
		
		; with bow
		AnimationState        = DYING
			StateName           = STATE_Bow
			Animation           = GUFaramir_DIEC
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEC
				AnimationMode     = ONCE
			End
		End


; --- Stunned anims


		AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_GTPB
				AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End
		
		AnimationState        = STUNNED_STANDING_UP
			StateName           = STATE_Bow
			Animation           = GUFaramir_GTPA
				AnimationName     = GUFaramir_SKL.GUFaramir_GTPA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		AnimationState        = STUNNED WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			
			Animation           = GUFaramir_LNDB
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode     = ONCE
			End
		End

		AnimationState        = STUNNED 
			StateName           = STATE_Bow
			
			Animation           = GUFaramir_LNDA
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode     = ONCE
			End
		End				

;;----------- pose 		
		AnimationState        = USER_1
		;*****************************************************************
			;ParticleSysBone     = B_SWORDBONE AndruilEfxParent FollowBone:yes
		;*****************************************************************
			Animation           = GUFaramir_POSA
				AnimationName     = GUFaramir_SKL.GUFaramir_POSA
				AnimationMode     = ONCE
			End
		End

		;--------------------- Wound Arrow anim
		AnimationState        =  SPECIAL_WEAPON_ONE
			StateName = STATE_Bow
			Animation
				AnimationName           = GUFaramir_SKL.GUFaramir_ATKC
				AnimationMode       = ONCE
			End
			FrameForPristineBonePositions = 59
			BeginScript
				CurDrawableShowSubObject("arrow")
			EndScript
		End
		
;;------------------ ATTACKING --------------------------------------------------------------------
		; Attacking Anims [Weapon_A]
		
		
		
		AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
			Animation           = TrotAndFire
				AnimationName       = GUFaramir_SKL.GUFaramir_ATRA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART
			StateName = RunAndSwing
		End
		
		AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			
			Animation           = ATKD
				AnimationName     = GUFaramir_SKL.GUFaramir_ATKD
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
				AnimationSpeedFactorRange = 1.149 1.149
			End
			
			Animation           = ATKE
				AnimationName    = GUFaramir_SKL.GUFaramir_ATKE
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
				AnimationSpeedFactorRange = 1.149 1.149
			End
			
			Animation           = ATKF
				AnimationName    = GUFaramir_SKL.GUFaramir_ATKF
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.47 1.47
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
			;	FrameForPristineBonePositions = 59
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
			EndScript
		End

;;------------------ MOVING -------------------------------------------------------------

		AnimationState        = MOVING USER_4                 ; Moving slaughter
			StateName           = Slaughter
			Flags               = RANDOMSTART
			;ParticleSysBone     = None InfantryDustTrails
			Animation           = GUFaramir_ATKE
				AnimationName     = GUFaramir_SKL.GUFaramir_ATKE
				AnimationMode     = LOOP
			End
			StateName           = NoSword
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
			EndScript
		End

		;--- Running with sword
		AnimationState			= MOVING WEAPONSET_TOGGLE_1		;WEAPONSTATE_CLOSE_RANGE
			StateName           = STATE_RunningSword
			Flags               = RANDOMSTART
			;ParticleSysBone    = None InfantryDustTrails
			
			Animation           = GUFaramir_RUNB
				AnimationName   = GUFaramir_SKL.GUFaramir_RUNB
;				AnimationMode   = LOOP
				AnimationSpeedFactorRange = 0.85 0.85
				Distance		= 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
			EndScript
		End

		;--- Running with bow
		AnimationState			= MOVING
			StateName           = STATE_RunningBow
			Flags               = RANDOMSTART
			;ParticleSysBone    = None InfantryDustTrails
			
			Animation           = GUFaramir_RUNA
				AnimationName   = GUFaramir_SKL.GUFaramir_RUNA
;				AnimationMode   = LOOP
				AnimationSpeedFactorRange = 0.85 0.85
				Distance = 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
			EndScript
		End

		;---------------------------------------------------
		;New style firing with bow
		AnimationState					=	PREATTACK_A 
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUFaramir_SKL.GUFaramir_ATKA1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	Yes			; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				;AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_A 
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUFaramir_SKL.GUFaramir_ATKA2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	Yes			; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.1 1.1		; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				;AnimationBlendTime		=	10
			End
		End
		;---------------------End New style firing

		AnimationState					=	CONTINUOUS_FIRE_MEAN
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUFaramir_SKL.GUFaramir_ATKA2
				AnimationMode			=	MANUAL
			End
		End
		
		AnimationState						= CONTINUOUS_FIRE_SLOW
			;StateName						= STATE_Idle_Bow
			Animation						= PutAwayArrow
				AnimationName				= GUFaramir_SKL.GUFaramir_ATKA3
				AnimationMode				= ONCE
			End
		End
				
		;End New style firing
		;---------------------------------------------------


		
;;-------------------- HIT REACTIONS -----------------------------------------------------------

; this hit animation attack stance
;		AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
;			Animation = Hit_Level_1_d
;				AnimationName = GUFaramir_SKL.GUFaramir_HITD
;				AnimationMode = ONCE
;			End
;		End
;
;		AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
;			Animation = Hit_Level_1_b
;				AnimationName = GUFaramir_SKL.GUFaramir_HITB
;				AnimationMode = ONCE
;			End
;		End
;
;		AnimationState = HIT_REACTION
;			Animation = Hit_Level_1_c
;				AnimationName = GUFaramir_SKL.GUFaramir_HITC
;				AnimationMode = ONCE
;			End
;		End

;;------------ EMOTIONS ------------------------------------------------------------------		


;;====== LEVELED
		AnimationState				= LEVELED WEAPONSET_TOGGLE_1	; This state clears itself in 3 seconds
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRC
				AnimationMode		= ONCE
			End
		End

		AnimationState				= LEVELED 						; This state clears itself in 3 seconds
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode		= ONCE
			End
		End

;====== CELEBRATING	

		AnimationState				=	EMOTION_CELEBRATING
				Animation           =	CHRA
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRA
					AnimationMode   =	ONCE
					AnimationPriority	=	10
				End
				Animation           =	CHRB
					AnimationName   =	GUFaramir_SKL.GUFaramir_CHRB
					AnimationMode   =	ONCE
					AnimationPriority	=	5
				End
				Flags				=	RESTART_ANIM_WHEN_COMPLETE		
			End

;;------------------- SELECTED STATES ------------------------------------------------------------

		AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = ATKD
				AnimationName     = GUFaramir_SKL.GUFaramir_ATKD
				AnimationMode     = MANUAL
			End			
		End

;;------------------- SELECTED STATES ------------------------------------------------------------

		AnimationState					= SELECTED WEAPONSET_TOGGLE_1
			StateName					= STATE_Selected_Sword
			
			Animation					= ATNE
				AnimationName			= GUFaramir_SKL.GUFaramir_ATNE
				AnimationMode			= LOOP
				AnimationBlendTime		= 15
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
			EndScript
		End
		
;;====== ALERT
		AnimationState				=	EMOTION_ALERT WEAPONSET_TOGGLE_1
			StateName				=	STATE_READY
			Animation				=	ready
				AnimationName		=	GUFaramir_SKL.GUFaramir_IDLA
				AnimationMode		=	LOOP
				AnimationBlendTime	=	20
			End
		End
		
		AnimationState				=	SELECTED 
			StateName				=	STATE_Selected_Bow
			
			Animation				=	ATNB
				AnimationName		=	GUFaramir_SKL.GUFaramir_ATNB
				AnimationMode		=	LOOP
				AnimationBlendTime  = 15
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_Idle_Bow"	then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
				if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
			EndScript
		End
	


;;--------------- IDLE STATES -----------------------------------------------------------------	
		
		AnimationState					= WEAPONSET_TOGGLE_1
			StateName					= STATE_Idle_Sword	

			Animation           		= IDLE
				AnimationName       	= GUFaramir_SKL.GUFaramir_IDLE
				AnimationMode       	= LOOP
				AnimationPriority	    = 20
				AnimationBlendTime  = 15
			End
			
			Animation           		= IDLF
				AnimationName       	= GUFaramir_SKL.GUFaramir_IDLF
				AnimationMode       	= LOOP
				AnimationPriority	    = 1
			End

			Animation           		= IDLG
				AnimationName       	= GUFaramir_SKL.GUFaramir_IDLG
				AnimationMode       	= LOOP
				AnimationPriority	    = 1
			End
			
			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
			EndScript
		End
		
		IdleAnimationState
			StateName           = STATE_Idle_Bow
			
			Animation           = IdleBow
				AnimationName     = GUFaramir_SKL.GUFaramir_IDLC
				AnimationMode     = ONCE
				AnimationBlendTime  = 15
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredBow") end
			EndScript
		End

	;---transitions--------------------------------------------

		TransitionState = TRANS_BoredToSelectedSword
			Animation = ANTD
				AnimationName		= GUFaramir_SKL.GUFaramir_ANTD
				AnimationMode		= ONCE
			End		
		End
		
		TransitionState = TRANS_SelectedToBoredSword
			Animation			= ATNF
				AnimationName	= GUFaramir_SKL.GUFaramir_ATNF
				AnimationMode	= ONCE
			End		
		End	

		TransitionState = TRANS_BoredToSelectedBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.GUFaramir_ATNC
				AnimationMode		= ONCE
			End		
		End
		
		TransitionState = TRANS_CaptainBowToSelectedBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.GUFaramir_ATNC
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationSpeedFactorRange = 1.5 1.5
			End		
		End
		
		TransitionState = TRANS_SelectedToBoredBow
			Animation			= ATNA
;				AnimationName	= GUFaramir_SKL.GUFaramir_ATNA
				AnimationName	= GUFaramir_SKL.GUFaramir_ATND
				AnimationMode	= ONCE
			End		
		End	


		TransitionState       = TRANS_BowToSword
			Animation           = GUFaramir_STHA
				AnimationName     = GUFaramir_SKL.GUFaramir_STHA 
				AnimationMode     = ONCE
			End
		End

		TransitionState       = TRANS_SwordToBow
			Animation           = GUFaramir_STHB
				AnimationName     = GUFaramir_SKL.GUFaramir_STHB 
				AnimationMode     = ONCE
			End
		End	

		TransitionState       		= TRANS_BowToSword_Running
			Animation           	= DrawSwords
				AnimationName       = GUFaramir_SKL.GUFaramir_STHD
				AnimationMode       = ONCE
			End
		End
		
		TransitionState       		= TRANS_SwordToBow_Running
			Animation           	= DrawBow
				AnimationName       = GUFaramir_SKL.GUFaramir_STHC
				AnimationMode       = ONCE
			End
		End		

	End
End
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    FaramirBow
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1		;CLOSE_RANGE CONTESTING_BUILDING
		Weapon = PRIMARY    FaramirSword
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	WeaponSet
		Conditions = WEAPONSET_HERO_MODE
		Weapon	= PRIMARY ElvenThranduilBowDeadeye
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
CommandPoints = 10
  ArmorSet
    Conditions        = None
    Armor             = HeroArmor
    ;DamageFX         = StructureDamageFXNoShake
  End

ReplaceModule ModuleTag_02
	Body = ActiveBody ModuleTag_024
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = 1000 ;BALANCE Archer Health
		MaxHealthDamaged  = DWARVEN_MENOFDALE_HEALTH_DAMAGED			
		BurningDeathBehavior	=	Yes
		BurningDeathFX       	=	FX_InfantryBurningFlame
	End
End

	; *** AUDIO Parameters ***;

	VoiceAttack				= ArnCaptVoiceAttack
	VoiceAttackAir				= ArnCaptVoiceAttack
	VoiceAttackCharge			= ArnCaptVoiceAttackCharge
	VoiceAttackMachine		= ArnCaptVoiceAttack
	VoiceAttackStructure		= ArnCaptVoiceAttackBuilding
	VoiceCreated			= ArnCaptVoiceSalute	;this conflicts with his respawn dialogue line -- rehooked to spawn FX
	VoiceFullyCreated 		= ArnCaptVoiceSalute	;this conflicts with his respawn dialogue line -- rehooked to spawn FX
	VoiceMove				= ArnCaptVoiceMove
	VoiceMoveToCamp			= ArnCaptVoiceMoveCamp
	VoiceMoveWhileAttacking		= ArnCaptVoiceModeDisengage
	VoicePriority			= 82
	VoiceRetreatToCastle		= ArnCaptVoiceModeRetreat
	VoiceSelect				= ArnCaptVoiceSelect
	VoiceSelectBattle 		= ArnCaptVoiceSelectBattle
	VoiceGuard				= ArnCaptVoiceMove

	SoundImpact				= ImpactHorse

	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = 65
	End
AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DeadeyeEnabler
		SpecialPowerTemplate = SpecialAbilityThranduilDeadeye
		TriggeredBy = Upgrade_MenFaction
	End
End
AddModule
  	Behavior = SpecialPowerModule ModuleTag_DeadeyeStarter					; SpecialAbility is a SpecialPower, SpecialPower is anyting special
		SpecialPowerTemplate    = SpecialAbilityThranduilDeadeye
		StartsPaused			= Yes
		UpdateModuleStartsAttack = Yes
	End
End
AddModule
	Behavior = HeroModeSpecialAbilityUpdate ModuleTag_DeadeyeUpdate			; So the difference in SpecialAbility is that it takes timing from this Update, instead of simply firing.
		SpecialPowerTemplate    = SpecialAbilityThranduilDeadeye
		HeroEffectDuration		= 20000										; this should sync with the auto ability delay re-fire time in commandButtons.ini
		UnpackTime              = 1											; insant unpack
		TriggerSound			= AragornBladeMaster
		PackTime				= 2500
		UnpackingVariation		= 1
	End
End
End

Object DwarvenMenOfDaleHorde
AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End
CommandSet = NewGondorDamrodCommandSet
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMissileHordeRangefinder
		;Weapon = TERTIARY   NormalMissileHordeRangefinderBombard
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End
	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1		
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
		;Weapon = TERTIARY   NormalMissileHordeRangefinderBombard
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End

BuildCost = 1100
BuildTime = 30
CommandPoints = 100
AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DeadeyeEnabler
		SpecialPowerTemplate = SpecialAbilityThranduilDeadeye
		TriggeredBy = Upgrade_MenFaction
	End
End
AddModule
  	Behavior = SpecialPowerModule ModuleTag_DeadeyeStarter					; SpecialAbility is a SpecialPower, SpecialPower is anyting special
		SpecialPowerTemplate    = SpecialAbilityThranduilDeadeye
		StartsPaused			= Yes
		UpdateModuleStartsAttack = Yes
	End
End
AddModule
	Behavior = HeroModeSpecialAbilityUpdate ModuleTag_DeadeyeUpdate			; So the difference in SpecialAbility is that it takes timing from this Update, instead of simply firing.
		SpecialPowerTemplate    = SpecialAbilityThranduilDeadeye
		HeroEffectDuration		= 20000										; this should sync with the auto ability delay re-fire time in commandButtons.ini
		UnpackTime              = 1											; insant unpack
		TriggerSound			= AragornBladeMaster
		PackTime				= 2500
		UnpackingVariation		= 1
	End
End
AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroHotWSummonAllies_Level2
	SpecialPowerTemplate = SpecialAbilityCreateAHeroHotWSummonAllies_Level2
	TriggeredBy			 = Upgrade_MenFaction
End
End
AddModule
Behavior = OCLSpecialPower ModuleTag_OCLSpecialPowerHotWSummonAllies_Level2
	SpecialPowerTemplate	= SpecialAbilityCreateAHeroHotWSummonAllies_Level2
	OCL						= OCL_SpawnDunedainRangers1; OCL_SpawnDunedainRangersEgg1
	TriggerFX				= FX_DunedainSummon
	CreateLocation			= CREATE_AT_LOCATION
	StartsPaused			= Yes
	SetModelCondition		= ModelConditionState:USER_1
	SetModelConditionTime	= 8.1
End
End
End

;-------------------------
CommandSet NewLindonWarriorCommandSet
	1	= Command_ToggleStance
	2	= Command_ToggleFaramirWeapon; Command_ToggleElvenWarriorWeapon
	3	= Command_MenLongShotAbility
	4 	= Command_PurchaseUpgradeGondorFireArrows
	5 	= Command_PurchaseUpgradeGondorBasicTraining
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End
;------------------------------------------
Object LindonElvenWarrior
	DisplayName = OBJECT:HordeGondorRanger

	
	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY    GondorRangerBow
		Weapon		= TERTIARY    GondorRangerBowBombard
		Weapon		= QUINARY		MenLongShotFakeWeapon
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT			; Not from AI.
		AutoChooseSources = QUINARY FROM_PLAYER FROM_SCRIPT			; Not from AI.
	End
	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1; CONTESTING_BUILDING
		Weapon = PRIMARY    ElvenLindonWarriorSword
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End

ReplaceModule ModuleTag_02
	Body = ActiveBody ModuleTag_022
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = 400			;BALANCE RohanElvenWarrior
		MaxHealthDamaged  = ELVEN_LINDONWARRIOR_HEALTH_DAMAGED		
		;RecoveryTime      = ELVEN_LINDONWARRIOR_HEALTH_RECOVERY_TIME		
	End
End
	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED	
	End
	SelectPortrait         = UPGondor_Ranger
	ButtonImage         = WOR_IthilienRangers

AddModule
	Behavior = WeaponSetUpgrade ModuleTag_WeaponSetUpgradeTag33
		TriggeredBy = Upgrade_GondorFireArrows
	End
End
	AddModule
	Behavior = SubObjectsUpgrade FireArrows_Upgrade44
  		TriggeredBy		= Upgrade_GondorFireArrows
  		ShowSubObjects	= FireArowTip ArrowNock	
  		HideSubObjects	= arrow
  	End
End

	
        VoiceAttack								= RangerVoiceAttack
	VoiceAttackAir							= RangerVoiceAttack				
	VoiceAttackCharge						= RangerVoiceAttack
	VoiceAttackMachine						= RangerVoiceAttack
	VoiceAttackStructure					= RangerVoiceAttackBuilding
	VoiceEnterStateAttack					= RangerVoiceEnterStateAttack	
	VoiceEnterStateAttackCharge				= RangerVoiceEnterStateAttack
	VoiceEnterStateAttackMachine			= RangerVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackStructure			= RangerVoiceEnterStateAttackBuilding
	VoiceCreated							= RangerVoiceSalute
	VoiceFullyCreated 						= RangerVoiceSalute		
	VoiceGuard								= RangerVoiceMove
	VoiceMove								= RangerVoiceMove		
	VoiceMoveToCamp							= RangerVoiceMoveCamp
	VoiceMoveWhileAttacking					= RangerVoiceDisengage
	VoiceEnterStateMove						= RangerVoiceEnterStateMove
	VoiceEnterStateMoveToCamp				= RangerVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking		= RangerVoiceEnterStateDisengage
	VoicePriority							= 43
	VoiceRetreatToCastle					= RangerVoiceRetreat
	VoiceEnterStateRetreatToCastle			= RangerVoiceEnterStateRetreat
	VoiceSelect								= RangerVoiceSelectMS
	VoiceSelectBattle 						= RangerVoiceSelectBattle

	SoundImpact								= ImpactHorse

	CrowdResponseKey = GoodMen

	UnitSpecificSounds
		VoiceGarrison						= RangerVoiceGarrison
		;VoiceCreatedFromInn				= TEMP_RangerVoiceSaluteInn
		;VoiceFullyCreatedFromInn 			= TEMP_RangerVoiceSaluteInn
		VoiceEnterUnitElvenTransportShip	= DunedainVoiceMoveShip
		VoiceInitiateCaptureBuilding		= DunedainVoiceCaptureBuilding
		VoiceMoveToTrees					= RangerVoiceMoveTrees				
		VoiceEnterStateMoveToTrees			= RangerVoiceEnterStateMoveTrees
		;VoiceEnterStateInitiateCaptureBuilding	=
                ;VoicePrimaryWeaponMode		=	RangerVoiceMove
		;VoiceSecondaryWeaponMode	=	RangerVoiceMove
End

ReplaceModule ModuleTag_01
	Draw = W3DHordeModelDraw ModuleTag_011
OkToChangeModelColor = Yes	
		StaticModelLODMode = Yes
		
		; specify options for static LODs
		LodOptions	= LOW
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_LOW
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_LOW
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_LOW
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_LOW
		End
		
		LodOptions	= MEDIUM
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_MED
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_MED
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_MED
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_MED
		End
		
		LodOptions	= HIGH
			AllowMultipleModels		=	ALLOW_MULTIPLE_MODELS_HIGH
			MaxRandomTextures		=	MAX_RANDOM_TEXTURES_HIGH
			MaxRandomAnimations		=	MAX_RANDOM_ANIMATIONS_HIGH
			MaxAnimFrameDelta		=	MAX_ANIM_FRAME_DELTA_HIGH
		End
;;=================== MODELS ============================================================
; --------- With Bow ------------
; Bah, must come first even though all the other bow stuff is below the sword stuff
		DefaultModelConditionState
			Model							= GURanger_SKNM
			WeaponLaunchBone				= PRIMARY ARROW
		End

		ModelConditionState				WEAPONSET_PLAYER_UPGRADE
			Model							= GURanger_SKNM
			WeaponLaunchBone				= PRIMARY ARROW
			WeaponLaunchBone				= SECONDARY ARROWNOCK	; when upgraded to flaming arrow
			ParticleSysBone					= FireArowTip arrowFire FollowBone:Yes
			ParticleSysBone					= FireArowTip arrowFire FollowBone:Yes
		End
		
; -------- With Sword ------------

		ModelConditionState				WEAPONSET_TOGGLE_1
			Model							= GURanger_SKNM
		End

;;================== ANIMATIONS ==============================================================		
; -------- Falling and flying and dying ----------
		
		AnimationState						= STUNNED_STANDING_UP 
			Animation						= GTPA
				AnimationName				= GURanger_SKL.GURanger_GTPA
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 0.7 1.1
			End
		End
		
		AnimationState						= PASSENGER
			Animation						= FLLA
				AnimationName				= GURanger_SKL.GURanger_FLLA
				AnimationMode				= LOOP
			End
			Flags							= RANDOMSTART
			StateName						= Bow
		End
		
		AnimationState						= THROWN_PROJECTILE
			Animation						= FLYA
				AnimationName				= GURanger_SKL.GURanger_FLYA
				AnimationMode				= LOOP
			End
		End

		AnimationState						= DYING SPLATTED
			Animation						= Splattered
				AnimationName				= GURanger_SKL.GURanger_LNDA
				AnimationMode				= ONCE
			End
		End

		AnimationState						= STUNNED 
			Animation						= Stun
				AnimationName				= GURanger_SKL.GURanger_LNDA
				AnimationMode				= ONCE
			End
		End

		AnimationState						= DYING
			Animation						= Die
				AnimationName				= GURanger_SKL.GURanger_DIEA
				AnimationMode				= ONCE
			End
		End
		
		
		
; --------- With Sword ------------
	
		AnimationState						= MOVING DAMAGED WEAPONSET_TOGGLE_1
			Animation						= STATE_Damaged_Walk_Sword
				AnimationName				= GURanger_SKL.GURanger_IWKA
				AnimationMode				= LOOP
			End
			Flags							= RANDOMSTART
			StateName						= Sword
			;ParticleSysBone				= None InfantryDustTrails
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Bow" then CurDrawableSetTransitionAnimState("TransBowToSword") end
			EndScript
		End
		
		AnimationState						= MOVING ATTACKING WEAPONSET_TOGGLE_1
			
			StateName						= STATE_Run_Sword
			
			Animation						= RunWithSword
				AnimationName				= GURanger_SKL.GURanger_RUNB
				AnimationMode				= LOOP
			End
			
			Flags							= RANDOMSTART
			;ParticleSysBone				= None InfantryDustTrails
			
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Bow" then CurDrawableSetTransitionAnimState("TransBowToSword") end
			EndScript
	End
		
		AnimationState						= MOVING WEAPONSET_TOGGLE_1
		
			StateName						= STATE_Run_Sword
		
			Animation						= RunWithSword
				AnimationName				= GURanger_SKL.GURanger_RUNB
				AnimationMode				= LOOP
			End

			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
			EndScript
		End

		AnimationState						= FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
		
			StateName						= STATE_Idle_Sword ;;this is what they look like at the end of the animation
		
			Animation						= AttackWithSwordA
				AnimationName				= GURanger_SKL.GURanger_ATKA
				AnimationMode				= ONCE
				UseWeaponTiming				= Yes
			End
			Animation						= AttackWithSwordB
				AnimationName				= GURanger_SKL.GURanger_ATKB
				AnimationMode				= ONCE
				UseWeaponTiming				= Yes
			End

			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
			EndScript
		End

		AnimationState						= DYING WEAPONSET_TOGGLE_1
		
			StateName						= STATE_Dead_Sword
			
			Animation						= DieWithSword
				AnimationName				= GURanger_SKL.GURanger_DIEB
				AnimationMode				= ONCE
			End

			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
			EndScript
		End
		
	

;---- Bow --------------------------------

		;;---- Bow Idle Animation State
		
		
		AnimationState						= MOVING BACKING_UP WEAPONSET_PLAYER_UPGRADE
			
			StateName						= STATE_Run_Bow
		
			ShareAnimation					= Yes
			Animation						= BackingUp
				AnimationName				= GURanger_SKL.GURanger_RUNC
				AnimationMode				= LOOP
			End
			
			Flags							= RANDOMSTART
			
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End

		AnimationState						= MOVING DAMAGED WEAPONSET_PLAYER_UPGRADE
			
			StateName						= STATE_Damaged_Walk_Bow
		
			ShareAnimation					= Yes
			Animation						= InjuredWalk
				AnimationName				= GURanger_SKL.GURanger_IWKA
				AnimationMode				= LOOP
			End
			
			Flags							= RANDOMSTART
			
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End
		
		AnimationState						= MOVING PANICKING WEAPONSET_PLAYER_UPGRADE
		
			StateName						= STATE_Run_Bow
		
			ShareAnimation					= Yes
			Animation						= RUNM
				AnimationName				= GURanger_SKL.GURanger_MFDA
				AnimationMode				= LOOP
			End
			
			Flags							= RANDOMSTART
			
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End
		
		AnimationState						= MOVING WEAPONSET_PLAYER_UPGRADE
			
			StateName						= STATE_Run_Bow
		
			ShareAnimation					= Yes
			Animation						= Run
				AnimationName				= GURanger_SKL.GURanger_RUNA
				AnimationMode				= LOOP
                AnimationSpeedFactorRange	= .7 .7 ;
			End
			
			Flags							= RANDOMSTART
			
			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End
		
		AnimationState						= MOVING BACKING_UP
			
			StateName						= STATE_Run_Bow
		
			ShareAnimation					= Yes
			Animation						= BackingUp
				AnimationName				= GURanger_SKL.GURanger_RUNC
				AnimationMode				= LOOP
			End
			
			Flags							= RANDOMSTART  
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End

;		AnimationState						= MOVING DAMAGED
;			
;			StateName						= STATE_Damaged_Walk_Bow
;		
;			ShareAnimation					= Yes
;			Animation						= InjuredWalk
;				AnimationName				= GURanger_SKL.GURanger_IWKA
;				AnimationMode				= LOOP
;			End
;			
;			Flags							= RANDOMSTART
;			
;			BeginScript
;				CurDrawableShowSubObject("arrow")
;				CurDrawableHideSubObject("arrownock")
;				Prev = CurDrawablePrevAnimationState()
;				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
;				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
;			EndScript
;		End
		
		AnimationState						= MOVING PANICKING
		
			StateName						= STATE_Run_Bow
		
			ShareAnimation					= Yes
			Animation						= RUNM
				AnimationName				= GURanger_SKL.GURanger_MFDA
				AnimationMode				= LOOP
			End
			
			Flags							= RANDOMSTART
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End
		
		AnimationState						= MOVING
			
			StateName						= STATE_Run_Bow
		
			ShareAnimation					= Yes
			Animation						= Run
				AnimationName				= GURanger_SKL.GURanger_RUNA
				AnimationMode				= LOOP
                AnimationSpeedFactorRange	= .7 .7 ;
			End
			
			Flags							= RANDOMSTART
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End

;---------------------------------------------------
		;New style firing
		AnimationState						= PREATTACK_A 
		
			StateName						= STATE_Firing
			
			Animation						= ReadyToDrawn
				AnimationName				= GURanger_SKL.GURanger_ATKD1
				AnimationMode				= ONCE
;				UseWeaponTiming				= Yes
				AnimationBlendTime			= 0
			End
		End

		AnimationState						= FIRING_A
		
			StateName						= STATE_Firing
			
			Animation						= OneFrameOfShooting
				AnimationName				= GURanger_SKL.GURanger_ATKD2
				AnimationMode				= MANUAL
			End
		End

		AnimationState						= RELOADING_A 
		
			StateName						= STATE_Firing
			
			Animation						= LooseReloadDraw
				AnimationName				= GURanger_SKL.GURanger_ATKD2
				AnimationMode				= ONCE
;				UseWeaponTiming				= Yes
			End
		End
		
		AnimationState						= CONTINUOUS_FIRE_MEAN
		
			StateName						= STATE_Firing
			
			Animation						= HangFrameWhileCoasting
				AnimationName				= GURanger_SKL.GURanger_ATKD2
				AnimationMode				= MANUAL
			End
		End
		
		AnimationState						= CONTINUOUS_FIRE_SLOW
		
			StateName						= STATE_Idle_Bow
			
			Animation						= PutAwayArrow
				AnimationName				= GURanger_SKL.GURanger_ATKD3
				AnimationMode				= ONCE
			End
		End
		
		;End New style firing
;---------------------------------------------------


; --------- Click and Hit Reactions ------------	
		AnimationState						= HIT_REACTION
			Animation						= Hit_Level_1_a
				AnimationName				= GURanger_SKL.GURanger_HITA
				AnimationMode				= ONCE
			End
		End


;;------------- EMOTIONS ------------------------------------------------
		AnimationState						= EMOTION_AFRAID WEAPONSET_TOGGLE_1
			ShareAnimation					= Yes
			Animation						= &&FEAR WITH SWORD&&
				AnimationName				= GURanger_SKL.GURanger_IDLA
				AnimationMode				= LOOP
			End
		End
		AnimationState						= EMOTION_AFRAID
			ShareAnimation					= Yes
			StateName						= STATE_Afraid
			Animation						= FERA
				AnimationName				= GURanger_SKL.GURanger_FERA
				AnimationMode				= LOOP
			End
			Animation						= FERB
				AnimationName				= GURanger_SKL.GURanger_FERB
				AnimationMode				= LOOP
			End
		End
		
		AnimationState						= EMOTION_TAUNTING WEAPONSET_TOGGLE_1
			Animation						= &&TAUNT WITH SWORD&&
				AnimationName				= GURanger_SKL.GURanger_IDLA
				AnimationMode				= LOOP
			End
		End
		AnimationState						= EMOTION_TAUNTING
			ShareAnimation					= Yes
			Animation						= Taunting
				AnimationName				= GURanger_SKL.GURanger_TNTA
				AnimationMode				= ONCE
			End
			Animation						= Taunting2
				AnimationName				= GURanger_SKL.GURanger_TNTB
				AnimationMode				= ONCE
			End
			Flags							= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState						= EMOTION_POINTING WEAPONSET_TOGGLE_1
			Animation						= &&POINT WITH SWORD&&
				AnimationName				= GURanger_SKL.GURanger_IDLA
				AnimationMode				= LOOP
			End
		End
		AnimationState						= EMOTION_POINTING
			Animation						= Pointing1
				AnimationName				= GURanger_SKL.GURanger_PNTA
				AnimationMode				= LOOP
			End
		End

		AnimationState						= EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
			Animation						= &&CHEER WITH SWORD&&
				AnimationName				= GURanger_SKL.GURanger_IDLA
				AnimationMode				= LOOP
			End
		End
		AnimationState						= EMOTION_CELEBRATING
			ShareAnimation					= Yes
			Animation						= CHRA
				AnimationName				= GURanger_SKL.GURanger_CHRA
				AnimationMode				= Once
			End
			Animation						= CHRB
				AnimationName				= GURanger_SKL.GURanger_CHRB
				AnimationMode				= Once
			End
			Flags							= RESTART_ANIM_WHEN_COMPLETE
		End
		
		AnimationState						= EMOTION_ALERT
			Animation						= IdleBowA
				AnimationName				= GURanger_SKL.GURanger_IDLA 
				AnimationMode				= ONCE
			End
		End
	;--------- selected animation -----------------------------
	
		AnimationState						= SELECTED WEAPONSET_TOGGLE_1
			StateName						= STATE_Idle_Sword
			
			Animation						= SwordIdle
				AnimationName				= GURanger_SKL.GURanger_IDLB
				AnimationMode				= LOOP
			End
		End
		AnimationState						= SELECTED
			StateName						= STATE_Idle_Bow
			
			Animation						= selected
				AnimationName				= GURanger_SKL.GURanger_IDLA 
				AnimationMode				= ONCE
			End
		End

	;;---- Idle Animation State ---------------------------------------
		AnimationState						= WEAPONSET_TOGGLE_1
		
			StateName						= STATE_Idle_Sword
			
			Animation						= SwordIdle
				AnimationName				= GURanger_SKL.GURanger_IDLB
				AnimationMode				= LOOP
			End

			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
			EndScript
		End
		AnimationState						= WEAPONSET_PLAYER_UPGRADE
			
			StateName						= STATE_Idle_Bow
		
			Animation						= IdleBow
				AnimationName				= GURanger_SKL.GURanger_IDLA 
				AnimationMode				= LOOP
			End

			BeginScript
				CurDrawableHideSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
			EndScript
		End
		IdleAnimationState
			StateName						= STATE_Idle_Bow

			Animation						= IdleBowG
				AnimationName				= GURanger_SKL.GURanger_IDLG
				AnimationMode				= ONCE
			End

			Animation						= IdleBowF
				AnimationName				= GURanger_SKL.GURanger_IDLF 
				AnimationMode				= ONCE
			End
			
			Flags							= RESTART_ANIM_WHEN_COMPLETE
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end	
			EndScript
		End

;---transitions--------------------------------------------
		TransitionState						= TRANS_Bow_To_Sword
			Animation						= DrawSwords
				AnimationName				= GURanger_SKL.GURanger_STHA
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 0.9 1.1
			End
		End

		TransitionState						= TRANS_Sword_To_Bow
			Animation						= DrawBow
				AnimationName				= GURanger_SKL.GURanger_STHB
				AnimationMode				= ONCE
				AnimationSpeedFactorRange	= 0.9 1.1
			End
		End
	End
End
AddModule
	Behavior = SubObjectsUpgrade Armor_SecondAge66
		TriggeredBy		= Upgrade_TechnologyElvenHeavyArmor
		UpgradeTexture	= GURanger.tga 0 GURanger_Gry.tga 
		UpgradeTexture	= GURanger.tga 0 GURanger_Gry.tga 
		UpgradeTexture	= GURanger_Gry.tga 0 GURanger_Gry.tga 
		;ShowSubObjects	= sshield
		RecolorHouse	= Yes
		ExcludeSubobjects = Forged_Blade
	End
End
End
;----------------------------------------
Object LindonWarriorHorde
	LocomotorSet
		Locomotor     = NormalRangedHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
	End

AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers5
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedFA
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades
		AttributeModifier		= SuperArcherMen
		;RefreshDelay		= 2000	; 2 secs
	End
      End
	CommandSet = NewLindonWarriorCommandSet
	SelectPortrait         = UPGondor_Ranger
	ButtonImage         = WOR_IthilienRangers
		
	Side = Men
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeGondorRanger
	DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorRangerHorde
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorRangerHorde
	BuildCost 		= GONDOR_RANGER_BUILDCOST
	BuildTime 		= GONDOR_RANGER_BUILDTIME
	VisionRange 		= GONDOR_RANGER_HORDE_VISION_RANGE
	ShroudClearingRange 	= GONDOR_RANGER_HORDE_SHROUD_RANGE
	VisionSide 		= 50%
	VisionRear 		= 25%
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%
	CommandPoints 		= 60	; originally 60
AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LongShotUnpause
		SpecialPowerTemplate      = SpecialAbilityMenLongShot
		TriggeredBy				  = Upgrade_MenFaction
	End
End
AddModule
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate		= SpecialAbilityMenLongShot
		OCL							= OCL_LongShotAbility
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		StartsPaused			  = Yes ; ;
		
		;// Need to set a model condition (unused by the horde anyway) in order to
		;// freeze the horde for the duration of the spell
		SetModelCondition			= ModelConditionState:USER_1
		SetModelConditionTime		= 5.0
		DisableDuringAnimDuration	= Yes
	End
End
AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate   
		SpecialPowerTemplate    = SpecialAbilityMenLongShot
		PackTime				= 5000									// returning to flap
		MustFinishAbility		= Yes
		SpecialWeapon			= MenLongShotWeapon
		NeedLivingTargets		= No
		;PackSound				= LongshotRangerCall	;this worked!
		;UnpackSound				= LongshotRangerCall	;this didn't work
		;PrepSoundLoop			= LongshotRangerCall	;this worked!
		TriggerSound			= RangerVoiceLongShot
	End
End
AddModule
	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_GondorBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
End
AddModule	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_GondorFireArrows
	End
End
End

ChildObject DwarvenAxeThrower GondorCavalry
	VoiceAttack								= RangerVoiceAttack
	VoiceAttackAir							= RangerVoiceAttack				
	VoiceAttackCharge						= RangerVoiceAttack
	VoiceAttackMachine						= RangerVoiceAttack
	VoiceAttackStructure					= RangerVoiceAttackBuilding
	VoiceEnterStateAttack					= RangerVoiceEnterStateAttack	
	VoiceEnterStateAttackCharge				= RangerVoiceEnterStateAttack
	VoiceEnterStateAttackMachine			= RangerVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackStructure			= RangerVoiceEnterStateAttackBuilding
	VoiceCreated							= RangerVoiceSalute
	VoiceFullyCreated 						= RangerVoiceSalute		
	VoiceGuard								= RangerVoiceMove
	VoiceMove								= RangerVoiceMove		
	VoiceMoveToCamp							= RangerVoiceMoveCamp
	VoiceMoveWhileAttacking					= RangerVoiceDisengage
	VoiceEnterStateMove						= RangerVoiceEnterStateMove
	VoiceEnterStateMoveToCamp				= RangerVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking		= RangerVoiceEnterStateDisengage
	VoicePriority							= 43
	VoiceRetreatToCastle					= RangerVoiceRetreat
	VoiceEnterStateRetreatToCastle			= RangerVoiceEnterStateRetreat
	VoiceSelect								= RangerVoiceSelectMS
	VoiceSelectBattle 						= RangerVoiceSelectBattle

	SoundImpact								= ImpactHorse

	CrowdResponseKey = GoodMen

	UnitSpecificSounds
		VoiceGarrison						= RangerVoiceGarrison
		;VoiceCreatedFromInn				= TEMP_RangerVoiceSaluteInn
		;VoiceFullyCreatedFromInn 			= TEMP_RangerVoiceSaluteInn
		VoiceEnterUnitElvenTransportShip	= DunedainVoiceMoveShip
		VoiceInitiateCaptureBuilding		= DunedainVoiceCaptureBuilding
		VoiceMoveToTrees					= RangerVoiceMoveTrees				
		VoiceEnterStateMoveToTrees			= RangerVoiceEnterStateMoveTrees
		;VoiceEnterStateInitiateCaptureBuilding	=
	End
RemoveModule ModuleTag_01
AddModule
	Draw = W3DScriptedModelDraw ModuleTag_DRAW
	OkToChangeModelColor = Yes
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
 DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP

;;====================== MODELS ================================================================
		DefaultModelConditionState
			Model               = GUFrmrHrs_SKN
			WeaponLaunchBone    = PRIMARY PASSENGERBONE
		End

;;================== ANIMATIONS =================================================================
	
;;----------- Captain of Gondor Mounted
		AnimationState        = PACKING_TYPE_2 
			StateName		  =	STATE_CaptainMounted
			
			Animation           = GUFaramir_IDLC
				AnimationName     = RUHHs_Theo_SKL.RUHHs_Theo_IDLC
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 0.5 0.5
			End
		End


; --------- MOUNTED  ------------		

; --- Dying Anims
		AnimationState				=	FREEFALL 
			Animation				=	freefall
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_FLYC
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
		End

		AnimationState				=	STUNNED_FLAILING 
			Animation				=	JustDie
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_FLYC
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
		End
		
		AnimationState				=	DYING SPLATTED
			Animation				=	Land
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_LNDA
				AnimationMode		=	ONCE
			End
		End
		
		; This is the no-spawn-horse type of death
		AnimationState				=	DYING
			Animation				=	JustDie
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_DIEA
				AnimationMode		=	ONCE
			End
		End
		
		AnimationState				=	STUNNED_STANDING_UP
			Animation				=	StandUp
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_GTPA
				AnimationMode		=	ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		AnimationState				=	STUNNED
			Animation				=	Land
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_LNDA
				AnimationMode		=	ONCE
			End
		End
		
		AnimationState						= PARALYZED 
			Animation
				AnimationName				= RUHHs_Theo_SKL.RUHHs_Theo_IDLA
				AnimationMode				= LOOP
			End
		End


; --- Attacking Anims		
		AnimationState        =  FIRING_OR_PREATTACK_A ATTACKING_STRUCTURE
			StateName = Attacking
			Animation = attackinga  building while mounted.
				AnimationName           = RUHHs_Theo_SKL.RUHHs_Theo_ATKA  ;ATKB looked pretty silly.
				AnimationMode       = ONCE
				UseWeaponTiming = Yes
			End
		End
		
		
		
		AnimationState        = MOVING FIRING_OR_PREATTACK_A
			ShareAnimation		= Yes
			Animation           = MountedRunAndFire
				AnimationName       = RUHHs_Theo_SKL.RUHHs_Theo_ATRA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART  
		End

		AnimationState				=	FIRING_OR_PREATTACK_A
			Animation				=	AttackA
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_ATKA
				AnimationMode		=	ONCE
				UseWeaponTiming		= Yes
			End
			Animation				=	AttackB
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_ATKB
				AnimationMode		=	ONCE
				UseWeaponTiming		= Yes
			End
		End

; --- Moving Anims
		AnimationState				=	TURN_LEFT_HIGH_SPEED
			Animation				=	TurnLeft
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_TNL1
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange= 1.2 1.2
				AnimationBlendTime	=	20
			End
		End
		
		AnimationState				=	TURN_RIGHT_HIGH_SPEED
			Animation				=	TurnLeft
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_TNR1
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange= 1.2 1.2
				AnimationBlendTime	=	20
			End
		End
		
		
		

		AnimationState				=	MOVING TURN_LEFT 
			Animation				=	TurnLeft
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_TRNL
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange= 1.5 1.5
			End
;			;ParticleSysBone			=	None CalvaryDustTrails
		End

		AnimationState				=	MOVING TURN_RIGHT 
			Animation				=	TurnRight
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_TRNR
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange= 1.5 1.5
			End
;			;ParticleSysBone			=	None CalvaryDustTrails
		End

		AnimationState				=	MOVING ACCELERATE
			Animation				=	Accelerate
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_ACCL
				AnimationMode		=	LOOP
			End
			;ParticleSysBone			=	None CalvaryDustTrails
		End

		AnimationState				=	MOVING DECELERATE
			Animation				=	Decelerate
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_DECL
				AnimationMode		=	ONCE
				AnimationSpeedFactorRange	= 0.55 0.55
			End
			;ParticleSysBone			=	None CalvaryDustTrails
		End

		AnimationState				=	MOVING WALKING
			Animation				=	Walk
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_WLKA
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
			;ParticleSysBone			=	None InfantryDustTrails  
		End
		
		AnimationState				=	MOVING BACKING_UP
			Animation				=	BackingUp
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_BAKA
				AnimationMode		=	LOOP
			End
			Flags					=	RANDOMSTART
			;ParticleSysBone			=	None InfantryDustTrails  
		End


		AnimationState				=	MOVING
			Animation				=	RunA
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_RUNA
				AnimationMode		=	LOOP
			End
 			Flags					=	RANDOMSTART
			;ParticleSysBone			=	None CalvaryDustTrails  
		End

; --- Selected Anims		
		AnimationState				= SELECTED
			SimilarRestart			=   Yes			
			StateName				=	AtAttentionIdle
			Animation				=	ATNB
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_IDLH
				AnimationMode		=	LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
				if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
				if Prev == "STATE_CaptainMounted" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
			EndScript
		End

		TransitionState				=	TRANS_MountedSelect
			Animation				=	ATNA
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_ATNA
				AnimationMode		=	ONCE
			End
		End

; HITA not available on Theoden
;		AnimationState = MOUNTED HIT_REACTION
;			Animation = Hit_Level_1_a
;				AnimationName = RUHHs_Theo_SKL.RUHHs_Theo_HITA
;				AnimationMode = ONCE
;			End
;		End

; --- Idle Anims		
		IdleAnimationState            ;AnimationState = MOUNTED
			StateName = Idle
			Animation	=	IdleA
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_IDLA
				AnimationPriority	=	30
				AnimationMode		=	ONCE
				AnimationBlendTime	=	15
			End
			Animation				=	IdleC
				AnimationName		=	RUHHs_Theo_SKL.RUHHs_Theo_IDLC
				AnimationMode		=	ONCE
				AnimationBlendTime	=	15
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
End
	End
	RefundValue			= 25
AddModule
	Behavior = SubObjectsUpgrade Armor_SecondAge667
		TriggeredBy		= Upgrade_MenFaction
		UpgradeTexture	= GUFaramir_M.tga 0 GURanger.tga
		UpgradeTexture	= GUManAtArms.tga 0 GURanger.tga 
		UpgradeTexture	= GUFaramir.tga 0 GURanger.tga 
		UpgradeTexture	= GURanger.tga 0 GURanger.tga 
		UpgradeTexture	= GUFrmirHrse.tga 0 CUHorse_BnA.tga 
		UpgradeTexture	= CUHorse_BnA.tga 0 CUHorse_BnA.tga 
		;UpgradeTexture	= GURanger_Gry.tga 0 GURanger_Gry.tga 
		;ShowSubObjects	= sshield
		RecolorHouse	= Yes
		ExcludeSubobjects = Forged_Blade
	End
End
AddModule
	Behavior = SubObjectsUpgrade Armor_SecondAge6678987
		TriggeredBy		= Upgrade_GondorHeavyArmor
		UpgradeTexture	= GUFaramir.tga 0 GURanger_Gry.tga 
		UpgradeTexture	= GUFaramir_M.tga 0 GURanger_Gry.tga 
		UpgradeTexture	= GURanger.tga 0 GURanger_Gry.tga 
		UpgradeTexture	= GURanger_Gry.tga 0 GURanger_Gry.tga 
		;ShowSubObjects	= sshield
		RecolorHouse	= Yes
		ExcludeSubobjects = Forged_Blade
	End
End
AddModule
	Behavior = RefundDie ModuleTag_refund4
		UpgradeRequired = Upgrade_MenFaction
		BuildingRequired = ANY 
		RefundPercent = 100%
	End
End
;CommandSet = RangerCavalryCommandSet
End

CommandButton Command_SpecialAbilityWildmanPillage
	Command			= SPECIAL_POWER
	SpecialPower		= SpecialAbilityWildmanPillage
	Options			= NONPRESSABLE
	ButtonImage		= HSDrogothIncinerate
	ButtonBorderType	= ACTION
	TextLabel		= rangeruh
	DescriptLabel		= rangeruhDesc
	InPalantir		= Yes
	DoubleClick		= Yes
	;UnitSpecificSound	= 
End

CommandButton Command_RohanEomerHorseLordLeadership
  Command                 = SPECIAL_POWER
  SpecialPower            = SpecialAbilityFakeLeadership
  Options				  = NONPRESSABLE
  TextLabel               = 100
  ButtonImage             = HSEomerLeadership
  RadiusCursorType        = TrainingRadiusCursor
  ButtonBorderType        = ACTION
  DescriptLabel           = 100Desc
  InPalantir		  = Yes
End

CommandSet = RangerCavalryCommandSet
        1 	= Command_ToggleStance
	2 	= Command_PurchaseUpgradeGondorForgedBlades
	3 	= Command_PurchaseUpgradeGondorHeavyArmor
	4 	= Command_LurtzPillage
        5       = Command_RohanEomerHorseLordLeadership
        6       = Command_SpecialAbilityCreateAHeroHeroicCharge
	12  	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandSet = SuperRangerCavalryCommandSet
        1 	= Command_ToggleStance
	2 	= Command_CreateAHero_SpecialAbilityBladeMaster
	3	= Command_PurchaseUpgradeGondorHeavyArmor
	4 	= Command_LurtzPillage
        5       = Command_RohanEomerHorseLordLeadership
        6       = Command_SpecialAbilityCreateAHeroHeroicCharge
	12  	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

ChildObject DwarvenAxeThrowerHorde GondorKnightHorde
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee67
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfft
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperSword
	End
      End

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36eehj
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfhh
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt6
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End
    AddModule
        Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3AA6
		TriggeredBy = Upgrade_DwarvenForgedBlades
	End
      End

      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced16
		TriggeredBy				= Upgrade_DwarvenForgedBlades
		AttributeModifier		= AdvancedCavalry
	End
      End

BuildCost = 800
CommandSet = RangerCavalryCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567gh
		TriggeredBy			= Upgrade_GondorForgedBlades Upgrade_TechnologyElvenHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= SuperRangerCavalryCommandSet
	End 
End
RemoveModule ModuleTag_HordeContain
AddModule
	Behavior 				= HorseHordeContain ModuleTag_HordeContain1
		FrontAngle 			= 270
		FlankedDelay 			= 2000
		ObjectStatusOfContained 	= 
		InitialPayload 			= DwarvenAxeThrower 12
		Slots 				= 12
		PassengerFilter 		= NONE +CAVALRY +GondorCavalryBanner
		ShowPips 			= No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset			= X:0 Y:0
		MeleeBehavior 			= Amoeba
		End

		// Banner Carrier info		
		// Banner Carrier info	
	
		BannerCarriersAllowed	= GondorCavalryBanner										// types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:GondorCavalry	Pos:X:70.0 Y:0.0		// (DEFAULT) posT) position of banner carrier
		
		RankInfo = RankNumber:1 UnitType:DwarvenAxeThrower Position:x:50 Y:10			Position:X:50 Y:-10		Position:X:50 Y:30		Position:X:50 Y:-30		Position:X:50 Y:50		Position:X:50 Y:-50
		RankInfo = RankNumber:2 UnitType:DwarvenAxeThrower Position:X:30 Y:10 Leader 1 0	Position:X:30 Y:-10 Leader 1 1	Position:X:30 Y:30 Leader 1 2	Position:X:30 Y:-30 Leader 1 3	Position:X:30 Y:50 Leader 1 4	Position:X:30 Y:-50 Leader 1 5

;		BannerCarrierPosition	= UnitType:DwarvenAxeThrower	Pos:X:70.0 Y:0.0		// (DEFAULT) position of banner carrier
		
;		RankInfo = RankNumber:1 UnitType:DwarvenAxeThrower Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		;Position:X:50 Y:-40 
;		RankInfo = RankNumber:2 UnitType:DwarvenAxeThrower Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	;Position:X:30 Y:-40 Leader 1 4
;		RankInfo = RankNumber:3 UnitType:DwarvenAxeThrower Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	;Position:X:10 Y:-40 Leader 2 4
		
		RanksToReleaseWhenAttacking = 1 2 ;3

		MeleeAttackLeashDistance 	= 1   	//How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		= 1	//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		= 3000	//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		= 1	//The minimum number of	cells to backup
		BackUpMaxDistance		= 3	//The maximum number of	cells to backup
		BackupPercentage		= 80%	//The amount of	chance that	a unit will	back up.
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_PillageStandin5
		SpecialPowerTemplate		= SpecialAbilityWildmanPillage
		StartsPaused			= No
		UpdateModuleStartsAttack	= No
	End
End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfghb56h
		TriggeredBy				= Upgrade_MenFaction
		AttributeModifier		= GN
	End
      End

AddModule
 	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Pillage6
		SpecialPowerTemplate	= SpecialAbilityFakeLeadership2
		TriggeredBy				= Upgrade_MenFaction
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_PillageUpdate7
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership2
		UpdateModuleStartsAttack	= No
		StartsPaused				= No
	End
End
AddModule
	Behavior = AttributeModifierAuraUpdate ModuleTag_PillageAura7
		StartsActive	= Yes										; If no, requires upgrade to turn on.
		BonusName		= LurtzPassiveOutlawLeadership
		TriggeredBy		= Upgrade_MenFaction
		RefreshDelay	= 2000
		Range			= 200
		AllowSelf		= Yes
		ObjectFilter	= NONE +CAVALRY 
	End	
End

AddModule
	Behavior = RefundDie ModuleTag_refund4
		UpgradeRequired = Upgrade_MenFaction
		BuildingRequired = ANY 
		RefundPercent = 100%
	End
End
AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
		SpecialPowerTemplate = SpecialAbilityFakeLeadership
		TriggeredBy = Upgrade_MenFaction
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate   
		SpecialPowerTemplate      = SpecialAbilityFakeLeadership
		UpdateModuleStartsAttack  = No
		StartsPaused = Yes
	End
End
AddModule	
	Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership1
		StartsActive	= No ;If no, requires upgrade to turn on.
		BonusName		= GenericHeroLeadershipRanger
		TriggeredBy		= Upgrade_MenFaction
;		RequiredConditions = MOUNTED  ;;; -- wanted to work on foot as well
		RefreshDelay	= 2000
		Range			= 200
		AntiCategory	= BUFF
		ObjectFilter	= NONE +CAVALRY -HERO +GondorKnightsofDol +GondorKnightsofDolHorde -MordorBlackRider -MordorBlackRiderHorde -AngmarDireWolfHorde -AngmarDireWolf -AngmarDireWolf_Slaved 
	End	

End
End

CommandSet NewRohirrimHordeCommandSet	
	1 = Command_ToggleStance
	2 = Command_ToggleRohirrimWeapon
	3 = Command_PurchaseUpgradeRohanForgedBladesForRohirrim	
	4 = Command_PurchaseUpgradeRohanHeavyArmorForRohirrim
	5 = Command_PurchaseUpgradeRohanBasicTraining
        6 = Command_SpecialAbilityCreateAHeroHeroicCharge
	12 = Command_CaptureBuilding
	13 = Command_AttackMove
	14 = Command_Stop
	16  = Command_SetStanceBattle
	17  = Command_SetStanceAggressive
	18  = Command_SetStanceHoldGround
End 

CommandSet SuperNewRohirrimHordeCommandSet	
	1 = Command_ToggleStance
	2 = Command_ToggleRohirrimWeapon
	3 = Command_CreateAHero_SpecialAbilityBladeMaster
	4 = Command_PurchaseUpgradeRohanHeavyArmorForRohirrim
	5 = Command_PurchaseUpgradeRohanBasicTraining
        6 = Command_SpecialAbilityCreateAHeroHeroicCharge
	12 = Command_CaptureBuilding
	13 = Command_AttackMove
	14 = Command_Stop
	16  = Command_SetStanceBattle
	17  = Command_SetStanceAggressive
	18  = Command_SetStanceHoldGround
End 

Object RohanRohirrimHorde
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36eeghg
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfghb
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperSword
	End
      End

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36eeby5
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf565
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End
CommandSet = NewRohirrimHordeCommandSet	
    AddModule
        Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3AA
		TriggeredBy = Upgrade_DwarvenForgedBlades
	End
      End

      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced1
		TriggeredBy				= Upgrade_DwarvenForgedBlades
		AttributeModifier		= AdvancedCavalry
	End
      End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567
		TriggeredBy			= Upgrade_RohanForgedBladesForRohirrim Upgrade_TechnologyElvenHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= SuperNewRohirrimHordeCommandSet
	End 
End
End

CommandSet NewRohanPikeCommandSet
	1 	= Command_ToggleStance		
	2	= Command_RohanPorcupineFormation
	3 	= Command_CreateAHero_SpecialAbilityBladeMaster
	4	= Command_PurchaseUpgradeGondorHeavyArmor
	5 	= Command_PurchaseUpgradeGondorBasicTraining
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

Object RohanSpearmenHorde
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36eevbb
		TriggeredBy = Upgrade_WildForgedBlades
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfhy6
		TriggeredBy				= Upgrade_WildForgedBlades
		AttributeModifier		= SuperSword
	End
      End

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36eehu7
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf77g
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567ggg
		TriggeredBy			= Upgrade_GondorForgedBlades Upgrade_TechnologyElvenHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= NewRohanPikeCommandSet
	End 
End
AddModule
    Behavior = AutoHealBehavior ModuleTag_HealHordeMembers
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 0
		HealingDelay		= 2000
		KindOf				= INFANTRY CAVALRY
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedyt
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= YesHeal
	End
      End
End

;ChildObject DwarvenGuardian GondorFighter
;End

CommandSet NewGondorFarmCommandSet
	1	= Command_CreateAHero_EarthShaker_Level2
        2       = Command_CreateAHero_Bombard_Level2
        3       = Command_PurchaseUpgradeDwarvenMithrilMail
	6	= Command_Sell
End

Object GondorFarm 
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= GBFarm.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
;AddModule
	;Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower66699
		;TriggeredBy		= Upgrade_TechnologyElvenBasicTraining
		;UpgradeTexture	= GBFarm.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	;End
;End

;AddModule
	;Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666999
		;TriggeredBy		= Upgrade_TechnologyElvenSilverthornArrows
		;UpgradeTexture	= GBFarm.tga 0 MMDStoneA.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	;End
;End

      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End
CommandSet = NewGondorFarmCommandSet

AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroEarthShakerEnabler_Level2
	SpecialPowerTemplate = SpecialAbilityCreateAHeroEarthShaker_Level2
	TriggeredBy = Upgrade_StructureLevel2
End
End
AddModule
Behavior = SpecialPowerModule ModuleTag_CreateAHeroEarthShakerStarter_Level2
	SpecialPowerTemplate      = SpecialAbilityCreateAHeroEarthShaker_Level2
	UpdateModuleStartsAttack  = Yes
	StartsPaused		  	  = Yes
End
End
AddModule
Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_CreateAHeroEarthShakerUpdate_Level2
	SpecialPowerTemplate    = SpecialAbilityCreateAHeroEarthShaker_Level2
	SpecialWeapon			= CreateAHeroEarthShaker_Level2
	WhichSpecialWeapon		= 3			; Corresponds to SPECIAL_WEAPON_THREE
	StartAbilityRange		= 1.0
	
	SkipContinue			= Yes
	UnpackTime				= 2000		; Trigger on frame 60 (of 100)
	PackTime				= 1333		; Remaining 40 frames (of 100)
	MustFinishAbility		= Yes
End
End

AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroBombard_Level2
	SpecialPowerTemplate = SpecialAbilityCreateAHeroBombard_Level2
	TriggeredBy = Upgrade_StructureLevel3
End
End
AddModule
Behavior = OCLSpecialPower ModuleTag_CreateAHeroBombardPower_Level2
	SpecialPowerTemplate = SpecialAbilityCreateAHeroBombard_Level2
	OCL                  = OCL_CreateAHeroBombardSeed_Level2
	CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
	NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
	StartsPaused		 = Yes
End
End
AddModule
Behavior = SpecialPowerModule ModuleTag_CreateAHeroBombardStarter_Level2
	SpecialPowerTemplate		= SpecialAbilityCreateAHeroBombard_Level2
	UpdateModuleStartsAttack	= Yes
	StartsPaused			= Yes
End
End
AddModule
Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_CreateAHeroBombardUpdate_Level2
	SpecialPowerTemplate    = SpecialAbilityCreateAHeroBombard_Level2
	WhichSpecialWeapon		= 4							; use MODELCONDITION_SPECIAL_WEAPON_FOUR
	SkipContinue			= Yes

	UnpackTime              = 900
	PreparationTime         = 1   
	PersistentPrepTime      = 1500 
	PackTime                = 1100
	
	FreezeAfterTriggerDuration	= 2500					; make sure we can't move immediately after.

	AwardXPForTriggering    = 0		
	StartAbilityRange		= 300.0
	MustFinishAbility		= Yes
	SpecialWeapon			= CreateAHeroBombardWeapon
End
End
End
CommandSet NewMarketPlaceCommandSet
	1 = Command_PurchaseUpgradeIronOre
	2 = Command_PurchaseUpgradeGrandHarvest
	3 = Command_PurchaseUpgradeDefiance
        5 = Command_PurchaseUpgradeDwarvenMithrilMail
	6 = Command_Sell
End

CommandSet NewGondorCastleWallHubSmallCommandSet
	1 = Command_GondorCastleWallHub_BeginWallSpan
	4 = Command_CancelWallSpan
        5 = Command_PurchaseUpgradeDwarvenMithrilMail
	6 = Command_Sell
End

CommandSet NewSellableCommandSet
        5 = Command_PurchaseUpgradeDwarvenMithrilMail
	6 = Command_Sell
End

;ChildObject DwarvenGuardianHorde GondorFighterHorde
;End

Object GondorWell
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= GBWell.tga 0 IBWargPit_A.tga ;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
IsTrainable = Yes
CommandSet = NewSellableCommandSet
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End
End

Object GondorStatue
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= GUHeroStat.tga 0 IBWargPit_A.tga ;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
IsTrainable = Yes
CommandSet = NewSellableCommandSet
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End
End


Object GondorMarketPlace
ReplaceModule ModuleTag_IronOreUpgrades
	Behavior = CostModifierUpgrade ModuleTag_IronOreUpgrades5
		LabelForPalantirString	= GUI:UPGRADE_DISCOUNT
		TriggeredBy				= Upgrade_MarketplaceUpgradeIronOre
		UpgradeDiscount			= Yes
		ApplyToTheseUpgrades	= Upgrade_GondorForgedBlades Upgrade_GondorHeavyArmor Upgrade_RohanForgedBladesForRohirrim Upgrade_RohanHeavyArmorForRohirrim Upgrade_DwarvenForgedBlades Upgrade_DwarvenMithrilMail Upgrade_WildForgedBlades
		Percentage				= -95%
	End
End
    AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedZuio
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor
		AttributeModifier		= LessTime
	End
      End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	=   GBMarketPlace.tga 0 IBWargPit_A.tga ;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
	CommandSet = NewMarketPlaceCommandSet               
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End
End

CommandSet NewGenericSentryTowerCommandSet
	1 = Command_ExitGarrison
	2 = Command_ExitGarrison
	3 = Command_PurchaseSentryTowerFireArrowsUpgrade
        4 = Command_PurchaseUpgradeDwarvenMithrilMail
	6 = Command_Sell
End

;----------------------------
Object GondorKeep
    AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedZuio
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor
		AttributeModifier		= LessTime
	End
      End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= GBBtlTwr.tga 0 IBWargPit_A.tga ;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
CommandSet = NewGenericSentryTowerCommandSet
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced556
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End
End


Object MenWallHubSmall
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= GBFortress1.tga 0 IBWargPit_A.tga ;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
IsTrainable = Yes
CommandSet = NewGondorCastleWallHubSmallCommandSet
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced66
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End
End

;-------------------------------------------------------------------------------

CommandButton Command_SpellBookRainOfFire	
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyDwarvenSiegeHammer	
	NeededUpgrade		= Upgrade_GondorWorkshopLevel3 ; ;Upgrade_DwarvenForgeWorksLevel3
	TextLabel			= macigin
	ButtonImage			= BDForgeWorks_SiegeHammers	
	ButtonBorderType	= UPGRADE
	DescriptLabel		= maciginDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= maciginLack; ;
	;UnitSpecificSound	= TrollVoxFindTree
End

CommandButton Command_FiresOfDoom
	Command				= OBJECT_UPGRADE
	Options				= NEED_UPGRADE OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_DwarvenSiegeHammer
	NeededUpgrade		= Upgrade_TechnologyDwarvenSiegeHammer
	TextLabel			= uao
	ButtonImage			= BDForgeWorks_SiegeHammers	
	ButtonBorderType	= UPGRADE
	DescriptLabel		= uaoDesc
	InPalantir			= Yes
	LacksPrerequisiteLabel		= uaoLack
	;UnitSpecificSound	= TrollVoxFindTree
End

CommandSet NewGondorTrebuchetCommandSet
	1 	= Command_ToggleStance
	2 	= Command_ToggleTrebAutoAcquire
	3 	= Command_PurchaseUpgradeGondorFireStones
	4 	= Command_Bombard
       ; 5       = Command_FiresOfDoom
	13	= Command_AttackMove
	14	= Command_Stop
End

CommandSet NewGondorTrebuchetCommandSetPowered
	1 	= Command_ToggleStance
	2 	= Command_ToggleTrebAutoAcquire
	3 	= Command_FiresOfDoom
	4 	= Command_Bombard
       ; 5       = Command_FiresOfDoom
	13	= Command_AttackMove
	14	= Command_Stop
End


CommandSet NewGondorWorkshopCommandSet
	1	= Command_ConstructGondorTrebuchet
	2	= Command_PurchaseTechnologyGondorFireStones
	3	= Command_PurchaseUpgradeGondorWorkshopLevel2
        4       = Command_SpellBookRainOfFire	
        5       = Command_PurchaseUpgradeDwarvenMithrilMail
	6	= Command_Sell
End

CommandSet NewGondorWorkshopCommandSetLevel2
	1	= Command_ConstructGondorTrebuchet
	2	= Command_PurchaseTechnologyGondorFireStones
	3	= Command_PurchaseUpgradeGondorWorkshopLevel3
        4       = Command_SpellBookRainOfFire	
        5       = Command_PurchaseUpgradeDwarvenMithrilMail
	6	= Command_Sell
End

CommandSet NewGondorWorkshopCommandSetLevel3
	1	= Command_ConstructGondorTrebuchet
	2	= Command_PurchaseTechnologyGondorFireStones
        4       = Command_SpellBookRainOfFire	
        5       = Command_PurchaseUpgradeDwarvenMithrilMail
	6	= Command_Sell
End

Object GondorWorkshop
CommandSet = NewGondorWorkshopCommandSet

ReplaceModule ModueTag_WorkshopLevel2CommandSet
        Behavior = CommandSetUpgrade ModueTag_WorkshopLevel2CommandSet1
		TriggeredBy			= Upgrade_GondorWorkshopLevel2
		ConflictsWith		= Upgrade_GondorWorkshopLevel3
		CommandSet			= NewGondorWorkshopCommandSetLevel2
	End 
End  
ReplaceModule ModueTag_WorkshopLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_WorkshopLevel3CommandSet0
		TriggeredBy			= Upgrade_GondorWorkshopLevel3		
		CommandSet			= NewGondorWorkshopCommandSetLevel3
	End 
End

AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End

      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= MetalDefencebonus
	End
      End

      
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedZuio
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor
		AttributeModifier		= LessTime
	End
      End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= GBWorkshop3.tga 0 IBWargPit_A.tga ;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
     
End


Object GondorTrebuchet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567ggg
		TriggeredBy			= Upgrade_GondorFireStones
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		;RequiresAllTriggers	= Yes
		CommandSet			= NewGondorTrebuchetCommandSetPowered
	End 
End

CommandSet = NewGondorTrebuchetCommandSet
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_DwarvenSiegeHammer
	End
      End

      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenSiegeHammer
		AttributeModifier		= SuperSiege
	End
      End
End

Object GondorTrebuchetRockProjectileFlaming
AddModule
  Behavior = FireWeaponWhenDeadBehavior ModuleTag_DIELIKETHIS8
  StartsActive = No
  TriggeredBy = Upgrade_TechnologyDwarvenSiegeHammer
    DeathWeapon = RainOfFirePhaseOneWeapon
  End
  End
End

;--------------------------


Object RohanArcher
DisplayName = RohanArchers
	SelectPortrait						=	UPGondor_Archer
	ButtonImage						=	WOR_GondorArcher
	;VoiceAmbushed					  =	GondorArcherVoiceAmbushed	  	  OBSOLETE VOICE
	VoiceAttack						  =	GondorArcherVoiceAttack
	VoiceAttackAir					  =	GondorArcherVoiceAttack
	VoiceAttackCharge				  =	GondorArcherVoiceAttackCharge
	VoiceAttackMachine				  =	GondorArcherVoiceAttack	  
	VoiceAttackStructure			  =	GondorArcherVoiceAttackBuilding
	VoiceEnterStateAttack			  =	GondorArcherVoiceEnterStateAttack
	VoiceEnterStateAttackCharge		  =	GondorArcherVoiceEnterStateAttackCharge
	VoiceEnterStateAttackMachine	  =	GondorArcherVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackStructure	  =	GondorArcherVoiceEnterStateAttackBuilding
	VoiceCreated					  =	GondorArcherVoiceSalute			  
	VoiceFullyCreated				  =	GondorArcherVoiceSalute			  
	VoiceMove						  =	GondorArcherVoiceMove
	; VoiceMoveToHigherGround			  =	GondorArcherVoiceMoveToHigherGround
	VoiceMoveToCamp					  =	GondorArcherVoiceMoveCamp
	VoiceMoveWhileAttacking			  =	GondorArcherVoiceDisengage			  
	VoiceEnterStateMove				  =	GondorArcherVoiceEnterStateMove
	; VoiceEnterStateMoveToHigherGround =	GondorArcherVoiceEnterStateMoveToHigherGround
	VoiceEnterStateMoveToCamp		  =	GondorArcherVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking =	GondorArcherVoiceEnterStateDisengage  
	VoicePriority					  =	47
	VoiceRetreatToCastle			  =	GondorArcherVoiceRetreat
	VoiceEnterStateRetreatToCastle	  =	GondorArcherVoiceEnterStateRetreat
	VoiceSelect						  =	GondorArcherVoiceSelectMS
	VoiceSelectBattle				  =	GondorArcherVoiceSelectBattle
	VoiceGuard						  =	GondorArcherVoiceMove
	MinZIncreaseForVoiceMoveToHigherGround = 45

	SoundImpact				= ImpactHorse

	UnitSpecificSounds
		VoiceGarrison						= GondorArcherVoiceGarrison      
		VoiceAttackUnitWebbedHumanoidWithGondorFighterInside	= GondorArcherVoiceAttackWebbedSoldier
		VoiceAttackUnitWebbedHumanoidWithGondorArcherInside	= GondorArcherVoiceAttackWebbedSoldier
		VoiceEnterUnitElvenTransportShip	= GondorArcherVoiceMove
		VoiceInitiateCaptureBuilding		= GondorArcherVoiceMove
	End

	CrowdResponseKey = GoodMen
End

Object RohanArcherHorde
DisplayName = RohanArchers
BuildCost = 25
BuildTime = 5
End


Object GondorAragorn
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6668r5
		TriggeredBy		= Upgrade_MenFaction
		UpgradeTexture	= GUAragorn_Rotk.tga 0 GUAragorn_2Trs.tga
		UpgradeTexture	= GUAragorn_Rotk_M.tga 0 GUAragorn_2Trs.tga
		UpgradeTexture	= GUAragFel.tga 0 GUAragorn_2Trs.tga
		UpgradeTexture	= GUAragorn_2Trs.tga 0 GUAragorn_2Trs.tga			
 
	End
End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6668r5yu
		TriggeredBy		= Upgrade_TechnologyElvenHeavyArmor
		UpgradeTexture	= GUAragorn_2Trs.tga 0 GUAragorn_Rotk.tga		
 
	End
End
AddModule
	Behavior = SubObjectsUpgrade Anduril_Upgradet
		TriggeredBy		= Upgrade_TechnologyElvenHeavyArmor
		ShowSubObjects	= PLANE02
	End
End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_AndurilBonust
		TriggeredBy = Upgrade_TechnologyElvenHeavyArmor
		AttributeModifier = SpellBookAnduril
	End
End
End

Object GondorGandalf
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_GandalfWhiteBonus
		TriggeredBy = Upgrade_TechnologyElvenHeavyArmor
		AttributeModifier = SpellBookGandalfWhite
	End
End
ReplaceModule ModuleTag_TurnWhite
	Behavior = ModelConditionUpgrade ModuleTag_TurnWhite36
		TriggeredBy			= Upgrade_TechnologyElvenHeavyArmor
		AddConditionFlags	= USER_2
	End
End
End



;------------------------------------------------------------------------------------------------------------------------
;elfi
;------------------------------------------------------------------------------------------------------------------------

ExperienceLevel	ElvenMallornTreeLevel1
	TargetNames				= ElvenMallornTree
	RequiredExperience		= 1
	ExperienceAward			= ELVEN_MALLORN_TREE_LVL1_EXP_AWARD
	Rank					= 1
	Upgrades				= Upgrade_StructureLevel1
        Upgrades                                = Upgrade_AragornBladeMaster 	
        Upgrades                                = Upgrade_GlorfindelBladeOfPurity						  
End
	
ExperienceLevel	ElvenMallornTreeLevel2
	TargetNames				= ElvenMallornTree
	RequiredExperience		= ELVEN_MALLORN_TREE_LVL2_EXP_NEEDED
	ExperienceAward			= ELVEN_MALLORN_TREE_LVL2_EXP_AWARD
	Rank					= 2
	AttributeModifiers		= ElvenMallornTreeBuildSpeedModLvl2
        Upgrades                                = Upgrade_ArwenFloodTrigger
	Upgrades				= Upgrade_StructureLevel2
	LevelUpFx				= FX:ElfMallornTreeUpgrade
End
	
ExperienceLevel	ElvenMallornTreeLevel3
	TargetNames				= ElvenMallornTree
	RequiredExperience		= ELVEN_MALLORN_TREE_LVL3_EXP_NEEDED
	ExperienceAward			= ELVEN_MALLORN_TREE_LVL3_EXP_AWARD
	Rank					= 3
	AttributeModifiers		= ElvenMallornTreeBuildSpeedModLvl3 
	Upgrades				= Upgrade_StructureLevel3
        Upgrades                                = Upgrade_CreateAHeroSpawnTornado_Level1
	LevelUpFx				= FX:ElfMallornTreeUpgrade
End	

CommandSet NewElvenMallornTreeCommandSet
	1       = Command_ArwenFlood 
        2       = Command_CreateAHero_SpawnTornado_Level1
      ;  3	= nothing
       ; 4       = nothing 
	6	= Command_Sell
End


Object ElvenMallornTree
AddModule
    Behavior = AutoHealBehavior ModuleTag_HealStrreucrure
		HealOnlyIfNotInCombat	= Yes
		StartsActive		= Yes
		HealingAmount		= 500
		HealingDelay		= 2000
		KindOf				= STRUCTURE
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
		AffectsContained	= Yes
		NonStackable		= Yes
     End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedXf
		TriggeredBy				= Upgrade_TechnologyMordorBasicTraining
		AttributeModifier		= Repair
	End
      End
      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_TechnologyMordorHeavyArmor 
		AttributeModifier		= Moneymodifier
	End
      End
CommandSet = NewElvenMallornTreeCommandSet

        AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FloodEnabler
		SpecialPowerTemplate = SpecialAbilityPersonalFlood
		TriggeredBy = Upgrade_StructureLevel2
	End
	End

	AddModule
	Behavior = SpecialPowerModule ModuleTag_FloodStarter                      
		SpecialPowerTemplate		= SpecialAbilityPersonalFlood
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
		InitiateSound				= ElrondVoiceAttack
	End
	End
	
	AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FloodUpdate   
		SpecialPowerTemplate    = SpecialAbilityPersonalFlood

		UnpackTime              = 1300
		PackTime                = 1500

		StartAbilityRange = 150.0
		
		SpecialWeapon = ArwenPersonalFlood
		WhichSpecialWeapon = 1
	End
	End

        AddModule
        Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroSpawnTornadoEnabler_Level1
	SpecialPowerTemplate	= SpecialPowerCreateAHeroSpawnTornado_Level1
	TriggeredBy				= Upgrade_StructureLevel3
        End
        End

        AddModule
        Behavior = OCLSpecialPower	ModuleTag_OCLSpawnTornado_Level1
	SpecialPowerTemplate	= SpecialPowerCreateAHeroSpawnTornado_Level1
	OCL						= OCL_CreateAHeroSpawnTornado_Level1
	CreateLocation			= CREATE_AT_LOCATION
	StartsPaused			= Yes
        End
        End

     End


CommandSet NewElvenPorterCommandSet
   1  = Command_Stop
   2  = Command_PorterExtinguishFire   
   3  = Command_ConstructElvenMallornTree
   4  =	Command_ConstructElvenBarracks
   5  = Command_ConstructElvenGreenPasture
   ;6  =	Command_ConstructElvenEntMoot
  ; 7  = Command_ConstructElvenStatue
  ; 8  =	Command_ConstructElvenWatchTower
  ; 9  = Command_ConstructElvenMirrorOfGaladriel   
   10 = Command_ConstructEregionForge
  ; 11 =	Command_ConstructElvenWallHub  
   12 = Command_ConstructElvenFortress
End

CommandSet NewNewElvenPorterCommandSet
   1  = Command_Stop
   2  = Command_PorterExtinguishFire   
   3  = Command_ConstructElvenMallornTree
   4  =	Command_ConstructElvenBarracks
   5  = Command_ConstructElvenGreenPasture
   ;6  =	Command_ConstructElvenEntMoot
   7  = Command_ConstructElvenStatue
   8  =	Command_ConstructElvenWatchTower
   9  = Command_ConstructElvenMirrorOfGaladriel   
   10 = Command_ConstructEregionForge
  ; 11 =	Command_ConstructElvenWallHub  
   12 = Command_ConstructElvenFortress
End

CommandSet NewNewNewElvenPorterCommandSet
   1  = Command_Stop
   2  = Command_PorterExtinguishFire   
   3  = Command_ConstructElvenMallornTree
   4  =	Command_ConstructElvenBarracks
   5  = Command_ConstructElvenGreenPasture
   6  =	Command_ConstructElvenEntMoot
   7  = Command_ConstructElvenStatue
   8  =	Command_ConstructElvenWatchTower
   9  = Command_ConstructElvenMirrorOfGaladriel   
   10 = Command_ConstructEregionForge
   11 =	Command_ConstructElvenWallHub  
   12 = Command_ConstructElvenFortress
End

CommandButton Command_ThranduilWildWalkButton
  	Command           	= OBJECT_UPGRADE
  	Upgrade           	= Upgrade_DwarvenFortressOilCasks 
	NeededUpgrade	  = Upgrade_TechnologyGondorBasicTraining
	NeededUpgradeAny		= Yes
	Options			  = CANCELABLE NEED_UPGRADE 
  	TextLabel         	= SecondAgeelf
  	ButtonImage       	= BDFortress_OilCasks
  	ButtonBorderType  	= UPGRADE
  	DescriptLabel     	= SecondAgeelfDesc
  	Radial            	= Yes
  	InPalantir	   	= No
LacksPrerequisiteLabel  =  SecondAgeelfLack
End

CommandButton Command_SpecialAbilityElrondRestoration
  Command           = OBJECT_UPGRADE
  Upgrade           = Upgrade_DwarvenFortressDwarvenStoneworkTrigger Upgrade_ElvenFortressEaglesNest
	Upgrade           	= Upgrade_ElvenFortressEaglesNest
	NeededUpgrade	  = Upgrade_TechnologyGondorFireArrows
	;NeededUpgrade	  = Upgrade_TechnologyElvenBasicTraining
	NeededUpgradeAny		= Yes
	Options			  = CANCELABLE NEED_UPGRADE  
  TextLabel         = thirdagelf
  ButtonImage       = BDFortress_DwarvenStonework
  ButtonBorderType  = UPGRADE
  DescriptLabel     = thirdagelfDesc
  Radial            = Yes
 InPalantir	   	= No
LacksPrerequisiteLabel  =  thirdagelfLack
End

CommandSet ElvenFortressCommandSetSecondAge
	InitialVisible = 6
	//Main Menu
	1	= Command_ConstructElvenPorter
;	2	= Command_ConstructNoldorWarriorHorde				; Added for BFME2 Expansion
	2   	= Command_SelectRevivablesElvenFortress
	3	= Command_SelectUpgradesElvenFortress
	4	= Command_PurchaseNewEagle
        5       = Command_ThranduilWildWalkButton ;Command_SpecialAbilityElrondFarsight
	6	= Command_Sell
	
		//Improvements
	7       = Command_PurchaseUpgradeElvenFortressEnchantedAnvil
	8	= Command_PurchaseUpgradeElvenFortressBlessedMist
	9	= Command_PurchaseUpgradeElvenFortressCrystalMoat
	10	= Command_PurchaseUpgradeElvenFortressMysticFountains
	;11	= Command_PurchaseUpgradeElvenFortressEncasingVines
	;12	= Command_PurchaseUpgradeElvenFortressEaglesNest
	13	= Command_RadialBack
	
	//Heroes
	14	= Command_RingHeroReviveSlot
	15	= Command_CreateAHeroReviveSlot		// Note we also need an extra slot for the Create A Hero
	16	= Command_GenericReviveSlot1		//Revives any hero. Use Slot1-Slot8 and keep them UNIQUE within the same commandset! 
	17	= Command_GenericReviveSlot2	
	18	= Command_GenericReviveSlot3	
	19	= Command_GenericReviveSlot4	
	20	= Command_GenericReviveSlot5	
	21	= Command_GenericReviveSlot6	
	22	= Command_GenericReviveSlot7
	23	= Command_RadialBack			
End

CommandSet ElvenFortressCommandSetThirdAge
	InitialVisible = 6
	//Main Menu
	1	= Command_ConstructElvenPorter
;	2	= Command_ConstructNoldorWarriorHorde				; Added for BFME2 Expansion
	2   	= Command_SelectRevivablesElvenFortress
	3	= Command_SelectUpgradesElvenFortress
	4	= Command_PurchaseNewEagle
        5       = Command_SpecialAbilityElrondRestoration
	6	= Command_Sell
	
		//Improvements
	7       = Command_PurchaseUpgradeElvenFortressEnchantedAnvil
	8	= Command_PurchaseUpgradeElvenFortressBlessedMist
	9	= Command_PurchaseUpgradeElvenFortressCrystalMoat
	10	= Command_PurchaseUpgradeElvenFortressMysticFountains
	;11	= Command_PurchaseUpgradeElvenFortressEncasingVines
	;12	= Command_PurchaseUpgradeElvenFortressEaglesNest
	13	= Command_RadialBack
	
	//Heroes
	14	= Command_RingHeroReviveSlot
	15	= Command_CreateAHeroReviveSlot		// Note we also need an extra slot for the Create A Hero
	16	= Command_GenericReviveSlot1		//Revives any hero. Use Slot1-Slot8 and keep them UNIQUE within the same commandset! 
	17	= Command_GenericReviveSlot2	
	18	= Command_GenericReviveSlot3	
	19	= Command_GenericReviveSlot4	
	20	= Command_GenericReviveSlot5	
	21	= Command_GenericReviveSlot6	
	22	= Command_GenericReviveSlot7
	23	= Command_RadialBack			
End

Object ElvenPorter
CommandSet = NewElvenPorterCommandSet 
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades  ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewElvenPorterCommandSet 
	End 
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp3
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor  ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewNewElvenPorterCommandSet 
	End 
End
End

Object ElvenCitadel
RemoveModule AutoDepositModuleTag
CommandSet = ElvenFortressCommandSetSecondAge
ReplaceModule ModuleTag_PassOutEncasingVinesUpgrade
	Behavior = CastleUpgrade ModuleTag_PassOutEncasingVinesUpgrade5
		TriggeredBy			= Upgrade_DwarvenFortressOilCasks 
		Upgrade				= Upgrade_ElvenFortressEncasingVines
		WallUpgradeRadius	= ELVEN_FORTRESS_WALL_EFFECTIVE_RADIUS
	End
End
	ReplaceModule ModuleTag_Reinforced
	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced6
		TriggeredBy				= Upgrade_ElvenFortressEncasingVines
		AttributeModifier		= EncasingVines_Bonus
	End
End
ReplaceModule ModuleTag_ShowTheVines
	Behavior = ModelConditionUpgrade ModuleTag_ShowTheVines6
		TriggeredBy			= Upgrade_ElvenFortressEncasingVines		
		AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK
		Permanent			= Yes
	End
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp89
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= ElvenFortressCommandSetThirdAge
	End 
End
End

CommandButton Command_SpellBookFlood
Command				= UNIT_BUILD
	Object				= GoblinSpiderRiderHorde
	Options				= CANCELABLE NEED_UPGRADE
	TextLabel			= flooddd
	ButtonImage			= BWSpiderPit_SpiderRider
	ButtonBorderType    = BUILD 
	DescriptLabel       = floodddDesc
	NeededUpgrade		= Upgrade_ElvenGreenPastureLevel3
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount	= Yes      
LacksPrerequisiteLabel  =  floodddLack
End

CommandButton Command_SpellBookEnshroudingMist
	Command				= UNIT_BUILD
	Object				= GoblinFighterHorde
	TextLabel			= potentielfi
	ButtonImage			= BEElvenBarracks_LorienWarrior
	ButtonBorderType		= BUILD 
	DescriptLabel			= potentielfiDesc
	Radial				= Yes
	InPalantir	   		= Yes
	IsClickable			= Yes
	Options				= CANCELABLE NEED_UPGRADE 
	NeededUpgrade		= Upgrade_ElvenBarracksLevel3
	ShowProductionCount	= Yes      
LacksPrerequisiteLabel  =  potentielfiLack
End

CommandButton Command_SpecialAbilityWoundArrow
	Command				= PLAYER_UPGRADE
	Upgrade				= Upgrade_TechnologyIsengardForgedBlades 
	Options				= CANCELABLE NEED_UPGRADE
	NeededUpgrade			= Upgrade_ElvenBarracksLevel2
        NeededUpgradeAny                = Yes
	TextLabel			= lagitatalefi
	ButtonImage			= BIArmory_ForgedBlades
	ButtonBorderType		= UPGRADE
	DescriptLabel			= lagitatalefiDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= lagitatalefiLack
End

;--------------------------------
;--Strutture elfiche---
;-------------------------------

CommandSet NewERElvenBarracksCommandSet
  	1 	= Command_ConstructElvenLorienWarriorHorde
  	2 	= Command_ConstructElvenLorienArcherHorde
  	3 	= Command_ConstructElvenMithlondSentryHorde
  	4 	= Command_ConstructElvenMirkwoodArcherHorde
 	5 	= Command_ConstructNoldorWarriorHorde
  	;7 	= Command_PurchaseUpgradeElvenBarracksLevel2
  	6 	= Command_Sell
        8       = Command_SpecialAbilityTerribleFury
        9       = Command_SpellBookEnshroudingMist
        10      = Command_SpecialAbilityWoundArrow
End

CommandSet NewElvenBarracksCommandSetLevel2-
  	1 	= Command_ConstructElvenLorienWarriorHorde
  	2 	= Command_ConstructElvenLorienArcherHorde
  	3 	= Command_ConstructElvenMithlondSentryHorde
  	4 	= Command_ConstructElvenMirkwoodArcherHorde
  	5 	= Command_ConstructNoldorWarriorHorde
  	7 	= Command_PurchaseUpgradeElvenBarracksLevel2
  	6 	= Command_Sell
        8       = Command_SpecialAbilityTerribleFury
        9       = Command_SpellBookEnshroudingMist
        10      = Command_SpecialAbilityWoundArrow
End

CommandSet NewElvenBarracksCommandSetLevel2
  	1 	= Command_ConstructElvenLorienWarriorHorde
  	2 	= Command_ConstructElvenLorienArcherHorde
  	3 	= Command_ConstructElvenMithlondSentryHorde
  	4 	= Command_ConstructElvenMirkwoodArcherHorde
  	5 	= Command_ConstructNoldorWarriorHorde
  	;7 	= Command_PurchaseUpgradeElvenBarracksLevel3
  	6 	= Command_Sell
        8       = Command_SpecialAbilityTerribleFury
        9       = Command_SpellBookEnshroudingMist
        10      = Command_SpecialAbilityWoundArrow
End

CommandSet NewElvenBarracksCommandSetLevel3-
  	1 	= Command_ConstructElvenLorienWarriorHorde
  	2 	= Command_ConstructElvenLorienArcherHorde
  	3 	= Command_ConstructElvenMithlondSentryHorde
  	4 	= Command_ConstructElvenMirkwoodArcherHorde
  	5 	= Command_ConstructNoldorWarriorHorde
  	6 	= Command_Sell
  	7 	= Command_PurchaseUpgradeElvenBarracksLevel3
        8       = Command_SpecialAbilityTerribleFury
        9       = Command_SpellBookEnshroudingMist
        10      = Command_SpecialAbilityWoundArrow
End

CommandSet NewElvenBarracksCommandSetLevel3
  	1 	= Command_ConstructElvenLorienWarriorHorde
  	2 	= Command_ConstructElvenLorienArcherHorde
  	3 	= Command_ConstructElvenMithlondSentryHorde
  	4 	= Command_ConstructElvenMirkwoodArcherHorde
  	5 	= Command_ConstructNoldorWarriorHorde
  	6 	= Command_Sell
  	;7 	= Command_PurchaseUpgradeElvenBarracksLevel3
        8       = Command_SpecialAbilityTerribleFury
        9       = Command_SpellBookEnshroudingMist
        10      = Command_SpecialAbilityWoundArrow
End

Object ElvenBarracks
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedXf
		TriggeredBy				= Upgrade_TechnologyMordorBasicTraining
		AttributeModifier		= Repair
	End
      End

CommandSet = NewERElvenBarracksCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewElvenBarracksCommandSetLevel2-
	End 
End
ReplaceModule ModueTag_ElvenBarracksLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_BarracksLevel2CommandSet1
		TriggeredBy			= Upgrade_ElvenBarracksLevel2
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewElvenBarracksCommandSetLevel2
	End   
End

ReplaceModule ModueTag_ElvenBarracksLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_ThirdAgeUp3
		TriggeredBy			= Upgrade_ElvenBarracksLevel3 
		CommandSet			= NewElvenBarracksCommandSetLevel3
	End
End

AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp57
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewElvenBarracksCommandSetLevel3-
	End 
End
End


CommandButton Command_RohanEomerHorseLordLeadership
	Command           = PLAYER_UPGRADE
	Upgrade           = Upgrade_WildSpiderVenomSackScience
	Options			  = CANCELABLE ;NEED_UPGRADE
	TextLabel         = elficavalieri
	ButtonImage       = BWSpiderPit_VenomSacks
	ButtonBorderType  = UPGRADE
	DescriptLabel     = CONTROLBAR:ToolTipPurchaseTechnologySpiderVenomSacks0
	NeededUpgrade	  = Upgrade_ElvenGreenPastureLevel3
	Radial            = Yes
	InPalantir	      = Yes
	;LacksPrerequisiteLabel		= TOOLTIP:LackVenomSacks0
	UnitSpecificSound	= TrollVoxFindTree
End

;-------
;---Pastura verde
;-------


CommandSet NewElvenGreenPastureCommandSet
  	1 	= Command_ConstructElvenRivendellLancers
  	2 	= Command_ConstructElvenRivendellArchers
  	;3 	= Command_ConstructElvenGreenPastureLevel2
        4       = Command_SpellBookFlood
  	6 	= Command_Sell
        7       = Command_RohanEomerHorseLordLeadership
End

CommandSet NewElvenGreenPastureCommandSet2-
  	1 	= Command_ConstructElvenRivendellLancers
  	2 	= Command_ConstructElvenRivendellArchers
  	3 	= Command_ConstructElvenGreenPastureLevel2
        4       = Command_SpellBookFlood
  	6 	= Command_Sell
        7       = Command_RohanEomerHorseLordLeadership
End

CommandSet NewElvenGreenPastureCommandSetLevel2
  	1 	= Command_ConstructElvenRivendellLancers
  	2 	= Command_ConstructElvenRivendellArchers
  	;3 	= Command_ConstructElvenGreenPastureLevel3
        4       = Command_SpellBookFlood
  	6 	= Command_Sell
        7       = Command_RohanEomerHorseLordLeadership
End

CommandSet NewElvenGreenPastureCommandSetLevel3-
  	1 	= Command_ConstructElvenRivendellLancers
  	2 	= Command_ConstructElvenRivendellArchers
  	3 	= Command_ConstructElvenGreenPastureLevel3
        4       = Command_SpellBookFlood
  	6 	= Command_Sell
        7       = Command_RohanEomerHorseLordLeadership
End

CommandSet NewElvenGreenPastureCommandSetLevel3
  	1 	= Command_ConstructElvenRivendellLancers
  	2 	= Command_ConstructElvenRivendellArchers
        4       = Command_SpellBookFlood
  	6 	= Command_Sell
        7       = Command_RohanEomerHorseLordLeadership
End

Object ElvenGreenPasture
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedXf
		TriggeredBy				= Upgrade_TechnologyMordorBasicTraining
		AttributeModifier		= Repair
	End
      End
CommandSet		= NewElvenGreenPastureCommandSet

ReplaceModule ModueTag_ElvenGreenPastureLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_ElvenGreenPastureLevel2CommandSet7
	TriggeredBy      = Upgrade_ElvenGreenPastureLevel2
	;ConflictsWith    = Upgrade_ElvenGreenPastureLevel3
	CommandSet       = NewElvenGreenPastureCommandSetLevel2
	End
End

	ReplaceModule ModueTag_ElvenGreenPastureLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_ElvenGreenPastureLevel3CommandSet7
	TriggeredBy      = Upgrade_ElvenGreenPastureLevel3
	CommandSet       = NewElvenGreenPastureCommandSetLevel3
	End
End

AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewElvenGreenPastureCommandSet2-
	End 
End

AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp588
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewElvenGreenPastureCommandSetLevel3-
	End 
End
End

Object EregionForge
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedXf
		TriggeredBy				= Upgrade_TechnologyMordorBasicTraining
		AttributeModifier		= Repair
	End
      End
  CommandSet          = NewEregionForgeCommandSet
ReplaceModule ModueTag_CaveLevel2CommandSet
  Behavior = CommandSetUpgrade ModueTag_CaveLevel2CommandSet5
		TriggeredBy      = Upgrade_EregionForgeLevel2
		;ConflictsWith    = Upgrade_EregionForgeLevel3
		CommandSet       = NewEregionForgeCommandSetLevel2
  End
End
ReplaceModule ModueTag_CaveLevel3CommandSet	
  Behavior = CommandSetUpgrade ModueTag_CaveLevel3CommandSet6
		TriggeredBy      = Upgrade_EregionForgeLevel3
		CommandSet       = NewEregionForgeCommandSetLevel3
  End
End

AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp588
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewEregionForgeCommandSetLevel2-
	End 
End

AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5888
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewEregionForgeCommandSetLevel3-
	End 
End
End ;CommandSet =

CommandSet NewElvenMithlondSentryHordeCommandSet
	1 	= Command_ToggleStance
	2 	= Command_MithlondSentryPorcupineFormation
	;2 	= Command_MithlondSentryZephyrStrike
	3 	= Command_PurchaseUpgradeElvenForgedBlades	
	4 	= Command_CreateAHero_EowynShieldMaiden
	5 	= Command_PurchaseUpgradeElvenBasicTraining
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End


;------------------------

Object ElvenMithlondSentry 

	ArmorSet
		Conditions      	= None
		Armor           	= PikemenArmor
		DamageFX        	= NormalDamageFX
	End
	ArmorSet
			Conditions      = PLAYER_UPGRADE
			Armor           = PikemenHeavyArmor
			DamageFX        = NormalDamageFX	
	End
	ArmorSet
			Conditions      = PLAYER_UPGRADE PLAYER_UPGRADE_2
			Armor           = PikemenHeavyArmorSuperShield
			DamageFX        = NormalDamageFX	
	End
AddModule
	Behavior = ArmorUpgrade ArmorUpgradeModuleTag789
		TriggeredBy				= Upgrade_WildHeavyArmor
		ArmorSetFlag			= PLAYER_UPGRADE_2
	End
End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf66766
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_ElfFaction
		UpgradeTexture	= EUMthlnd_C.tga 0 EUGlrfdl.tga
		UpgradeTexture	= EUMthlnd.tga 0 EUGlrfdl.tga
		UpgradeTexture	= EUGlrfdl.tga 0 EUGlrfdl.tga
	End
End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6668
		TriggeredBy		= Upgrade_TechnologyGondorForgedBlades
		UpgradeTexture	= EUGlrfdl.tga 0 EUMthlndB_C.tga
		UpgradeTexture	= EUMthlnd.tga 0 EUMthlndB_C.tga 
		UpgradeTexture	= EUMthlnd_C.tga 0 EUMthlndB_C.tga
	End
End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6667
		TriggeredBy		= Upgrade_TechnologyGondorHeavyArmor
		UpgradeTexture	= EUMthlndB_C.tga 0 EUMthlnd.tga
		UpgradeTexture	= EUMthlnd.tga 0 EUMthlnd.tga
	End
End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades
		AttributeModifier		= SecondAgeBonus
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		AttributeModifier		= ThirdAgeBonus
	End
End
End

Object ElvenMithlondSentryHorde
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp45674e
		TriggeredBy			= Upgrade_ElvenHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= NewElvenMithlondSentryHordeCommandSet
	End 
End
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee778
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf66766
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades
		AttributeModifier		= SecondAgeBonus
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		AttributeModifier		= ThirdAgeBonus
	End
End
End

CommandSet NewElvenLorienWarriorHordeCommandSet
	1	= Command_ToggleStance	
	2 	= Command_PurchaseUpgradeElvenForgedBlades	
	3 	= Command_CreateAHero_EowynShieldMaiden
	4 	= Command_PurchaseUpgradeElvenBasicTraining	
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

;-------------------------

Object ElvenLorienWarrior  
	ArmorSet
		Conditions     	 	= None
		Armor           	= LorienWarriorArmor
		DamageFX        	= NormalDamageFX
	End

	ArmorSet
		Conditions      	= PLAYER_UPGRADE
		Armor          		= LorienWarriorHeavyArmor
		DamageFX        	= NormalDamageFX
	End
	ArmorSet
		Conditions      	= PLAYER_UPGRADE PLAYER_UPGRADE_2
		Armor          		= LorienWarriorHeavyArmorSuperShield
		DamageFX        	= NormalDamageFX
	End
AddModule
	Behavior = ArmorUpgrade ArmorUpgradeModuleTag789
		TriggeredBy				= Upgrade_WildHeavyArmor
		ArmorSetFlag			= PLAYER_UPGRADE_2
	End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf66766
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End        
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_ElfFaction
		UpgradeTexture	= EUlorienwarrior.tga 0 EUCelebn_C.tga
		UpgradeTexture	= EUCelebn_C.tga 0 EUCelebn_C.tga
	End
End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6668
		TriggeredBy		= Upgrade_TechnologyGondorForgedBlades
		UpgradeTexture	= EUlorienwarrior.tga 0 EULorArch.tga
		UpgradeTexture	= EUCelebn_C.tga 0 EULorArch.tga
	End
End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6668r5
		TriggeredBy		= Upgrade_TechnologyGondorHeavyArmor
		UpgradeTexture	= EUlorienwarrior.tga 0 EUlorienwarrior.tga
		UpgradeTexture	= EULorArch.tga 0 EUlorienwarrior.tga
	End
End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades
		AttributeModifier		= SecondAgeBonus
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		AttributeModifier		= ThirdAgeBonus
	End
End
End

Object ElvenLorienWarriorHorde
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp45674e
		TriggeredBy			= Upgrade_ElvenHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= NewElvenLorienWarriorHordeCommandSet
	End 
End
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee778
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf66766
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades
		AttributeModifier		= SecondAgeBonus
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		AttributeModifier		= ThirdAgeBonus
	End
End
End

CommandSet NewElvenMirkwoodArcherHordeCommandSet
	1	= Command_ToggleStance
	2	= Command_CreateAHero_Blink
	3	= Command_SpecialAbilityElfCloak
	4	= Command_PurchaseUpgradeElvenSilverthornArrows
	5 	= Command_PurchaseUpgradeElvenBasicTraining
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandSet NewElvenMirkwoodArcherHordeCommandSet2
	1	= Command_ToggleStance
	2	= Command_CreateAHero_Blink
	3	= Command_SpecialAbilityElfCloak
	4	= Command_HaldirGoldenArrow
	5 	= Command_PurchaseUpgradeElvenBasicTraining
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandSet NewElvenLorienArcherHordeCommandSet
	1 	= Command_ToggleStance	
	2	= Command_ArcherBombard
	3 	= Command_PurchaseUpgradeElvenHeavyArmor
	4 	= Command_HaldirGoldenArrow
	5 	= Command_PurchaseUpgradeElvenBasicTraining	
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End
;--------------------------


Object ElvenLorienArcher       // Command_HaldirGoldenArrow

AddModule
	Behavior = ArmorUpgrade ArmorUpgradeModuleTag789
		TriggeredBy				= Upgrade_WildHeavyArmor
		ArmorSetFlag			= PLAYER_UPGRADE_2
	End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf66766
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
	WeaponSet
		Conditions = None 
		Weapon 			= PRIMARY    LorienElvenBow
		Weapon 			= TERTIARY   LorienElvenBowBombard
		AutoChooseSources 	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources 	= TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End
	WeaponSet
		Conditions = SPECIAL_ONE
		Weapon = PRIMARY	HaldirGoldenArrow
		Weapon = TERTIARY   MirkwoodArcherSilverthornBowBombard
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End
AddModule
	Behavior = WeaponSetUpgrade ModuleTag_WeaponLevel26
			TriggeredBy	= Upgrade_DwarvenFlamingShot
			WeaponCondition = SPECIAL_ONE
	End
End

AddModule
	Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTagMirkwoodArcher6
		TriggeredBy = Upgrade_DwarvenFlamingShot
	End
End
;-------------
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567ggg56
		TriggeredBy			= Upgrade_ElfFaction; Upgrade_ElvenSilverthornArrows
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		;RequiresAllTriggers	= Yes
		CommandSet			= NewElvenLorienArcherHordeCommandSet
	End 
End
;----------
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedFA
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades
		AttributeModifier		= SuperArcherMen
		;RefreshDelay		= 2000	; 2 secs
	End
      End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_ElfFaction
		UpgradeTexture	= EULorArch.tga 0 EUCelebn_C.tga
		UpgradeTexture	= EUCelebn_C.tga 0 EUCelebn_C.tga
	End
End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6668
		TriggeredBy		= Upgrade_TechnologyGondorForgedBlades
		UpgradeTexture	= EULorArch.tga 0 EUlorienwarrior.tga
		UpgradeTexture	= EUCelebn_C.tga 0 EUlorienwarrior.tga
	End
End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6668r5
		TriggeredBy		= Upgrade_TechnologyGondorHeavyArmor
		UpgradeTexture	= EUlorienwarrior.tga 0 EULorArch.tga
		UpgradeTexture	= EULorArch.tga 0 EULorArch.tga
	End
End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades
		AttributeModifier		= SecondAgeBonusArcher
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		AttributeModifier		= ThirdAgeBonusArcher
	End
End
End

Object ElvenLorienArcherHorde
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee778
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf66766
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
AddModule
	Behavior = WeaponSetUpgrade ModuleTag_WeaponLevel26
			TriggeredBy	= Upgrade_DwarvenFlamingShot
			WeaponCondition = SPECIAL_ONE
	End
End
;CommandSet = NewElvenLorienArcherHordeCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567ggg56
		TriggeredBy			= Upgrade_ElvenSilverthornArrows
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		;RequiresAllTriggers	= Yes
		CommandSet			= NewElvenLorienArcherHordeCommandSet
	End 
End
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality666
		TriggeredBy = Upgrade_DwarvenFlamingShot
	End
      End

      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced666
		TriggeredBy				= Upgrade_DwarvenFlamingShot
		AttributeModifier		= GoldenArrow
	End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedFA
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades
		AttributeModifier		= SuperArcherMen
		;RefreshDelay		= 2000	; 2 secs
	End
      End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades
		AttributeModifier		= SecondAgeBonusArcher
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		AttributeModifier		= ThirdAgeBonusArcher
	End
End
End

;----------------------

Object ElvenRivendellLancer
	ArmorSet
		Conditions      = None
		Armor           = RivendellLancerArmor
		DamageFX        = NormalDamageFX
	End
	ArmorSet
		Conditions      = PLAYER_UPGRADE
		Armor           = RivendellLancerHeavyArmor
		DamageFX        = NormalDamageFX	
	End
	ArmorSet
		Conditions      = PLAYER_UPGRADE PLAYER_UPGRADE_2
		Armor           = RivendellLancerHeavyArmorSuperShield
		DamageFX        = NormalDamageFX	
	End
AddModule
	Behavior = ArmorUpgrade ArmorUpgradeModuleTag789
		TriggeredBy				= Upgrade_WildHeavyArmor
		ArmorSetFlag			= PLAYER_UPGRADE_2
	End
End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf66766
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced1
		TriggeredBy				= Upgrade_WildSpiderVenomSackScience
		AttributeModifier		= BetterCavalry
	End
      End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_ElfFaction
		UpgradeTexture	= EURivenLan01.tga 0 EURivenLan_C.tga
		UpgradeTexture	= EURivenLan_C.tga 0 EURivenLan_C.tga
                UpgradeTexture  = ElderHorse.tga 0 CUHorse_BnA.tga 
	End
End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6668
		TriggeredBy		= Upgrade_TechnologyGondorForgedBlades
		;UpgradeTexture	= EURivenLan_C.tga 0 EURivenLan01.tga
		;UpgradeTexture	= EURivenLan01.tga 0 EURivenLan01.tga
                UpgradeTexture  = CUHorse_BnA.tga 0 EUHorse01.tga
	End
End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower6668r5
		TriggeredBy		= Upgrade_TechnologyGondorHeavyArmor
		UpgradeTexture	= EUHorse01.tga 0 ElderHorse.tga
	End
End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades
		AttributeModifier		= SecondAgeBonus
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		AttributeModifier		= ThirdAgeBonus
	End
End
End

CommandSet NewElvenRivendellLancerHordeCommandSet
	1	= Command_ToggleStance
	2	= Command_CreateAHero_EowynShieldMaiden
	3	= Command_PurchaseUpgradeElvenForgedBlades		
	4	= Command_PurchaseUpgradeElvenBasicTraining
	12 	= Command_CaptureBuilding	
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

Object ElvenRivendellLancerHorde
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp45674e
		TriggeredBy			= Upgrade_ElvenHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		RequiresAllTriggers	= Yes
		CommandSet			= NewElvenRivendellLancerHordeCommandSet
	End 
End
AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality36ee778
		TriggeredBy = Upgrade_WildHeavyArmor
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf66766
		TriggeredBy				= Upgrade_WildHeavyArmor
		AttributeModifier		= SuperShield
	End
      End
AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedSecondAge
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades
		AttributeModifier		= SecondAgeBonus
	End
End

AddModule
	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedThirdAge
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		AttributeModifier		= ThirdAgeBonus
	End
End
End

;------------
;some structure
;-------------

;CommandSet NewERElvenBarracksCommandSet
  	;1 	= Command_ConstructElvenLorienWarriorHorde
  	;2 	= Command_ConstructElvenLorienArcherHorde
  	;3 	= Command_ConstructElvenMithlondSentryHorde
  	;4 	= Command_ConstructElvenMirkwoodArcherHorde; Command_ConstructRohanElvenWarriorHorde
 	;5 	= Command_ConstructNoldorWarriorHorde
  	;7 	= Command_PurchaseUpgradeElvenBarracksLevel2
  	;6 	= Command_Sell
;End

;CommandSet NewElvenBarracksCommandSetLevel2
  	;1 	= Command_ConstructElvenLorienWarriorHorde
  	;2 	= Command_ConstructElvenLorienArcherHorde
  	;3 	= Command_ConstructElvenMithlondSentryHorde
  	;4 	= Command_ConstructElvenMirkwoodArcherHorde; Command_ConstructRohanElvenWarriorHorde
  	;5 	= Command_ConstructNoldorWarriorHorde
  	;7 	= Command_PurchaseUpgradeElvenBarracksLevel3
  	;6 	= Command_Sell
;End

;CommandSet NewElvenBarracksCommandSetLevel3
  	;1 	= Command_ConstructElvenLorienWarriorHorde
  	;2 	= Command_ConstructElvenLorienArcherHorde
  	;3 	= Command_ConstructElvenMithlondSentryHorde
  	;4 	= Command_ConstructElvenMirkwoodArcherHorde; Command_ConstructRohanElvenWarriorHorde
  	;5 	= Command_ConstructNoldorWarriorHorde
  	;6 	= Command_Sell
  	;7 	= Command_ConstructElvenImladrisWarriorHorde
;  	8 	= 
;End

;Object ElvenBarracks
 ;CommandSet = NewERElvenBarracksCommandSet
;ReplaceModule ModueTag_ElvenBarracksLevel2CommandSet
	;Behavior = CommandSetUpgrade ModueTag_ElvenBarracksLevel2CommandSet5
		;TriggeredBy      = Upgrade_ElvenBarracksLevel2
		;ConflictsWith    = Upgrade_ElvenBarracksLevel3
		;CommandSet       = NewElvenBarracksCommandSetLevel2
	;End
	;End
;ReplaceModule ModueTag_ElvenBarracksLevel3CommandSet
	;Behavior = CommandSetUpgrade ModueTag_ElvenBarracksLevel3CommandSet55
	;	TriggeredBy      = Upgrade_ElvenBarracksLevel3
		;CommandSet       = NewElvenBarracksCommandSetLevel3
	;End
;End
;End

;------------------------------------------------------------------------------
Weapon BalrogCrush0  ; Used when the FloodCavalry crush an enemy.
  LeechRangeWeapon      = Yes
  AttackRange           = 9999999.0
  MeleeWeapon           = No
  DelayBetweenShots     = 0            ; time between shots, msec
  PreAttackDelay        = 0 ;PreAttackDelay+FiringDuration = UseWeaponTiming = Yes duration
  PreAttackType         = PER_SHOT 
  FiringDuration        = 0 ;
  FireFX				= FX_GenericCrushImpactSound

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        = 500 ;A whole lot of damage.
    DamageScalar  		= 0% NONE +STRUCTURE
    Radius        = 0.0
    DelayTime     = 0
    DamageType    = CRUSH
    DeathType     = CRUSHED
  End
DamageNugget                        ; A basic Nugget that just does damage
		Damage        = 500
                DamageScalar  		= 0% ANY +STRUCTURE
		DamageArc 		= 0
		Radius			= 0.0
		DamageType    = CRUSH
		DeathType     = CRUSHED
		DamageSpeed		= 500.0 ; must match the ShockWaveSpeed below
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
		HeroResist			= 2.00
		ShockWaveAmount   = 0.0
		ShockWaveArc	  = 0
		ShockWaveRadius   = 0.0
		ShockWaveTaperOff = 1.25
		ShockWaveZMult    = 0.7
		ShockWaveSpeed	  = 500.0
	End
End

;------------------------------------------------------------------------------
Weapon FloodHorseRadiusWeapon2 ; Shot out every DelayBetweenShots
	RadiusDamageAffects = ENEMIES NOT_SIMILAR
	LeechRangeWeapon      = Yes
	AttackRange           = 9999999.0
	MeleeWeapon           = No
	DelayBetweenShots     = 0            ; time between shots, msec
	PreAttackDelay        = 0 ;PreAttackDelay+FiringDuration = UseWeaponTiming = Yes duration
	PreAttackType         = PER_SHOT 
	FiringDuration        = 0 

	DamageNugget                  ; A basic Nugget that just does damage
		Damage        = 1000; A whole lot of damage.
		DamageScalar  = 1% NONE +STRUCTURE
		Radius        = 0.0
		DelayTime     = 0
		DamageType    = CRUSH
		DamageFXType  = FLOOD_HORSE
		DeathType     = CRUSHED
	End

	FireLogicNugget
		LogicType		= DECREASE_BURN_RATE
		Radius			= ARWEN_FLOOD_DECREASEBURNRATE_RADIUS
		Damage			= ARWEN_FLOOD_DECREASEBURNRATE_AMOUNT
		DelayTime		= 200  
	End
	
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .75
		ShockWaveAmount   = 0.0
		; ShockWaveArc	  = 0
		ShockWaveRadius   = 0.0
		ShockWaveTaperOff = 0.75
		ShockWaveZMult    = 1.000
		ShockWaveSpeed	  = 700.0 
	End
End

CommandSet SuperElvenRivendellLancerCommandSet
	1	= Command_ToggleStance
	12 	= Command_CaptureBuilding	
	13	= Command_AttackMove
	14	= Command_Stop
End

Armor FloodArmor
  Armor = DEFAULT          25%   
  Armor = SLASH            25%   
  Armor = PIERCE           25%   ; ; 25; ; 20
  Armor = SPECIALIST       50%   ; ; 25; ; 60
  Armor = CRUSH             25%    ; ; 1
  Armor = CAVALRY	   25% 
  Armor = SIEGE            25%   
  Armor = FLAME            1%   ; ; 25; ; 40
  Armor = MAGIC           50%   ; ; 100; ; 50
  Armor = HERO            50%   ;; ; 50
  Armor = POISON	   50% 
  Armor = STRUCTURAL	  100%; ; 50
  	
 ;FlankedPenalty 	 = 50%    
  Armor = CAVALRY_RANGED   20% ; ;
End

ChildObject GoblinSpiderRider FloodHorse
DisplayName	= FloodCavalry
ReplaceModule ModuleTag_WeaponFiring
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring5
		FireWeaponNugget
			WeaponName = FloodHorseRadiusWeapon2
			Offset = X:-25 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
End
Side				= Elves
	EditorSorting		= UNIT
	ThreatLevel			= 1.0
	TransportSlotCount	= TRANSPORTSLOTCOUNT_UNIT

	; Weapon Sets
	WeaponSet
		Conditions			= None 
		Weapon				= PRIMARY ElvenRivendellLancerLance
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End

	ArmorSet
		Conditions      = None
		Armor           = FloodArmor
		DamageFX        = NormalDamageFX
	End

	BountyValue			= ELVEN_RIVENDELLLANCER_BOUNTY_VALUE
	VisionRange			= ELVEN_RIVENDELLLANCER_VISION_RANGE 			
	ShroudClearingRange 		= SHROUD_CLEAR_STANDARD
	
	VisionSide = 35%
	VisionRear = 25%
	
	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 2.0%
	CommandSet			= SuperElvenRivendellLancerCommandSet
	CommandPoints		= 15 ; ;6
	SelectPortrait		= SP_Gondor_Horsemanr
	CrushableLevel		= 3  ; ; 1;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel		= 4
	;CrushWeapon			= BalrogCrush0  



	MinCrushVelocityPercent		= 0 ; ;40 ; Has to be moving at at least this % of full speed.
	CrushDecelerationPercent	= 0 ; ;20 ; Lose this % of max velocity when crushing.

	CrushKnockback	= 60;
	CrushZFactor	= 1.5;

	; *** AUDIO Parameters ***

	VoiceAttack								= ElfGreenPastureSelect;ElfLancerVoiceAttack
	VoiceAttackCharge						= ElfGreenPastureSelect; ElfLancerVoiceAttackCharge
	VoiceAttackStructure 					= ElfGreenPastureSelect; ElfLancerVoiceAttackBuilding
 	VoiceAttackMachine						= ElfGreenPastureSelect; ElfLancerVoiceAttack
	VoiceCreated							= ElfGreenPastureSelect; ElfLancerVoiceSalute
	VoiceFullyCreated						= ElfGreenPastureSelect; ElfLancerVoiceSalute
	VoiceGuard								= ElfGreenPastureSelect; ElfLancerVoiceMove
	VoiceMove								= ElfGreenPastureSelect; ElfLancerVoiceMove
	VoiceMoveToCamp 						= BuildingGoodVoiceSelectUnderConstruction; ElfLancerVoiceMoveCamp
	VoiceMoveWhileAttacking					= ElfGreenPastureSelect; ElfLancerVoiceDisengage
	VoicePriority							= 53	
	VoiceRetreatToCastle 					= ElfGreenPastureSelect; ElfLancerVoiceMoveRetreat
	VoiceSelect								= BuildingGoodVoiceSelectUnderConstruction; ElfLancerVoiceSelectMS
	VoiceSelectBattle						= BuildingGoodVoiceSelectUnderConstruction; ElfLancerVoiceSelectBattle

	SoundCrushing							= RohirrimCrushing 		;Sound made when crushing another unit underhoof
	SoundImpact 							= ImpactHorse
        SoundMoveStart 							= GondorHorseMoveStart
	
	VoiceEnterStateAttack 					= ElfGreenPastureSelect; ElfLancerVoiceEnterStateAttack
	VoiceEnterStateAttackCharge 			= ElfGreenPastureSelect; ElfLancerVoiceEnterStateAttackCharge
	VoiceEnterStateAttackStructure	 		= ElfGreenPastureSelect; ElfLancerVoiceEnterStateAttackBuilding
	VoiceEnterStateAttackMachine 			= ElfGreenPastureSelect; ElfLancerVoiceEnterStateAttackBuilding
	VoiceEnterStateMove 					= BuildingGoodVoiceSelectUnderConstruction; ElfLancerVoiceEnterStateMove
	VoiceEnterStateMoveToCamp 				= BuildingGoodVoiceSelectUnderConstruction; ElfLancerVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking		= ElfGreenPastureSelect; ElfLancerVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle	 		= ElfGreenPastureSelect; ElfLancerVoiceEnterStateMoveRetreat

	UnitSpecificSounds
		VoiceEnterUnitElvenTransportShip	= ElfGreenPastureSelect; ElfLancerVoiceMoveShip
		VoiceGarrison						= ElfGreenPastureSelect; ElfLancerVoiceMove
		VoiceInitiateCaptureBuilding		= ElfGreenPastureSelect; ElfLancerVoiceCaptureBuilding
	End

	;CrowdResponseKey = Elf
 

	;ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
	;	ModelCondition = Required:EMOTION_CELEBRATING	Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxCheerSinglesLoop	;MOVING ATTACKING 
	;	ModelCondition = Required:EMOTION_TAUNTING		Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxTauntSinglesLoop	;MOVING ATTACKING
	;	ModelCondition = Required:EMOTION_POINTING		Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxTauntSinglesLoop
	;	ModelCondition = Required:RAISING_FLAG			Excluded:DYING ENGAGED	Sound:EmotionElfCompilationVoxTauntSinglesLoop
	;End
;

;ReplaceModule ModuleTag_AnimAudioBehavior
	;ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior0
		;MaxUpdateRangeCap = 800
		;AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_ACCL	Frames: 8 30
		;AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_RUNA	Frames: 0
		;AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_RUNB	Frames: 0
		;AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_RUNC	Frames: 0
		;AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_TNL1	Frames: 0
		;AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_TNR1	Frames: 0
		;AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_TRNL	Frames: 0
		;AnimationSound = Sound: HorseMoveFootstepsLoose		Animation: RURohrm_SKL.RURohrm_TRNR	Frames: 0
		;AnimationSound = Sound: HorseWhinny			Animation: RURohrm_SKL.RURohrm_CHRB	Frames: 8
		;AnimationSound = Sound: HorseWhinny			Animation: RURohrm_SKL.RURohrm_CHRC	Frames: 15
		;AnimationSound = Sound: HorseWhinny			Animation: RURohrm_SKL.RURohrm_DIEA	Frames: 0
		;AnimationSound = Sound: HorseWhinny			Animation: RURohrm_SKL.RURohrm_DIEB	Frames: 0
		;AnimationSound = Sound: BodyFallGeneric1		Animation: RURohrm_SKL.RURohrm_DIEA	Frames: 10 46
		;AnimationSound = Sound: BodyFallGeneric1		Animation: RURohrm_SKL.RURohrm_DIEB	Frames: 11
		;AnimationSound = Sound: BodyFallGeneric1		Animation: RURohrm_SKL.RURohrm_LNDA	Frames: 3 11
		;AnimationSound = Sound: TauntHitShieldPitchShifted 	Animation: RURohrm_SKL.RURohrm_TNTB	Frames: 12 29
;		need means for filtering for upgraded horse shields!
	;End
;
;
	; *** ENGINEERING Parameters ***
 
	RadarPriority	= UNIT
	ThingClass		= CAVALRY_UNIT
	KindOf			= PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY SCORE GRAB_AND_DROP

AddModule 
Body = ActiveBody ModuleTag_02
		CheerRadius 		= EMOTION_CHEER_RADIUS
		MaxHealth			= 3000
		MaxHealthDamaged	= ELVEN_RIVENDELLLANCER_HEALTH_DAMAGED

		BurningDeathBehavior = Yes
		BurningDeathFX       = FX_CavalryBurningFlame
		DodgePercent      		= 30 ; ;
	End
End

AddModule 
	Behavior = AIUpdateInterface ModuleTag_030
		AutoAcquireEnemiesWhenIdle		= Yes ATTACK_BUILDINGS
		AILuaEventsList					= GondorFighterFunctions    
		MoodAttackCheckRate				= 500
		HoldGroundCloseRangeDistance	= 80
		AttackPriority					= AttackPriority_Spearman
		BurningDeathTime				= BURNINGDEATH_DURATION_INFANTRY
	End
End

	LocomotorSet
		Locomotor     = HumanLocomotor
		Condition     = SET_NORMAL
		Speed         = 150
	End

	LocomotorSet
		Locomotor = BurningDeathLocomotorInfantry
		Condition = SET_BURNINGDEATH
		Speed	  = BURNINGDEATH_WANDERSPEED_INFANTRY
	End

AddModule 
	Behavior = PhysicsBehavior ModuleTag_040
		GravityMult				= 1.0
		ShockStunnedTimeLow		= 1400 ;//msec
		ShockStunnedTimeHigh	= 2400 ;//msec
		ShockStandingTime		= 2133 ;//msec
	End
End
AddModule  ModuleTag_05
	Behavior = SlowDeathBehavior ModuleTag_050
		DeathTypes			= ALL -KNOCKBACK -FADED
		SinkDelay			= 3000
		SinkRate			= 0.40     ;// in Dist/Sec
		DestructionDelay	= 8000
		Sound				= INITIAL DwarfGenericVoiceDie
	End
End

AddModule ModuleTag_07 
	Behavior = SlowDeathBehavior ModuleTag_070
		;// Same as normal death, but no sound (sound already played by SoundImpact = ... )
		DeathTypes			= NONE +KNOCKBACK
		SinkDelay			= 3000
		SinkRate			= 0.40     ;// in Dist/Sec
		DestructionDelay	= 8000
		;Sound				= INITIAL UrukVoiceDie
	End
End

AddModule ModuleTag_08
	Behavior = BezierProjectileBehavior ModuleTag_080 ;// Module starts asleep, and wakes up when thrown.		 
		FirstHeight					= 24  ;// Height of Bezier control points above highest intervening terrain
		SecondHeight				= 24
		FirstPercentIndent			= 30% ;// Percentage of shot distance control points are placed
		SecondPercentIndent			= 70%
		TumbleRandomly				= Yes

		CrushStyle					= Yes ;// I don't detonate, I just hit
		DieOnImpact					= Yes
		BounceCount					= 1   ;// When I hit the ground, I'll arc again
		BounceDistance				= 40  ;// this far
		BounceFirstHeight			= 24  ;// Height of Bezier control points above highest intervening terrain
		BounceSecondHeight			= 24
		BounceFirstPercentIndent	= 20% ;// Percentage of shot distance control points are placed
		BounceSecondPercentIndent	= 80%

		GroundHitFX       = FX_ThrownRockGroundHit
		GroundBounceFX    = FX_ThrownRockBounceHit
	End
End

	Geometry			= CYLINDER
	GeometryMajorRadius = 8
	GeometryMinorRadius = 8
	GeometryHeight		= 19.2
	GeometryIsSmall		= Yes

	Shadow				= SHADOW_DECAL
	ShadowSizeX 		= 21;
	ShadowSizeY 		= 21;
	ShadowTexture		= ShadowI;
End

Object GoblinSpiderRiderHorde
KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND//UNATTACKABLE 
BuildCost		= 2800
BuildTime		= 35
CommandSet			= SuperElvenRivendellLancerCommandSet
Side			= Men
EditorSorting	= UNIT
EmotionRange	= 240
DisplayName	= FloodCavalry
WeaponSet
Conditions = None 
Weapon = PRIMARY    NormalMeleeHordeRangefinder		
End
CommandPoints = 90
ReplaceModule ModuleTag_HordeContain
Behavior = HordeContain ModuleTag_HordeContain0
	        FrontAngle = 270
		FlankedDelay = 2000
		ObjectStatusOfContained		= 
		InitialPayload				= GoblinSpiderRider 6
		Slots						= 6
		PassengerFilter				= ANY +CAVALRY 
		ShowPips					= No
		
		; Banner Carrier info	

		RandomOffset	= X:2 Y:2	
		
		MeleeBehavior = Amoeba
		End
		
		RankInfo		= RankNumber:1 UnitType:GoblinSpiderRider		Position:X:30 Y:0 		Position:X:30 Y:30 		Position:X:30 Y:60 		;Position:X:30 Y:-60	
		RankInfo 		= RankNumber:2 UnitType:GoblinSpiderRider 		Position:X:0 Y:0 Leader 1 0	Position:X:0 Y:30 Leader 1 1	Position:X:0 Y:60 Leader 1 2	;Position:X:0 Y:-60 Leader 1 4
	
		RanksToReleaseWhenAttacking = 1 2

		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End
End
	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = 150
	End

	LocomotorSet
		Locomotor = HumanLocomotor
		Condition = SET_NORMAL 
		Speed     = 150
	End
End

Object ElvenMirkwoodArcher
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    MirkwoodArcherBow
		Weapon = TERTIARY   MirkwoodArcherBowBombard
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End
	WeaponSet
		Conditions = PLAYER_UPGRADE
		Weapon = PRIMARY	MirkwoodArcherSilverthornBow
		Weapon = TERTIARY   MirkwoodArcherSilverthornBowBombard
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End
	WeaponSet
		Conditions = SPECIAL_ONE PLAYER_UPGRADE
		Weapon = PRIMARY	HaldirGoldenArrow
		Weapon = TERTIARY   MirkwoodArcherSilverthornBowBombard
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End
AddModule
	Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTagMirkwoodArcher68
		TriggeredBy = Upgrade_DwarvenFlamingShot
	End
End
AddModule
	Behavior = WeaponSetUpgrade ModuleTag_WeaponLevel26
			TriggeredBy	= Upgrade_DwarvenFlamingShot
			WeaponCondition = SPECIAL_ONE
	End
End
End
Object ElvenMirkwoodArcherHorde
ReplaceModule ModuleTag_ElvenCamouflage
	Behavior 	= InvisibilityUpdate ModuleTag_ElvenCamouflage5
		InvisibilityNugget
			InvisibilityType	= CAMOUFLAGE
			DetectionRange		= CAMOUFLAGE_RADIUS
			ForbiddenConditions	= MOVING FIRING_ANY
			Options				= ALLOW_NEAR_TREES
		End
		UpdatePeriod			= 2000
		StartsActive			= No
               ; TriggeredBy = Upgrade_TechnologyGondorForgedBlades
		UnitSpecificSoundNameToUseAsVoiceMoveToStealthyArea = VoiceMoveToTrees
		UnitSpecificSoundNameToUseAsVoiceEnterStateMoveToStealthyArea = VoiceEnterStateMoveToTrees
	End
End
AddModule
	Behavior = WeaponSetUpgrade ModuleTag_WeaponLevel26
			TriggeredBy	= Upgrade_DwarvenFlamingShot
			WeaponCondition = SPECIAL_ONE
	End
End

AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality666
		TriggeredBy = Upgrade_DwarvenFlamingShot
	End
      End

      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced666
		TriggeredBy				= Upgrade_DwarvenFlamingShot
		AttributeModifier		= GoldenArrow
	End
End

AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp4567ggg56
		TriggeredBy			= Upgrade_ElvenSilverthornArrows
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		;RequiresAllTriggers	= Yes
		CommandSet			= NewElvenMirkwoodArcherHordeCommandSet2
	End 
End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedFA
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades
		AttributeModifier		= SuperArcherMen
		;RefreshDelay		= 2000	; 2 secs
	End
      End
CommandSet = NewElvenMirkwoodArcherHordeCommandSet
AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TeleportEnabler
	SpecialPowerTemplate = SpecialAbilityHeroBlink
	TriggeredBy			 = Upgrade_TechnologyGondorHeavyArmor; Upgrade_ElfFaction ;Upgrade_TechnologyGondorHeavyArmor
End
End
AddModule
Behavior = SpecialPowerModule ModuleTag_TeleportStarteryyy                      
	SpecialPowerTemplate	 = SpecialAbilityHeroBlink
	UpdateModuleStartsAttack = Yes
	TriggerFX				 = FX_UnSummonWildmen; FX_Blink
	StartsPaused			 = Yes
End
End
AddModule
Behavior = TeleportSpecialAbilityUpdate ModuleTag_TeleportUpdate   
	SpecialPowerTemplate  =	SpecialAbilityHeroBlink

	UnpackingVariation	  =	1
	UnpackTime			  =	1800
	PackTime			  =	1800

	ApproachRequiresLOS	  =	No
	BusyForDuration		  =	1800 // don't accept	any	AI for this	long...	ai commands	will be	queued (should be at least PackTime)
	
	DestinationWeaponName =	CreateaHeroBlinkDestination	// Fires	at point of	teleport to	push people	away and down.
End
End
End

ChildObject WildGoblinKing IsengardSaruman
End


Object WildMarauder
	SelectPortrait = CPAvatar
	ButtonImage = HICAHAvatar
DisplayName = ValarsMagicians
	SelectPortrait         =  CPWanderer
	ButtonImage		= HICAHWanderer
	AddModule
	Behavior = GrantUpgradeCreate ModuleTag_1
		UpgradeToGrant = Upgrade_GandalfWhite  ;
	End 
	End

	AddModule
	Behavior = SubObjectsUpgrade CorruptedWeapon_Upgrade270
	TriggeredBy			   = Upgrade_GandalfWhite
	HideSubObjects		   = WizardStaff01 ;WizStaff01_FX01 ;WizStaff01_FX2 ;WizStaff01_FX3 ;WizStaff01_FX4
	HideSubObjects		   = WizStaff01_FX01
	HideSubObjects		   = WizStaff01_FX2
	HideSubObjects		   = WizStaff01_FX3
	HideSubObjects		   = WizStaff01_FX4
	HideSubObjects		   = WizardStaff02 
	HideSubObjects		   = WizStaff02_FX1
	HideSubObjects		   = WizardStaff03 
	HideSubObjects		   = WizStaff03_FX01
	HideSubObjects		   = WizStaff03_FX02
	;HideSubObjects		   = WizardStaff04 
	HideSubObjects		   = WizStaff04_FX01
;----------------------------------------------------------
	HideSubObjects		   = WizStaff04_FX02
	HideSubObjects		   = WizStaff04_FX03
	HideSubObjects		   = WizStaff04_FX04
	HideSubObjects		   = WizStaff04_FX05
	HideSubObjects		   = WizStaff04_FX06
	HideSubObjects		   = WizStaff04_FX07
	HideSubObjects		   = WizStaff04_FX01
	HideSubObjects		   = STFF_05 
	HideSubObjects		   = STFF_06 



	HideSubObjects		   = Shld_01
	HideSubObjects		   = Shld_02
	HideSubObjects		   = Shld_03
	HideSubObjects		   = Shld_04
	HideSubObjects		   = Shld_05
	HideSubObjects		   = Shld_06

	HideSubObjects		   = HLMT_01
	HideSubObjects		   = HLMT_02
	HideSubObjects		   = HLMT_03
	HideSubObjects		   = HLMT_04
	HideSubObjects		   = HLMT_05
	HideSubObjects		   = HLMT_06
	HideSubObjects		   = HLMT_07
	HideSubObjects		   = SLDR_01
	HideSubObjects		   = SLDR_02

	HideSubObjects		   = GNLT_01
	HideSubObjects		   = GNLT_02
	HideSubObjects		   = GNLT_03
	HideSubObjects		   = GNLT_04
	HideSubObjects		   = GNLT_05
	HideSubObjects		   = GNLT_06
	HideSubObjects		   = GNLT_07

	HideSubObjects		   = CHEST_01
	HideSubObjects		   = CHEST_02
	HideSubObjects		   = CHEST_03
        HideSubObjects		   = CHEST_03

	FadeTimeInSeconds      = 0.0
	RecolorHouse		   = No

	End
        End
	

RemoveModule ModuleTag_01
AddModule
Draw = W3DScriptedModelDraw ModuleTag_DRAW1

DefaultModelConditionState
	Model				 = CHWZ_YW_U_SKN
	Skeleton			 = CHWZ_YW_U_SKL
	ModelAnimationPrefix = CHWZ_YW
	WeaponLaunchBone	 = PRIMARY WizardStaff04 
			ParticleSysBone = SWORD BalrogSwordFlareWhite FollowBone:yes		; Not SWORDBONE, because SWORD is the bone that gets art-hidden mid animation in WIPX
			ParticleSysBone = SWORD BalrogSwordEmbersWhite FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFlareWhite FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeEmbersWhite FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFireWhite FollowBone:yes
			ParticleSysBone = RTWINGBONE BalrogWingSmokeLite FollowBone:yes
			ParticleSysBone = LFWINGBONE BalrogWingSmokeLite FollowBone:yes


End

	

//================== ANIMATIONS =================================================================

AnimationState        =  SPECIAL_WEAPON_ONE
			StateName				= Curse
	Animation
		AnimationName		= #(MODEL)_U_LVLA
		AnimationMode		= ONCE
	End
//			FXEvent	= Frame:6	Name: FX_SarumanDominateAtSelf
			ParticleSysBone = B_HEAD LurtzWOPGrow1 FollowBone:Yes
			ParticleSysBone = B_HEAD LurtzWOPGrow2 FollowBone:Yes
			ParticleSysBone = B_HEAD LurtzWOPGrow3 FollowBone:Yes
;			ParticleSysBone = B_HEAD LurtzWOPGrowb1 FollowBone:Yes
;			ParticleSysBone = B_HEAD LurtzWOPGrowb2 FollowBone:Yes
;			ParticleSysBone = B_HEAD LurtzWOPGrowb3 FollowBone:Yes
;			ParticleSysBone = B_HEAD LurtzWOPGrowc1 FollowBone:Yes
;			ParticleSysBone = B_HEAD LurtzWOPGrowc2 FollowBone:Yes
;			ParticleSysBone = B_HEAD LurtzWOPGrowc3 FollowBone:Yes
;			FXEvent			= Frame:3000 Name:FX_GandalfPreAttackBlast

End

//----------- Special Create A Hero Creation Screen Animations ---------------
AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN CREATE_A_HERO_EXAMINE_SELF CREATE_A_HERO_SELECTED_CHEER 
	StateName			   = STATE_ExamineSelf
	Animation			   = ExamineSelf
		AnimationName	   = #(MODEL)_C_CLRA
		AnimationMode	   = ONCE
		AnimationBlendTime = 20
	End
End

AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN CREATE_A_HERO_EXAMINE_WEAPON_RIGHT CREATE_A_HERO_SELECTED_CHEER 
	StateName			   = STATE_ExamineWeapon
	Animation			   = WeaponSwap
		AnimationName	   = #(MODEL)_C_WPNA
		AnimationMode	   = ONCE
		AnimationBlendTime = 20
	End
End

AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN USER_75
 	StateName			   = STATE_SwapModels
 	Animation			   = WeaponSwap
 		AnimationName	   = #(MODEL)_C_ATNB #(MODEL)_C_ATND
 		AnimationMode	   = MANUAL
 		AnimationBlendTime = 0
 	End
End
                





//-----------------------------------------------------------------------------
AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN CREATE_A_HERO_SELECTED_CHEER
	StateName = STATE_SelectedCheer
	Animation = Foot_ATNB // Bored Idle
		AnimationName	   = #(MODEL)_C_ATNB #(MODEL)_C_ATND
		AnimationMode	   = ONCE
		AnimationPriority  = 90
		AnimationBlendTime = 20
	End
	Animation = Foot_ATND // Bored Fidget
		AnimationName	   = #(MODEL)_C_ATND #(MODEL)_C_ATNB
		AnimationMode	   = ONCE
		AnimationPriority  = 10
		AnimationBlendTime = 20
	End
	Animation = Foot_ATNE // Bored Fidget
		AnimationName	   = #(MODEL)_C_ATNE #(MODEL)_C_ATND #(MODEL)_C_ATNB
		AnimationMode	   = ONCE
		AnimationPriority  = 3
		AnimationBlendTime = 20
	End
	Flags =	RESTART_ANIM_WHEN_COMPLETE
	BeginScript //script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Unselected" then 
			CurDrawableSetTransitionAnimState("Trans_SelectedCheer") 
		end
//  		if Prev == "STATE_SwapModels" then 
//  			CurDrawableSetTransitionAnimState("Trans_SwapModels") 
//  		end
	EndScript
End

AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN
	StateName = STATE_Unselected
	Animation = Foot_ATNB // Bored Idle
		AnimationName       = #(MODEL)_C_ATNB #(MODEL)_C_ATND
		AnimationMode       = ONCE
		AnimationPriority   = 90
		AnimationBlendTime = 10
	End
	Animation = Foot_ATND // Bored Fidget
		AnimationName       = #(MODEL)_C_ATND #(MODEL)_C_ATNB
		AnimationMode       = ONCE
		AnimationPriority   = 10
		AnimationBlendTime = 10
	End
	Animation = Foot_ATNE // Bored Fidget
		AnimationName       = #(MODEL)_C_ATNE #(MODEL)_C_ATND #(MODEL)_C_ATNB
		AnimationMode       = ONCE
		AnimationPriority   = 3
		AnimationBlendTime = 10
	End
	Flags =	RESTART_ANIM_WHEN_COMPLETE
 	BeginScript //script to set transition from moving
 		Prev = CurDrawablePrevAnimationState()
 		if Prev == "STATE_SwapModels" then 
 			CurDrawableSetTransitionAnimState("Trans_SwapModels") 
 		end
 	EndScript
End

TransitionState = Trans_ExamineWeapon
	Animation = Transition
		AnimationName = #(MODEL)_C_WPNA
		AnimationMode = ONCE
		AnimationBlendTime = 20
	End
End
TransitionState = Trans_ExamineSelf
	Animation = Transition
		AnimationName = #(MODEL)_C_CLRA
		AnimationMode = ONCE
		AnimationBlendTime = 20
	End
End
TransitionState = Trans_SelectedCheer
	Animation = Transition
		AnimationName = #(MODEL)_C_SLCA
		AnimationMode = ONCE
		AnimationBlendTime = 20
	End
End

TransitionState = Trans_SwapModels
	StateName = STATE_Unselected
	Animation = Transition
		AnimationName = #(MODEL)_C_ATNB #(MODEL)_C_ATND
		AnimationMode = ONCE
		AnimationBlendTime = 0
	End
End



//----------- Climbing/rappelling ---------------
AnimationState						= CLIMBING WEAPONSET_TOGGLE_1
	StateName						= STATE_Climbing
	Animation						= Climbing
		AnimationName				= #(MODEL)_U_WALB
		AnimationMode				= LOOP
		AnimationBlendTime			= 10
	End
	BeginScript//script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Running"  then CurDrawableSetTransitionAnimState("Trans_RunningToClimbing_WeaponToggle") return end
	EndScript
End
TransitionState = Trans_RunningToClimbing_WeaponToggle
	Animation = Transition
		AnimationName = #(MODEL)_B_WALA
		AnimationMode = ONCE
	End
End

AnimationState						= CLIMBING
	StateName						= STATE_Climbing
	Animation						= Climbing
		AnimationName				= #(MODEL)_U_WALB
		AnimationMode				= LOOP
		AnimationBlendTime			= 10
	End
	BeginScript//script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Running"  then CurDrawableSetTransitionAnimState("Trans_RunningToClimbing") return end
	EndScript
End
TransitionState = Trans_RunningToClimbing
	Animation = Transition
		AnimationName = #(MODEL)_U_WALA
		AnimationMode = ONCE
	End
End

AnimationState						= RAPPELLING WEAPONSET_TOGGLE_1
	StateName						= STATE_Rappelling
	Animation						= Rapelling
		AnimationName				= #(MODEL)_U_WALD
		AnimationMode				= LOOP
		AnimationBlendTime			= 10
	End
	BeginScript//script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Climbing"  then CurDrawableSetTransitionAnimState("Trans_ClimbingToRappelling") return end
	EndScript
End
AnimationState						= RAPPELLING
	StateName						= STATE_Rappelling
	Animation						= Rapelling
		AnimationName				= #(MODEL)_U_WALD
		AnimationMode				= LOOP
		AnimationBlendTime			= 10
	End
	BeginScript//script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Climbing"  then CurDrawableSetTransitionAnimState("Trans_ClimbingToRappelling") return end
	EndScript
End
TransitionState = Trans_ClimbingToRappelling
	Animation = Transition
		AnimationName = #(MODEL)_U_WALC
		AnimationMode = ONCE
	End
End
TransitionState = Trans_RappellingToRunning_WeaponToggle
	Animation = Transition
		AnimationName = MUGblnSwrd_B_WALE
		AnimationMode = ONCE
	End
End
TransitionState = Trans_RappellingToRunning
	Animation = Transition
		AnimationName = MUGblnSwrd_U_WALE
		AnimationMode = ONCE
	End
End
	



// --------- MOUNTED  ------------

// --- Dying Anims
AnimationState					=	DYING AFLAME MOUNTED
	Animation					=	Fire
		AnimationName			=	#(MODEL)_M_MFDA 
		AnimationSpeedFactorRange = 0.9 1.1
	End
	BeginScript
		CurDrawableHideSubObject("arrow") //Circumvents blend issues when the arrow is being shown...
	EndScript
End

AnimationState				=	DYING SPLATTED MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_LNDA
		AnimationMode		=	ONCE
	End
End
AnimationState        = DYING MOUNTED
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_M_DIEA
		AnimationMode     = ONCE
	End
End

AnimationState				=	STUNNED_STANDING_UP MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_GTPA
		AnimationMode		=	ONCE
		AnimationSpeedFactorRange = 1.5 1.5
	End
End

AnimationState				=	STUNNED MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_LNDA
		AnimationMode		=	ONCE
	End
End

AnimationState				=	FREEFALL MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_FLYA
		AnimationMode		=	LOOP
	End
	Flags					=	RANDOMSTART
End

AnimationState				=	STUNNED_FLAILING MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_FLYA
		AnimationMode		=	LOOP
	End
	Flags					=	RANDOMSTART
End

AnimationState        = PASSENGER MOUNTED
	Animation
		AnimationName       = #(MODEL)_M_GBDA
		AnimationMode       = LOOP
	End
	Flags               = RANDOMSTART
End

AnimationState        = MOUNTED LEVELED	// This state clears itself in 3 of your Earth seconds
	Animation
		AnimationName           = #(MODEL)_M_LVLA
		AnimationMode       = ONCE
	End
End

AnimationState        = MOUNTED RAISING_FLAG	// This state clears itself in 3 of your Earth seconds
	Animation
		AnimationName           = #(MODEL)_M_CHRA
		AnimationMode		=	ONCE
	End
	Flags					=	RESTART_ANIM_WHEN_COMPLETE
End

// --- Attacking Anims		
AnimationState				= FIRING_OR_PREATTACK_A MOUNTED	// Melee attack.
	Animation
		AnimationName		= #(MODEL)_M_ATKA #(MODEL)_M_ATKB
		AnimationMode		= ONCE
		UseWeaponTiming		= Yes
	End
End

// --- Moving Anims
AnimationState				=	MOUNTED TURN_LEFT_HIGH_SPEED
	Animation
		AnimationName		=	#(MODEL)_M_TNL1
		AnimationMode		=	LOOP
		AnimationSpeedFactorRange= 1.8 1.8
		AnimationBlendTime	=	20
	End
End

AnimationState				=	MOUNTED TURN_RIGHT_HIGH_SPEED
	Animation
		AnimationName		=	#(MODEL)_M_TNR1
		AnimationMode		=	LOOP
		AnimationSpeedFactorRange= 1.8 1.8
		AnimationBlendTime	=	20
	End
End

AnimationState				=	MOVING TURN_LEFT MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_TRNL
		AnimationMode		=	LOOP
	End
//			//ParticleSysBone			=	None CalvaryDustTrails
End

AnimationState				=	MOVING TURN_RIGHT MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_TRNR
		AnimationMode		=	LOOP
	End
//			//ParticleSysBone			=	None CalvaryDustTrails
End

AnimationState				=	MOVING ACCELERATE MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_ACCL
		AnimationMode		=	LOOP
	End
	//ParticleSysBone			=	None CalvaryDustTrails
End

AnimationState				=	MOVING DECELERATE MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_DECL
		AnimationMode		=	ONCE
	End
	//ParticleSysBone			=	None CalvaryDustTrails
End

AnimationState				=	MOVING WALKING MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_WLKA
		AnimationMode		=	LOOP
	End
	Flags					=	RANDOMSTART
	//ParticleSysBone			=	None InfantryDustTrails  
End

AnimationState				=	MOVING BACKING_UP MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_BAKA
		AnimationMode		=	LOOP
	End
	Flags					=	RANDOMSTART
	//ParticleSysBone			=	None InfantryDustTrails  
End

AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_A
	ShareAnimation		= Yes
	Animation
		AnimationName       = #(MODEL)_M_ATRA
		AnimationMode       = LOOP
	End
	Flags               = RANDOMSTART  
End

AnimationState				=	MOVING MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_RUNA
		AnimationMode		=	LOOP
	End
 	Flags					=	RANDOMSTART
	//ParticleSysBone			=	None CalvaryDustTrails  
End

// --- Selected Anims
AnimationState				=	SELECTED MOUNTED
	SimilarRestart			=   Yes			
	StateName				=	AtAttentionIdleMounted
	Animation				=	ATNB
		AnimationName		=	#(MODEL)_M_ATNB
		AnimationMode		=	LOOP
	End
	BeginScript
		Prev = CurDrawablePrevAnimationState()
		if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
		if Prev == "AtAttentionIdleMounted" then CurDrawableSetTransitionAnimState("TRANS_Select") end
	EndScript
End

TransitionState				=	TRANS_Select
	Animation
		AnimationName		=	#(MODEL)_M_ATNA
		AnimationMode		=	ONCE
	End
End

// --- Idle Anims
AnimationState				= MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_IDLA
		AnimationPriority	=	20
		AnimationMode		=	ONCE
		AnimationBlendTime	=	15
	End
	Flags				=	RESTART_ANIM_WHEN_COMPLETE
End

// --------- UNMOUNTED  ------------

//------------------  DYING -------------------------------------------------------------

// --- Flying through the air.
AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_FLYA
		AnimationMode     = LOOP
	End
	Flags               = RANDOMSTART
End

AnimationState        = STUNNED_FLAILING 
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_U_FLYA
		AnimationMode     = LOOP
	End
	Flags               = RANDOMSTART
End

// --- Dying anims
AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_LNDA
		AnimationMode     = ONCE
	End
End

AnimationState        = DYING SPLATTED
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_U_LNDA
		AnimationMode     = ONCE
	End
End

AnimationState        = DYING WEAPONSET_TOGGLE_1	//WEAPONSTATE_CLOSE_RANGE
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_DIEA
		AnimationMode     = ONCE
	End
End

AnimationState        = DYING
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_U_DIEA
		AnimationMode     = ONCE
	End
	Animation           = GUHero_DIEB
		AnimationName     = #(MODEL)_U_DIEB
		AnimationMode     = ONCE
	End
End


// --- Stunned anims


AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_GTPA
		AnimationMode     = ONCE
		AnimationSpeedFactorRange = 1.5 1.5
	End
End

AnimationState        = STUNNED_STANDING_UP
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_U_GTPA
		AnimationMode     = ONCE
		AnimationSpeedFactorRange = 1.5 1.5
	End
End

AnimationState        = STUNNED WEAPONSET_TOGGLE_1
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_LNDA
		AnimationMode     = ONCE
	End
End

AnimationState        = STUNNED 
	StateName           = STATE_Sword
	Animation           = GUHero_LNDA
		AnimationName     = #(MODEL)_U_LNDA
		AnimationMode     = ONCE
	End
End				

//------------------ SPECIAL POWER ANIMS ---------------------


// RAIN OF ARROWS SPECIAL POWER //
AnimationState				= PACKING_TYPE_1  WEAPONSET_TOGGLE_1
	StateName				= rainofarrows
	Animation
		AnimationName		= #(MODEL)_B_ATKA2
		AnimationMode		= LOOP
	End
//			FXEvent	= Frame:6	Name: FX_SarumanDominateAtSelf
End

// DOMINATE SPECIAL POWER //
AnimationState				= PACKING_TYPE_1
	StateName				= Curse
	Animation
		AnimationName		= #(MODEL)_U_LVLA
		AnimationMode		= ONCE
	End
//			FXEvent	= Frame:6	Name: FX_SarumanDominateAtSelf
End

// TELEPORT SPECIAL POWER //
AnimationState				= PACKING_TYPE_3
	StateName				= Curse
	Animation
		AnimationName		= #(MODEL)_U_SPCA
		AnimationMode		= ONCE
	End
//			FXEvent	= Frame:6	Name: FX_SarumanDominateAtSelf
End

//--------------------- Wound Arrow anim
AnimationState        =  SPECIAL_WEAPON_TWO
	StateName = STATE_Bow
	Animation
		AnimationName       = #(MODEL)_U_SPCL #(MODEL)_U_ATKC
		AnimationMode       = ONCE
	End
	FrameForPristineBonePositions = 59
	BeginScript
		CurDrawableShowSubObject("arrow")
	EndScript
End
		
//------------------ ATTACKING --------------------------------------------------------------------
		// Attacking Anims [Weapon_A]
		
		
		
//		AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
//			Animation           = TrotAndFire
//				AnimationName       = #(MODEL)_U_ATRA
//				AnimationMode       = LOOP
//			End
//			Flags               = RANDOMSTART
//			StateName = RunAndSwing
//		End
//		
//		AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
//			StateName           = STATE_Sword
//			
//			Animation           = ATKD
//				AnimationName     = #(MODEL)_U_ATKD
//				AnimationMode     = ONCE
//				UseWeaponTiming		= Yes
//				AnimationSpeedFactorRange = 1.149 1.149
//			End
//			
//			Animation           = ATKE
//				AnimationName    = #(MODEL)_U_ATKE
//				AnimationMode     = ONCE
//				UseWeaponTiming		= Yes
//				AnimationSpeedFactorRange = 1.149 1.149
//			End
//			
//			Animation           = ATKF
//				AnimationName    = #(MODEL)_U_ATKF
//				AnimationMode     = ONCE
//				AnimationSpeedFactorRange = 1.47 1.47
//			End
//			Flags				=	RESTART_ANIM_WHEN_COMPLETE
//			//	FrameForPristineBonePositions = 59
//			BeginScript
//				Prev = CurDrawablePrevAnimationState()
//				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
//			EndScript
//		End

//------------------ MOVING -------------------------------------------------------------

		AnimationState        = MOVING USER_4                 // Moving slaughter
			StateName           = Slaughter
			Flags               = RANDOMSTART
			//ParticleSysBone     = None InfantryDustTrails
			Animation           = GUHero_ATKE
				AnimationName     = #(MODEL)_U_ATKE
				AnimationMode     = LOOP
			End
			StateName           = NoSword
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
			EndScript
		End

		//--- Running with bow
		AnimationState			= MOVING WEAPONSET_TOGGLE_1		//WEAPONSTATE_CLOSE_RANGE
			StateName           = STATE_RunningBow
			Flags               = RANDOMSTART
			//ParticleSysBone    = None InfantryDustTrails
			Animation
				AnimationName   = #(MODEL)_B_RUNA
//				AnimationMode   = LOOP
				AnimationSpeedFactorRange = 0.85 0.85
//				Distance		= 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
				if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning_WeaponToggle") return end
			EndScript
		End

		//--- Running with sword
		AnimationState			= MOVING
			StateName           = STATE_RunningSword
			Flags               = RANDOMSTART
			//ParticleSysBone    = None InfantryDustTrails
			Animation
				AnimationName   = #(MODEL)_U_RUNA
//				AnimationMode   = LOOP
				AnimationSpeedFactorRange = 0.85 0.85
//				Distance = 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
				if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning") return end
			EndScript
		End

		//---------------------------------------------------
		//New style firing with bow
		AnimationState					=	PREATTACK_A WEAPONSET_TOGGLE_1
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	#(MODEL)_B_ATKA1
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				//AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_A WEAPONSET_TOGGLE_1
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	#(MODEL)_B_ATKA2
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.1 1.1		// Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				//AnimationBlendTime		=	10
			End
		End
		//---------------------End New style firing

		//AnimationState					=	CONTINUOUS_FIRE_MEAN WEAPONSET_TOGGLE_1
		//	Animation					=	HangFrameWhileCoasting
		//		AnimationName			=	#(MODEL)_B_ATKA2
		//		AnimationMode			=	MANUAL
		//	End
		//End
		
		//AnimationState						= CONTINUOUS_FIRE_SLOW WEAPONSET_TOGGLE_1
		//	//StateName						= STATE_Idle_Bow
		//	Animation						= PutAwayArrow
		//		AnimationName				= #(MODEL)_U_ATKA3
		//		AnimationMode				= ONCE
		//	End
		//End
				
		//End New style firing
		//---------------------------------------------------

		AnimationState				= FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
			StateName				= STATE_Firing
			Animation
				AnimationName		= #(MODEL)_B_ATKA1
				AnimationMode		= ONCE
				UseWeaponTiming		= No			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
			End
		End

		AnimationState				= FIRING_OR_PREATTACK_A // Melee attack.
			Animation
				AnimationName		= #(MODEL)_U_ATKA1 #(MODEL)_U_ATKA #(MODEL)_U_ATKB
				AnimationMode		= ONCE
				UseWeaponTiming		= Yes
			End
		End


		
//-------------------- HIT REACTIONS -----------------------------------------------------------

// this hit animation attack stance
		AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
			Animation
				AnimationName = #(MODEL)_B_HITA
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
			Animation
				AnimationName = #(MODEL)_B_HITA
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION
			Animation = Sword_HITA
				AnimationName = #(MODEL)_U_HITA
				AnimationMode = ONCE
			End
			Animation = Sword_HITB
				AnimationName = #(MODEL)_U_HITB
				AnimationMode = ONCE
			End

			BeginScript
				PrevAnim = CurDrawablePrevAnimation()
				if PrevAnim == "Foot_IDLB"
				then
					return "Sword_HITB"
				else
					return "Swort_HITA"
				end
			EndScript
		End

//------------ SPECIAL POWERS ------------------------------------------------------------------		

		AnimationState		  =	THROWN_PROJECTILE
			Animation
				AnimationName =	#(MODEL)_U_LEP2
				AnimationMode =	LOOP
			End
		End

		AnimationState		  =	ABOUT_TO_HIT
			Animation
				AnimationName =	#(MODEL)_U_LEP3
				AnimationMode =	ONCE
			End
		End

		AnimationState				= SPECIAL_POWER_1							; Aragorn shouting Elendil anim
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_U_SPCA
				AnimationMode		= ONCE
			End
			ParticleSysBone			= B_SWORDBONE ElendilFlare FollowBone:yes
			ParticleSysBone			= B_SWORDBONE ElendilSwordFlare FollowBone:yes
;			FXEvent	= Name: FX_ElendilGlowEvent
		End

		// WORD OF POWER ANIMS ON FOOT //
		AnimationState		  =	SPECIAL_WEAPON_ONE
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCA
				AnimationMode =	ONCE
			End
			//FXEvent			  =	Frame:5	Name:FX_GandalfPreAttackBlast
		End

		//	WIZARD BLAST ANIMS MOUNTED //
		AnimationState		  =	SPECIAL_WEAPON_TWO MOUNTED
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPLD #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End
	
		//	WIZARD BLAST ANIMS ON FOOT //
		AnimationState		  =	SPECIAL_WEAPON_TWO
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCB #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End

		//	ISTARI LIGHT STAFF WEAPON MOUNTED //
		AnimationState		  =	SPECIAL_WEAPON_THREE MOUNTED	// FIRING_OR_PREATTACK_C
			StateName		  =	Attacking
			Animation		  =	StaffLaser
				AnimationName =	#(MODEL)_U_SPCD #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:30 Name:FX_GandalfStaffFlare
		End

		//	ISTARI LIGHT STAFF WEAPON ON FOOT //
		AnimationState		  =	SPECIAL_WEAPON_THREE // FIRING_OR_PREATTACK_C
			StateName		  =	Attacking
			Animation		  =	StaffLaser
				AnimationName =	#(MODEL)_U_SPCE #(MODEL)_U_ATKA//	isitari's light?
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:30 Name:FX_GandalfStaffFlare
		End
		
		; Throwing and cripple strike
		AnimationState		  =	SPECIAL_WEAPON_FOUR
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCD
				AnimationMode =	ONCE
			End
			FrameForPristineBonePositions	= 44
		End

		AnimationState		  =	SPECIAL_WEAPON_FIVE
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCE
				AnimationMode =	ONCE
			End
		End

		AnimationState		  =	SPECIAL_WEAPON_SIX
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCF
				AnimationMode =	ONCE
			End
		End

;---------------------------------------------------------

		AnimationState        =  PACKING_TYPE_1 UNPACKING
			StateName = Attacking
			Animation = LightningSwordStart
				AnimationName           = GUGandalfG_SKL.GUGandalfG_SPE3
				AnimationMode       = ONCE
			End
			FXEvent			= Frame:14 Name:FX_GandalfLightningCharge
;			FXEvent			= Frame:70 Name:FX_GandalfLightningFizzle
			FXEvent			= Frame:14 Name:FX_GandalfLightningSword  FrameStop:70
		End
	
		AnimationState        =  PACKING_TYPE_1 PREPARING
			StateName = Attacking
			Animation = LightningSwordLoop
				AnimationName           = GUGandalfG_SKL.GUGandalfG_SPE2
				AnimationMode       = LOOP
			End
		End

		AnimationState        =  PACKING_TYPE_1 PACKING
			StateName = Attacking
			Animation = LightningSwordPutAway
				AnimationName           = GUGandalfG_SKL.GUGandalfG_SPE1
				AnimationMode       = ONCE
			End
		End

;-------------------------------------------

		//	Special Power 1
		AnimationState		  =	PACKING_TYPE_1 UNPACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordStart
				AnimationName =	#(MODEL)_U_SPCC #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:14 Name:FX_CreateAHeroLightningCharge
//			FXEvent			  =	Frame:70 Name:FX_GandalfLightningFizzle
			FXEvent			  =	Frame:14 Name:FX_GandalfLightningSword	FrameStop:70
		End
	
		AnimationState		  =	PACKING_TYPE_1 PREPARING
			StateName		  =	Attacking
			Animation		  =	LightningSwordLoop
				AnimationName =	#(MODEL)_U_SPCA #(MODEL)_U_ATKA
				AnimationMode =	LOOP
			End
		End

		AnimationState		  =	PACKING_TYPE_1 PACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordPutAway
				AnimationName =	#(MODEL)_U_SPCB #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End

		// (specific) dwarf train allies.
		AnimationState		  =	PACKING_TYPE_2 CREATE_A_HERO_20 CREATE_A_HERO_21
			Animation
				AnimationName =	#(MODEL)_U_SPCC
				AnimationMode =	LOOP
			End
		End

		//	Special Power 2
		AnimationState		  =	PACKING_TYPE_2 UNPACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordStart
				AnimationName =	#(MODEL)_U_SPCC #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:14 Name:FX_CreateAHeroLightningCharge
//			FXEvent			  =	Frame:70 Name:FX_GandalfLightningFizzle
			FXEvent			  =	Frame:14 Name:FX_GandalfLightningSword	FrameStop:70
		End
	
		AnimationState		  =	PACKING_TYPE_2 PREPARING
			StateName		  =	Attacking
			Animation		  =	LightningSwordLoop
				AnimationName =	#(MODEL)_U_SPCA #(MODEL)_U_ATKA
				AnimationMode =	LOOP
			End
		End

		AnimationState		  =	PACKING_TYPE_2 PACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordPutAway
				AnimationName =	#(MODEL)_U_SPCB #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End
		
//----------- Captain of Gondor - Sword --------------------------------------------
		AnimationState        = PACKING_TYPE_2 WEAPONSET_TOGGLE_1
			StateName		  =	CaptainPower
			Animation           = GUHero_CHRC
				AnimationName     = #(MODEL)_U_CHRC
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.2 1.2
			End
		End

//----------- Captain of Gondor - Bow -----------------------------------------------
		AnimationState        = PACKING_TYPE_2
			StateName		  =	STATE_CaptainBow
			Animation           = GUHero_CHRD
				AnimationName     = #(MODEL)_U_SPCE #(MODEL)_U_SPCA #(MODEL)_U_CHRD
				AnimationMode     = ONCE
//				AnimationSpeedFactorRange = 0.75 0.75
			End
		End

		//	Special Power 3
		AnimationState		  =	PACKING_TYPE_3 UNPACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordStart
				AnimationName =	#(MODEL)_U_SPCC #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:14 Name:FX_CreateAHeroLightningCharge
//			FXEvent			  =	Frame:70 Name:FX_GandalfLightningFizzle
			FXEvent			  =	Frame:14 Name:FX_GandalfLightningSword	FrameStop:70
		End
	
		AnimationState		  =	PACKING_TYPE_3 PREPARING
			StateName		  =	Attacking
			Animation		  =	LightningSwordLoop
				AnimationName =	#(MODEL)_U_SPCA #(MODEL)_U_ATKA
				AnimationMode =	LOOP
			End
		End

		AnimationState		  =	PACKING_TYPE_3 PACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordPutAway
				AnimationName =	#(MODEL)_U_SPCB #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End
		
		//	Special Power 4
		AnimationState		  =	PACKING_TYPE_4 UNPACKING	  
			Animation		  
				AnimationName =	#(MODEL)_U_SPCA
				AnimationMode =	ONCE
			End
		End
	
		AnimationState		  =	PACKING_TYPE_4 PREPARING
			Animation		 
				AnimationName =	#(MODEL)_U_SPCA
				AnimationMode =	ONCE
			End
		End

		AnimationState		  =	PACKING_TYPE_4 PACKING
			Animation		  
				AnimationName =	#(MODEL)_U_SPCA
				AnimationMode =	ONCE
			End
		End
		
		//	Special Power 5
		
		//		AnimationState		  =	PACKING_TYPE_5 UNPACKING WEAPONSET_TOGGLE_1  
//			Animation		  
//				AnimationName =	#(MODEL)_B_SPCB
//				AnimationMode =	ONCE
//			End
//		End
//	
//		AnimationState		  =	PACKING_TYPE_5 PREPARING WEAPONSET_TOGGLE_1
//			Animation		 
//				AnimationName =	#(MODEL)_B_SPCB
//				AnimationMode =	ONCE
//			End
//		End

		AnimationState		  =	PACKING_TYPE_5 PACKING WEAPONSET_TOGGLE_1
			Animation		  
				AnimationName =	#(MODEL)_B_SPCB
				AnimationMode =	ONCE
				AnimationSpeedFactorRange = 0.7333 0.7333
			End
		End
		
//		AnimationState		  =	PACKING_TYPE_5 UNPACKING	  
//			Animation		  
//				AnimationName =	#(MODEL)_U_SPCB
//				AnimationMode =	ONCE
//			End
//		End
//	
//		AnimationState		  =	PACKING_TYPE_5 PREPARING
//			Animation		 
//				AnimationName =	#(MODEL)_U_SPCB
//				AnimationMode =	ONCE
//			End
//		End

		AnimationState		  =	PACKING_TYPE_5 PACKING
			Animation		  
				AnimationName =	#(MODEL)_U_SPCB
				AnimationMode =	ONCE
			End
		End
		
		//	Special Power 6
//		AnimationState		  =	PACKING_TYPE_6 UNPACKING	  
//			Animation		  
//				AnimationName =	#(MODEL)_U_SPCD
//				AnimationMode =	ONCE
//			End
//		End
//	
//		AnimationState		  =	PACKING_TYPE_6 PREPARING
//			Animation		 
//				AnimationName =	#(MODEL)_U_SPCD
//				AnimationMode =	ONCE
//			End
//		End

		AnimationState		  =	PACKING_TYPE_6 PACKING
			Animation		  
				AnimationName =	#(MODEL)_U_SPCD
				AnimationMode =	ONCE
			End
		End




//====== LEVELED
		AnimationState				= LEVELED WEAPONSET_TOGGLE_1	// This state clears itself in 3 seconds
			Animation				= LevelUp
				AnimationName		= #(MODEL)_B_CHRA #(MODEL)_B_LVLA
				AnimationMode		= ONCE
			End
		End

		AnimationState				= LEVELED 						// This state clears itself in 3 seconds
			Animation				= LevelUp
				AnimationName		= #(MODEL)_U_CHRA #(MODEL)_U_LVLA
				AnimationMode		= ONCE
			End
		End

//---------------------- EMOTIONS ---------------------------------------------------------------

		// cheer, mounted
		AnimationState				=	EMOTION_CELEBRATING MOUNTED
			Animation 
				AnimationName		=	#(MODEL)_M_CHRA #(MODEL)_M_IRFA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End

		// cheer, w/ bow on foot
		AnimationState				=	EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
			Animation 
				AnimationName		=	#(MODEL)_B_CHRA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End

		// cheer, on foot
		AnimationState				=	EMOTION_CELEBRATING
			Animation CHRA
				AnimationName		=	#(MODEL)_U_CHRA #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Animation CHRB
				AnimationName		=	#(MODEL)_U_CHRB #(MODEL)_U_CHRA #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
		// raise flag, w/ bow on foot
		AnimationState				=	RAISING_FLAG WEAPONSET_TOGGLE_1
			Animation 
				AnimationName		=	#(MODEL)_B_CHRA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End

		// cheer, on foot
		AnimationState				=	RAISING_FLAG
			Animation CHRA
				AnimationName		=	#(MODEL)_U_CHRA #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Animation CHRB
				AnimationName		=	#(MODEL)_U_CHRB #(MODEL)_U_CHRA #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
		// taunt, mounted
		AnimationState				=	EMOTION_TAUNTING MOUNTED
			Animation 
				AnimationName		=	#(MODEL)_M_TNTA #(MODEL)_M_IRFA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
		// taunt, w/ bow on foot
		AnimationState				=	EMOTION_TAUNTING WEAPONSET_TOGGLE_1
			Animation 
				AnimationName		=	#(MODEL)_B_TNTA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
		// taunt, on foot
		AnimationState				=	EMOTION_TAUNTING
			Animation CHRA
				AnimationName		=	#(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Animation CHRB
				AnimationName		=	#(MODEL)_U_TNTB #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
// 	Animation
// 		AnimationName				= RUMerry_CHRA
// 		AnimationMode				= ONCE
// 	End
// 	Animation
// 		AnimationName				= RUMerry_CHRB
// 		AnimationMode				= ONCE
// 	End
// 	Flags							= RESTART_ANIM_WHEN_COMPLETE
// End
// 
// AnimationState						= EMOTION_TAUNTING
// 	Animation
// 		AnimationName				= RUMerry_TNTB
// 		AnimationMode				= LOOP
// 	End
// End
// 
// AnimationState					= EMOTION_ALERT WEAPONSET_TOGGLE_1
// 	StateName					= STATE_Ready_Rocks
// 	Animation					= IDLA
// 		AnimationName			= RUMerry_IDLA
// 		AnimationMode			= LOOP
// 	End
// End
// AnimationState					= EMOTION_ALERT
// 	StateName					= STATE_Ready_Sword
// 	Animation
// 		AnimationName			= RUMerry_IDLB
// 		AnimationMode			= LOOP
// 	End
// End
		


//====== ENGAGED
		AnimationState				= ENGAGED WEAPONSET_TOGGLE_1
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_B_IDLA
				AnimationMode		= ONCE
			End
		End
		AnimationState				= ENGAGED
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_U_IDLA
				AnimationMode		= ONCE
			End
		End
		AnimationState				= BETWEEN_FIRING_SHOTS_A WEAPONSET_TOGGLE_1
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_B_IDLA
				AnimationMode		= ONCE
			End
		End
		AnimationState				= BETWEEN_FIRING_SHOTS_A
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_U_IDLA
				AnimationMode		= ONCE
			End
		End
		
// --- Idle Toggled

		AnimationState = SELECTED WEAPONSET_TOGGLE_1
			StateName				= STATE_Selected_Bow
			Animation				= Selected_Loop
				AnimationName		= #(MODEL)_B_ATNB
				AnimationMode		= LOOP
				AnimationBlendTime	= 10
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") end
			EndScript
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState = SELECTED
			StateName				= STATE_Selected_Sword
			Animation				= Selected_Loop
				AnimationName		= #(MODEL)_U_ATNB
				AnimationMode		= LOOP
				AnimationBlendTime	= 10
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") end
			EndScript
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End


		AnimationState				= WEAPONSET_TOGGLE_1
			StateName				= STATE_Idle_Bow
			Animation
				AnimationName		=	#(MODEL)_B_IDLA
				AnimationPriority	=	20
				AnimationMode		=	ONCE
				AnimationBlendTime	=	15
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
			EndScript
		End

		IdleAnimationState
			StateName					= STATE_Idle_Sword	
			Animation = Foot_IDLB // Bored Idle
				AnimationName       = #(MODEL)_U_IDLB
				AnimationMode       = ONCE
				AnimationPriority   = 20
			End
			Animation = Foot_IDLC // Bored Fidget
				AnimationName       = #(MODEL)_U_IBFA
				AnimationMode       = ONCE
				AnimationPriority   = 2
			End
			//Animation = Foot_IDLD // Bored Fidget
			//	AnimationName       = #(MODEL)_U_IBFB
			//	AnimationMode       = ONCE
			//	AnimationPriority   = 1
			//End

			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
			EndScript
		End
		

	//---transitions--------------------------------------------

		TransitionState = TRANS_BoredToSelectedSword
		// Once we have proper animations for enter -> idle -> exit, fix this properly.
			Animation = ANTD
				AnimationName	= #(MODEL)_U_ATNA #(MODEL)_U_ATND #(MODEL)_U_IDLA
				AnimationMode	= ONCE
			End		
		End
		
		TransitionState = TRANS_SelectedToBoredSword
			Animation			= ATNF
				AnimationName	= #(MODEL)_U_ATNC #(MODEL)_U_ATNF #(MODEL)_U_ATNE
				AnimationMode	= ONCE
			End		
		End	

		TransitionState = TRANS_BoredToSelectedBow
			Animation = ATNC
				AnimationName		= #(MODEL)_U_ATNF #(MODEL)_U_ATNE
				AnimationMode		= ONCE
			End		
		End
		
		TransitionState = TRANS_CaptainBowToSelectedBow
			Animation = ATNC
				AnimationName		= #(MODEL)_U_ATNF
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationSpeedFactorRange = 1.5 1.5
			End		
		End
		
		TransitionState = TRANS_SelectedToBoredBow
			Animation			= ATNA
				AnimationName	= #(MODEL)_U_ATNF
				AnimationMode	= ONCE
			End		
		End	


		TransitionState       = TRANS_BowToSword
			Animation           = CUHero_STHA
				AnimationName     = #(MODEL)_B_STHA
				AnimationMode     = ONCE
			End
		End

		TransitionState       = TRANS_SwordToBow
			Animation           = CUHero_STHB
				AnimationName     = #(MODEL)_U_STHA
				AnimationMode     = ONCE
			End
		End	

		TransitionState       		= TRANS_BowToSword_Running
			Animation           	= DrawSwords
				AnimationName       = #(MODEL)_B_STHB
				AnimationMode       = ONCE
			End
		End
		
		TransitionState       		= TRANS_SwordToBow_Running
			Animation           	= DrawBow
				AnimationName       = #(MODEL)_U_STHB
				AnimationMode       = ONCE
			End
		End		

	End	
End 
	Side				= Elves
	EditorSorting		= UNIT
	ThreatLevel			= FIRE_DRAKE_THREAT_LEVEL
	ThingClass	= HORDE_UNIT
	CommandPoints	=20
	BountyValue			= FIREDRAKE_BOUNTY_VALUE
	TransportSlotCount	= TRANSPORTSLOTCOUNT_UNIT

	BuildTime	= 40
	BuildCost	= 400
	
	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY    GondorSword
	End

	CrushableLevel		= 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel		= 0
	;CrushDecelerationPercent = 50%
	;CrushRevengeWeapon	= RangedInfantryCrushRevenge
	
LocomotorSet
		Locomotor = FiredrakeLocomotor
		Condition = SET_NORMAL
		Speed     = 60; originally 120
	End

	LocomotorSet
		Locomotor = HumanWanderLocomotor
		Condition = SET_WANDER 
		Speed     = 60; originally 120
	End

	ArmorSet
		Conditions      = None
		Armor           = HeroArmor
		DamageFX        = NormalDamageFX
	End

	CommandSet			= NewValarCommandSet
                        

                        VoiceAttack 							= HeroWizardVoiceAttack
			VoiceAttackAir							= HeroWizardVoiceAttack
			VoiceAttackCharge 						= HeroWizardVoiceAttack
			VoiceAttackMachine 						= HeroWizardVoiceAttack
			VoiceAttackStructure 					= HeroWizardVoiceAttack
			VoiceCreated							= HeroWizardVoiceWandererSalute
			VoiceFear								= HeroWizardVoiceHelpMe
			VoiceFullyCreated						= HeroWizardVoiceWandererSalute
			VoiceGuard								= HeroWizardVoiceMove
			VoiceMove 								= HeroWizardVoiceMove
			VoiceMoveToCamp 						= HeroWizardVoiceMove
			VoiceMoveWhileAttacking 				= HeroWizardVoiceMove
			VoicePriority							= 95
			VoiceRetreatToCastle 					= HeroWizardVoiceMove
			VoiceSelect 							= HeroWizardVoiceSelectMS
			VoiceSelectBattle  						= HeroWizardVoiceSelectBattle
		
			SoundImpact								= ImpactHorse
		
			UnitSpecificSounds
				VoiceAttackFireball					= HeroWizardVoiceAttack
				VoiceEnterUnitElvenTransportShip	= HeroWizardVoiceMove
				VoiceEnterUnitMordorMumakil			= HeroWizardVoiceMove
				VoiceEnterUnitSlaughterHouse		= HeroWizardVoiceMove
				VoiceEnterUnitTransportShip			= HeroWizardVoiceMove
				VoiceGarrison						= HeroWizardVoiceMove
				VoiceInitiateCaptureBuilding		= HeroWizardVoiceCaptureBuilding
			End
		

;-----------------------------

;------------------------------

AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroInvulnerabilityEnabler_Level3
	SpecialPowerTemplate = SpecialAbilityCreateAHeroInvulnerability_Level3
	TriggeredBy			 = Upgrade_ObjectLevel2;							
End
End
AddModule
Behavior = SpecialPowerModule ModuleTag_CreateAHeroInvulnerabilityStarter_Level3
	SpecialPowerTemplate		 = SpecialAbilityCreateAHeroInvulnerability_Level3
	UpdateModuleStartsAttack	 = No
	StartsPaused				 = Yes
	AttributeModifier			 = MagicianInvulnerability
	AttributeModifierRange		 = 0
	AttributeModifierAffectsSelf = Yes
	AttributeModifierAffects	 = ANY 
	;AttributeModifierFX			 = FX_Invulnerability; FX_CreateAHeroInvulnerability_Start
End
End

AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ForcePushEnabler_Level3
	SpecialPowerTemplate = SpecialAbilityForcePush_Level3
	TriggeredBy			 = Upgrade_ElfFaction; 
End
End
AddModule
Behavior = SpecialPowerModule ModuleTag_ForcePushPower_Level3
	SpecialPowerTemplate	 = SpecialAbilityForcePush_Level3
	UpdateModuleStartsAttack = Yes
	StartsPaused			 = Yes
//	InitiateSound			 = GandalfVoiceAttackWizardBlast //this plays when he targets, not when he fires
End
End
AddModule
Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ForcePushUpdate_Level3
	SpecialPowerTemplate = SpecialAbilityForcePush_Level3
	WhichSpecialWeapon	 = 2
	SkipContinue		 = Yes

	UnpackTime			 = 900
	PreparationTime		 = 1   
	PersistentPrepTime	 = 1500	
	PackTime			 = 1100	

	AwardXPForTriggering = 0	 
	StartAbilityRange	 = 180.0
	MustFinishAbility	 = Yes
	SpecialWeapon		 = ForcePush_Level30
End
End

AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroWordOfPoultryEnabler_Level2
	SpecialPowerTemplate = SpecialAbilityCreateAHeroWordOfPoultry_Level2
	TriggeredBy			 = Upgrade_ObjectLevel4
End
End
AddModule
Behavior = SpecialPowerModule ModuleTag_CreateAHeroWordOfPoultryStarter_Level2			// SpecialAbility is	a SpecialPower,	SpecialPower is	anyting	special
	SpecialPowerTemplate = SpecialAbilityCreateAHeroWordOfPoultry_Level2
	StartsPaused		 = Yes
End
End
AddModule
Behavior = ReplaceObjectUpdate ModuleTag_WordOfPoultryUpdate_Level2
	SpecialPowerTemplate    = SpecialAbilityCreateAHeroWordOfPoultry_Level2
	//SkipContinue			= Yes

	UnpackingVariation		= 1

	UnpackTime             	= 800
	PreparationTime			= 1   
	//PersistentPrepTime		= 1000 
	PackTime				= 100
	
	AwardXPForTriggering    = 0
	
	StartAbilityRange		= CREATE_A_HERO_WORD_OF_POULTRY_RANGE_L2
	MustFinishAbility		= Yes
	
	ReplaceObject
		TargetObjectFilter = CREATE_A_HERO_WORD_OF_POULTRY_OBJECT_FILTER
		ReplacementObjectName = Chicken_Replacement Rabbit_Replacement Dog_Replacement Dog1_Replacement Racoon_Replacement Duck_Replacement Cow_Replacement Sheep_Replacement Crow_Replacement //GoatMale_Replacement GoatFemale_Replacement
	End
	ReplaceRadius			= CREATE_A_HERO_WORD_OF_POULTRY_RADIUS_L2
	ReplaceFX				= FX_CreateAHeroReplaceObject
	Scatter					= Yes
End
End

;---------------------
AddModule
		Behavior = UnpauseSpecialPowerUpgrade ModuleTag_IstariLightEnabler
		SpecialPowerTemplate = SpecialAbilityLightingBolt
		TriggeredBy = Upgrade_ObjectLevel3
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_IstariLightPower                      
		SpecialPowerTemplate		= SpecialAbilityLightingBolt
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
		InitiateSound				= SarumanVoiceAttackCharge
	End
End
AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IstariLightUpdate
		SpecialPowerTemplate    = SpecialAbilityLightingBolt
		SkipContinue			= Yes
		UnpackTime              = 1500
 		PreparationTime         = 1  
 		PersistentPrepTime      = 1000
 		PackTime                = 500
		AwardXPForTriggering    = 0
		StartAbilityRange		= 290; Note: This has to be smaller than the weapon range or it'll never succeed
		ApproachRequiresLOS		= Yes		
		SpecialWeapon			= SarumanLightningBlastWeapon
		MustFinishAbility		= Yes
		WhichSpecialWeapon		= 3
		BusyForDuration			= 2500
	End
End
AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
		SpecialPowerTemplate = SpecialAbilityWordOfPower
		TriggeredBy = Upgrade_ObjectLevel5
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_WordStarter       
		SpecialPowerTemplate      = SpecialAbilityWordOfPower
		UpdateModuleStartsAttack  = Yes
		StartsPaused		  	  = Yes
	End
End
AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate   
		SpecialPowerTemplate    = SpecialAbilityWordOfPower
		WhichSpecialWeapon		= 1
		SkipContinue			= Yes

		UnpackTime              = 1700 
		PackTime                = 1	
		FreezeAfterTriggerDuration = 2500 ; Hold AI for this long after we fire.
		
		AwardXPForTriggering    = 0		
		StartAbilityRange		= 80.0
		
		SpecialWeapon			= SunflareWeaponBlast
	End
End
	LocomotorSet
		Locomotor = HeroHumanLocomotor
		Condition = SET_NORMAL 
		Speed     = NORMAL_GOOD_HERO_SPEED
	End
AddModule
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring6
		FireWeaponNugget
			WeaponName = FloodHorseRadiusWeaponRefresh
			Offset = X:-25 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
End
End
;---------------------


Object WildMarauderHorde
	SelectPortrait         =  CPWanderer
	ButtonImage		= HICAHWanderer
	CommandPoints           = 80
	Side			= Elves
	EditorSorting		= UNIT
	EmotionRange		= 240
	DisplayName		= ValarsMagicians
	DisplayNameStrategic 	= ValarsMagicians
	;DescriptionStrategic	= CONTROLBAR:LW_ToolTip_WildBabyDrakeHorde
	MaxSimultaneousOfType		= 3		
	IsAutoBuilt		= Yes
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
		;Weapon			= TERTIARY	DwarvenZealotBoomAxeRangeFinder
		;AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		;AutoChooseSources	= TERTIARY FROM_PLAYER FROM_SCRIPT
		;ShareWeaponReloadTime	= Yes
	End
	;FormationWidth	= 2 		; Width it occupies in formations. Current choices are 1 or 2.
	;FormationDepth	= 2 
	BuildCost = 1400
	BuildTime = 40
	CrushableLevel	=   	0	; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel		= 1
	CommandSet = NewValarCommandSet
	LocomotorSet
		Locomotor = FiredrakeLocomotor
		Condition = SET_NORMAL
		Speed     = 60
	End

	LocomotorSet
		Locomotor = HumanWanderLocomotor
		Condition = SET_WANDER 
		Speed     = 60
	End
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain5
		FrontAngle = 270
		FlankedDelay = 2000
		ObjectStatusOfContained = 
		InitialPayload			= WildMarauder 4
		PassengerFilter			= NONE +INFANTRY
		Slots					= 4
		ShowPips				= No

		ThisFormationIsTheMainFormation = Yes	;//Used to determine which armorset to use (and anything else we want!)
		
		MeleeBehavior = Amoeba
		End

		; Banner Carrier info		
		;BannerCarriersAllowed	= WildBannerMarauder								; types of units that are allowed as banner carriers
		;BannerCarrierPosition	= UnitType:WildMarauder	Pos:X:60.0 Y:6.5	; (DEFAULT) position of banner carrier for fighter horde		
		
		RankInfo		= RankNumber:1 UnitType:WildMarauder Position:X:30 Y:-25	Position:X:30 Y:0	Position:X:30 Y:25	Position:X:30 Y:50					;Position:X:25 Y:-50
		;RankInfo		= RankNumber:2 UnitType:WildMarauder Position:X:0 Y:-5	Leader 1 0	Position:X:0 Y:20 Leader 1 1	Position:X:0 Y:45 Leader 1 2	Position:X:0 Y:-30 Leader 1 3		;Position:X:0 Y:-30 Leader 1 4

		RanksToReleaseWhenAttacking = 1
		
		UseSlowHordeMovement = Yes
		MeleeAttackLeashDistance = 1 ;// How far the hordes can move from the center of the horde when melee attacking.

		AlternateFormation = WildMarauderHordePorcupine
	End
End
;----------------------------------------------------

;------------------------------------------------------

AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroInvulnerabilityEnabler_Level3
	SpecialPowerTemplate = SpecialAbilityCreateAHeroInvulnerability_Level3
	TriggeredBy			 = Upgrade_ObjectLevel2 ;Upgrade_GandalfLightningSword; Upgrade_MiniHordeLvl2
End
End
AddModule
Behavior = SpecialPowerModule ModuleTag_CreateAHeroInvulnerabilityStarter_Level3
	SpecialPowerTemplate		 = SpecialAbilityCreateAHeroInvulnerability_Level3
	UpdateModuleStartsAttack	 = No
	StartsPaused				 = Yes
	AttributeModifier			 = MagicianInvulnerability
	AttributeModifierRange		 = 0
	AttributeModifierAffectsSelf = Yes
	AttributeModifierAffects	 = ANY 
	;AttributeModifierFX			 = FX_Invulnerability; FX_CreateAHeroInvulnerability_Start
End
End

AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ForcePushEnabler_Level3
	SpecialPowerTemplate = SpecialAbilityForcePush_Level3
	TriggeredBy			 = Upgrade_ElfFaction; Upgrade_MiniHordeLvl4
End
End
AddModule
Behavior = SpecialPowerModule ModuleTag_ForcePushPower_Level3
	SpecialPowerTemplate	 = SpecialAbilityForcePush_Level3
	UpdateModuleStartsAttack = Yes
	StartsPaused			 = Yes
//	InitiateSound			 = GandalfVoiceAttackWizardBlast //this plays when he targets, not when he fires
End
End
AddModule
Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ForcePushUpdate_Level3
	SpecialPowerTemplate = SpecialAbilityForcePush_Level3
	WhichSpecialWeapon	 = 2
	SkipContinue		 = Yes

	UnpackTime			 = 900
	PreparationTime		 = 1   
	PersistentPrepTime	 = 1500	
	PackTime			 = 1100	

	AwardXPForTriggering = 0	 
	StartAbilityRange	 = 180.0
	MustFinishAbility	 = Yes
	SpecialWeapon		 = ForcePush_Level30
End
End

AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroWordOfPoultryEnabler_Level2
	SpecialPowerTemplate = SpecialAbilityCreateAHeroWordOfPoultry_Level2
	TriggeredBy			 = Upgrade_ObjectLevel4
End
End
AddModule
Behavior = SpecialPowerModule ModuleTag_CreateAHeroWordOfPoultryStarter_Level2			// SpecialAbility is	a SpecialPower,	SpecialPower is	anyting	special
	SpecialPowerTemplate = SpecialAbilityCreateAHeroWordOfPoultry_Level2
	StartsPaused		 = Yes
End
End
AddModule
Behavior = ReplaceObjectUpdate ModuleTag_WordOfPoultryUpdate_Level2
	SpecialPowerTemplate    = SpecialAbilityCreateAHeroWordOfPoultry_Level2
	//SkipContinue			= Yes

	UnpackingVariation		= 1

	UnpackTime             	= 800
	PreparationTime			= 1   
	//PersistentPrepTime		= 1000 
	PackTime				= 100
	
	AwardXPForTriggering    = 0
	
	StartAbilityRange		= CREATE_A_HERO_WORD_OF_POULTRY_RANGE_L2
	MustFinishAbility		= Yes
	
	ReplaceObject
		TargetObjectFilter = CREATE_A_HERO_WORD_OF_POULTRY_OBJECT_FILTER
		ReplacementObjectName = Chicken_Replacement Rabbit_Replacement Dog_Replacement Dog1_Replacement Racoon_Replacement Duck_Replacement Cow_Replacement Sheep_Replacement Crow_Replacement //GoatMale_Replacement GoatFemale_Replacement
	End
	ReplaceRadius			= CREATE_A_HERO_WORD_OF_POULTRY_RADIUS_L2
	ReplaceFX				= FX_CreateAHeroReplaceObject
	Scatter					= Yes
End
End

;---------------------
AddModule
		Behavior = UnpauseSpecialPowerUpgrade ModuleTag_IstariLightEnabler
		SpecialPowerTemplate = SpecialAbilityLightingBolt
		TriggeredBy = Upgrade_ObjectLevel3
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_IstariLightPower                      
		SpecialPowerTemplate		= SpecialAbilityLightingBolt
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
		InitiateSound				= SarumanVoiceAttackCharge
	End
End
AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IstariLightUpdate
		SpecialPowerTemplate    = SpecialAbilityLightingBolt
		SkipContinue			= Yes
		UnpackTime              = 1500
 		PreparationTime         = 1  
 		PersistentPrepTime      = 1000
 		PackTime                = 500
		AwardXPForTriggering    = 0
		StartAbilityRange		= 290; Note: This has to be smaller than the weapon range or it'll never succeed
		ApproachRequiresLOS		= Yes		
		SpecialWeapon			= SarumanLightningBlastWeapon
		MustFinishAbility		= Yes
		WhichSpecialWeapon		= 3
		BusyForDuration			= 2500
	End
End
AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
		SpecialPowerTemplate = SpecialAbilityWordOfPower
		TriggeredBy = Upgrade_ObjectLevel5
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_WordStarter       
		SpecialPowerTemplate      = SpecialAbilityWordOfPower
		UpdateModuleStartsAttack  = Yes
		StartsPaused		  	  = Yes
	End
End
AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate   
		SpecialPowerTemplate    = SpecialAbilityWordOfPower
		WhichSpecialWeapon		= 1
		SkipContinue			= Yes

		UnpackTime              = 1700 
		PackTime                = 1	
		FreezeAfterTriggerDuration = 2500 ; Hold AI for this long after we fire.
		
		AwardXPForTriggering    = 0		
		StartAbilityRange		= 80.0
		
		SpecialWeapon			= SunflareWeaponBlast
	End
End
	LocomotorSet
		Locomotor = HeroHumanLocomotor
		Condition = SET_NORMAL 
		Speed     = NORMAL_GOOD_HERO_SPEED
	End
End

CommandButton Command_SpellBookEntAllies					
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE
	Upgrade				= Upgrade_TechnologyWildBasicTraining 
	TextLabel			= entpowerf
	ButtonImage			= BWTreasureTrove_BannerCarrier
	ButtonBorderType	= UPGRADE
	DescriptLabel		= entpowerfDesc
	Radial				= Yes
	InPalantir			= Yes
End

CommandSet NewEntsMootCommandSet
  	1 	= Command_ConstructEntGeneric
  	2	= Command_ConstructEntTreeBeard
        3       = Command_SpellBookEntAllies					
  	6 	= Command_Sell
End

Object ElvenEntMoot
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedXf
		TriggeredBy				= Upgrade_TechnologyMordorBasicTraining
		AttributeModifier		= Repair
	End
      End
CommandSet = NewEntsMootCommandSet
End 

Object RohanEntFir
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedXf7
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= SuperEnt
	End
      End
End

Object RohanEntBirch
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedXf7
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= SuperEnt
	End
      End
End

Object RohanEntBase
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedXf7
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= SuperEnt
	End
      End
End
Object RohanTreeBerd
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_ReinforcedXf7
		TriggeredBy				= Upgrade_TechnologyWildBasicTraining 
		AttributeModifier		= SuperEnt
	End
      End
End

Object RockBigTreeberd
AddModule
	Behavior = CreateObjectDie ModuleTag_GoldenAttack
 // TriggeredBy = Upgrade_TechnologyWildBasicTraining
		DeathTypes = ALL
		CreationList = OCL_ElvenWoodSeed
	End
End
End




;------------------------------------------------------------------------------
Armor SpecialEntArmor
  Armor = DEFAULT       	 50%    ; this sets the level for all nonspecified damage types
  Armor = CRUSH         	  1%    ; horseman damage
  Armor = SLASH         	 10%    ; 1%	 		; soldier damage
  Armor = PIERCE        	  1%    ; archer damage
  Armor = FLAME         	200%    ; fire damage
  Armor = FROST          	100%   ;
  Armor = SIEGE         	100%    ; siege damage
  Armor = STRUCTURAL    	 10%    ; Structural damage (Ent rocks)
  Armor = SPECIALIST    	10%    ;
  Armor = CHOP          	500%    ; axe damage
  Armor = HERO         		 50%    ; hero damage
  Armor = HERO_RANGED   	  5%    ; Hero bow damage
  Armor = CAVALRY		 10%
  Armor = MAGIC         	100%    ; hero damage
  
End

ChildObject WildMarauderSwords RohanEntBase ;RUEomer_SPER
	ArmorSet
		Conditions      = None
		Armor           = SpecialEntArmor
		DamageFX        = EntDamageFX
	End
Scale = 0.75
	CommandPoints	= 30
End

Object WildMarauderSwordHorde
	Side			= Elves
	EditorSorting		= UNIT
	EmotionRange		= 240
	DisplayName		= ValarsMagicians; WildMarauderHorde
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_WildMarauderSwordHorde		; WildMarauderHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_WildMarauderSwordHorde		; WildMarauderHorde
	
	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY    TowerGuardHordeRangefinder
	End

	BuildCost		= 1200
	BuildTime		= 35

	ShroudClearingRange 	= WILD_MARAUDERSWORDS_SHROUD_RANGE       
	VisionRange 		= WILD_MARAUDERSWORDS_HORDE_VISION_RANGE
	
	VisionSide = 50%
	VisionRear = 25%
	
	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 1.0%	
	
		
	CrushableLevel	= 2 	;//What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel	= 2 	;//What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles 
	CommandPoints	= 120	; originally 48
		
	CommandSet  	= RohanEntCommandSet; WildMarauderSwordsHordeCommandSet			
		
	FormationWidth 	= 2 	;// Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth 	= 2 	;// Depth it occupies in formations. Current choices are 1 or 2.
	
	TransportSlotCount	= TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf			= SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE  ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND;//UNATTACKABLE 
	ReplaceModule ModuleTag_HordeContain	

         Behavior = HordeContain ModuleTag_HordeContain5
		FrontAngle 		= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload		= WildMarauderSwords 4
		PassengerFilter		= NONE +INFANTRY
		Slots			= 4
		ShowPips		= No

		ThisFormationIsTheMainFormation = Yes	;//Used to determine which armorset to use (and anything else we want!)
		
		MeleeBehavior = Amoeba
		End

		; Banner Carrier info		
		;BannerCarriersAllowed	= WildMarauderSwordBanner				; types of units that are allowed as banner carriers
		;BannerCarrierPosition	= UnitType:WildMarauderswordBanner	Pos:X:60.0 Y:6.5	; (DEFAULT) position of banner carrier for fighter horde		
		
		RankInfo		= RankNumber:1 UnitType:WildMarauderSwords Position:X:30 Y:-25			Position:X:30 Y:0		Position:X:30 Y:25		Position:X:30 Y:50					;Position:X:25 Y:-50
		;RankInfo		= RankNumber:2 UnitType:WildMarauderSwords Position:X:0 Y:-5	Leader 1 0	Position:X:0 Y:20 Leader 1 1	Position:X:0 Y:45 Leader 1 2	Position:X:0 Y:-30 Leader 1 3		;Position:X:0 Y:-30 Leader 1 4

		RanksToReleaseWhenAttacking = 1
		
		UseSlowHordeMovement = Yes
		MeleeAttackLeashDistance = 1 		; // How far the hordes can move from the center of the horde when melee attacking.

		; AlternateFormation = WildMarauderHordePorcupine
	End
End
	LocomotorSet
		Locomotor     = NormalChargeMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = ROHAN_ENT_WALK_SPEED
	End
End

Object GoblinFighter
                        VoiceAttack 							= HeroMenArcherVoiceAttack
			VoiceAttackAir							= HeroMenArcherVoiceAttack
			VoiceAttackCharge 						= HeroMenArcherVoiceAttack
			VoiceAttackMachine 						= HeroMenArcherVoiceAttack
			VoiceAttackStructure 					= HeroMenArcherVoiceAttack
			VoiceCreated							= HeroMenArcherVoiceSalute
			VoiceFear								= HeroMenArcherVoiceHelpMe
			VoiceFullyCreated						= HeroMenArcherVoiceSalute
			VoiceGuard								= HeroMenArcherVoiceMove
			VoiceMove 								= HeroMenArcherVoiceMove
			VoiceMoveToCamp 						= HeroMenArcherVoiceMove
			VoiceMoveWhileAttacking 				= HeroMenArcherVoiceMove
			VoicePriority							= 95
			VoiceRetreatToCastle 					= HeroMenArcherVoiceMove
			VoiceSelect 							= HeroMenArcherVoiceSelectMS
			VoiceSelectBattle  						= HeroMenArcherVoiceSelectBattle
		
			SoundImpact								= ImpactHorse
		
			UnitSpecificSounds
				VoiceEnterUnitElvenTransportShip	= HeroMenArcherVoiceMove
				VoiceEnterUnitMordorMumakil			= HeroMenArcherVoiceMove
				VoiceEnterUnitSlaughterHouse		= HeroMenArcherVoiceMove
				VoiceEnterUnitTransportShip			= HeroMenArcherVoiceMove
				VoiceGarrison						= HeroMenArcherVoiceMove
				VoiceInitiateCaptureBuilding		= HeroMenArcherVoiceCaptureBuilding
			End
		
ReplaceModule ModuleTag_02
  Body = ActiveBody ModuleTag_025
    MaxHealth         = 1000
    MaxHealthDamaged  = GOBLIN_FIGHTER_HEALTH_DAMAGED
	BurningDeathBehavior = Yes
	BurningDeathFX       = FX_InfantryBurningFlame
  End
End
	ArmorSet
		Conditions      = None
		Armor           = HeroArmor
		DamageFX        = NormalDamageFX
	End
	CommandPoints 	= 15
	SelectPortrait         =  CPMaleElfArcher
	ButtonImage		= HICAHMaleElfArcher

	AddModule
	Behavior = GrantUpgradeCreate ModuleTag_1
		UpgradeToGrant = Upgrade_GandalfWhite  ;
	End 
	End

	AddModule
	Behavior = SubObjectsUpgrade CorruptedWeapon_Upgrade270
	TriggeredBy			   = Upgrade_GandalfWhite
	HideSubObjects		   = MithlondBow;WizStaff01_FX01 ;WizStaff01_FX2 ;WizStaff01_FX3 ;WizStaff01_FX4
	HideSubObjects		   = WestronSword
	HideSubObjects		   = BOW_03
	;HideSubObjects		   = BOW_04
	;HideSubObjects		   = BOW_05
	HideSubObjects		   = WizardStaff02 
	HideSubObjects		   = WizStaff02_FX1
	HideSubObjects		   = WizardStaff03 
	HideSubObjects		   = WizStaff03_FX01
	HideSubObjects		   = WizStaff03_FX02
	;HideSubObjects		   = WizardStaff04 
	HideSubObjects		   = WizStaff04_FX01
;----------------------------------------------------------
	HideSubObjects		   = WizStaff04_FX02
	HideSubObjects		   = WizStaff04_FX03
	HideSubObjects		   = WizStaff04_FX04
	HideSubObjects		   = WizStaff04_FX05
	HideSubObjects		   = WizStaff04_FX06
	HideSubObjects		   = WizStaff04_FX07
	HideSubObjects		   = WizStaff04_FX01
	HideSubObjects		   = STFF_05 
	HideSubObjects		   = STFF_06 



	HideSubObjects		   = Shld_01
	HideSubObjects		   = Shld_02
	HideSubObjects		   = Shld_03
	HideSubObjects		   = Shld_04
	HideSubObjects		   = Shld_05
	HideSubObjects		   = Shld_06

	HideSubObjects		   = HLMT_01
	HideSubObjects		   = HLMT_02
	;HideSubObjects		   = HLMT_03
	;HideSubObjects		   = HLMT_04
	HideSubObjects		   = BOOT_03
	HideSubObjects		   = BOOT_01
	HideSubObjects		   = BOOT_02
	HideSubObjects		   = SLDR_01
	HideSubObjects		   = SLDR_02

	HideSubObjects		   = GNLT_01
	HideSubObjects		   = GNLT_02
	;HideSubObjects		   = GNLT_03
	HideSubObjects		   = GNLT_04
	HideSubObjects		   = GNLT_05
	HideSubObjects		   = GNLT_06
	HideSubObjects		   = GNLT_07

	HideSubObjects		   = CHEST_01
	HideSubObjects		   = CHEST_02
	HideSubObjects		   = CHEST_03
        ;HideSubObjects		   = CHEST_03

	FadeTimeInSeconds      = 0.0
	RecolorHouse		   = No

	End
        End

RemoveModule ModuleTag_01
AddModule
Draw = W3DScriptedModelDraw ModuleTag_DRAW1

DefaultModelConditionState
	Model				 = CHAR_EL_U_SKN
	Skeleton			 = CHAR_AR_U_SKL
	ModelAnimationPrefix = CHAR_AR
	PortraitImageName	 = CPMaleElfArcher
	ButtonImageName		 = HICAHMaleElfArcher
	ParticleSysBone		= NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
	ParticleSysBone		= NONE Predator02 FollowBone:Yes Persist:HOLD PersistID:101
	WeaponLaunchBone	= PRIMARY ARROW
End


//================== ANIMATIONS =================================================================

//----------- Special Create A Hero Creation Screen Animations ---------------
AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN CREATE_A_HERO_EXAMINE_SELF CREATE_A_HERO_SELECTED_CHEER 
	StateName			   = STATE_ExamineSelf
	Animation			   = ExamineSelf
		AnimationName	   = #(MODEL)_C_CLRA
		AnimationMode	   = ONCE
		AnimationBlendTime = 20
	End
End

AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN CREATE_A_HERO_EXAMINE_WEAPON_RIGHT CREATE_A_HERO_SELECTED_CHEER 
	StateName			   = STATE_ExamineWeapon
	Animation			   = WeaponSwap
		AnimationName	   = #(MODEL)_C_WPNA
		AnimationMode	   = ONCE
		AnimationBlendTime = 20
	End
End

AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN USER_75
 	StateName			   = STATE_SwapModels
 	Animation			   = WeaponSwap
 		AnimationName	   = #(MODEL)_C_ATNB #(MODEL)_C_ATND
 		AnimationMode	   = MANUAL
 		AnimationBlendTime = 0
 	End
End





//-----------------------------------------------------------------------------
AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN CREATE_A_HERO_SELECTED_CHEER
	StateName = STATE_SelectedCheer
	Animation = Foot_ATNB // Bored Idle
		AnimationName	   = #(MODEL)_C_ATNB #(MODEL)_C_ATND
		AnimationMode	   = ONCE
		AnimationPriority  = 90
		AnimationBlendTime = 20
	End
	Animation = Foot_ATND // Bored Fidget
		AnimationName	   = #(MODEL)_C_ATND #(MODEL)_C_ATNB
		AnimationMode	   = ONCE
		AnimationPriority  = 10
		AnimationBlendTime = 20
	End
	Animation = Foot_ATNE // Bored Fidget
		AnimationName	   = #(MODEL)_C_ATNE #(MODEL)_C_ATND #(MODEL)_C_ATNB
		AnimationMode	   = ONCE
		AnimationPriority  = 3
		AnimationBlendTime = 20
	End
	Flags =	RESTART_ANIM_WHEN_COMPLETE
	BeginScript //script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Unselected" then 
			CurDrawableSetTransitionAnimState("Trans_SelectedCheer") 
		end
//  		if Prev == "STATE_SwapModels" then 
//  			CurDrawableSetTransitionAnimState("Trans_SwapModels") 
//  		end
	EndScript
End

AnimationState = CREATE_A_HERO_IN_CREATION_SCREEN
	StateName = STATE_Unselected
	Animation = Foot_ATNB // Bored Idle
		AnimationName       = #(MODEL)_C_ATNB #(MODEL)_C_ATND
		AnimationMode       = ONCE
		AnimationPriority   = 90
		AnimationBlendTime = 10
	End
	Animation = Foot_ATND // Bored Fidget
		AnimationName       = #(MODEL)_C_ATND #(MODEL)_C_ATNB
		AnimationMode       = ONCE
		AnimationPriority   = 10
		AnimationBlendTime = 10
	End
	Animation = Foot_ATNE // Bored Fidget
		AnimationName       = #(MODEL)_C_ATNE #(MODEL)_C_ATND #(MODEL)_C_ATNB
		AnimationMode       = ONCE
		AnimationPriority   = 3
		AnimationBlendTime = 10
	End
	Flags =	RESTART_ANIM_WHEN_COMPLETE
 	BeginScript //script to set transition from moving
 		Prev = CurDrawablePrevAnimationState()
 		if Prev == "STATE_SwapModels" then 
 			CurDrawableSetTransitionAnimState("Trans_SwapModels") 
 		end
 	EndScript
End

TransitionState = Trans_ExamineWeapon
	Animation = Transition
		AnimationName = #(MODEL)_C_WPNA
		AnimationMode = ONCE
		AnimationBlendTime = 20
	End
End
TransitionState = Trans_ExamineSelf
	Animation = Transition
		AnimationName = #(MODEL)_C_CLRA
		AnimationMode = ONCE
		AnimationBlendTime = 20
	End
End
TransitionState = Trans_SelectedCheer
	Animation = Transition
		AnimationName = #(MODEL)_C_SLCA
		AnimationMode = ONCE
		AnimationBlendTime = 20
	End
End

TransitionState = Trans_SwapModels
	StateName = STATE_Unselected
	Animation = Transition
		AnimationName = #(MODEL)_C_ATNB #(MODEL)_C_ATND
		AnimationMode = ONCE
		AnimationBlendTime = 0
	End
End



//----------- Climbing/rappelling ---------------
AnimationState						= CLIMBING WEAPONSET_TOGGLE_1
	StateName						= STATE_Climbing
	Animation						= Climbing
		AnimationName				= #(MODEL)_U_WALB
		AnimationMode				= LOOP
		AnimationBlendTime			= 10
	End
	BeginScript//script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Running"  then CurDrawableSetTransitionAnimState("Trans_RunningToClimbing_WeaponToggle") return end
	EndScript
End
TransitionState = Trans_RunningToClimbing_WeaponToggle
	Animation = Transition
		AnimationName = #(MODEL)_B_WALA
		AnimationMode = ONCE
	End
End

AnimationState						= CLIMBING
	StateName						= STATE_Climbing
	Animation						= Climbing
		AnimationName				= #(MODEL)_U_WALB
		AnimationMode				= LOOP
		AnimationBlendTime			= 10
	End
	BeginScript//script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Running"  then CurDrawableSetTransitionAnimState("Trans_RunningToClimbing") return end
	EndScript
End
TransitionState = Trans_RunningToClimbing
	Animation = Transition
		AnimationName = #(MODEL)_U_WALA
		AnimationMode = ONCE
	End
End

AnimationState						= RAPPELLING WEAPONSET_TOGGLE_1
	StateName						= STATE_Rappelling
	Animation						= Rapelling
		AnimationName				= #(MODEL)_U_WALD
		AnimationMode				= LOOP
		AnimationBlendTime			= 10
	End
	BeginScript//script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Climbing"  then CurDrawableSetTransitionAnimState("Trans_ClimbingToRappelling") return end
	EndScript
End
AnimationState						= RAPPELLING
	StateName						= STATE_Rappelling
	Animation						= Rapelling
		AnimationName				= #(MODEL)_U_WALD
		AnimationMode				= LOOP
		AnimationBlendTime			= 10
	End
	BeginScript//script to set transition from moving
		Prev = CurDrawablePrevAnimationState()
		if Prev == "STATE_Climbing"  then CurDrawableSetTransitionAnimState("Trans_ClimbingToRappelling") return end
	EndScript
End
TransitionState = Trans_ClimbingToRappelling
	Animation = Transition
		AnimationName = #(MODEL)_U_WALC
		AnimationMode = ONCE
	End
End
TransitionState = Trans_RappellingToRunning_WeaponToggle
	Animation = Transition
		AnimationName = MUGblnSwrd_B_WALE
		AnimationMode = ONCE
	End
End
TransitionState = Trans_RappellingToRunning
	Animation = Transition
		AnimationName = MUGblnSwrd_U_WALE
		AnimationMode = ONCE
	End
End
	



// --------- MOUNTED  ------------

// --- Dying Anims
AnimationState					=	DYING AFLAME MOUNTED
	Animation					=	Fire
		AnimationName			=	#(MODEL)_M_MFDA 
		AnimationSpeedFactorRange = 0.9 1.1
	End
	BeginScript
		CurDrawableHideSubObject("arrow") //Circumvents blend issues when the arrow is being shown...
	EndScript
End

AnimationState				=	DYING SPLATTED MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_LNDA
		AnimationMode		=	ONCE
	End
End
AnimationState        = DYING MOUNTED
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_M_DIEA
		AnimationMode     = ONCE
	End
End

AnimationState				=	STUNNED_STANDING_UP MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_GTPA
		AnimationMode		=	ONCE
		AnimationSpeedFactorRange = 1.5 1.5
	End
End

AnimationState				=	STUNNED MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_LNDA
		AnimationMode		=	ONCE
	End
End

AnimationState				=	FREEFALL MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_FLYA
		AnimationMode		=	LOOP
	End
	Flags					=	RANDOMSTART
End

AnimationState				=	STUNNED_FLAILING MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_FLYA
		AnimationMode		=	LOOP
	End
	Flags					=	RANDOMSTART
End

AnimationState        = PASSENGER MOUNTED
	Animation
		AnimationName       = #(MODEL)_M_GBDA
		AnimationMode       = LOOP
	End
	Flags               = RANDOMSTART
End

AnimationState        = MOUNTED LEVELED	// This state clears itself in 3 of your Earth seconds
	Animation
		AnimationName           = #(MODEL)_M_LVLA
		AnimationMode       = ONCE
	End
End

AnimationState        = MOUNTED RAISING_FLAG	// This state clears itself in 3 of your Earth seconds
	Animation
		AnimationName           = #(MODEL)_M_CHRA
		AnimationMode		=	ONCE
	End
	Flags					=	RESTART_ANIM_WHEN_COMPLETE
End

// --- Attacking Anims		
AnimationState				= FIRING_OR_PREATTACK_A MOUNTED	// Melee attack.
	Animation
		AnimationName		= #(MODEL)_M_ATKA #(MODEL)_M_ATKB
		AnimationMode		= ONCE
		UseWeaponTiming		= Yes
	End
End

// --- Moving Anims
AnimationState				=	MOUNTED TURN_LEFT_HIGH_SPEED
	Animation
		AnimationName		=	#(MODEL)_M_TNL1
		AnimationMode		=	LOOP
		AnimationSpeedFactorRange= 1.8 1.8
		AnimationBlendTime	=	20
	End
End

AnimationState				=	MOUNTED TURN_RIGHT_HIGH_SPEED
	Animation
		AnimationName		=	#(MODEL)_M_TNR1
		AnimationMode		=	LOOP
		AnimationSpeedFactorRange= 1.8 1.8
		AnimationBlendTime	=	20
	End
End

AnimationState				=	MOVING TURN_LEFT MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_TRNL
		AnimationMode		=	LOOP
	End
//			//ParticleSysBone			=	None CalvaryDustTrails
End

AnimationState				=	MOVING TURN_RIGHT MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_TRNR
		AnimationMode		=	LOOP
	End
//			//ParticleSysBone			=	None CalvaryDustTrails
End

AnimationState				=	MOVING ACCELERATE MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_ACCL
		AnimationMode		=	LOOP
	End
	//ParticleSysBone			=	None CalvaryDustTrails
End

AnimationState				=	MOVING DECELERATE MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_DECL
		AnimationMode		=	ONCE
	End
	//ParticleSysBone			=	None CalvaryDustTrails
End

AnimationState				=	MOVING WALKING MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_WLKA
		AnimationMode		=	LOOP
	End
	Flags					=	RANDOMSTART
	//ParticleSysBone			=	None InfantryDustTrails  
End

AnimationState				=	MOVING BACKING_UP MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_BAKA
		AnimationMode		=	LOOP
	End
	Flags					=	RANDOMSTART
	//ParticleSysBone			=	None InfantryDustTrails  
End

AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_A
	ShareAnimation		= Yes
	Animation
		AnimationName       = #(MODEL)_M_ATRA
		AnimationMode       = LOOP
	End
	Flags               = RANDOMSTART  
End

AnimationState				=	MOVING MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_RUNA
		AnimationMode		=	LOOP
	End
 	Flags					=	RANDOMSTART
	//ParticleSysBone			=	None CalvaryDustTrails  
End

// --- Selected Anims
AnimationState				=	SELECTED MOUNTED
	SimilarRestart			=   Yes			
	StateName				=	AtAttentionIdleMounted
	Animation				=	ATNB
		AnimationName		=	#(MODEL)_M_ATNB
		AnimationMode		=	LOOP
	End
	BeginScript
		Prev = CurDrawablePrevAnimationState()
		if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
		if Prev == "AtAttentionIdleMounted" then CurDrawableSetTransitionAnimState("TRANS_Select") end
	EndScript
End

TransitionState				=	TRANS_Select
	Animation
		AnimationName		=	#(MODEL)_M_ATNA
		AnimationMode		=	ONCE
	End
End

// --- Idle Anims
AnimationState				= MOUNTED
	Animation
		AnimationName		=	#(MODEL)_M_IDLA
		AnimationPriority	=	20
		AnimationMode		=	ONCE
		AnimationBlendTime	=	15
	End
	Flags				=	RESTART_ANIM_WHEN_COMPLETE
End

// --------- UNMOUNTED  ------------

//------------------  DYING -------------------------------------------------------------

// --- Flying through the air.
AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_FLYA
		AnimationMode     = LOOP
	End
	Flags               = RANDOMSTART
End

AnimationState        = STUNNED_FLAILING 
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_U_FLYA
		AnimationMode     = LOOP
	End
	Flags               = RANDOMSTART
End

// --- Dying anims
AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_LNDA
		AnimationMode     = ONCE
	End
End

AnimationState        = DYING SPLATTED
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_U_LNDA
		AnimationMode     = ONCE
	End
End

AnimationState        = DYING WEAPONSET_TOGGLE_1	//WEAPONSTATE_CLOSE_RANGE
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_DIEA
		AnimationMode     = ONCE
	End
End

AnimationState        = DYING
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_U_DIEA
		AnimationMode     = ONCE
	End
	Animation           = GUHero_DIEB
		AnimationName     = #(MODEL)_U_DIEB
		AnimationMode     = ONCE
	End
End


// --- Stunned anims


AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_GTPA
		AnimationMode     = ONCE
		AnimationSpeedFactorRange = 1.5 1.5
	End
End

AnimationState        = STUNNED_STANDING_UP
	StateName           = STATE_Sword
	Animation
		AnimationName     = #(MODEL)_U_GTPA
		AnimationMode     = ONCE
		AnimationSpeedFactorRange = 1.5 1.5
	End
End

AnimationState        = STUNNED WEAPONSET_TOGGLE_1
	StateName           = STATE_Bow
	Animation
		AnimationName     = #(MODEL)_B_LNDA
		AnimationMode     = ONCE
	End
End

AnimationState        = STUNNED 
	StateName           = STATE_Sword
	Animation           = GUHero_LNDA
		AnimationName     = #(MODEL)_U_LNDA
		AnimationMode     = ONCE
	End
End				

//------------------ SPECIAL POWER ANIMS ---------------------


// RAIN OF ARROWS SPECIAL POWER //
AnimationState				= PACKING_TYPE_1  WEAPONSET_TOGGLE_1
	StateName				= rainofarrows
	Animation
		AnimationName		= #(MODEL)_B_ATKA2
		AnimationMode		= LOOP
	End
//			FXEvent	= Frame:6	Name: FX_SarumanDominateAtSelf
End

// DOMINATE SPECIAL POWER //
AnimationState				= PACKING_TYPE_1
	StateName				= Curse
	Animation
		AnimationName		= #(MODEL)_U_LVLA
		AnimationMode		= ONCE
	End
//			FXEvent	= Frame:6	Name: FX_SarumanDominateAtSelf
End

// TELEPORT SPECIAL POWER //
AnimationState				= PACKING_TYPE_3
	StateName				= Curse
	Animation
		AnimationName		= #(MODEL)_U_SPCA
		AnimationMode		= ONCE
	End
//			FXEvent	= Frame:6	Name: FX_SarumanDominateAtSelf
End

//--------------------- Wound Arrow anim
AnimationState        =  SPECIAL_WEAPON_TWO
	StateName = STATE_Bow
	Animation
		AnimationName       = #(MODEL)_U_SPCL #(MODEL)_U_ATKC
		AnimationMode       = ONCE
	End
	FrameForPristineBonePositions = 59
	BeginScript
		CurDrawableShowSubObject("arrow")
	EndScript
End
		
//------------------ ATTACKING --------------------------------------------------------------------
		// Attacking Anims [Weapon_A]
		
		
		
		AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
			Animation           = TrotAndFire
				AnimationName       = #(MODEL)_U_ATRA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART
			StateName = RunAndSwing
		End
		
		AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			
			Animation           = ATKD
				AnimationName     = #(MODEL)_U_ATKD
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
				AnimationSpeedFactorRange = 1.149 1.149
			End			
			Animation           = ATKE
				AnimationName    = #(MODEL)_U_ATKE
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
				AnimationSpeedFactorRange = 1.149 1.149
			End
			
			Animation           = ATKF
				AnimationName    = #(MODEL)_U_ATKF
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.47 1.47
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
			//	FrameForPristineBonePositions = 59
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
			EndScript
		End

//------------------ MOVING -------------------------------------------------------------

		AnimationState        = MOVING USER_4                 // Moving slaughter
			StateName           = Slaughter
			Flags               = RANDOMSTART
			//ParticleSysBone     = None InfantryDustTrails
			Animation           = GUHero_ATKE
				AnimationName     = #(MODEL)_U_ATKE
				AnimationMode     = LOOP
			End
			StateName           = NoSword
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
			EndScript
		End

		//--- Running with bow
		AnimationState			= MOVING WEAPONSET_TOGGLE_1		//WEAPONSTATE_CLOSE_RANGE
			StateName           = STATE_RunningBow
			Flags               = RANDOMSTART
			//ParticleSysBone    = None InfantryDustTrails
			Animation
				AnimationName   = #(MODEL)_B_RUNA
//				AnimationMode   = LOOP
				AnimationSpeedFactorRange = 0.85 0.85
//				Distance		= 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
				if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning_WeaponToggle") return end
			EndScript
		End

		//--- Running with sword
		AnimationState			= MOVING
			StateName           = STATE_RunningSword
			Flags               = RANDOMSTART
			//ParticleSysBone    = None InfantryDustTrails
			Animation
				AnimationName   = #(MODEL)_U_RUNA
//				AnimationMode   = LOOP
				AnimationSpeedFactorRange = 0.85 0.85
//				Distance = 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
				if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning") return end
			EndScript
		End

		//---------------------------------------------------
		//New style firing with bow
		AnimationState					=	PREATTACK_A WEAPONSET_TOGGLE_1
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	#(MODEL)_B_ATKA1
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				//AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_A WEAPONSET_TOGGLE_1
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	#(MODEL)_B_ATKA2
				AnimationMode			=	ONCE
//				UseWeaponTiming			=	Yes			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.1 1.1		// Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				//AnimationBlendTime		=	10
			End
		End
		//---------------------End New style firing

		//AnimationState					=	CONTINUOUS_FIRE_MEAN WEAPONSET_TOGGLE_1
		//	Animation					=	HangFrameWhileCoasting
		//		AnimationName			=	#(MODEL)_B_ATKA2
		//		AnimationMode			=	MANUAL
		//	End
		//End
		
		//AnimationState						= CONTINUOUS_FIRE_SLOW WEAPONSET_TOGGLE_1
		//	//StateName						= STATE_Idle_Bow
		//	Animation						= PutAwayArrow
		//		AnimationName				= #(MODEL)_U_ATKA3
		//		AnimationMode				= ONCE
		//	End
		//End
				
		//End New style firing
		//---------------------------------------------------

		AnimationState				= FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
			StateName				= STATE_Firing
			Animation
				AnimationName		= #(MODEL)_B_ATKA1
				AnimationMode		= ONCE
				UseWeaponTiming		= No			// UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
			End
		End

		AnimationState				= FIRING_OR_PREATTACK_A // Melee attack.
			Animation
				AnimationName		= #(MODEL)_U_ATKA1 #(MODEL)_U_ATKA #(MODEL)_U_ATKB
				AnimationMode		= ONCE
				UseWeaponTiming		= Yes
			End
		End


		
//-------------------- HIT REACTIONS -----------------------------------------------------------

// this hit animation attack stance
		AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
			Animation
				AnimationName = #(MODEL)_B_HITA
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
			Animation
				AnimationName = #(MODEL)_B_HITA
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION
			Animation = Sword_HITA
				AnimationName = #(MODEL)_U_HITA
				AnimationMode = ONCE
			End
			Animation = Sword_HITB
				AnimationName = #(MODEL)_U_HITB
				AnimationMode = ONCE
			End

			BeginScript
				PrevAnim = CurDrawablePrevAnimation()
				if PrevAnim == "Foot_IDLB"
				then
					return "Sword_HITB"
				else
					return "Swort_HITA"
				end
			EndScript
		End

//------------ SPECIAL POWERS ------------------------------------------------------------------		

		AnimationState		  =	THROWN_PROJECTILE
			Animation
				AnimationName =	#(MODEL)_U_LEP2
				AnimationMode =	LOOP
			End
		End

		AnimationState		  =	ABOUT_TO_HIT
			Animation
				AnimationName =	#(MODEL)_U_LEP3
				AnimationMode =	ONCE
			End
		End

		AnimationState				= SPECIAL_POWER_1							; Aragorn shouting Elendil anim
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_U_SPCA
				AnimationMode		= ONCE
			End
			ParticleSysBone			= B_SWORDBONE ElendilFlare FollowBone:yes
			ParticleSysBone			= B_SWORDBONE ElendilSwordFlare FollowBone:yes
;			FXEvent	= Name: FX_ElendilGlowEvent
		End

		// WORD OF POWER ANIMS ON FOOT //
		AnimationState		  =	SPECIAL_WEAPON_ONE
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCA
				AnimationMode =	ONCE
			End
			//FXEvent			  =	Frame:5	Name:FX_GandalfPreAttackBlast
		End

		//	WIZARD BLAST ANIMS MOUNTED //
		AnimationState		  =	SPECIAL_WEAPON_TWO MOUNTED
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPLD #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End
	
		//	WIZARD BLAST ANIMS ON FOOT //
		AnimationState		  =	SPECIAL_WEAPON_TWO
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCB #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End

		//	ISTARI LIGHT STAFF WEAPON MOUNTED //
		AnimationState		  =	SPECIAL_WEAPON_THREE MOUNTED	// FIRING_OR_PREATTACK_C
			StateName		  =	Attacking
			Animation		  =	StaffLaser
				AnimationName =	#(MODEL)_U_SPCD #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:30 Name:FX_GandalfStaffFlare
		End

		//	ISTARI LIGHT STAFF WEAPON ON FOOT //
		AnimationState		  =	SPECIAL_WEAPON_THREE // FIRING_OR_PREATTACK_C
			StateName		  =	Attacking
			Animation		  =	StaffLaser
				AnimationName =	#(MODEL)_U_SPCE #(MODEL)_U_ATKA//	isitari's light?
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:30 Name:FX_GandalfStaffFlare
		End
		
		; Throwing and cripple strike
		AnimationState		  =	SPECIAL_WEAPON_FOUR
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCD
				AnimationMode =	ONCE
			End
			FrameForPristineBonePositions	= 44
		End

		AnimationState		  =	SPECIAL_WEAPON_FIVE
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCE
				AnimationMode =	ONCE
			End
		End

		AnimationState		  =	SPECIAL_WEAPON_SIX
			StateName		  =	Attacking
			Animation
				AnimationName =	#(MODEL)_U_SPCF
				AnimationMode =	ONCE
			End
		End

		//	Special Power 1
		AnimationState		  =	PACKING_TYPE_1 UNPACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordStart
				AnimationName =	#(MODEL)_U_SPCC #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:14 Name:FX_CreateAHeroLightningCharge
//			FXEvent			  =	Frame:70 Name:FX_GandalfLightningFizzle
			FXEvent			  =	Frame:14 Name:FX_GandalfLightningSword	FrameStop:70
		End
	
		AnimationState		  =	PACKING_TYPE_1 PREPARING
			StateName		  =	Attacking
			Animation		  =	LightningSwordLoop
				AnimationName =	#(MODEL)_U_SPCA #(MODEL)_U_ATKA
				AnimationMode =	LOOP
			End
		End

		AnimationState		  =	PACKING_TYPE_1 PACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordPutAway
				AnimationName =	#(MODEL)_U_SPCB #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End

		// (specific) dwarf train allies.
		AnimationState		  =	PACKING_TYPE_2 CREATE_A_HERO_20 CREATE_A_HERO_21
			Animation
				AnimationName =	#(MODEL)_U_SPCC
				AnimationMode =	LOOP
			End
		End

		//	Special Power 2
		AnimationState		  =	PACKING_TYPE_2 UNPACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordStart
				AnimationName =	#(MODEL)_U_SPCC #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:14 Name:FX_CreateAHeroLightningCharge
//			FXEvent			  =	Frame:70 Name:FX_GandalfLightningFizzle
			FXEvent			  =	Frame:14 Name:FX_GandalfLightningSword	FrameStop:70
		End
	
		AnimationState		  =	PACKING_TYPE_2 PREPARING
			StateName		  =	Attacking
			Animation		  =	LightningSwordLoop
				AnimationName =	#(MODEL)_U_SPCA #(MODEL)_U_ATKA
				AnimationMode =	LOOP
			End
		End

		AnimationState		  =	PACKING_TYPE_2 PACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordPutAway
				AnimationName =	#(MODEL)_U_SPCB #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End
		
//----------- Captain of Gondor - Sword --------------------------------------------
		AnimationState        = PACKING_TYPE_2 WEAPONSET_TOGGLE_1
			StateName		  =	CaptainPower
			Animation           = GUHero_CHRC
				AnimationName     = #(MODEL)_U_CHRC
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.2 1.2
			End
		End

//----------- Captain of Gondor - Bow -----------------------------------------------
		AnimationState        = PACKING_TYPE_2
			StateName		  =	STATE_CaptainBow
			Animation           = GUHero_CHRD
				AnimationName     = #(MODEL)_U_SPCE #(MODEL)_U_SPCA #(MODEL)_U_CHRD
				AnimationMode     = ONCE
//				AnimationSpeedFactorRange = 0.75 0.75
			End
		End

		//	Special Power 3
		AnimationState		  =	PACKING_TYPE_3 UNPACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordStart
				AnimationName =	#(MODEL)_U_SPCC #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
			FXEvent			  =	Frame:14 Name:FX_CreateAHeroLightningCharge
//			FXEvent			  =	Frame:70 Name:FX_GandalfLightningFizzle
			FXEvent			  =	Frame:14 Name:FX_GandalfLightningSword	FrameStop:70
		End
	
		AnimationState		  =	PACKING_TYPE_3 PREPARING
			StateName		  =	Attacking
			Animation		  =	LightningSwordLoop
				AnimationName =	#(MODEL)_U_SPCA #(MODEL)_U_ATKA
				AnimationMode =	LOOP
			End
		End

		AnimationState		  =	PACKING_TYPE_3 PACKING
			StateName		  =	Attacking
			Animation		  =	LightningSwordPutAway
				AnimationName =	#(MODEL)_U_SPCB #(MODEL)_U_ATKA
				AnimationMode =	ONCE
			End
		End
		
		//	Special Power 4
		AnimationState		  =	PACKING_TYPE_4 UNPACKING	  
			Animation		  
				AnimationName =	#(MODEL)_U_SPCA
				AnimationMode =	ONCE
			End
		End
	
		AnimationState		  =	PACKING_TYPE_4 PREPARING
			Animation		 
				AnimationName =	#(MODEL)_U_SPCA
				AnimationMode =	ONCE
			End
		End

		AnimationState		  =	PACKING_TYPE_4 PACKING
			Animation		  
				AnimationName =	#(MODEL)_U_SPCA
				AnimationMode =	ONCE
			End
		End
		
		//	Special Power 5
		
		//		AnimationState		  =	PACKING_TYPE_5 UNPACKING WEAPONSET_TOGGLE_1  
//			Animation		  
//				AnimationName =	#(MODEL)_B_SPCB
//				AnimationMode =	ONCE
//			End
//		End
//	
//		AnimationState		  =	PACKING_TYPE_5 PREPARING WEAPONSET_TOGGLE_1
//			Animation		 
//				AnimationName =	#(MODEL)_B_SPCB
//				AnimationMode =	ONCE
//			End
//		End

		AnimationState		  =	PACKING_TYPE_5 PACKING WEAPONSET_TOGGLE_1
			Animation		  
				AnimationName =	#(MODEL)_B_SPCB
				AnimationMode =	ONCE
				AnimationSpeedFactorRange = 0.7333 0.7333
			End
		End
		
//		AnimationState		  =	PACKING_TYPE_5 UNPACKING	  
//			Animation		  
//				AnimationName =	#(MODEL)_U_SPCB
//				AnimationMode =	ONCE
//			End
//		End
//	
//		AnimationState		  =	PACKING_TYPE_5 PREPARING
//			Animation		 
//				AnimationName =	#(MODEL)_U_SPCB
//				AnimationMode =	ONCE
//			End
//		End

		AnimationState		  =	PACKING_TYPE_5 PACKING
			Animation		  
				AnimationName =	#(MODEL)_U_SPCB
				AnimationMode =	ONCE
			End
		End
		
		//	Special Power 6
//		AnimationState		  =	PACKING_TYPE_6 UNPACKING	  
//			Animation		  
//				AnimationName =	#(MODEL)_U_SPCD
//				AnimationMode =	ONCE
//			End
//		End
//	
//		AnimationState		  =	PACKING_TYPE_6 PREPARING
//			Animation		 
//				AnimationName =	#(MODEL)_U_SPCD
//				AnimationMode =	ONCE
//			End
//		End

		AnimationState		  =	PACKING_TYPE_6 PACKING
			Animation		  
				AnimationName =	#(MODEL)_U_SPCD
				AnimationMode =	ONCE
			End
		End




//====== LEVELED
		AnimationState				= LEVELED WEAPONSET_TOGGLE_1	// This state clears itself in 3 seconds
			Animation				= LevelUp
				AnimationName		= #(MODEL)_B_CHRA #(MODEL)_B_LVLA
				AnimationMode		= ONCE
			End
		End

		AnimationState				= LEVELED 						// This state clears itself in 3 seconds
			Animation				= LevelUp
				AnimationName		= #(MODEL)_U_CHRA #(MODEL)_U_LVLA
				AnimationMode		= ONCE
			End
		End

//---------------------- EMOTIONS ---------------------------------------------------------------

		// cheer, mounted
		AnimationState				=	EMOTION_CELEBRATING MOUNTED
			Animation 
				AnimationName		=	#(MODEL)_M_CHRA #(MODEL)_M_IRFA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End

		// cheer, w/ bow on foot
		AnimationState				=	EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
			Animation 
				AnimationName		=	#(MODEL)_B_CHRA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End

		// cheer, on foot
		AnimationState				=	EMOTION_CELEBRATING
			Animation CHRA
				AnimationName		=	#(MODEL)_U_CHRA #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Animation CHRB
				AnimationName		=	#(MODEL)_U_CHRB #(MODEL)_U_CHRA #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
		// raise flag, w/ bow on foot
		AnimationState				=	RAISING_FLAG WEAPONSET_TOGGLE_1
			Animation 
				AnimationName		=	#(MODEL)_B_CHRA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End

		// cheer, on foot
		AnimationState				=	RAISING_FLAG
			Animation CHRA
				AnimationName		=	#(MODEL)_U_CHRA #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Animation CHRB
				AnimationName		=	#(MODEL)_U_CHRB #(MODEL)_U_CHRA #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
		// taunt, mounted
		AnimationState				=	EMOTION_TAUNTING MOUNTED
			Animation 
				AnimationName		=	#(MODEL)_M_TNTA #(MODEL)_M_IRFA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
		// taunt, w/ bow on foot
		AnimationState				=	EMOTION_TAUNTING WEAPONSET_TOGGLE_1
			Animation 
				AnimationName		=	#(MODEL)_B_TNTA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
		// taunt, on foot
		AnimationState				=	EMOTION_TAUNTING
			Animation CHRA
				AnimationName		=	#(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Animation CHRB
				AnimationName		=	#(MODEL)_U_TNTB #(MODEL)_U_TNTA
				AnimationMode		=	ONCE
			End
			Flags					=	RESTART_ANIM_WHEN_COMPLETE
		End
		
// 	Animation
// 		AnimationName				= RUMerry_CHRA
// 		AnimationMode				= ONCE
// 	End
// 	Animation
// 		AnimationName				= RUMerry_CHRB
// 		AnimationMode				= ONCE
// 	End
// 	Flags							= RESTART_ANIM_WHEN_COMPLETE
// End
// 
// AnimationState						= EMOTION_TAUNTING
// 	Animation
// 		AnimationName				= RUMerry_TNTB
// 		AnimationMode				= LOOP
// 	End
// End
// 
// AnimationState					= EMOTION_ALERT WEAPONSET_TOGGLE_1
// 	StateName					= STATE_Ready_Rocks
// 	Animation					= IDLA
// 		AnimationName			= RUMerry_IDLA
// 		AnimationMode			= LOOP
// 	End
// End
// AnimationState					= EMOTION_ALERT
// 	StateName					= STATE_Ready_Sword
// 	Animation
// 		AnimationName			= RUMerry_IDLB
// 		AnimationMode			= LOOP
// 	End
// End
		


//====== ENGAGED
		AnimationState				= ENGAGED WEAPONSET_TOGGLE_1
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_B_IDLA
				AnimationMode		= ONCE
			End
		End
		AnimationState				= ENGAGED
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_U_IDLA
				AnimationMode		= ONCE
			End
		End
		AnimationState				= BETWEEN_FIRING_SHOTS_A WEAPONSET_TOGGLE_1
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_B_IDLA
				AnimationMode		= ONCE
			End
		End
		AnimationState				= BETWEEN_FIRING_SHOTS_A
			StateName				= STATE_ready
			Animation
				AnimationName		= #(MODEL)_U_IDLA
				AnimationMode		= ONCE
			End
		End
		
// --- Idle Toggled

		AnimationState = SELECTED WEAPONSET_TOGGLE_1
			StateName				= STATE_Selected_Bow
			Animation				= Selected_Loop
				AnimationName		= #(MODEL)_B_ATNB
				AnimationMode		= LOOP
				AnimationBlendTime	= 10
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") end
			EndScript
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState = SELECTED
			StateName				= STATE_Selected_Sword
			Animation				= Selected_Loop
				AnimationName		= #(MODEL)_U_ATNB
				AnimationMode		= LOOP
				AnimationBlendTime	= 10
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") end
			EndScript
			Flags = RESTART_ANIM_WHEN_COMPLETE
		End


		AnimationState				= WEAPONSET_TOGGLE_1
			StateName				= STATE_Idle_Bow
			Animation
				AnimationName		=	#(MODEL)_B_IDLA
				AnimationPriority	=	20
				AnimationMode		=	ONCE
				AnimationBlendTime	=	15
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
			EndScript
		End

		IdleAnimationState
			StateName					= STATE_Idle_Sword	
			Animation = Foot_IDLB // Bored Idle
				AnimationName       = #(MODEL)_U_IDLB
				AnimationMode       = ONCE
				AnimationPriority   = 20
			End
			Animation = Foot_IDLC // Bored Fidget
				AnimationName       = #(MODEL)_U_IBFA
				AnimationMode       = ONCE
				AnimationPriority   = 2
			End
			//Animation = Foot_IDLD // Bored Fidget
			//	AnimationName       = #(MODEL)_U_IBFB
			//	AnimationMode       = ONCE
			//	AnimationPriority   = 1
			//End

			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
			EndScript
		End
		

	//---transitions--------------------------------------------

		TransitionState = TRANS_BoredToSelectedSword
		// Once we have proper animations for enter -> idle -> exit, fix this properly.
			Animation = ANTD
				AnimationName	= #(MODEL)_U_ATNA #(MODEL)_U_ATND #(MODEL)_U_IDLA
				AnimationMode	= ONCE
			End		
		End
		
		TransitionState = TRANS_SelectedToBoredSword
			Animation			= ATNF
				AnimationName	= #(MODEL)_U_ATNC #(MODEL)_U_ATNF #(MODEL)_U_ATNE
				AnimationMode	= ONCE
			End		
		End	

		TransitionState = TRANS_BoredToSelectedBow
			Animation = ATNC
				AnimationName		= #(MODEL)_U_ATNF #(MODEL)_U_ATNE
				AnimationMode		= ONCE
			End		
		End
		
		TransitionState = TRANS_CaptainBowToSelectedBow
			Animation = ATNC
				AnimationName		= #(MODEL)_U_ATNF
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationSpeedFactorRange = 1.5 1.5
			End		
		End
		
		TransitionState = TRANS_SelectedToBoredBow
			Animation			= ATNA
				AnimationName	= #(MODEL)_U_ATNF
				AnimationMode	= ONCE
			End		
		End	


		TransitionState       = TRANS_BowToSword
			Animation           = CUHero_STHA
				AnimationName     = #(MODEL)_B_STHA
				AnimationMode     = ONCE
			End
		End

		TransitionState       = TRANS_SwordToBow
			Animation           = CUHero_STHB
				AnimationName     = #(MODEL)_U_STHA
				AnimationMode     = ONCE
			End
		End	

		TransitionState       		= TRANS_BowToSword_Running
			Animation           	= DrawSwords
				AnimationName       = #(MODEL)_B_STHB
				AnimationMode       = ONCE
			End
		End
		
		TransitionState       		= TRANS_SwordToBow_Running
			Animation           	= DrawBow
				AnimationName       = #(MODEL)_U_STHB
				AnimationMode       = ONCE
			End
		End		

	End
End
	WeaponSet
		Conditions		= None 
		Weapon			= PRIMARY    ElvenSpecialSword
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
WeaponSet
		Conditions = WEAPONSET_TOGGLE_1 
		Weapon			= PRIMARY    MirkwoodArcherSilverthornBow; CreateAHeroBasicRangedWeapon
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
End

CommandSet ElvenHaldirCommandSet2
	1	= Command_ToggleStance
	2	= Command_ToggleHaldirWeapon
	;3	= Command_HaldirFakeLeadershipButton
	;4	= Command_HaldirGoldenArrow
	12	= Command_CaptureBuilding
 	13	= Command_AttackMove
	14	= Command_Stop
	16  = Command_SetStanceBattle
	17  = Command_SetStanceAggressive
	18  = Command_SetStanceHoldGround
End

Object GoblinFighterHorde
BuildCost = 2000
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain6
		FrontAngle = 270
		FlankedDelay = 2000
		ObjectStatusOfContained = 
		InitialPayload	= GoblinFighter 5
		Slots			= 5
		PassengerFilter = ANY +INFANTRY
		ShowPips		= No
		
		; Banner Carrier info		
		;BannerCarriersAllowed	= WildBannerGoblin								; types of units that are allowed as banner carriers
		;BannerCarrierPosition	= UnitType:GoblinFighter	Pos:X:60.0 Y:0.0	; (DEFAULT) position of banner carrier for fighter horde
		
		;RandomOffset = X:5 Y:5	
		
		MeleeBehavior = Amoeba
		End
		
		RankInfo = RankNumber:1 UnitType:GoblinFighter Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		;RankInfo = RankNumber:2 UnitType:GoblinFighter Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		;RankInfo = RankNumber:3 UnitType:GoblinFighter Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		;RankInfo = RankNumber:3 UnitType:GoblinFighter Position:X:-10 Y:0 Leader 3 0	Position:X:-10 Y:20 Leader 3 1	Position:X:-10 Y:-20 Leader 3 2	Position:X:-10 Y:40 Leader 3 3	Position:X:-10 Y:-40 Leader 3 4
		



		RanksToReleaseWhenAttacking = 1

		MeleeAttackLeashDistance = 1; How far the hordes can move from the center of the horde when melee attacking.
	End
End
	Side 		= Elves
	EditorSorting 	= UNIT
	EmotionRange 	= 240
	DisplayName 	= LightningWarriors
	DisplayNameStrategic = CONTROLBAR:LW_Unit_ElvenNoldorWarriorHorde
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_ElvenNoldorWarriorHorde

	MaxSimultaneousOfType	= 3

	WeaponSet
		Conditions = None 
		Weapon 		= PRIMARY    	NormalMeleeHordeRangefinder
		;Weapon 		= TERTIARY	MirkwoodArcherMissileHordeRangefinderBombard
		;AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
	End
	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1
		Weapon 		= PRIMARY	NormalMissileHordeRangefinder
		;Weapon 		= TERTIARY	MirkwoodArcherMissileHordeRangefinderBombard
		;AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
	End

	CommandSet = ElvenHaldirCommandSet2         ; CHANGE THIS WHEN ElvenNoldorWarriorHordeCommandSet IS CREATED


 	CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 0
		
	VisionRange = ELVEN_NOLDORWARRIOR_HORDE_VISION_RANGE
	ShroudClearingRange = 161
	CommandPoints = 96
		
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2

AddModule
	Behavior = StealthUpdate StealthUpdateModuleTag
		StealthDelay					= 500         			; msec
		FriendlyOpacityMin				= STEALTH_FRIENDLY_OPACITY_MIN
		FriendlyOpacityMax				= STEALTH_FRIENDLY_OPACITY_MAX
		PulseFrequency					= 750   			; msec
		StealthForbiddenConditions			= AWAY_FROM_TREES ATTACKING
		OrderIdleEnemiesToAttackMeUponReveal		= Yes
		DetectedByAnyoneRange				= 120
		RevealWeaponSets				= CLOSE_RANGE CONTESTING_BUILDING
	End
End

;;;;;;;;
End

Object ElvenRivendellArcher
      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced1
		TriggeredBy				= Upgrade_WildSpiderVenomSackScience
		AttributeModifier		= BetterCavalry
	End
      End
End

CommandSet NewElvenRivendellArcherHordeCommandSet
	1	= Command_ToggleStance
	2	= Command_PurchaseUpgradeElvenHeavyArmor
	3	= Command_HaldirGoldenArrow
	4	= Command_PurchaseUpgradeElvenBasicTraining
        ;5       = 
	12 	= Command_CaptureBuilding	
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

Object ElvenRivendellArcherHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced17
		TriggeredBy				= Upgrade_WildSpiderVenomSackScience
		AttributeModifier		= BetterCavalry
	End
      End
End

;----------------------------------



;--------------------------------------------TEST----------------------------------

;--------------CattiviMordor------------------------
;-----------------------------------------------------

CommandButton Command_SarumanFireball
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyDwarvenMithrilMail
	NeededUpgrade		= Upgrade_MordorSiegeWorksLevel3
	NeededUpgradeAny		= Yes
	TextLabel			= firedefence
	ButtonImage			= BDForgeWorks_MithrilMail
	ButtonBorderType	= UPGRADE
	DescriptLabel		= firedefence
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= firedefenceLack
 	;UnitSpecificSound	= TrollVoxFindTree
End

CommandButton Command_CreateAHero_Fireball_Level1
	Command				= OBJECT_UPGRADE
	Options				= NEED_UPGRADE OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_DwarvenMithrilMail
	NeededUpgrade		= Upgrade_TechnologyDwarvenMithrilMail
	TextLabel			= fdifpo
	ButtonImage			= BDForgeWorks_MithrilMail
	ButtonBorderType	= UPGRADE
	DescriptLabel		= fdifpoDesc
	InPalantir			= Yes
	LacksPrerequisiteLabel		= fdifpoLack
End

CommandButton Command_SpecialAbilityScreech 
Command                 = SPECIAL_POWER
  SpecialPower            = SpecialAbilityFakeLeadership
  Options				  = NONPRESSABLE
  TextLabel               = CONTROLBAR:DreadVisage
  ButtonImage             = KUDreadVisageIcon
  RadiusCursorType        = TrainingRadiusCursor
  ButtonBorderType        = ACTION
  DescriptLabel           = CONTROLBAR:ToolTipWitchKingDreadVisage
  InPalantir		  = Yes
End

CommandSet NewMordorSlaughterHouseCommandSet
	;1       = Command_EowynShieldMaiden
        ;2       = Command_SpecialAbilityIgnite
        1	= Command_SpecialAbilityScreech 
        2       = Command_FireWeaponMordorFortressMagmaCauldrons
        3       = Command_CreateAHero_Fireball_Level1
	6	= Command_Sell
End

Object MordorSlaughterHouse SlaughterHouse
AddModule
Behavior = DamageFieldUpdate ModuleTag_RazorSpinesWeapon
		Radius			= 100
		ObjectFilter	= ALL ENEMIES
		RequiredUpgrade	= Upgrade_DwarvenMithrilMail
		
		FireWeaponNugget
			WeaponName		= FireDrakeWarhead
			FireDelay		= 0
			OneShot			= No
		End
	End
End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= MBSltrhs.tga 0 mubalrogwingsash.tga;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= FireDefencebonus
	End
      End

CommandSet = NewMordorSlaughterHouseCommandSet

        AddModule
		Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
		SpecialPowerTemplate = SpecialAbilityFakeLeadership
		TriggeredBy = Upgrade_StructureLevel2
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
		SpecialPowerTemplate      = SpecialAbilityFakeLeadership
		UpdateModuleStartsAttack  = Yes
		StartsPaused = Yes
	End
End
AddModule
	Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
		StartsActive		= No ;If no, requires upgrade to turn on.
		BonusName		= GenericDebuff
		TriggeredBy		= Upgrade_StructureLevel2
		RefreshDelay	= 2000
		Range			= 200
		TargetEnemy		= Yes
		AntiCategory	= LEADERSHIP BUFF ; This means cancel all previous leadership bonuses
		ObjectFilter	= ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
	End
End
AddModule
	
	Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
		InitiallyActive						= No
		TriggeredBy							= Upgrade_BlackRiderDreadVisage
		WhichSpecialPower					= 1
		GenerateTerror						= No
		GenerateFear			= Yes
		EmotionPulseRadius					= 100
		EmotionPulseInterval				= 1000
	End
        End

        AddModule
        Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CauldronsEnabler
		SpecialPowerTemplate	= SpecialAbilityMordorFortressMagmaCauldrons
		TriggeredBy				= Upgrade_StructureLevel3
	End
        End
        AddModule
	Behavior = SpecialPowerModule ModuleTag_CauldronStarter       
		SpecialPowerTemplate      = SpecialAbilityMordorFortressMagmaCauldrons
		UpdateModuleStartsAttack  = Yes
		StartsPaused		  	  = Yes
		;InitiateSound			= MordorFortressMagmaCauldronRelease		;this didn't work
	End
        End
        AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_CauldronWeaponFireUpdate   
		SpecialPowerTemplate    = SpecialAbilityMordorFortressMagmaCauldrons
		WhichSpecialWeapon		= 1

		UnpackTime              = 5200 
		PackTime                = 4600
		;TriggerSound			= MordorFortressMagmaCauldronRelease		;this triggers too late
		SpecialWeapon			= MordorFortressMagmaCauldronsWeapon
	End
        End
     
End

CommandButton Command_SpellBookBalrogAlly
	Command				= UNIT_BUILD
	Object				= WildBabyDrakeHorde
	Options				= CANCELABLE NEED_UPGRADE 
	NeededUpgrade			= Upgrade_TechnologyGondorHeavyArmor
	NeededUpgradeAny		= Yes
	TextLabel			= balrogminihorge
	ButtonImage			= HIFireDrakeBroodIcon
	ButtonBorderType    		= BUILD 
	DescriptLabel       		= balrogminihorgeDesc
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= Yes    
	LacksPrerequisiteLabel		= balrogminihorgeLack
End


CommandButton Command_WhisperofDeath
	Command			= UNIT_BUILD
	Object			= AngmarDarkDunedainHorde
	Options			= NEED_UPGRADE CANCELABLE
	NeededUpgrade		= Upgrade_TechnologyGondorForgedBlades
	NeededUpgradeAny	= Yes
	TextLabel		= spettrifanastmi
	ButtonImage		= KUBlackNumenoreansIcon
	ButtonBorderType    	= BUILD 
	DescriptLabel       	= spettrifanastmiDesc
	Radial			= Yes
	InPalantir		= Yes
	ShowProductionCount	= Yes    
End



;------------------------------------------------------------------
Weapon MordorBalrogSwordSwipeLess     ; BALANCE Balrog Weapon
  LeechRangeWeapon      = Yes
AttackRange		= 11.5
  MeleeWeapon           = Yes
  DelayBetweenShots     = 1500            ; time between shots, msec
  PreAttackDelay        = 1300             ; 300 is mace swing delay time before contact with target.
  PreAttackType         = PER_SHOT ; Do the delay each time we attack
  FireFX                = FX_BalrogSwordHit
  FiringDuration        = 1500    ; Duration of the mace swing 
  DamageDealtAtSelfPosition = Yes ; A melee based AoE.  Arc radiates from me, not them

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        = 200
    DamageScalar  = 10% NONE +COMMANDCENTER			
    Radius        = 40.0
    DamageType    = FLAME
    DamageFXType  = BALROG_SWORD
    DeathType     = BURNED
    DamageArc      = 90
  End

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        = 300
    DamageScalar  = 10% NONE +COMMANDCENTER		
    Radius        = 40.0
    DamageType    = SIEGE
    DamageFXType  = BALROG_SWORD
    DeathType     = NORMAL
    DamageArc      = 90
  End
  
	FireLogicNugget						; Lights flammables on fire
		LogicType	= INCREASE_BURN_RATE
		Radius		= 40.0
		Damage		= BALROG_SWORD_SWIPE_DAMAGE_FLAME
	End

  MetaImpactNugget                    ; A Nugget that throws things back with force
    KillObjectFilter  = INSTANT_DEATH_ON_METAIMPACT_OBJFILTER
    ShockWaveAmount   = 100.0
    ShockWaveRadius   = 40.0
    ShockWaveTaperOff = 0.75
    ShockWaveArc      = 90
    ShockWaveZMult    = 0.600
  End
End

Weapon MordorBalrogWhipLess     ; BALANCE Orc Warrior Weapon
	LeechRangeWeapon			= Yes
	AttackRange				= 240.0
	MeleeWeapon				= No
	DelayBetweenShots			= 10000            		; time between shots, msec
	PreAttackDelay			= 1400 
	PreAttackType			= PER_SHOT				; Do the delay each time we attack
	;FireFX				= FX_BalrogSpecialPowerRoar	; this plays when Balrog starts his whip, not when right click-trageting
	FiringDuration			= 1600 
	
	ForceDisplayPercentReady	= Yes 				; As opposed to displaying clip reload time


	DamageNugget                        ; A basic Nugget that just does damage
		Damage        = 300
		DamageScalar  = 15% NONE +COMMANDCENTER
		Radius        = 15.0
		DelayTime     = 0
		DamageType    = FLAME
		DamageFXType  = BALROG_WHIP
		DeathType     = NORMAL
	End

	DamageNugget                        ; A basic Nugget that just does damage
		Damage        = 600
		DamageScalar  = 10% NONE +COMMANDCENTER
		Radius        = 15.0
		DelayTime     = 0
		DamageType    = SIEGE 
		DamageFXType  = BALROG_WHIP
		DeathType     = NORMAL
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .25
		ShockWaveAmount		= 50.0
		ShockWaveRadius		= 25.0
		ShockWaveTaperOff	= 1.0
		ShockWaveZMult		= 1.20
		InvertShockWave		= Yes
	End
	
  	FireLogicNugget						; Lights flammables on fire
		LogicType	= INCREASE_BURN_RATE
		Radius		= 25.0
		Damage		= BALROG_WHIP_DAMAGE_FLAME
	End
End


Object WildBabyDrake 
AddModule
	Behavior = CreateObjectDie ModuleTag_CrushUnitsOnDeath3
		CreationList = OCL_BalrogDie2
 	End
End
RemoveModule ModuleTag_01
    ; SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
	SelectPortrait = HPBalrog
    
    ; ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
    ButtonImage = HIBalrog
AddModule
	Draw = W3DScriptedModelDraw ModuleTag_BodyDraw
;		GlowEnabled = Yes
;		GlowEmissive = Yes
		
;		StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

		OkToChangeModelColor = Yes
	
		ExtraPublicBone = ZZZPASSENGERBON
		ExtraPublicBone = ZZZWHIPCOIL
		ExtraPublicBone = SWORD

		;-------------------------
		ModelConditionState = NONE ; Not DefaultConditionState, because that keyword copies anything in here to every other state
			Model = MUBalrog_SKN
			ParticleSysBone = SWORD BalrogSwordFlare FollowBone:yes		; Not SWORDBONE, because SWORD is the bone that gets art-hidden mid animation in WIPX
			ParticleSysBone = SWORD BalrogSwordEmbers FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFlare FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeEmbers FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFire FollowBone:yes
			ParticleSysBone = RTWINGBONE BalrogWingSmokeLite FollowBone:yes
			ParticleSysBone = LFWINGBONE BalrogWingSmokeLite FollowBone:yes
		End

; This is triggered by the single player only HitReaction module for the lightningsword		
        ModelConditionState = HIT_LEVEL_2
			Model = MUBalLIT_SKN
		End

		ModelConditionState = HERO
			Model = MUBalIGNT_SKN
			ParticleSysBone = MANEBONE BalrogManeFlare FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeEmbers FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFire FollowBone:yes
			ParticleSysBone = RTWINGBONE BalrogWingEmbers FollowBone:yes
			ParticleSysBone = LFWINGBONE BalrogWingEmbers FollowBone:yes

			ParticleSysBone = SWORD BalrogSwordFlare FollowBone:yes		; Not SWORDBONE, because SWORD is the bone that gets art-hidden mid animation in WIPX
			ParticleSysBone = SWORD BalrogSwordEmbers FollowBone:yes
	                ParticleSysBone = NONE BalrogIgniteHeatWave FollowBone:no
		End

		;-----------------		
		IdleAnimationState
			StateName = State_Idle
			Animation = Breathe 
				AnimationName = MUBalrog_SKL.MUBalrog_IDLA
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 20
			End
			Animation = LookAround 
				AnimationName = MUBalrog_SKL.MUBalrog_IDLB
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 2
			End
			Animation = SnortLikeABull 
				AnimationName = MUBalrog_SKL.MUBalrog_IDLC
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 1
			End

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_JustBuilt" 
					then CurDrawableSetTransitionAnimState("TRANS_JustBuilt_To_Idle") 
				end
				if Prev == "State_AboutToHitGround" 
					then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") 
				end
			EndScript
		End 
		
		AnimationState					=	DYING DEATH_1
			Animation					=	Dying 
				AnimationName			=	MUBalrog_SKL.MUBalrog_DIEA 
				AnimationMode			=	ONCE
			End
			ParticleSysBone = None BalrogFallDust FollowBone:No
		End

		AnimationState					=	DYING DEATH_2
			Animation					=	FadingOut 
				AnimationName			=	MUBalrog_SKL.MUBalrog_RORC 
				AnimationMode			=	ONCE
			End
		End


; This is triggered by the single player only HitReaction module for the lightningsword	
; It is highest instead of lowest priority, because the hit reaction Paralyzes us, where for others it is just a fancy idle.	
		AnimationState					=	HIT_LEVEL_2
			Animation					=	Owowowowowowowow
				AnimationName			=	MUBalrog_SKL.MUBalrog_HITB 
				AnimationMode			=	ONCE
			End
		End
		
		AnimationState					=	EATING
			Animation					=	DoingHorribleThingToGrabbedGuy 
				AnimationName			=	MUBalrog_SKL.MUBalrog_BRNA 
				AnimationMode			=	ONCE
				AnimationBlendTime		=	0
			End

				ParticleSysBone = ZZZPassengerBon balrogHandSqueezeFlames FollowBone:Yes
                ParticleSysBone = ZZZPassengerBon balrogHandSqueezeFlames2 FollowBone:Yes
				ParticleSysBone = ZZZPassengerBon balrogHandSqueezeFlamesFinal FollowBone:Yes
                ParticleSysBone = ZZZPassengerBon BalrogHandSqueezeFlash FollowBone:Yes
                ParticleSysBone = ZZZPassengerBon BalrogHandSmoke FollowBone:Yes
                ParticleSysBone = RING_2_L balrogHandAsh FollowBone:Yes
                ParticleSysBone = RING_2_L balrogHandAshSmall FollowBone:Yes
		End

		AnimationState					=	UNPACKING PACKING_TYPE_3
			Animation					=	GrabbingToTouching
				AnimationName			=	MUBalrog_SKL.MUBalrog_GRBA 
				AnimationMode			=	ONCE
				AnimationBlendTime		=	0
			End
		End

		AnimationState					=	PACKING PACKING_TYPE_3
			Animation					=	GrabbingFollowThrough 
				AnimationName			=	MUBalrog_SKL.MUBalrog_GRBC 
				AnimationMode			=	ONCE
				AnimationBlendTime		=	0
			End	
		End

		AnimationState			= JUST_BUILT
			StateName = State_JustBuilt
			Animation
				AnimationName = MUBalrog_SKL.MUBalrog_RORA
				AnimationMode = MANUAL
				AnimationBlendTime = 0
			End
		End
		
	    TransitionState = TRANS_JustBuilt_To_Idle
			Animation = BeingSummoned
				AnimationName = MUBalrog_SKL.MUBalrog_RORA 
				AnimationMode = ONCE
			End
		End
		
		AnimationState = FIRING_OR_PREATTACK_B
			Animation = CrackThatWhip 
				AnimationName = MUBalrog_SKL.MUBalrog_WIPA
				AnimationMode = ONCE
			End
				ParticleSysBone = RTHANDBONE BalrogWhip2swordEfx FollowBone:Yes
		End

		AnimationState			= SPECIAL_POWER_1
			Animation			= RoaringFear 
				AnimationName	= MUBalrog_SKL.MUBalrog_RORB
				AnimationMode   = ONCE
			End
				ParticleSysBone = BAT_JAW BalrogScreamEffect FollowBone:Yes
				FXEvent			= Frame:20 Name:FX_BalrogScreamEfx
				ParticleSysBone = BAT_JAW balrogPixelDisplScrm FollowBone:Yes
				ParticleSysBone = BAT_JAW balrogScrmEmbers FollowBone:Yes
		End
			   
		AnimationState			= SPECIAL_WEAPON_ONE
			Animation			= BreathingFireAnimation
				AnimationName	= MUBalrog_SKL.MUBalrog_FIRA
				AnimationMode   = ONCE
			End
				;This is Balrog's fire breath efx
				ParticleSysBone = BAT_JAW balrogFireBreath FollowBone:Yes
				ParticleSysBone = BAT_JAW balrogBreathEmbers FollowBone:Yes
				ParticleSysBone = BAT_JAW balrogBreathSmoke FollowBone:Yes
				ParticleSysBone = BAT_JAW balrogBreathProxy FollowBone:Yes
			End
			   
		AnimationState			= SPECIAL_WEAPON_TWO UNPACKING
			StateName			= State_LeapStart
			Animation			= GettingReadyToLeap
				AnimationName	= MUBalrog_SKL.MUBalrog_JMP1
				AnimationMode   = ONCE
			End
		End
			   
	    AnimationState			= SPECIAL_WEAPON_TWO PACKING
			Animation			= FirstWingBeatGoingUp 
				AnimationName	= MUBalrog_SKL.MUBalrog_JMP2
				AnimationMode   = ONCE
			End
		End
			   
	    AnimationState			= ABOUT_TO_HIT						; Before ThrownProjectile, since by definition this set for nn frames while T_P is still on
			StateName			= State_AboutToHitGround
			Animation			= StartingToLandToTouchingGround 
				AnimationName	= MUBalrog_SKL.MUBalrog_LND1
				AnimationMode   = ONCE
			End
		End
			   
		AnimationState			= THROWN_PROJECTILE
			Animation			= HurtlingThroughAir 
				AnimationName	= MUBalrog_SKL.MUBalrog_FLYA
				AnimationMode   = LOOP
				AnimationBlendTime = 10
			End
		End
			   
	    TransitionState = TRANS_AboutToHitGround_To_Idle
			Animation = SplashAtEndOfJump
				AnimationName = MUBalrog_SKL.MUBalrog_LND2 
				AnimationMode = ONCE
				AnimationBlendTime = 0
			End
		End
		
		AnimationState			= TURN_RIGHT
			Animation			= TurningRight 
				AnimationName	= MUBalrog_SKL.MUBalrog_TRNA
				AnimationMode   = LOOP
				AnimationBlendTime = 10
			End
		End

		AnimationState			= TURN_LEFT
			Animation			= TurningLeft 
				AnimationName	= MUBalrog_SKL.MUBalrog_TRNB
				AnimationMode   = LOOP
				AnimationBlendTime = 10
			End
		End

		AnimationState			= MOVING
			Animation			= Running 
				AnimationName	= MUBalrog_SKL.MUBalrog_WLKA
				AnimationMode   = LOOP
				AnimationBlendTime = 10
			End
			Flags               = RANDOMSTART
			
			FXEvent	= Frame:20 FireWhenSkipped Name:FX_BalrogRightFootStep
			FXEvent	= Frame:44 FireWhenSkipped Name:FX_BalrogLeftFootStep
		End
      
		AnimationState			= WEAPONSET_HERO_MODE UNPACKING PACKING_TYPE_1
			Animation = StartIgniteRoar 
				AnimationName = MUBalrog_SKL.MUBalrog_IGNTA
				AnimationMode = ONCE
			End
		End
				
		AnimationState			= HERO PACKING PACKING_TYPE_1
			Animation = FinishIgniteRoar 
				AnimationName = MUBalrog_SKL.MUBalrog_IGNTB
				AnimationMode = ONCE
			End
           
            EnteringStateFX = FX_BalrogIgniteStart
		End
				
		AnimationState			= FIRING_OR_PREATTACK_A
			Animation			= Swipe
				AnimationName	= MUBalrog_SKL.MUBalrog_ATKB
				AnimationMode	= ONCE
				UseWeaponTiming	= Yes
			End
		End
		
		AnimationState			= FIRING_OR_PREATTACK_C
			Animation			= Chop
				AnimationName	= MUBalrog_SKL.MUBalrog_ATKA
				AnimationMode	= ONCE
				UseWeaponTiming	= Yes
			End
			ParticleSysBone		= SWORDBONE BalrogSword FollowBone:yes
		End
	End

;--------------------------
	Draw = W3DScriptedModelDraw ModuleTag_WhipDraw
		GlowEnabled = Yes
		GlowEmissive = Yes
		ShadowForceDisable = Yes	;The shadow setting is for the whole drawable, but this individual draw module wants to not have a shadow.
		
;		StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

		DefaultModelConditionState
			Model = None
		End
		
		ModelConditionState = FIRING_OR_PREATTACK_B
			Model = MUBalsWhip_SKN
		End
		
		;------------------
		IdleAnimationState
		End
		
		AnimationState = FIRING_OR_PREATTACK_B
			Animation = CrackThatWhip 
				AnimationName = MUBalsWhip_SKL.MUBalsWhip_WIPA
				AnimationMode = ONCE
				AnimationBlendTime = 0
			End
		End
			WadingParticleSys = BalrogRiverSteam		
	End
End
;------------------------
	DisplayName      = OBJECT:Balrog
	;//DisplayMeleeDamage = BALROG_DAMAGE_DISPLAY

	Side = Mordor
	EditorSorting = UNIT
	ThreatLevel = BALROG_THREAT_LEVEL
	ThingClass = CHARACTER_UNIT
        CrushableLevel = 4
	CrusherLevel = 0  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
	CrushWeapon = BalrogCrush  

	TransportSlotCount = TRANSPORTSLOTCOUNT_MONSTER

	
	ArmorSet
		Conditions      = None
		Armor           = NewBalrogArmor
		DamageFX        = NormalDamageFX
	End

	VisionRange = VISION_BALROG					
	ShroudClearingRange = SHROUD_CLEAR_BALROG

	DisplayName = OBJECT:Balrog
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS
	CommandSet = NewBalrogCommandSet
	CanPathThroughGates	= No
	IsTrainable = No
	
	DeadCollideSize = LARGE ; How big does the AOD consider this unit for damage fx & behavior.
;---------------------------------
	VoiceAttack							= BalrogVoiceAttack
	VoiceAttackAir						= BalrogVoiceAttack
	VoiceAttackCharge					= BalrogVoiceAttack
	VoiceAttackMachine					= BalrogVoiceAttack
	VoiceAttackStructure				= BalrogVoiceAttack
	VoiceCreated						= BalrogVoiceAttack
	VoiceCreated						= BalrogVoiceAttack
	VoiceFullyCreated					= BalrogVoiceAttack
	VoiceFullyCreated					= BalrogVoiceAttack
	VoiceGuard							= BalrogVoiceSelect
	VoiceMove							= BalrogVoiceSelect
	VoiceMoveToCamp						= BalrogVoiceSelect
	VoiceMoveWhileAttacking				= BalrogVoiceSelect
	VoicePriority						= 55
	VoiceRetreatToCastle				= BalrogVoiceSelect
	VoiceSelect							= BalrogVoiceSelect
	VoiceSelectBattle 					= BalrogVoiceSelect

;	VoiceEnterStateAttack			= 
;	VoiceEnterStateAttackCharge		= 
;	VoiceEnterStateAttackMachine		= 
;	VoiceEnterStateAttackStructure	= 
;	VoiceEnterStateMove			= 
;	VoiceEnterStateMoveToCamp		= 
;	VoiceEnterStateMoveWhileAttacking	= 
;	VoiceEnterStateRetreatToCastle	= 

	SoundImpact					= ImpactHorse
	SoundAmbient				= BalrogVoiceMove

	UnitSpecificSounds
		VoiceEnterUnitEvilMenTransportShip	= BalrogVoiceMove
		VoiceEnterUnitMordorMumakil			= BalrogVoiceMove
		VoiceEnterUnitSlaughterHouse		= BalrogVoiceMove
		VoiceGarrison						= BalrogVoiceMove
		VoiceInitiateCaptureBuilding		= BalrogVoiceMove
	End
;-------------------------------

	;------------------ AUDIO Parameters ----------------------

	VoiceAttack			= BalrogVoiceAttack
	VoiceAttackCharge		= BalrogVoiceAttack
	VoiceAttackMachine	= BalrogVoiceAttack
	VoiceAttackStructure	= BalrogVoiceAttack
	VoiceGuard			= BalrogVoiceMove
	VoiceMove			= BalrogVoiceMove
	VoiceSelect			= BalrogVoiceSelect
	VoiceSelectBattle		= BalrogVoiceSelect

	SoundAmbient		= BalrogAmbientLoop
	SoundImpact			= ImpactHorse

   ; #include "..\includes\StandardUnitEvaEvents.inc"
	
    ; Warn the player when the enemy gets a unit. Override the normal sighting event from StandardUnitEvaEvents.inc
    EvaEnemyObjectSightedEvent	= DiscoveredEnemyBalrog
ReplaceModule ModuleTag_CreateAnnounce
	ClientUpdate = EvaAnnounceClientCreate ModuleTag_CreateAnnounce6
		AnnouncementEventEnemy = DiscoveredEnemyBalrog
		AnnouncementEventAlly = None
		AnnouncementEventOwner = None
		
		OnlyIfVisible = Yes						; Don't announce if hidden in the shroud
		CountAsFirstSightedAnnoucement = Yes	; Don't re-annouce if going into shroud & back
		UseObjectsPosition = No					; Play from central Fortress, not at unit's position
		CreateFakeRadarEvent = Yes				; Allow player to jump to unit after hearing annoucement
	End
End
ReplaceModule ModuleTag_AnimAudioBehavior
	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior6
		MaxUpdateRangeCap = 800
		AnimationSound = Sound: BalrogFootstep			Animation: MUBalrog_SKL.MUBalrog_WLKA Frames: 42 17 
		AnimationSound = Sound: BalrogFootstep			Animation: MUBalrog_SKL.MUBalrog_TRNA Frames: 21 52
		AnimationSound = Sound: BalrogFootstep			Animation: MUBalrog_SKL.MUBalrog_TRNB Frames: 21 52
 
		AnimationSound = Sound: BalrogWhipPart1			Animation: MUBalrog_SKL.MUBalrog_WIPA Frames: 1 
		AnimationSound = Sound: BalrogWhipPart2			Animation: MUBalrog_SKL.MUBalrog_WIPA Frames: 21 
		AnimationSound = Sound: ImpactWhipCrack			Animation: MUBalrog_SKL.MUBalrog_WIPA Frames: 34

		AnimationSound = Sound: BalrogSwordSwipe			Animation: MUBalrog_SKL.MUBalrog_ATKB Frames: 32	
		AnimationSound = Sound: BalrogSwordSwipe			Animation: MUBalrog_SKL.MUBalrog_ATKA Frames: 32
		AnimationSound = Sound: ImpactBalrogAttackGeneric	Animation: MUBalrog_SKL.MUBalrog_ATKA Frames:41
		AnimationSound = Sound: ImpactBalrogAttackGeneric	Animation: MUBalrog_SKL.MUBalrog_ATKB Frames:40 
		AnimationSound = Sound: ImpactBalrogAttackGeneric	Animation: MUBalrog_SKL.MUBalrog_ATKC Frames:27 53 88

		AnimationSound = Sound: BalrogJump_Part1			Animation: MUBalrog_SKL.MUBalrog_JMP1 Frames: 0 
		AnimationSound = Sound: BalrogJump_Part2			Animation: MUBalrog_SKL.MUBalrog_JMP1 Frames: 41
		AnimationSound = Sound: BalrogWingFlaps			Animation: MUBalrog_SKL.MUBalrog_FLYA Frames: 9 
		AnimationSound = Sound: BalrogLand				Animation: MUBalrog_SKL.MUBalrog_LND1 Frames: 0
		AnimationSound = Sound: BalrogWingFlaps			Animation: MUBalrog_SKL.MUBalrog_JMP2 Frames: 0
		AnimationSound = Sound: BalrogLandSwordHit		Animation: MUBalrog_SKL.MUBalrog_LND2 Frames: 6
		AnimationSound = Sound: BalrogIdleB_Part3			Animation: MUBalrog_SKL.MUBalrog_LND2 Frames: 27

		AnimationSound = Sound: BalrogBreathFireExhale		Animation: MUBalrog_SKL.MUBalrog_FIRA Frames: 31 
		AnimationSound = Sound: BalrogBreathFireInhale		Animation: MUBalrog_SKL.MUBalrog_FIRA Frames: 0

		AnimationSound = Sound: BalrogRoar				Animation: MUBalrog_SKL.MUBalrog_RORB Frames: 25
		AnimationSound = Sound: BalrogVanquishedRoar		Animation: MUBalrog_SKL.MUBalrog_RORC Frames: 21
		AnimationSound = Sound: BalrogVanquished			Animation: MUBalrog_SKL.MUBalrog_RORC Frames: 50

		AnimationSound = Sound: BalrogInjuredB_Part1		Animation: MUBalrog_SKL.MUBalrog_HITB Frames: 0 
		AnimationSound = Sound: BalrogInjuredB_Part2		Animation: MUBalrog_SKL.MUBalrog_HITB Frames: 70 

		AnimationSound = Sound: BalrogChuckle			Animation: MUBalrog_SKL.MUBalrog_IDLA Frames: 1
		AnimationSound = Sound: BalrogContentVox			Animation: MUBalrog_SKL.MUBalrog_IDLA Frames: 0
		AnimationSound = Sound: BalrogIdleB_Part1			Animation: MUBalrog_SKL.MUBalrog_IDLB Frames: 0 
		AnimationSound = Sound: BalrogIdleB_Part2			Animation: MUBalrog_SKL.MUBalrog_IDLB Frames: 37 
		AnimationSound = Sound: BalrogIdleB_Part3			Animation: MUBalrog_SKL.MUBalrog_IDLB Frames: 95 
		AnimationSound = Sound: BalrogIdleC_Part2			Animation: MUBalrog_SKL.MUBalrog_IDLC Frames: 29 
		AnimationSound = Sound: BalrogIdleC_Part3			Animation: MUBalrog_SKL.MUBalrog_IDLC Frames: 60 
		AnimationSound = Sound: BalrogFootstep			Animation: MUBalrog_SKL.MUBalrog_IDLC Frames: 61

		AnimationSound = Sound: BalrogDieVox			Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 13
		AnimationSound = Sound: BalrogBodyfall1			Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 56
		AnimationSound = Sound: BalrogBodyfall2			Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 57
		AnimationSound = Sound: OliphantFall			Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 21
		AnimationSound = Sound: BalrogLandSwordHit		Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 54

		AnimationSound = Sound: BalrogIgnite			Animation: MUBalrog_SKL.MUBalrog_IGNTA Frames: 51
	End
End
;-----------------------
AddModule
  Body            = ActiveBody ModuleTag_026
    MaxHealth         = 1500 ;BALANCE Balrog Health
  End
End
AddModule
	Behavior = BezierProjectileBehavior ModuleTag_Projectile6 ; Module starts asleep, and wakes up when thrown.
		; To tweak a Bezier path
		FirstHeight = 104  ; Height of Bezier control points above highest intervening terrain
		SecondHeight = 52
		FirstPercentIndent = 20% ; Percentage of shot distance control points are placed
		SecondPercentIndent = 70%
		TumbleRandomly = Yes

		CrushStyle = Yes ; I don't detonate, I just hit

		BounceCount = 0   ; When I hit the ground, I'll arc again

		FinalStuckTime = 1766 ; Can't move for this long afterwards

		GroundHitFX       = FX_BalrogJumpHitGround
		GroundHitWeapon   = RohanGimliLeapWarhead
		
		PreLandingStateTime = 300; Look ahead to the end of the arc, and get the ABOUT_TO_HIT flag this far in advance
	End
End
AddModule
  	Behavior = SlowDeathBehavior ModuleTag_05y
		DeathTypes = ALL -FADED
		DestructionDelay = 2500
        FX = FINAL FX_BalrogFinalDeath
        DeathFlags = DEATH_1
	End
End
CommandPoints	= 40
	WeaponSet
		Conditions = None
		Weapon = PRIMARY	MordorBalrogSwordSwipeLess
		Weapon = SECONDARY	MordorBalrogWhipLess
		Weapon = TERTIARY	MordorBalrogSwordChop
		
		AutoChooseSources = SECONDARY None
		OnlyAgainst = TERTIARY STRUCTURE BIG_MONSTER
	End
	CommandSet = BalrogCommandSet
	CanPathThroughGates	= No
	IsTrainable = Yes
Scale = 0.50
  KindOf          = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MONSTER SCORE CAN_ATTACK NO_FREEWILL_ENTER PATH_THROUGH_INFANTRY SCARY BIG_MONSTER CAN_ATTACK_WALLS 
AddModule
	Behavior = SpecialPowerModule ModuleTag_ScreamStarter                      
		SpecialPowerTemplate      = SpecialAbilityBalrogScream
		UpdateModuleStartsAttack  = Yes
		;InitiateSound           = 
	End
End
AddModule
	Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_ScreamUpdate   ; So the difference in SpecialPower is that it takes timing from this UpdateG, instead of simply firing.
		SpecialPowerTemplate    = SpecialAbilityBalrogScream

		UnpackTime              = 1500 ; Drawing the horn
		PreparationTime         = 1   ; nothing
		PackTime                = 1800 ; Putting horn away

		AwardXPForTriggering    = 0
		
		WhichSpecialPower = 1
	End
End

AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AragornBladeMasterEnabler78
		SpecialPowerTemplate = SpecialAbilityBalrogBreath
		TriggeredBy = Upgrade_MiniHordeLvl7
	End
End

AddModule
	Behavior = SpecialPowerModule ModuleTag_BreathStarter                      
		SpecialPowerTemplate		= SpecialAbilityBalrogBreath
		UpdateModuleStartsAttack	= Yes
		InitiateSound			= BalrogSpecialPowerRoar	;this plays on right-click target, not when Balrog leaps
	End
End
AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BreathUpdate   
		SpecialPowerTemplate    = SpecialAbilityBalrogBreath

		UnpackTime              = 1300 ; Drawing the horn
		PackTime                = 3700 ; Putting horn away

		AwardXPForTriggering    = 0
		
		StartAbilityRange = 40.0
		
		SpecialWeapon = MordorBalrogBreath
		WhichSpecialWeapon = 1
	End
End

End

Object WildBabyDrakeHorde ;Object DwarvenZerkerHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced26
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End

	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End
	CommandSet = NewBalrogCommandSet
Side			= Mordor
	EditorSorting		= UNIT
	EmotionRange		= 240
	DisplayName		= OBJECT:Balrog
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_WildBabyDrakeHorde
	DescriptionStrategic	= CONTROLBAR:LW_ToolTip_WildBabyDrakeHorde
	;MaxSimultaneousOfType		= 2		
	IsAutoBuilt		= Yes


	BuildCost		= 3000
	BuildTime		= 40
	   
	VisionRange 		= VISION_STANDARD_LARGE_ANIMAL
	ShroudClearingRange 	= SHROUD_CLEAR_HERO
	
	VisionSide 		= 50%
	VisionRear 		= 25%
	
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0% 
	
	CrushableLevel	=   	4	; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel		= 0
	;CrushDecelerationPercent = 10%
	CrushRevengeWeapon	= RangedInfantryCrushRevenge
	CommandPoints	= 120 		; originally 60
	;CommandSet	= BalrogCommandSet

  LocomotorSet
    Locomotor     = BalrogLocomotor
    Condition     = SET_NORMAL
    Speed         = 50
  End
;	FormationWidth	= 2 		; Width it occupies in formations. Current choices are 1 or 2.
	;FormationDepth	= 2 		; Depth it occupies in formations. Current choices are 1 or 2.
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain6
		FrontAngle 		= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload		= WildBabyDrake 3
		Slots			= 3
		PassengerFilter 	= ANY +MONSTER
		ShowPips		= No
		
		
		RandomOffset = X:5 Y:5	
		
		MeleeBehavior = Amoeba
		End
		
		RankInfo = RankNumber:1 UnitType:WildBabyDrake Position:X:20 Y:0		Position:X:0 Y:30		Position:X:0 Y:-30	

		RanksToReleaseWhenAttacking = 1

		MeleeAttackLeashDistance = 1; How far the hordes can move from the center of the horde when melee attacking.
	End
End

AddModule
	Behavior = SpecialPowerModule ModuleTag_ScreamStarter                      
		SpecialPowerTemplate      = SpecialAbilityBalrogScream
		UpdateModuleStartsAttack  = Yes
		;InitiateSound           = 
	End
End
AddModule
	Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_ScreamUpdate   ; So the difference in SpecialPower is that it takes timing from this UpdateG, instead of simply firing.
		SpecialPowerTemplate    = SpecialAbilityBalrogScream

		UnpackTime              = 1500 ; Drawing the horn
		PreparationTime         = 1   ; nothing
		PackTime                = 1800 ; Putting horn away

		AwardXPForTriggering    = 0
		
		WhichSpecialPower = 1
	End
End

AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AragornBladeMasterEnabler78
		SpecialPowerTemplate = SpecialAbilityBalrogBreath
		TriggeredBy = Upgrade_MiniHordeLvl7
	End
End

AddModule
	Behavior = SpecialPowerModule ModuleTag_BreathStarter                      
		SpecialPowerTemplate		= SpecialAbilityBalrogBreath
		UpdateModuleStartsAttack	= Yes
		InitiateSound			= BalrogSpecialPowerRoar	;this plays on right-click target, not when Balrog leaps
	End
End
AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BreathUpdate   
		SpecialPowerTemplate    = SpecialAbilityBalrogBreath

		UnpackTime              = 1300 ; Drawing the horn
		PackTime                = 3700 ; Putting horn away

		AwardXPForTriggering    = 0
		
		StartAbilityRange = 40.0
		
		SpecialWeapon = MordorBalrogBreath
		WhichSpecialWeapon = 1
	End
End
	
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf = SELECTABLE CAN_CAST_REFLECTIONS MONSTER CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND 

End

CommandButton Command_SpellBookDarkness
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE
	Upgrade				= Upgrade_TechnologyIsengardHeavyArmor 
	TextLabel			= experienza
	ButtonImage			= BEEregionForge_ElvenArmor
	ButtonBorderType	= UPGRADE
	DescriptLabel		= experienzaDesc
	Radial				= Yes
	InPalantir	   		= Yes
	;LacksPrerequisiteLabel		= experienzaLack
End

CommandSet MonsterMachineFactory
  	1	= Command_SpellBookBalrogAlly
  	2	= Command_WhisperofDeath
  	3	= Command_SpellBookDarkness
  	;4	= Command_PurchaseTechnologyMordorBasicTraining
  	;5 	= Command_UpgradeMordorOrcPitLevel2
  	6	= Command_Sell
  
End

CommandButton Command_ConstructMordorTavern; Command_ConstructMordorOrcFletcher
  Command          = DOZER_CONSTRUCT
  Object           = MordorOrcFletcher
  TextLabel        = CONTROLBAR:ConstructMordorSiegeWorks
  ButtonImage      = BMGreatSiegeWorks
  ButtonBorderType = BUILD 
  DescriptLabel    = CONTROLBAR:ToolTipordorSiegeWorks
  Radial           = Yes  
End

CommandButton Command_NecromancerWellOfSouls
  Command          = DOZER_CONSTRUCT
  Object           = MordorBase_DEMO; ShireWorkPit
  TextLabel        = factory
  ButtonImage      = BMGreatSiegeWorks
  ButtonBorderType = BUILD 
  DescriptLabel    = factoryDesc
  Radial           = Yes  
End

  

ChildObject MordorBase_DEMO AngmarBarracks
ReplaceModule ModuleTag_Draw
  Draw = W3DScriptedModelDraw ModuleTag_01
  OkToChangeModelColor = Yes
  
    DefaultModelConditionState
      Model = MBBlkGate
    End
    
  End
End
  DisplayName      = MonsterFactory
  Side = Mordor
  EditorSorting   = STRUCTURE
  
CommandSet = MonsterMachineFactory
Scale = 0.60
End

CommandSet NewMordorPorterCommandSet
	1  = Command_Stop
	2  = Command_PorterExtinguishFire
	3  = Command_PorterConstructMordorSlaughterHouse
	;4  = Command_PorterConstructMordorLumberMill
	5  = Command_PorterConstructMordorOrcPit // x 2 era
	6  = Command_PorterConstructMordorHaradrimPalace // x 2 era
	7  = Command_PorterConstructMordorTrollCage // x 2 era
	;8  = Command_PorterConstructMordorSiegeWorks 
	;9  = Command_PorterConstructMumakilPen
	;10 = Command_NecromancerWellOfSouls
	;11 = Command_PorterconstructMordorBattleTower
	12 = Command_PorterConstructMordorFortress
	;13  = Command_ConstructMordorTavern; Command_ConstructMordorOrcFletcher
      ;  14  = Command_ConstructMordorUmbarTavern 
End

CommandSet NewNewMordorPorterCommandSet
	1  = Command_Stop
	2  = Command_PorterExtinguishFire
	3  = Command_PorterConstructMordorSlaughterHouse
	;4  = Command_PorterConstructMordorLumberMill
	5  = Command_PorterConstructMordorOrcPit // x 2 era
	6  = Command_PorterConstructMordorHaradrimPalace // x 2 era
	7  = Command_PorterConstructMordorTrollCage // x 2 era
	8  = Command_PorterConstructMordorSiegeWorks 
	;9  = Command_PorterConstructMumakilPen
	10 = Command_NecromancerWellOfSouls ;Command_NecromancerWellOfSouls
	;11 = Command_PorterconstructMordorBattleTower
	12 = Command_PorterConstructMordorFortress
	;13  = Command_ConstructMordorTavern; Command_ConstructMordorOrcFletcher
      ;  14  = Command_ConstructMordorUmbarTavern 
End

CommandSet NewNewNewMordorPorterCommandSet
	1  = Command_Stop
	2  = Command_PorterExtinguishFire
	3  = Command_PorterConstructMordorSlaughterHouse
	4  = Command_PorterConstructMordorLumberMill
	5  = Command_PorterConstructMordorOrcPit // x 2 era
	6  = Command_PorterConstructMordorHaradrimPalace // x 2 era
	7  = Command_PorterConstructMordorTrollCage // x 2 era
	8  = Command_PorterConstructMordorSiegeWorks 
	9  = Command_PorterConstructMumakilPen
	10 = Command_NecromancerWellOfSouls; Command_NecromancerWellOfSouls
	11 = Command_PorterconstructMordorBattleTower
	12 = Command_PorterConstructMordorFortress
	;13  = Command_ConstructMordorTavern; Command_ConstructMordorOrcFletcher
      ;  14  = Command_ConstructMordorUmbarTavern 
End

CommandButton Command_PurchaseUpgradeMordorBasicTraining
  	Command           	= OBJECT_UPGRADE
  	Upgrade           	= Upgrade_DwarvenFortressOilCasks 
	NeededUpgrade	  = Upgrade_TechnologyGondorBasicTraining
	NeededUpgradeAny		= Yes
	Options			  = CANCELABLE NEED_UPGRADE 
  	TextLabel         	= SecondAgeM
  	ButtonImage       	= BDFortress_OilCasks
  	ButtonBorderType  	= UPGRADE
  	DescriptLabel     	= SecondAgeMDesc
  	Radial            	= Yes
  	InPalantir	   	= No
LacksPrerequisiteLabel  =  SecondAgeMLack
End



CommandButton Command_SpellBookEyeofSauron
  Command           = OBJECT_UPGRADE
  Upgrade           = Upgrade_MordorFortressGorgorothSpire
  ;Upgrade           = Upgrade_MordorFortressGorgorothSpire
	NeededUpgrade	  = Upgrade_TechnologyElvenSilverthornArrows
	;NeededUpgrade	  = Upgrade_TechnologyElvenBasicTraining
	NeededUpgradeAny		= Yes
	Options			  = CANCELABLE NEED_UPGRADE  
  TextLabel         = thirdagem
  ButtonImage       = BDFortress_DwarvenStonework
  ButtonBorderType  = UPGRADE
  DescriptLabel     = thirdagemDesc
  Radial            = Yes
 InPalantir	   	= No
LacksPrerequisiteLabel  =  thirdagemLack
End

CommandSet MordorFortressCommandSetSecondAge
	InitialVisible = 7
	//Main Menu
	1	= Command_ConstructMordorPorter
;	2	= Command_ConstructMordorBlackRiderHorde
	2	= Command_SelectRevivablesMordorFortress
	3	= Command_FireWeaponMordorFortressMagmaCauldrons
	4	= Command_FireWeaponMordorFortressSpireFireball 
	5	= Command_SelectUpgradesMordorFortress	
	6	= Command_Sell
        7       = Command_PurchaseUpgradeMordorBasicTraining

	
		//Upgrades Menu
	8	= Command_PurchaseUpgradeMordorFortressDoomPyres
	9	= Command_PurchaseUpgradeMordorFortressLavaMoat
	10	= Command_PurchaseUpgradeMordorFortressFireArrows
	11	= Command_PurchaseUpgradeMordorFortressMagmaCauldrons
	;12	= Command_PurchaseUpgradeMordorFortressMorgulSorcery
	;13	= Command_PurchaseUpgradeMordorFortressGorgorothSpire
	14	= Command_RadialBack

	//Hero Menu
	15	= Command_RingHeroReviveSlot
	16	= Command_CreateAHeroReviveSlot		// Note we also need an extra slot for the Create A Hero
	17	= Command_GenericReviveSlot1
	18	= Command_GenericReviveSlot2		
	19	= Command_GenericReviveSlot3		
	20	= Command_GenericReviveSlot4    	
	21	= Command_GenericReviveSlot5		
	22	= Command_GenericReviveSlot6    	
	23	= Command_GenericReviveSlot7		
	24	= Command_RadialBack			
End	

CommandSet MordorFortressCommandSetThirdAge
	InitialVisible = 7
	//Main Menu
	1	= Command_FireWeaponMordorFortressSpireFireball
;	2	= Command_ConstructMordorBlackRiderHorde
	2	= Command_SelectRevivablesMordorFortress
	3	= Command_FireWeaponMordorFortressMagmaCauldrons
	4	= Command_SelectUpgradesMordorFortress 
	5	= Command_SpellBookEyeofSauron	
	6	= Command_Sell
        7       = Command_ConstructMordorPorter


	
		//Upgrades Menu

	8	= Command_PurchaseUpgradeMordorFortressDoomPyres
	9	= Command_PurchaseUpgradeMordorFortressLavaMoat
	10	= Command_PurchaseUpgradeMordorFortressFireArrows
	11	= Command_PurchaseUpgradeMordorFortressMagmaCauldrons
	;12	= Command_PurchaseUpgradeMordorFortressMorgulSorcery
	;13	= Command_PurchaseUpgradeMordorFortressGorgorothSpire
	14	= Command_RadialBack

	//Hero Menu
	15	= Command_RingHeroReviveSlot
	16	= Command_CreateAHeroReviveSlot		// Note we also need an extra slot for the Create A Hero
	17	= Command_GenericReviveSlot1
	18	= Command_GenericReviveSlot2		
	19	= Command_GenericReviveSlot3		
	20	= Command_GenericReviveSlot4    	
	21	= Command_GenericReviveSlot5		
	22	= Command_GenericReviveSlot6    	
	23	= Command_GenericReviveSlot7		
	24	= Command_RadialBack			
End		


Object MordorPorter
CommandSet = NewMordorPorterCommandSet
RemoveModule ModuleTag_01
AddModule
	Draw = W3DTruckDraw ModuleTag_016

	  OkToChangeModelColor = Yes
	  
;   StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
		
    DefaultModelConditionState
      Model             = MUOrcPrtr_SKN
      Skeleton			= MUOrcPrtr_SKL
    End

				IdleAnimationState
			Animation				= IDLA
				AnimationName		= MUOrcPrtr_IDLA
				AnimationMode		= ONCE
				AnimationPriority   = 10
			End
			Animation				= IDLB ; fidget. Search animation
				AnimationName		= MUOrcPrtr_IDLB
				AnimationMode		= ONCE
				AnimationPriority   = 1
			End
			Flags					= RESTART_ANIM_WHEN_COMPLETE			
		End
		AnimationState				= MOVING WANDER
			Animation				= WLKA
				AnimationName		= MUOrcPrtr_WLKA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
			;ParticleSysBone			= None InfantryDustTrails
		End
	
		AnimationState				= MOVING
			Animation				= RUNNING
				AnimationName		= MUOrcPrtr_RUNA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
			;ParticleSysBone			= None InfantryDustTrails
		End
	
		AnimationState          = DYING DEATH_2
			Animation
				AnimationName   = MUOrcPrtr_IDLA
				AnimationMode   = LOOP
			End
		End

		AnimationState				= DYING
			Animation				= DIEA
				AnimationName		= MUOrcPrtr_DIEA
				AnimationMode		= ONCE
			End
		End
				
		AnimationState						= PARALYZED
			Animation
				AnimationName				= MUOrcPrtr_IDLA
				AnimationMode				= LOOP
			End
		End

		AnimationState		= UNPACKING PACKING_TYPE_1
			Animation
				AnimationName		= MUOrcPrtr_FIRA
				AnimationMode		= ONCE
			End
			ParticleSysBone = BUCKET PorterFireWater FollowBone:YES
			BeginScript
				CurDrawablePlaySound("MenBuilderFireExtinguish")
			EndScript
		End

		LeftFrontTireBone			= Wheel_L01
		RightFrontTireBone			= Wheel_R01
		;LeftRearTireBone			= WHEEL_L01
		;RightRearTireBone			= WHEEL_R01
		TireRotationMultiplier		= 0.2
	End
End
CommandSet = NewMordorPorterCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades  ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewMordorPorterCommandSet
	End 
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp3
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor  ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewNewMordorPorterCommandSet
	End 
End
End

Object MordorFortressCitadel // prima roba triggered da Upgrade_DwarvenFortressOilCasks // seconda da Upgrade_DwarvenFortressDwarvenStoneworkTrigger
CommandSet = MordorFortressCommandSetSecondAge
RemoveModule AutoDepositModuleTag
ReplaceModule ModuleTag_PassOutNumenorStoneworkUpgrade
	Behavior = CastleUpgrade ModuleTag_PassOutNumenorStoneworkUpgrade56
		TriggeredBy	= Upgrade_DwarvenFortressOilCasks
		Upgrade		= Upgrade_MordorFortressMorgulSorcery
	End
	End
ReplaceModule ModuleTag_SpireEnabler
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SpireEnabler5
		SpecialPowerTemplate	= SpecialAbilityGorgorothSpireFireball
		TriggeredBy				= Upgrade_DwarvenFortressDwarvenStoneworkTrigger
	End
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp894
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= MordorFortressCommandSetThirdAge
	End 
End
End

//---------------------------------------StruttureCattiviMordor----------------

CommandButton Command_SpellBookSummonOrcs
	Command				= UNIT_BUILD
	Object				= DwarvenPhalanxHorde
	Options				= CANCELABLE
	TextLabel			= pikemanorcg
	ButtonImage			= BDHallofWarriors_DwarvenPhalanx
	ButtonBorderType    		= BUILD 
	DescriptLabel       		= pikemanorcgDesc
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= Yes    
End

CommandButton Command_BloodThirstySacrifice
	Command				= UNIT_BUILD
	Object				= WildSpiderlingHorde
	Options				= CANCELABLE NEED_UPGRADE
NeededUpgrade = Upgrade_MordorOrcPitLevel2
NeededUpgradeAny = Yes
	TextLabel			= merde
	ButtonImage			= BWSpiderPit_Spiderling
	ButtonBorderType    = BUILD 
	DescriptLabel       = merdeDesc
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount	= Yes      
LacksPrerequisiteLabel  =  merdeLack
End


CommandSet NewMordorOrcPitCommandSetLevel1
  	1	= Command_ConstructMordorOrcFighterHorde
  	2	= Command_ConstructMordorOrcArcherHorde
  	3	= Command_ConstructMordorBlackOrcFighterHorde
  	4	= Command_PurchaseTechnologyMordorBasicTraining
  	5 	= Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
        7       = Command_SpellBookSummonOrcs
        8       = Command_BloodThirstySacrifice
 
End

CommandSet NewMordorOrcPitCommandSetLevel2-
  	1	= Command_ConstructMordorOrcFighterHorde
  	2	= Command_ConstructMordorOrcArcherHorde
  	3	= Command_ConstructMordorBlackOrcFighterHorde
  	4	= Command_PurchaseTechnologyMordorBasicTraining
  	5 	= Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
        7       = Command_SpellBookSummonOrcs
        8       = Command_BloodThirstySacrifice
  	9 	= Command_UpgradeMordorOrcPitLevel2
End

CommandSet NewMordorOrcPitCommandSetLevel2
  	1	= Command_ConstructMordorOrcFighterHorde
  	2	= Command_ConstructMordorOrcArcherHorde
  	3	= Command_ConstructMordorBlackOrcFighterHorde
  	4	= Command_PurchaseTechnologyMordorBasicTraining
  	5 	= Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
        7       = Command_SpellBookSummonOrcs
        8       = Command_BloodThirstySacrifice
End

CommandSet NewMordorOrcPitCommandSetLevel3-
  	1	= Command_ConstructMordorOrcFighterHorde
  	2	= Command_ConstructMordorOrcArcherHorde
  	3	= Command_ConstructMordorBlackOrcFighterHorde
  	4	= Command_PurchaseTechnologyMordorBasicTraining
  	5 	= Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
        7       = Command_SpellBookSummonOrcs
        8       = Command_BloodThirstySacrifice
  	9 	= Command_UpgradeMordorOrcPitLevel3
End

CommandSet NewMordorOrcPitCommandSetLevel3
  	1	= Command_ConstructMordorOrcFighterHorde
  	2	= Command_ConstructMordorOrcArcherHorde
  	3	= Command_ConstructMordorBlackOrcFighterHorde
  	4	= Command_PurchaseTechnologyMordorBasicTraining
  	5 	= Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
        7       = Command_SpellBookSummonOrcs
        8       = Command_BloodThirstySacrifice
End

Object MordorOrcPit
AddModule
Behavior = DamageFieldUpdate ModuleTag_RazorSpinesWeapon
		Radius			= 100
		ObjectFilter	= ALL ENEMIES
		RequiredUpgrade	= Upgrade_DwarvenMithrilMail
		
		FireWeaponNugget
			WeaponName		= FireDrakeWarhead
			FireDelay		= 0
			OneShot			= No
		End
	End
End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= MBOrcPit01.tga 0 mubalrogwingsash.tga;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced5
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= FireDefencebonus
	End
      End
CommandSet = NewMordorOrcPitCommandSetLevel1
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp56
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMordorOrcPitCommandSetLevel2-
	End 
End

	

ReplaceModule ModuleTag_MordorOrcPitLevel2
	Behavior = CommandSetUpgrade ModuleTag_MordorOrcPitLevel266
		TriggeredBy		= Upgrade_MordorOrcPitLevel2
		ConflictsWith	= Upgrade_MordorOrcPitLevel3
		CommandSet		= NewMordorOrcPitCommandSetLevel2
	End
End

AddModule
Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5667
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMordorOrcPitCommandSetLevel3-
	End 
End

ReplaceModule ModuleTag_MordorOrcPitLevel3
	Behavior = CommandSetUpgrade ModuleTag_MordorOrcPitLevel367
		TriggeredBy		= Upgrade_MordorOrcPitLevel3
		CommandSet		= NewMordorOrcPitCommandSetLevel3
	End
End
End



Object DwarvenArcheryRange 
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE FS_FACTORY AUTO_RALLYPOINT NEED_BASE_FOUNDATION ATTACK_NEEDS_LINE_OF_SIGHT CAN_ATTACK MADE_OF_WOOD IGNORE_FOR_VICTORY
End

Object DwarvenSiegeWorks
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION AUTO_RALLYPOINT FS_FACTORY LIVING_WORLD_BUILDING_MIRROR IGNORE_FOR_VICTORY
End

Object MordorSiegeWorks
  KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION FS_FACTORY AUTO_RALLYPOINT  MADE_OF_DIRT FACE_AWAY_FROM_CASTLE_KEEP LIVING_WORLD_BUILDING_MIRROR IGNORE_FOR_VICTORY
End

Object WildSpiderPit
KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE AUTO_RALLYPOINT FS_FACTORY IGNORE_FOR_VICTORY
End

;-------------------------------------------------------------------------------



CommandButton Command_ConstructMordorHaradrimRiderHorde
	Command				= UNIT_BUILD
	Object				= MordorHaradrimRiderHorde
	Options				= CANCELABLE
	TextLabel			= CONTROLBAR:ConstructMordorHaradrimRiderHorde
	ButtonImage			= BMHaradCalvaryIcon
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildMordorHaradrimRiderHorde
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
	;NeededUpgrade			= Upgrade_MordorHaradrimPalaceLevel2		
;   	UnitSpecificSound  		= GondorArcherVoiceBuy      
End

CommandButton Command_CreateAHero_SpecialAbilityDisguise
	Command				= UNIT_BUILD
	Object				= GoblinArcherHorde
	Options				= CANCELABLE NEED_UPGRADE
        NeededUpgrade                   = Upgrade_MordorHaradrimPalaceLevel2
        NeededUpgradeAny                   = Yes
	TextLabel			= spadahara
	ButtonImage			= BWCave_GoblinArcher
	ButtonBorderType		= BUILD											
	DescriptLabel			= spadaharaDesc
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
LacksPrerequisiteLabel  =  spadaharaLack
End

CommandButton Command_ConstructEasterlingHorde
	Command				= UNIT_BUILD
	Object				= MordorEasterlingHorde
	Options				= CANCELABLE NEED_UPGRADE
        NeededUpgrade                   = Upgrade_MordorHaradrimPalaceLevel2
        NeededUpgradeAny                   = Yes
	TextLabel			= CONTROLBAR:ConstructMordorEasterlingHorde
	ButtonImage			= BMHaradrimPalace_SoldiersRhun
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildMordorEasterlingHorde
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
;    UnitSpecificSound   = GondorArcherVoiceBuy      
End

CommandSet NewMordorHaradrimPalaceCommandSetLevel1
  	1	= Command_ConstructEasterlingHorde
	2 	= Command_ConstructMordorHaradrimRiderHorde
  	3	= Command_ConstructMordorCorsairsOfUmbarHorde	; BFME EXPANSION PACT Faction Enhancement
	4	= Command_ConstructMordorHaradrimArcherHorde
	5	= Command_CreateAHero_Fireball_Level1 	; BFME EXPANSION PACT Faction Enhancement
  	6	= Command_Sell
  	;7 	= Command_UpgradeMordorHaradrimPalaceLevel2
        8       = Command_CreateAHero_SpecialAbilityDisguise
        9       = Command_PurchaseTechnologyMordorFireArrows
End

CommandSet NewMordorHaradrimPalaceCommandSetLevel2-
  	1	= Command_ConstructEasterlingHorde
	2 	= Command_ConstructMordorHaradrimRiderHorde
  	3	= Command_ConstructMordorCorsairsOfUmbarHorde	; BFME EXPANSION PACT Faction Enhancement
	4	= Command_ConstructMordorHaradrimArcherHorde
	5	= Command_CreateAHero_Fireball_Level1; BFME EXPANSION PACT Faction Enhancement
  	6	= Command_Sell
  	7 	= Command_UpgradeMordorHaradrimPalaceLevel2
        8       = Command_CreateAHero_SpecialAbilityDisguise
        9       = Command_PurchaseTechnologyMordorFireArrows
End

CommandSet NewMordorHaradrimPalaceCommandSetLevel2
  	1	= Command_ConstructEasterlingHorde
	2 	= Command_ConstructMordorHaradrimRiderHorde
  	3	= Command_ConstructMordorCorsairsOfUmbarHorde	; BFME EXPANSION PACT Faction Enhancement
	4	= Command_ConstructMordorHaradrimArcherHorde
	5	= Command_CreateAHero_Fireball_Level1; BFME EXPANSION PACT Faction Enhancement
  	6	= Command_Sell
  	;7 	= Command_UpgradeMordorHaradrimPalaceLevel3
        8       = Command_CreateAHero_SpecialAbilityDisguise
        9       = Command_PurchaseTechnologyMordorFireArrows
End

CommandSet NewMordorHaradrimPalaceCommandSetLevel3-
  	1	= Command_ConstructEasterlingHorde
	2 	= Command_ConstructMordorHaradrimRiderHorde
  	3	= Command_ConstructMordorCorsairsOfUmbarHorde	; BFME EXPANSION PACT Faction Enhancement
	4	= Command_ConstructMordorHaradrimArcherHorde
	5	= Command_CreateAHero_Fireball_Level1; BFME EXPANSION PACT Faction Enhancement
  	6	= Command_Sell
  	7 	= Command_UpgradeMordorHaradrimPalaceLevel3
        8       = Command_CreateAHero_SpecialAbilityDisguise
        9       = Command_PurchaseTechnologyMordorFireArrows
End

CommandSet NewMordorHaradrimPalaceCommandSetLevel3
  	1	= Command_ConstructEasterlingHorde
	2 	= Command_ConstructMordorHaradrimRiderHorde
  	3	= Command_ConstructMordorCorsairsOfUmbarHorde	; BFME EXPANSION PACT Faction Enhancement
	4	= Command_ConstructMordorHaradrimArcherHorde
	5	= Command_CreateAHero_Fireball_Level1; BFME EXPANSION PACT Faction Enhancement
  	6	= Command_Sell
        8       = Command_CreateAHero_SpecialAbilityDisguise
        9       = Command_PurchaseTechnologyMordorFireArrows
End

Object MordorHaradrimPalace
AddModule
Behavior = DamageFieldUpdate ModuleTag_RazorSpinesWeapon
		Radius			= 100
		ObjectFilter	= ALL ENEMIES
		RequiredUpgrade	= Upgrade_DwarvenMithrilMail
		
		FireWeaponNugget
			WeaponName		= FireDrakeWarhead
			FireDelay		= 0
			OneShot			= No
		End
	End
End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= MBHrdPlc.tga 0 mubalrogwingsash.tga;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= FireDefencebonus
	End
      End
CommandSet = NewMordorHaradrimPalaceCommandSetLevel1
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5645
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMordorHaradrimPalaceCommandSetLevel2-
	End 
End
ReplaceModule ModuleTag_MordorHaradrimPalaceLevel2
	Behavior = CommandSetUpgrade ModuleTag_MordorHaradrimPalaceLevel26
		TriggeredBy		= Upgrade_MordorHaradrimPalaceLevel2
		ConflictsWith	= Upgrade_MordorHaradrimPalaceLevel3
		CommandSet		= NewMordorHaradrimPalaceCommandSetLevel2
	End
End 
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5645tt
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMordorHaradrimPalaceCommandSetLevel3-
	End 
End
ReplaceModule ModuleTag_MordorHaradrimPalaceLevel3
	Behavior = CommandSetUpgrade ModuleTag_MordorHaradrimPalaceLevel36
		TriggeredBy		= Upgrade_MordorHaradrimPalaceLevel3
		CommandSet		= NewMordorHaradrimPalaceCommandSetLevel3
	End
End
End

CommandButton Command_SpecialAbilityRageoftheNorth
	Command				= UNIT_BUILD
	Object				= WildMountainGiant
	Options				= CANCELABLE NEED_UPGRADE
	TextLabel			= CONTROLBAR:ConstructWildMountainGiant0
	ButtonImage			= BWFissure_Giant
	ButtonBorderType	= BUILD											
	DescriptLabel		= CONTROLBAR:ToolTipBuildWildMountainGiant0
	NeededUpgrade		= Upgrade_MordorTrollCageLevel3
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount	= Yes
LacksPrerequisiteLabel  =  trollllack
End

FXParticleSystem balrogFireRing0
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXFireScroll3.tga
    Lifetime = 45 60
    SystemLifetime = 75
    Size = 1 8
    BurstDelay = 25 35
    BurstCount = 25 50
    InitialDelay = 43 43
  End
  Color = DefaultColor
    Color2 = R:98 G:69 B:51 8
    Color3 = R:0 G:0 B:0 45
    ColorScale = -0.3 0
  End
  Alpha = DefaultAlpha
    Alpha3 = 60 60 0
  End
  Update = DefaultUpdate
    SizeRate = 1 3
    SizeRateDamping = 0.8 0.9
    AngularRateZ = -5 5
    AngularDamping = 0.6 0.6
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 0.9
    DriftVelocity = X:0 Y:0 Z:0.24
  End
  EmissionVelocity = CylindricalEmissionVelocity
    Radial = 2 3
    Normal = 1 1
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:56 Y:-40 Z:0
    EndPoint = X:75 Y:25 Z:0
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem SarumanWaveBlastWave0
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXSarumanBlast.TGA
    Lifetime = 20 20
    SystemLifetime = 5
    SortLevel = 1
    BurstCount = 10 10
    IsGroundAligned = Yes
    IsParticleUpTowardsEmitter = Yes
  End
  Color = DefaultColor
    Color1 = R:98 G:69 B:51 0
    Color2 = R:0 G:0 B:0 45
  End
  Update = DefaultUpdate
    SizeRate = 3 7
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.1 -0.1
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem TrollSplatDust0
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXFireScroll3.tga
    Lifetime = 125 125
    SystemLifetime = 3
    SortLevel = 1
    Size = 5 15
    BurstCount = 4 8
    InitialDelay = 34 34
  End
  Color = DefaultColor
    Color1 = R:200 G:78 B:61 1
    Color2 = R:200 G:108 B:91 30
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.5 0.5 1
    Alpha2 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 1 3
    SizeRateDamping = 0.85 0.95
    AngularRateZ = -0.03 0.03
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.75 0.8
  End
  EmissionVelocity = OutwardEmissionVelocity
    Speed = 4 6
    OtherSpeed = 1 2
  End
  EmissionVolume = CylinderEmissionVolume
    IsHollow = Yes
    Radius = 12
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem TrollSplatDust10
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXLnzFlar1.tga
    Lifetime = 125 125
    SystemLifetime = 3
    SortLevel = 1
    Size = 5 15
    BurstCount = 8 12
    InitialDelay = 90 90
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 1
    Color2 = R:255 G:255 B:255 30
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.5 0.5 1
    Alpha2 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 1 3
    SizeRateDamping = 0.85 0.95
    AngularRateZ = -0.03 0.03
    AngularDamping = 0.99 0.99
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.8 0.95
  End
  EmissionVelocity = OutwardEmissionVelocity
    Speed = -4 4
    OtherSpeed = 1 0
  End
  EmissionVolume = LineEmissionVolume
    IsHollow = Yes
    StartPoint = X:-24 Y:0 Z:-12
    EndPoint = X:30 Y:0 Z:-15
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem TrollSplatDust20
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXLeaf01.tga
    Lifetime = 125 125
    SystemLifetime = 3
    Size = 5 15
    BurstCount = 2 4
  End
  Color = DefaultColor
    Color1 = R:86 G:200 B:61 1
    Color2 = R:121 G:200 B:91 30
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.5 0.5 1
    Alpha2 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 1 3
    SizeRateDamping = 0.85 0.95
    AngularRateZ = -0.03 0.03
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.75 0.8
  End
  EmissionVelocity = OutwardEmissionVelocity
    Speed = 4 6
    OtherSpeed = 1 2
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:-12 Y:0 Z:-12
    EndPoint = X:15 Y:0 Z:-15
  End
  Draw = DefaultDraw
  End
End

FXList FX_TrollClubHit0
  Sound
    Name = ImpactCatapultRock
  End
  ParticleSystem
    Name = SarumanWaveBlastWave0
    Offset = X:40.0 Y:0.0 Z:8.0
    OrientToObject = Yes
  End
  ParticleSystem
    Name = balrogFireRing0
    Offset = X:40.0 Y:0.0 Z:8.0
    OrientToObject = Yes
  End
  ViewShake 
    Type = STRONG
  End
End

Weapon MordorAttackTrollClubSwing0
	LeechRangeWeapon			= Yes
	RadiusDamageAffects			= ENEMIES								; Turning off friendly fire for all allies, but ya know, this could say NotSimilar and then he could hit friendlies except for trolls
	MeleeWeapon					= Yes
	AttackRange					= 30									; this was tuned with the Damage and shock wave nugget so it looks good with club
	FireFX						= FX_TrollClubHit0
	ClipSize					= INFINITE_CLIP_SIZE					; how many shots in a Clip (0 == infinite)
	AutoReloadsClip				= No									; We need a rock explicitly picked up.
	DelayBetweenShots			= MORDOR_ATTACKTROLL_TREE_DELAYBETWEENSHOTS	; time between shots, msec
	FiringDuration				= MORDOR_ATTACKTROLL_TREE_FIRINGDURATION
	PreAttackDelay				= MORDOR_ATTACKTROLL_TREE_PREATTACKDELAY
	PreAttackType				= PER_SHOT								; Do the delay each time we attack a new target
	PreAttackFX					= FX_TrollTreeSwing
	DamageDealtAtSelfPosition	= Yes									; A melee based AoE.  Arc radiates from me, not them
	AcceptableAimDelta			= 35.0 

	DamageNugget									; A basic Nugget that just does damage
		Damage			= 600  ; kill gondor troops in 1 hit
		DamageScalar		= 50% NONE +HERO +PIKE
		Radius			= 90.0						; matches impact nugget so it throws them back and hurts them
		DamageArc		= 135
		DamageType		= SIEGE
		DamageFXType		= CLUBBING
		DeathType		= NORMAL
	End

	MetaImpactNugget								; A Nugget that throws things back with force
		ShockWaveAmount   = 75.0
		ShockWaveRadius   = 90.0
		ShockWaveTaperOff = 0.75
		ShockWaveArc      = 135
		ShockWaveZMult    = 1.20
;		HeroResist		  = 0.90					; 90% resistance to heroes
	End
End

;------------------------------------------------------------------------------
Armor AttackTrollArmor0
  Armor = DEFAULT        	 16%   	; 100%
  Armor = SLASH          	 33%   	; 100%
  Armor = PIERCE         	 16%   	;  50%
  Armor = SPECIALIST     	75%   	;  50%	originally 200%
  Armor = CRUSH          	  1%   	; 200%
  Armor = CAVALRY	 	 16%   	;
  Armor = SIEGE          	 33%   	;
  Armor = FLAME          	 33%   	;  30%
  Armor = FROST          	 33%   ;
  Armor = MAGIC          	 33%   	;
  Armor = HERO            	69%   	;
  Armor = HERO_RANGED     	69%   	; 
  Armor = STRUCTURAL   		 13%    ; originally 25%
  FlankedPenalty 	       = 50%    
End

CommandSet NewMordorMountainTrollCommandSet
	1	= Command_ToggleStance
	2  	= Command_ToggleMountainTrollRockThrow
	3  	= Command_SpecialAbilityTrollFindTree 
	4  	= Command_SpecialAbilityTrollFindTastyOrc
	5       = Command_CreateAHero_HowlOfRage_Level1
	13 	= Command_AttackMove
	14 	= Command_Stop
	16	= Command_SpecialAbilityTrollGrabTree			; For context-sensitive tree grab
End

ChildObject WildMountainGiant MordorAttackTroll
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End
BuildCost = 1500
BuildTime = 30
Scale = 1.3
ReplaceModule ModuleTag_02
	Body = DelayedDeathBody ModuleTag_020
		CheerRadius					= EMOTION_CHEER_RADIUS
		MaxHealth					= 3000
		MaxHealthDamaged				= MORDOR_ATTACKTROLL_HEALTH_DAMAGED
		MaxHealthReallyDamaged				= MORDOR_ATTACKTROLL_HEALTH_RAMPAGE_DAMAGED
		DoHealthCheck					= No
		DelayedDeathTime				= 5000
		CanRespawn					= No
	End
End
	AddModule
	Behavior = SubObjectsUpgrade Costume_3
		TriggeredBy		= Upgrade_MordorFaction
		UpgradeTexture	= muattktroll.tga 0 mubalrogwingsash.tga 
		UpgradeTexture	= muattkwpns.tga 0 mubalrogwings.tga  
				RecolorHouse	= No
	End
End
ReplaceModule ModuleTag_01
Draw = W3DScriptedModelDraw ModuleTag_010
		WadingParticleSys = EntRipples
		OkToChangeModelColor = Yes
		ExtraPublicBone = Trunk
		ShowShadowWhileContained = Yes
		StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

		DefaultModelConditionState
			Model = MUAtkTroll_SKN
                        ParticleSysBone = B_JAW BalrogManeFlare FollowBone:yes
			ParticleSysBone = NONE BalrogManeEmbers FollowBone:yes
			ParticleSysBone = NONE BalrogManeEmbers FollowBone:yes
			ParticleSysBone = B_Neck BalrogManeFlare FollowBone:yes
		End

		AnimationState = DYING DEATH_3
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode = LOOP
			End
		End

		; Splatted death goes first, independant of death flags
		ModelConditionState    = DYING DECAY SPLATTED USER_4
			Model                = MUAtkTr2_DISC
			RetainSubObjects = Yes
		End
		ModelConditionState    = DYING DECAY SPLATTED
			Model                = MUAtkTroll_DISC

			RetainSubObjects = Yes
		End

		AnimationState         = DYING DECAY SPLATTED 
			Animation            = dead1
				AnimationName       = MUAtkTroll_DISC.MUAtkTroll_DISC
				AnimationMode      = ONCE
			End
		End

		ModelConditionState    = DYING DECAY DEATH_1 USER_4
			Model                = MUAtkTr2_DISA
			RetainSubObjects = Yes
		End;
		ModelConditionState    = DYING DECAY DEATH_1
			Model                = MUAtkTroll_DISA
			RetainSubObjects = Yes
		End;

		AnimationState         = DYING DECAY DEATH_1 
			Animation            = dead1
				AnimationName       = MUAtkTroll_DISA.MUAtkTroll_DISA
				AnimationMode      = ONCE
			End
		End
		
		ModelConditionState    = DYING DECAY DEATH_2 USER_4
			Model                = MUAtkTr2_DISB
			RetainSubObjects = Yes
		End;
		ModelConditionState    = DYING DECAY DEATH_2
			Model                = MUAtkTroll_DISB
			RetainSubObjects = Yes
		End;

		AnimationState         = DYING DECAY DEATH_2 
			Animation            = dead1
				AnimationName       = MUAtkTroll_DISB.MUAtkTroll_DISB
				AnimationMode      = ONCE
			End
		End

		; Flailing must go before dying in case we are dead in the air
		AnimationState = STUNNED_FLAILING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_FLYA
				AnimationMode = LOOP
			End
		End

		AnimationState = DYING SPLATTED
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_LNDA
				AnimationMode = ONCE
			End
		End


		AnimationState = DYING DEATH_1
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_DIEA
				AnimationMode = ONCE
			End
			ParticleSysBone = B_PELVIS TrollSplatDust0
			ParticleSysBone = BAT_HEAD TrollSplatDust0
		End

		AnimationState = DYING DEATH_2
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_DIEB
				AnimationMode = ONCE
			End
			ParticleSysBone = BAT_SPINE1 TrollSplatDust1
			ParticleSysBone = BAT_HEAD TrollSplatDust1
		End
		
		ModelConditionState = DYING USER_4
			Model = MUAtkTr2_SKN
		End
		ModelConditionState = DYING
			Model = MUAtkTroll_SKN
		End

		AnimationState = DYING
			Animation
				AnimationName     =  MUMntTroll_SKL.MUMntTroll_DIEB
				AnimationMode     = ONCE
			End
		End

		//Turned to stone
		ModelConditionState = STONED USER_4
			Model			= MUAtkTr2_SKN
			Texture			= MUAttkTroll.tga MUAttkTroll_R.tga
		End 		
		ModelConditionState = STONED 
			Model			= MUAtkTroll_SKN
			Texture			= MUAttkTroll.tga MUAttkTroll_R.tga
		End 		

		AnimationState		= STONED
			Animation			= Stoned
				AnimationName		= MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode		= MANUAL
				AnimationBlendTime	= 10
			End
			Flags	= START_FRAME_LAST
		End

		; Flailing must go before dying in case we are dead in the air
		AnimationState = STUNNED_FLAILING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_FLYA
				AnimationMode = LOOP
			End
		End

		AnimationState				= STUNNED_STANDING_UP
			Animation				= MUMntTroll_GTPA
				AnimationName		= MUMntTroll_SKL.MUMntTroll_GTPA
				AnimationMode		= ONCE
			End
		End	

		AnimationState				= STUNNED
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_LNDA
				AnimationMode = ONCE
			End
			ParticleSysBone = B_PELVIS TrollSplatDust2
			ParticleSysBone = BAT_HEAD TrollSplatDust2
		End

		AnimationState						= PARALYZED
			Animation
				AnimationName				= MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode				= LOOP
			End
		End

		;--Troll is angry
		AnimationState = WEAPONSET_RAMPAGE
			Animation = GetMad
				AnimationName = MUMntTroll_SKL.MUMntTroll_RPGC
				AnimationMode = LOOP
			End
		End

		; --------- With Club ------------
		AnimationState = FIRING_OR_PREATTACK_A
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKC
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKD
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
		End

		;Running attack
		AnimationState = MOVING FIRING_OR_PREATTACK_B
			Animation

				AnimationName = MUMntTroll_SKL.MUMntTroll_ATRA
				AnimationMode = LOOP
				UseWeaponTiming		= Yes
			End
		End
			
		AnimationState = PREPARING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_GRBC
				AnimationMode = ONCE
			End

		End

		IdleAnimationState
			Animation = BreathWithClub
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode = ONCE
				AnimationPriority = 30
				AnimationSpeedFactorRange = 0.8 1.0
			End
			Animation = BreathWithClub
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode = ONCE
				AnimationPriority = 30
				AnimationSpeedFactorRange = 0.8 1.0
			End
			Animation = IDLE
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLE  ;ROAR THEN HIT GROUND (holding club only)
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 5
			End
			Animation = IDLG
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLG  ;BUTT SCRATCH THEN BURP
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 10
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE
			BeginScript ; Here since normal Packing state can be skipped with a fast click.
				CurDrawableShowSubObjectPermanently("Trunk01")
			EndScript
		End


		; --------- With Bare Hands ------------
		AnimationState = UNPACKING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLH
				AnimationMode = ONCE
			End
		End

		AnimationState = TURN_LEFT
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNL
				AnimationMode = LOOP
				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails
		End

		AnimationState = TURN_RIGHT
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNR
				AnimationMode = LOOP

				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails0
		End


		;AnimationState = MOVING ATTACKING
		;	Animation
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_RUNA  ; Running with club
		;		AnimationMode = LOOP
		;		AnimationSpeedFactorRange = 0.77 0.77
		;	End
		;	Flags               = RANDOMSTART
		;	ParticleSysBone     = None InfantryDustTrails
		;	FXEvent	= Frame:5 FireWhenSkipped Name:FX_TrollRightFootStep
		;	FXEvent	= Frame:17 FireWhenSkipped Name:FX_TrollLeftFootStep
		;End

		AnimationState				= MOVING PANICKING
			Animation				= RUNM
				AnimationName		=  MUMntTroll_SKL.MUMntTroll_MFDA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End

		;AnimationState = MOVING DAMAGED
		;	Animation
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB ; Walking with club
		;		AnimationMode = LOOP
		;		AnimationSpeedFactorRange = 1.3 1.3
		;	End
		;	Flags               = RANDOMSTART
		;	ParticleSysBone     = None InfantryDustTrails
		;	FXEvent	= Frame:22 FireWhenSkipped Name:FX_TrollLeftFootStep
		;	FXEvent	= Frame:3 FireWhenSkipped Name:FX_TrollRightFootStep
		;End


		;AnimationState = MOVING
		;	Animation
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB ; Walking with club 
		;		AnimationMode = LOOP
		;		AnimationSpeedFactorRange = 1.36 1.36
		;	End
		;	Flags               = RANDOMSTART
		;	ParticleSysBone     = None InfantryDustTrails
		;	FXEvent	= Frame:22 FireWhenSkipped Name:FX_TrollLeftFootStep
		;	FXEvent	= Frame:3 FireWhenSkipped Name:FX_TrollRightFootStep	
		;End

		AnimationState = MOVING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_RUNA  ; Running with club
				AnimationMode = LOOP
				;AnimationSpeedFactorRange = 0.77 0.77
			End
			Flags               = RANDOMSTART
			ParticleSysBone     = None InfantryDustTrails
			FXEvent	= Frame:5 FireWhenSkipped Name:FX_TrollRightFootStep
			FXEvent	= Frame:17 FireWhenSkipped Name:FX_TrollLeftFootStep
		End


		AnimationState = ENGAGED
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLA
				AnimationMode = LOOP
			End
		End


		AnimationState = DESTROYED_WEAPON
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKA
				AnimationMode = ONCE
			End
		End

		; --------- Just built ------------

		AnimationState = JUST_BUILT
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_WLKC ; temp
				AnimationMode = ONCE
				AnimationBlendTime = 0
				AnimationSpeedFactorRange = 0.9 0.9			
			End
			FXEvent	= Frame:0 FireWhenSkipped Name:FX_TrollRightFootStep
			FXEvent	= Frame:16 FireWhenSkipped Name:FX_TrollLeftFootStep
			FXEvent	= Frame:30 FireWhenSkipped Name:FX_TrollRightFootStep
			FXEvent	= Frame:44 FireWhenSkipped Name:FX_TrollLeftFootStep
		End	

		; --------- Click and Hit Reactions ------------

		AnimationState = HIT_REACTION HIT_LEVEL_1
			Animation = Hit_Level_1_a
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITC
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION HIT_LEVEL_2
			Animation = Hit_Level_2
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITB
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION HIT_LEVEL_3
			Animation = Hit_Level_3
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITA
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_1
			Animation = Click_React_1
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTA
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_2
			Animation = Click_React_2
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTB
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_3
			Animation = Click_React_3
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTC
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_4
			Animation = Click_React_4
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTD
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_5
			Animation = Click_React_5
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTE
				AnimationMode = ONCE
			End
		End

		AnimationState = USER_2
			Animation = ReactToTrollPoke ; The two comes from the special TrollBored weapon
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITE
				AnimationMode = ONCE
			End
		End

		AnimationState = USER_3 
			Animation = ExpectAnotherPoke ; The three comes from the special TrollBored weapon, and lasts longer than 2
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLJ
				AnimationMode = LOOP
			End
		End

		;-----------------------------------
		;Emotion

		AnimationState = EMOTION_CELEBRATING
			Animation
				AnimationName	=	MUMntTroll_SKL.MUMntTroll_IDLF
				AnimationMode	=	LOOP
			End
		End
		
		AnimationState					= EMOTION_TAUNTING
			Animation
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLA
				AnimationMode			= ONCE
				AnimationPriority		= 20
			End
			Animation					= Taunting3
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLH
				AnimationMode			= ONCE
				AnimationPriority		= 10
			End
			Animation					= Taunting4
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLE
				AnimationMode			= ONCE
				AnimationPriority		= 5
			End
		End

		ModelConditionState = USER_4 
			Model			= MUAtkTr2_SKN
		End 		
	End
End

AddModule	
	Draw = W3DScriptedModelDraw DustEffects
	    DefaultModelConditionState
	      Model = None
	    End
	    IdleAnimationState
	    End
	    AnimationState =  MOVING WADING
			ParticleSysBone = None FootstepSlash
	    End
	    AnimationState = MOVING ACCELERATE
			ParticleSysBone = None GenericSiegeTrailDust
	    End
	    AnimationState =  MOVING ACCELERATE
			ParticleSysBone = None GenericSiegeTrailDust
	    End
	    AnimationState = MOUNTED MOVING
	    End
	End
End
	WeaponSet
		Conditions					= None
		Weapon						= PRIMARY    MordorAttackTrollClubSwing0
		AutoChooseSources			= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		Weapon						= SECONDARY	 MordorAttackTrollClubSwing
		OnlyInCondition				= SECONDARY	 MOVING
	End

	WeaponSet
		Conditions					= RAMPAGE
		Weapon						= PRIMARY MordorCaveTrollRampage
	End

	ArmorSet
		Conditions					= None
		Armor						= AttackTrollArmor0
		DamageFX					= NormalDamageFX
	End
End

CommandSet NewMordorDrummerTrollCommandSet
	1	= Command_ToggleStance
	2	= Command_SpecialAbilityRoar
	3	= Command_DrummerTrollLeadership
        4       = Command_CreateAHero_HowlOfRage_Level1
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandButton Command_ConstructMordorAttackTroll
	Command				= UNIT_BUILD
	Object				= MordorAttackTroll
	Options				= CANCELABLE NEED_UPGRADE
        NeededUpgradeAny                = Yes
	NeededUpgrade			= Upgrade_MordorTrollCageLevel2
	TextLabel			= CONTROLBAR:ConstructMordorAttackTroll
	ButtonImage			= BMTrollCages_AttackTroll
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildMordorAttackTroll
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
	;NeededUpgrade			= Upgrade_MordorTrollCageLevel2
End



CommandSet NewMordorTrollCageCommandSetLevel1
;	1	= Command_ConstructMordorWargHorde	; BFME EXPANSION PACT Faction Enhancement
	1	= Command_ConstructMordorMountainTroll
	2	= Command_ConstructMordorDrummerTroll
	3	= Command_ConstructMordorAttackTroll
	;4	= Command_UpgradeMordorTrollCageLevel2
        5       = Command_CreateAHero_Fireball_Level1
	6	= Command_Sell
        7       = Command_DominateTroll
        8       = Command_SpecialAbilityRageoftheNorth
End
CommandSet NewMordorTrollCageCommandSetLevel2-
;	1	= Command_ConstructMordorWargHorde	; BFME EXPANSION PACT Faction Enhancement
	1	= Command_ConstructMordorMountainTroll
	2	= Command_ConstructMordorDrummerTroll
	3	= Command_ConstructMordorAttackTroll
	4	= Command_UpgradeMordorTrollCageLevel2
        5       = Command_CreateAHero_Fireball_Level1
	6	= Command_Sell
        7       = Command_DominateTroll
        8       = Command_SpecialAbilityRageoftheNorth
End

CommandSet NewMordorTrollCageCommandSetLevel2
;	1	= Command_ConstructMordorWargHorde		; BFME EXPANSION PACT Faction Enhancement
	1	= Command_ConstructMordorMountainTroll
	2	= Command_ConstructMordorDrummerTroll
	3	= Command_ConstructMordorAttackTroll
	;4	= Command_UpgradeMordorTrollCageLevel3
        5       = Command_CreateAHero_Fireball_Level1
	6	= Command_Sell
        7       = Command_DominateTroll
        8       = Command_SpecialAbilityRageoftheNorth
End

CommandSet NewMordorTrollCageCommandSetLevel3-
;	1	= Command_ConstructMordorWargHorde		; BFME EXPANSION PACT Faction Enhancement
	1	= Command_ConstructMordorMountainTroll
	2	= Command_ConstructMordorDrummerTroll
	3	= Command_ConstructMordorAttackTroll
	4	= Command_UpgradeMordorTrollCageLevel3
        5       = Command_CreateAHero_Fireball_Level1
	6	= Command_Sell
        7       = Command_DominateTroll
        8       = Command_SpecialAbilityRageoftheNorth
End

CommandSet NewMordorTrollCageCommandSetLevel3
;	1	= Command_ConstructMordorWargHorde	; BFME EXPANSION PACT Faction Enhancement
	1	= Command_ConstructMordorMountainTroll
	2	= Command_ConstructMordorDrummerTroll
	3	= Command_ConstructMordorAttackTroll
        5       = Command_CreateAHero_Fireball_Level1
	6	= Command_Sell
        7       = Command_DominateTroll
        8       = Command_SpecialAbilityRageoftheNorth
End

Object MordorTrollCage
AddModule
Behavior = DamageFieldUpdate ModuleTag_RazorSpinesWeapon
		Radius			= 100
		ObjectFilter	= ALL ENEMIES
		RequiredUpgrade	= Upgrade_DwarvenMithrilMail
		
		FireWeaponNugget
			WeaponName		= FireDrakeWarhead
			FireDelay		= 0
			OneShot			= No
		End
	End
End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= MBTrollPit.tga 0 mubalrogwingsash.tga;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced7
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= FireDefencebonus
	End
      End
CommandSet = NewMordorTrollCageCommandSetLevel1
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5645764
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMordorTrollCageCommandSetLevel2-
	End 
End
ReplaceModule ModuleTag_MordorTrollCageLevel2
	Behavior = CommandSetUpgrade ModuleTag_MordorTrollCageLevel25
		TriggeredBy		= Upgrade_MordorTrollCageLevel2
		ConflictsWith	= Upgrade_MordorTrollCageLevel3
		CommandSet		= NewMordorTrollCageCommandSetLevel2
	End
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5645
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMordorTrollCageCommandSetLevel3-
	End 
End
ReplaceModule ModuleTag_MordorTrollCageLevel3
	Behavior = CommandSetUpgrade ModuleTag_MordorTrollCageLevel3y
		TriggeredBy		= Upgrade_MordorTrollCageLevel3
		CommandSet		= NewMordorTrollCageCommandSetLevel3
	End
End
End

;--------------------orchetti picca -------------------

Object DwarvenPhalanx
RemoveModule ModuleTag_01
	ButtonImage		= WOR_OrcWarrior
	SelectPortrait		= UPMordor_OrcHorde
AddModule
  Draw = W3DScriptedModelDraw ModuleTag_0156

    ; Arrow sticking
    DefaultModelConditionState
      Model = MUOrcPike_SKN
    End

		IdleAnimationState
			Animation = IDLA
	      AnimationName = IUPikeman_SKL.IUPikeman_IDLA
	      AnimationMode = ONCE
				AnimationPriority = 15
			End
			Animation = IDLB
	      AnimationName = IUPikeman_SKL.IUPikeman_IDLB
	      AnimationMode = ONCE
				AnimationPriority = 10
			End
			Animation = IDLC
	      AnimationName = IUPikeman_SKL.IUPikeman_IDLC
	      AnimationMode = ONCE
			End
			StateName = Idle
		End
 
    AnimationState = MOVING
			Animation = Moving_1
	      AnimationName = IUPikeman_SKL.IUPikeman_RUNA
		    AnimationMode = LOOP
			End
			Animation = Moving_2
	      AnimationName = IUPikeman_SKL.IUPikeman_RUNB
		    AnimationMode = LOOP
			End
			Flags = RANDOMSTART
			ParticleSysBone = None InfantryDustTrails
    End


	AnimationState =  FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
		Animation = ATKC
			AnimationName		= IUPikeman_SKL.IUPikeman_ATKC
			AnimationMode		= ONCE
			UseWeaponTiming		= Yes	
		End
	End
	

	AnimationState = FIRING_OR_PREATTACK_A AIM_HIGH 
		Animation = ATKB
			AnimationName		= IUPikeman_SKL.IUPikeman_ATKB
			AnimationMode		= ONCE
			UseWeaponTiming		= Yes	
		End
	End
	

	AnimationState =  FIRING_OR_PREATTACK_A
		Animation = ATKA
			AnimationName		= IUPikeman_SKL.IUPikeman_ATKA
			AnimationMode		= ONCE
			UseWeaponTiming		= Yes	
		End
	End

    AnimationState = DYING SPLATTED
 			Animation = Splattered_On_Ground_1
				AnimationName = IUPikeman_SKL.IUBanner_LNDA
	      AnimationMode = ONCE
			End
 			Animation = Splattered_On_Ground_2
				AnimationName = IUPikeman_SKL.IUBanner_LNDB
	      AnimationMode = ONCE
			End
    End

     AnimationState = DYING AFLAME
			Animation = Flaming_Death
	      AnimationName = IUPikeman_SKL.IUPikeman_MFDA
		    AnimationMode = ONCE
			End
    End

    AnimationState = DYING
			Animation = Dying_1
	      AnimationName = IUPikeman_SKL.IUPikeman_DTHA
		    AnimationMode = ONCE
			End
			Animation = Dying_2
	      AnimationName = IUPikeman_SKL.IUPikeman_DTHB
		    AnimationMode = ONCE
			End
    End
 
    ; --- stunned anims
    AnimationState = STUNNED_FLAILING
 			Animation = Flying_1
				AnimationName = IUPikeman_SKL.IUPikeman_FLYA
	      AnimationMode = LOOP
			End
 			Animation = Flying_2
				AnimationName = IUPikeman_SKL.IUPikeman_FLYB
	      AnimationMode = LOOP
			End
 			Animation = Flying_3
				AnimationName = IUPikeman_SKL.IUPikeman_FLYC
	      AnimationMode = LOOP
			End
      Flags = RANDOMSTART
    End

    AnimationState = STUNNED
 			Animation = Splattered_On_Ground
				AnimationName = IUPikeman_SKL.IUPikeman_LNDA
	      AnimationMode = ONCE
			End
    End

    AnimationState = STUNNED_STANDING_UP
 			Animation = Standing_Back_Up
				AnimationName = IUPikeman_SKL.IUPikeman_GTPA
	      AnimationMode = ONCE
			End
    End
  End
End
  
  ; ***DESIGN parameters ***
  Side = Mordor
  EditorSorting = UNIT
  ThingClass = HORDE_UNIT
  CommandPoints = 3

  TransportSlotCount = 1
  WeaponSet
    Conditions = None 
    Weapon = PRIMARY    IsengardPikemanPike ;BALANCE Isengard Pikeman Weapon
  End
	
  ArmorSet
    Conditions      = None
    Armor           = AngmarPikemenArmor
    DamageFX        = NormalDamageFX
  End
  VisionRange = 80.0
  DisplayName = OrcPikeman
  CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
 
  CommandSet = MordorFighterCommandSet

  ; *** AUDIO Parameters ***;
	VoiceAttack					= OrcFighterVoiceAttackMS			;UrukVoiceAttack		;MordorOrcHordeVoiceAttack
	VoiceAttackCharge				= OrcFighterVoiceAttackCharge			;MordorOrcHordeVoiceAttackCharge
	VoiceAttackStructure				= OrcFighterVoiceAttackBuilding
	VoiceCreated					= EVA:OrcHordeCreated
	VoiceFullyCreated 				= OrcFighterVoiceSelectMS
	VoiceCreated					= EVA:OrcHordeCreated
	VoiceFullyCreated 				= OrcFighterVoiceSelectMS
	VoiceGuard					= OrcFighterVoiceMoveMS
	VoiceMove					= OrcFighterVoiceMoveMS				;UrukVoiceMove			;MordorOrcHordeVoiceMove
	VoiceMoveToCamp					= OrcFighterVoiceMoveCamp
	VoicePriority					= 15
	VoiceRetreatToCastle				= OrcFighterVoiceRetreat
	VoiceSelect					= OrcFighterVoiceSelectMS			;UrukVoiceSelect		;MordorOrcHordeVoiceSelect
	VoiceSelectBattle				= OrcFighterVoiceSelectBattle

	VoiceEnterStateAttack				= OrcFighterVoiceEnterStateAttack		;UrukVoiceAttack		;MordorOrcHordeVoiceAttack
 	VoiceEnterStateAttackCharge			= OrcFighterVoiceEnterStateAttackCharge		;MordorOrcHordeVoiceAttackCharge
	VoiceEnterStateAttackStructure			= OrcFighterVoiceEnterStateAttackBuilding
	VoiceEnterStateMove				= OrcFighterVoiceEnterStateMove			;UrukVoiceMove			;MordorOrcHordeVoiceMove
	VoiceEnterStateMoveToCamp			= OrcFighterVoiceEnterStateMoveCamp
	VoiceEnterStateRetreatToCastle			= OrcFighterVoiceEnterStateRetreat
	
	SoundImpact					= ImpactHorse					;UrukDie

	UnitSpecificSounds
		VoiceGarrison				= OrcFighterVoiceGarrison
		VoiceEnterUnitMordorMumakil		= OrcFighterVoiceEnterMumakil
		VoiceEnterUnitSlaughterHouse		= OrcFighterVoiceGarrisonSlaughterHouse
		VoiceEnterUnitEvilMenTransportShip	= OrcFighterVoiceMoveMS
		VoiceInitiateCaptureBuilding		= OrcHordeVoiceCaptureBuilding
	End

	CrowdResponseKey = Orc

  ; *** ENGINEERING Parameters ***
  RadarPriority = UNIT
 ; KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER CAN_USE_SIEGE_TOWER SCORE THROWN_OBJECT
 AddModule
  Body = ActiveBody ModuleTag_02
    MaxHealth         = 150                  ;BALANCE Isengard Pikeman Health
    MaxHealthDamaged  = 75
    RecoveryTime      = 5000
  End
 End

  LocomotorSet
    Locomotor     = HumanLocomotor
    Condition     = SET_NORMAL
    Speed         = 36
  End

  LocomotorSet
    Locomotor     = HumanWanderLocomotor
    Condition     = SET_WANDER
    Speed         = 16
  End

 ReplaceModule ModuleTag_05
  Behavior = SlowDeathBehavior ModuleTag_055
    DeathTypes = ALL -KNOCKBACK
    SinkDelay = 3000
    SinkRate = 0.40     ; in Dist/Sec
    DestructionDelay = 8000
    Sound = INITIAL UrukDie
  End
End
 
ReplaceModule ModuleTag_07
  Behavior = SlowDeathBehavior ModuleTag_075
    ; Same as normal death, but no sound (sound already played by SoundImpact = ... )
    DeathTypes = NONE +KNOCKBACK
    SinkDelay = 3000
    SinkRate = 0.40     ; in Dist/Sec
    DestructionDelay = 8000
  End
End
 
AddModule
  Behavior = DualWeaponBehavior ModuleTag_09
    SwitchWeaponOnCloseRangeDistance = 40
  End
End

  Geometry = CYLINDER
  GeometryMajorRadius = 8.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 19.2
  GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 11;
  ShadowSizeY = 11;
  ShadowTexture = ShadowI;
End

Object DwarvenPhalanxHorde
	ButtonImage		= WOR_OrcWarrior
	SelectPortrait		= UPMordor_OrcHorde
  	CommandSet 		= MordorFighterHordeCommandSet
	Side			= Mordor
	DisplayName		= OrcsPikeman
	BuildCost			= 120
	BuildTime			= 20
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain6
		FrontAngle 			= 270
		FlankedDelay 			= 2000
		ObjectStatusOfContained		= 
		InitialPayload			= DwarvenPhalanx 15
		Slots				= 15
		PassengerFilter			= NONE +INFANTRY
		ShowPips			= No
		ThisFormationIsTheMainFormation = Yes			;// Used to determine which armorset to use (and anything else we want!)
		RandomOffset 			= X:0 Y:0
		
		MeleeBehavior 			= Amoeba
		End					

		; Banner Carrier info		
		BannerCarriersAllowed	= MordorBannerOrc ;// types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:DwarvenPhalanx	Pos:X:70.0 Y:0.0		;// (DEFAULT) position of banner carrier
		
;		RankInfo = RankNumber:1 UnitType:DwarvenPhalanx Position:X:50 Y:10		Position:X:50 Y:-10		Position:X:50 Y:-30		Position:X:50 Y:30		
;		RankInfo = RankNumber:2 UnitType:DwarvenPhalanx Position:X:30 Y:10 Leader 1 0	Position:X:30 Y:-10 Leader 1 1	Position:X:30 Y:-30 Leader 1 2	Position:X:30 Y:30 Leader 1 3	
;		RankInfo = RankNumber:3 UnitType:DwarvenPhalanx Position:X:10 Y:10 Leader 2 0	Position:X:10 Y:-10 Leader 2 1	Position:X:10 Y:-30 Leader 2 2	Position:X:10 Y:30 Leader 2 3
		
		RankInfo = RankNumber:1 UnitType:DwarvenPhalanx Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:DwarvenPhalanx Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:DwarvenPhalanx Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		
		;// Positions for 5
		
		RanksToReleaseWhenAttacking		= 1 
		
		MeleeAttackLeashDistance		= 25		;// How far the hordes can move from the center of the horde when melee attacking.				
		BackUpMinDelayTime			= 1		;// The minimum amount of time to delay before backing up
		BackUpMaxDelayTime			= 3000		;// The maximum amount of time to delay before backing up
		BackUpMinDistance			= 1		;// The minimum number of cells to backup
		BackUpMaxDistance			= 3		;// The maximum number of cells to backup
		BackupPercentage			= 80%		;// The amount of chance that a unit will back up.

		AlternateFormation			= DwarvenPhalanxHordePorcupine
	End
End
AddModule
	Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty 
		;In order to sacrifice or be sacrificed, you must have a BloodthirstyUpdate
		SacrificeFilter			= ALL		; Hordes with BloodthirstyUpdates I can sacrifice (hint: use template names)
		ExperienceModifier		= 1.95		; Balance this so that a level 1 orc horde eating a level 1 orc horde gets enough exp to get to level 2
		InitiateVoice			= EVA:BloodthirstySacrificOfOrcs
	End
End
ReplaceModule ModuleTag_BasicTraining
	Behavior = LevelUpUpgrade ModuleTag_BasicTraining6
		TriggeredBy = Upgrade_MordorBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
End
CommandPoints = 45
End

CommandSet NewMordorSiegeWorksCommandSetLevel1
  	1	= Command_ConstructMordorBatteringRam
  	2	= Command_ConstructMordorCatapult
  	;3	= Command_ConstructMordorSiegeTower
	3	= Command_PurchaseTechnologyMordorForgedBlades	; BFME EXPANSION PACT Faction Enhancement
	4	= Command_PurchaseTechnologyMordorHeavyArmor	; BFME EXPANSION PACT Faction Enhancement
	5	= Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
  	7	= Command_UpgradeMordorSiegeWorksLevel2
        8       = Command_SarumanFireball
	9	= Command_ConstructMordorBlackRiderHorde
End

CommandSet NewMordorSiegeWorksCommandSetLevel2
  	1	= Command_ConstructMordorBatteringRam
  	2	= Command_ConstructMordorCatapult
  	;3	= Command_ConstructMordorSiegeTower
	3	= Command_PurchaseTechnologyMordorForgedBlades	; BFME EXPANSION PACT Faction Enhancement
	4	= Command_PurchaseTechnologyMordorHeavyArmor	; BFME EXPANSION PACT Faction Enhancement
	5	= Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
  	;7	= Command_UpgradeMordorSiegeWorksLevel2
        8       = Command_SarumanFireball
	9	= Command_ConstructMordorBlackRiderHorde
End

CommandSet NewMordorSiegeWorksCommandSetLevel3-
  	1 	= Command_ConstructMordorBatteringRam
  	2	= Command_ConstructMordorCatapult
  	;3	= Command_ConstructMordorSiegeTower
	3	= Command_PurchaseTechnologyMordorForgedBlades	; BFME EXPANSION PACT Faction Enhancement
	4	= Command_PurchaseTechnologyMordorHeavyArmor	; BFME EXPANSION PACT Faction Enhancement
	5	= Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
  	7	= Command_UpgradeMordorSiegeWorksLevel3
        8       = Command_SarumanFireball
	9	= Command_ConstructMordorBlackRiderHorde
End

CommandSet NewMordorSiegeWorksCommandSetLevel3
  	1 	= Command_ConstructMordorBatteringRam
  	2	= Command_ConstructMordorCatapult
  	;3	= Command_ConstructMordorSiegeTower
	3	= Command_PurchaseTechnologyMordorForgedBlades	; BFME EXPANSION PACT Faction Enhancement
	4	= Command_PurchaseTechnologyMordorHeavyArmor	; BFME EXPANSION PACT Faction Enhancement
	5	= Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
  	;7	= Command_UpgradeMordorSiegeWorksLevel3
        8       = Command_SarumanFireball
	9	= Command_ConstructMordorBlackRiderHorde
End



Object MordorSiegeWorks
AddModule
Behavior = DamageFieldUpdate ModuleTag_RazorSpinesWeapon
		Radius			= 100
		ObjectFilter	= ALL ENEMIES
		RequiredUpgrade	= Upgrade_DwarvenMithrilMail
		
		FireWeaponNugget
			WeaponName		= FireDrakeWarhead
			FireDelay		= 0
			OneShot			= No
		End
	End
End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= MBSeigeWork1.tga 0 mubalrogwingsash.tga;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= FireDefencebonus
	End
      End
CommandSet = NewMordorSiegeWorksCommandSetLevel1
ReplaceModule ModuleTag_MordorSiegeWorksLevel2
	Behavior = CommandSetUpgrade ModuleTag_MordorSiegeWorksLevel2tpjihg
		TriggeredBy		= Upgrade_MordorSiegeWorksLevel2
		;ConflictsWith	= Upgrade_MordorSiegeWorksLevel3
		CommandSet		= NewMordorSiegeWorksCommandSetLevel2
	End
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp56yy
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewMordorSiegeWorksCommandSetLevel3-
	End 
End
ReplaceModule ModuleTag_MordorSiegeWorksLevel3
	Behavior = CommandSetUpgrade ModuleTag_MordorSiegeWorksLevel36
		TriggeredBy		= Upgrade_MordorSiegeWorksLevel3
		CommandSet		= NewMordorSiegeWorksCommandSetLevel3
	End
End
  
End

ChildObject AngmarDarkDunedain BarrowWight
AddModule
 	Behavior = FireWeaponWhenDeadBehavior FireDeadTag2
		DeathTypes		= ALL
		StartsActive	= Yes
		DeathWeapon		= NecroWellOfSoulsAttack
		;DelayTime		= 1					; Required so this happens even when constructing.
	End
End
End
CommandButton Command_SpellBookSummonWights
Command			= SPECIAL_POWER
	SpecialPower		= SpecialAbilityFakeLeadership2
	Options			= NONPRESSABLE
	ButtonImage		= HSDrogothIncinerate
	ButtonBorderType	= ACTION
	TextLabel		= wightpassiv
	DescriptLabel		= wightpassivDesc
	InPalantir		= Yes
	DoubleClick		= Yes
	;UnitSpecificSound	= 
End
CommandSet GhostCommandset
	1 	= Command_ToggleStance	
	2	= Command_SpellBookSummonWights
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End



Object AngmarDarkDunedainHorde
	Side = Mordor
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:BarrowWight
	DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarDarkDunedainHorde
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarDarkDunedainHorde
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End
	LocomotorSet
		Locomotor = BarrowWightLocomotor
		Condition = SET_NORMAL
		Speed     = 80
	End

	BuildCost 		= 800
	BuildTime 		= 35
	ShroudClearingRange 	= ANGMAR_DARKDUNEDAIN_HORDE_SHROUD_RANGE       
	VisionRange 		= ANGMAR_DARKDUNEDAIN_HORDE_VISION_RANGE
	VisionSide 		= 50%
	VisionRear 		= 25%
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%
	CommandPoints 		= 80	; originally 60
	
	FormationWidth = 2 // Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 // Depth it occupies in formations. Current choices are 1 or 2.
	
 	CrushableLevel = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 0
	
	CrushOnlyWhileCharging = YES ; // the guardian is only supposed to crush during his special charge ability
	
	MinCrushVelocityPercent = 50% ; Has to be moving at least xx% of full speed
	CrushDecelerationPercent = 90% ; Lose xx% max velocity when crushing -- thus they only crush 1 row of infantry
	
	CrushKnockback = 40  ; how hard we knock back crushed units.
	CrushZFactor = 1.0  ; How much we knock upwards.
	 
    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND //UNATTACKABLE 

	ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT
	ThreatBreakdown GondorFighterHorde_DetailedThreat
		AIKindOf = INFANTRY
	End
	CommandSet = GhostCommandset
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain5
		FrontAngle 			= 270
		FlankedDelay 			= 2000
		ObjectStatusOfContained 	= 
		InitialPayload 			= AngmarDarkDunedain 10
		Slots 				= 10			; originally 15
		PassengerFilter			= NONE +INFANTRY
		ShowPips 			= No
		ThisFormationIsTheMainFormation = Yes	//Used to determine which armorset to use (and anything else we want!)
		RandomOffset			= X:0 Y:0
		MeleeBehavior 			= Amoeba
		End

		// Banner Carrier info		
		;BannerCarriersAllowed		= AngmarInfantryBanner						// types of units that are allowed as banner carriers
		;BannerCarrierPosition		= UnitType:AngmarDarkDunedain   Pos:X:70.0 Y:0.0		// (DEFAULT) position of banner carrier
		
		RankInfo = RankNumber:1 UnitType:AngmarDarkDunedain Position:X:50 Y:0			Position:X:50 Y:20				Position:X:50 Y:-20				Position:X:50 Y:40				Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:AngmarDarkDunedain Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		//RankInfo = RankNumber:3 UnitType:AngmarDarkDunedain Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		
		RanksToReleaseWhenAttacking 	= 1 2

		;AlternateFormation 		= GondorFighterHordeBlock
		MeleeAttackLeashDistance 	= 1   		//How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		= 1		//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		= 3000		//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		= 1		//The minimum number of	cells to backup
		BackUpMaxDistance		= 3		//The maximum number of	cells to backup
		BackupPercentage		= 80%		//The amount of	chance that	a unit will	back up.
	End
End
End

CommandButton Command_SpellBookScavenger
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE ;NEED_UPGRADE 
	Upgrade				= Upgrade_TechnologyIsengardForgedBlades 
	; ;NeededUpgrade		= Upgrade_GondorForgeLevel2
	TextLabel			= prendisorse
	ButtonImage			= BRArmory_ForgedBlades
	ButtonBorderType	= UPGRADE
	DescriptLabel		= prendisorseDesc
	Radial				= Yes
	InPalantir			= Yes
	; ;LacksPrerequisiteLabel		= TOOLTIP:LackLevel2BlackSmithForgedBlades
End

CommandSet NewMordorMumakilPenCommandSetLevel1
  	1	= Command_ConstructMordorMumakil
  	2 	= Command_UpgradeMordorMumakilPenLevel2
        3       = Command_SpellBookScavenger
        4       = Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
End

CommandSet NewMordorMumakilPenCommandSetLevel2
  	1	= Command_ConstructMordorMumakil
  	2 	= Command_UpgradeMordorMumakilPenLevel3
        3       = Command_SpellBookScavenger
        4       = Command_CreateAHero_Fireball_Level1
  	6	= Command_Sell
End

CommandSet NewMordorMumakilPenCommandSetLevel3
  	1	= Command_ConstructMordorMumakil
  	6	= Command_Sell
        3       = Command_SpellBookScavenger
        4       = Command_CreateAHero_Fireball_Level1
End

Object MordorMumakilPen
AddModule
Behavior = DamageFieldUpdate ModuleTag_RazorSpinesWeapon
		Radius			= 100
		ObjectFilter	= ALL ENEMIES
		RequiredUpgrade	= Upgrade_DwarvenMithrilMail
		
		FireWeaponNugget
			WeaponName		= FireDrakeWarhead
			FireDelay		= 0
			OneShot			= No
		End
	End
End
AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower666
		TriggeredBy		= Upgrade_DwarvenMithrilMail
		UpgradeTexture	= MBMumkPen.tga 0 mubalrogwingsash.tga;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End
      AddModule
      	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality37
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced5t
		TriggeredBy				= Upgrade_DwarvenMithrilMail
		AttributeModifier		= FireDefencebonus
	End
      End
CommandSet = NewMordorMumakilPenCommandSetLevel1
ReplaceModule ModuleTag_MordorMumakilPenLevel2
	Behavior = CommandSetUpgrade ModuleTag_MordorMumakilPenLevel26
		TriggeredBy		= Upgrade_MordorMumakilPenLevel2
		ConflictsWith	= Upgrade_MordorMumakilPenLevel3
		CommandSet		= NewMordorMumakilPenCommandSetLevel2
	End
End
ReplaceModule ModuleTag_MordorMumakilPenLevel3
	Behavior = CommandSetUpgrade ModuleTag_MordorMumakilPenLevel36
		TriggeredBy		= Upgrade_MordorMumakilPenLevel3
		CommandSet		= NewMordorMumakilPenCommandSetLevel3
	End
End
End

CommandSet NewMordorAttackTrollCommandSet
	1	= Command_ToggleStance
        3       = Command_CreateAHero_HowlOfRage_Level1
	13 	= Command_AttackMove
	14 	= Command_Stop
End


Object MordorAttackTroll

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf7777
		TriggeredBy				= Upgrade_MordorFaction
		AttributeModifier		= AttackTroll
	End
      End


CommandSet = NewMordorAttackTrollCommandSet
RemoveModule ModuleTag_01
AddModule
  Draw = W3DScriptedModelDraw ModuleTag_0156
    ExtraPublicBone = Trunk
    ShowShadowWhileContained = Yes
;	BurntTexture = twwater01.tga

    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

    DefaultModelConditionState
		Model = CinAtkTroll_SKN
		WeaponLaunchBone = PRIMARY Firepoint
	End

	ModelConditionState = BURNT_MODEL
		Model = CinAtkTroll_SKN	
	End

                ModelConditionState = UPGRADE_NUMENOR_STONEWORK
			 Model               = MUAtkTroll_SKN;CineMAArms_SKN
			 ;Skeleton            = GUMAArms_SKL
                ;Texture           = GUManAtArms.tga 0 GUPorterUpgrades.tga
		End
	IdleAnimationState
		StateName = Idle
		Animation = IDLA
			AnimationName = MUMntTroll_SKL.MUMntTroll_IDLA  ;JUST BREATHING
			AnimationMode = ONCE
			AnimationBlendTime = 10
			AnimationPriority = 10
		End
		Animation = IDLC
			AnimationName = MUMntTroll_SKL.MUMntTroll_IDLC  ;BELLY SCRATCH
			AnimationMode = ONCE
			AnimationBlendTime = 10
		End
		Animation = IDLE
			AnimationName = MUMntTroll_SKL.MUMntTroll_IDLE  ;ROAR THEN HIT GROUND
			AnimationMode = ONCE
			AnimationBlendTime = 10
		End
		Animation = IDLF
			AnimationName = MUMntTroll_SKL.MUMntTroll_IDLF  ;BIG ROAR
			AnimationMode = ONCE
			AnimationBlendTime = 10
		End
		Animation = IDLG
			AnimationName = MUMntTroll_SKL.MUMntTroll_IDLG  ;BUTT SCRATCH THEN BURP
			AnimationMode = ONCE
			AnimationBlendTime = 10
		End
		Animation = IDLH
			AnimationName = MUMntTroll_SKL.MUMntTroll_IDLH  ;SHORT ROAR
			AnimationMode = ONCE
			AnimationBlendTime = 10
		End
		Animation = IDLI
			AnimationName = MUMntTroll_SKL.MUMntTroll_IDLI  ;NOSE WIPE
			AnimationMode = ONCE
			AnimationBlendTime = 10
		End
		
		BeginScript
			CurDrawableHideSubObject("Trunk01")
			Prev = CurDrawablePrevAnimationState()
			if Prev == "Throw"	then CurDrawableSetTransitionAnimState("Trans_Throwing_To_Ready") return end	
		EndScript
	End


; Flailing must go before dying in case we are dead in the air
	AnimationState = STUNNED_FLAILING
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_FLYA
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
	End

	AnimationState				= STUNNED_STANDING_UP
		Animation				= MUMntTroll_GTPA
			AnimationName		= MUMntTroll_SKL.MUMntTroll_GTPA
			AnimationMode		= ONCE
		End

	End	
	AnimationState				= STUNNED
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_LNDA
			AnimationMode = ONCE
		End
			ParticleSysBone = B_PELVIS TrollSplatDust2
			ParticleSysBone = BAT_HEAD TrollSplatDust2
	End

//------------------------------------------------------------------------

    ; --------- With Club ------------
		AnimationState = FIRING_OR_PREATTACK_A
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKC
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKD
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
		End

		;Running attack
		AnimationState = MOVING FIRING_OR_PREATTACK_B
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATRA
				AnimationMode = LOOP
				UseWeaponTiming		= Yes
			End
		End
			
		AnimationState = PREPARING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_GRBC
				AnimationMode = ONCE
			End
		End

		IdleAnimationState
			Animation = BreathWithClub
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode = ONCE
				AnimationPriority = 30
				AnimationSpeedFactorRange = 0.8 1.0
			End
			Animation = BreathWithClub
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode = ONCE
				AnimationPriority = 30
				AnimationSpeedFactorRange = 0.8 1.0
			End
			Animation = IDLE
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLE  ;ROAR THEN HIT GROUND (holding club only)
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 5
			End
			Animation = IDLG
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLG  ;BUTT SCRATCH THEN BURP
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 10
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE
			BeginScript ; Here since normal Packing state can be skipped with a fast click.
				CurDrawableShowSubObjectPermanently("Trunk01")
			EndScript
		End


		; --------- With Bare Hands ------------
		AnimationState = UNPACKING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLH
				AnimationMode = ONCE
			End
		End

		AnimationState = TURN_LEFT
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNL
				AnimationMode = LOOP
				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails
		End

		AnimationState = TURN_RIGHT
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNR
				AnimationMode = LOOP
				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails
		End

//-----------------------------------

		AnimationState = MOVING WEAPONSTATE_ONE ATTACKING
			Animation
	      AnimationName = MUMntTroll_SKL.MUMntTroll_RUNA  ; Running with club
		    AnimationMode = LOOP
	      AnimationSpeedFactorRange = 0.77 0.77
			End
      Flags               = RANDOMSTART
      ParticleSysBone     = None InfantryDustTrails
    End

		AnimationState = MOVING WEAPONSTATE_ONE DAMAGED
			Animation
	      AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB ; Walking with club
		    AnimationMode = LOOP
	      AnimationSpeedFactorRange = 1.3 1.3
			End
      Flags               = RANDOMSTART
      ParticleSysBone     = None InfantryDustTrails
    End

		AnimationState = MOVING WEAPONSTATE_ONE
			Animation
	      AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB ; Walking with club 
		    AnimationMode = LOOP
	      AnimationSpeedFactorRange = 1.36 1.36
			End
      Flags               = RANDOMSTART
      ParticleSysBone     = None InfantryDustTrails
    End

	AnimationState = FIRING_OR_PREATTACK_A WEAPONSTATE_ONE
		Animation
			; Taking this one out since it doesn't work with the logic of the attack, which is a 180 knockback (this one is vertical clubbing, could be used as anti-monster anim, not anti bunch of inf)
			AnimationName = MUMntTroll_SKL.MUMntTroll_ATKB
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_ATKC
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_ATKD
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
	End

    AnimationState = PREPARING WEAPONSTATE_ONE
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_GRBC
				AnimationMode = ONCE
			End
		End

    AnimationState = PACKING WEAPONSTATE_ONE
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_GRBD
				AnimationMode = ONCE
			End
      BeginScript
				CurDrawableShowSubObject("Trunk01")
      EndScript
		End

		AnimationState = WEAPONSTATE_ONE
			Animation = IDLA
	      AnimationName = MUMntTroll_SKL.MUMntTroll_IDLB
	      AnimationMode = LOOP
				AnimationPriority = 15
		AnimationSpeedFactorRange = 0.8 1.0
			End
	Flags = RANDOMSTART
      BeginScript
				CurDrawableShowSubObject("Trunk01")
      EndScript
		End

; --------- With Rock or Infantry ------------

	AnimationState = MOVING WEAPONSTATE_TWO ATTACKING
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_RUNA 
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 0.77 0.77
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
	End

	AnimationState = MOVING WEAPONSTATE_TWO DAMAGED
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB 
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 1.3 1.3
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
	End

	AnimationState = MOVING WEAPONSTATE_TWO
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB 
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 1.36 1.36
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
	End

	AnimationState = FIRING_OR_PREATTACK_A WEAPONSTATE_TWO
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_THRW
			AnimationMode = ONCE
			UseWeaponTiming = Yes
		End
		FrameForPristineBonePositions = 21
		StateName = Throw
	End
	
	AnimationState = FIRING_OR_PREATTACK_B WEAPONSTATE_TWO
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_THRW
			AnimationMode = ONCE
			UseWeaponTiming = Yes
		End
		FrameForPristineBonePositions = 21
		StateName = Throw
	End

	AnimationState = PACKING WEAPONSTATE_TWO
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_GRBB
			AnimationMode = ONCE
		End
	End

	;Building attack, which you can do with a rock in yo hand
	AnimationState = FIRING_OR_PREATTACK_C WEAPONSTATE_TWO
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_ATKF
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
	End

	AnimationState = WEAPONSTATE_TWO
		Animation = IDLB
			AnimationName = MUMntTroll_SKL.MUMntTroll_IDLB
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 0.8 1.0
		End
			Flags = RANDOMSTART
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	
; ------ SWINGING THE GROND BATTERING RAM -----
   ModelConditionState = PASSENGER
		Model =  MUGrndTrl_SKN
	End

	AnimationState = PREATTACK_A PASSENGER PASSENGER_VARIATION_1 ; swinging grond
			Animation = grasping_grond_lefthanded
			AnimationName =  MUGrndTrl_SKL.MUGrndTrl_GAA1
			AnimationMode = ONCE
			AnimationBlendTime = 15				
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End
	AnimationState = PREATTACK_A PASSENGER PASSENGER_VARIATION_2 ; swinging grond
			Animation = grasping_grond_righthanded
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GAB1
			AnimationMode = ONCE
			AnimationBlendTime = 15
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = FIRING_A PASSENGER_VARIATION_1 ; swinging grond
		Animation = swinging_grond_lefthanded
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GAA2
			AnimationMode = ONCE
			AnimationBlendTime = 5	
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End
	AnimationState = FIRING_A PASSENGER_VARIATION_2 ; swinging grond
		Animation = swinging_grond_righthanded
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GAB2
			AnimationMode = ONCE
			AnimationBlendTime = 5			
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = BETWEEN_FIRING_SHOTS_A PASSENGER PASSENGER_VARIATION_1 ; swinging grond
		Animation = swinging_grond_lefthanded
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GAA4
			AnimationMode = ONCE
			AnimationBlendTime = 15	
		End

		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End
	AnimationState = BETWEEN_FIRING_SHOTS_A PASSENGER PASSENGER_VARIATION_2 ; swinging grond
		Animation = swinging_grond_righthanded
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GAB4
			AnimationMode = ONCE
			AnimationBlendTime = 15	
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End


	AnimationState = UNPACKING PASSENGER PASSENGER_VARIATION_1 ; swinging grond
			Animation = packing_grond_lefthanded
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GAA4
			AnimationMode = ONCE
			AnimationBlendTime = 15				
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End
	AnimationState = UNPACKING PASSENGER PASSENGER_VARIATION_2 ; swinging grond
			Animation = packing_grond_righthanded
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GAB4
			AnimationMode = ONCE
			AnimationBlendTime = 15			
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript		
	End

; --------- With Bare Hands ------------
	AnimationState = PASSENGER MOVING BACKING_UP; pulling the seige tower or grond
			Animation = Passenger_moving
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GBKA
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 2.0 2.0
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript		
		Flags = RANDOMSTART
	End

	AnimationState = PASSENGER MOVING ; pushing the seige tower
			Animation = Passenger_moving
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GWKA
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 2.5 2.5
		End
		Flags = RANDOMSTART
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = PASSENGER ; idling by the grond
		Animation = Passenger
			AnimationName = MUGrndTrl_SKL.MUGrndTrl_GIDA
			AnimationMode = LOOP
			AnimationBlendTime = 15
		End
		Flags = RANDOMSTART
		BeginScript
				CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = UNPACKING
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_GRBA
			AnimationMode = ONCE
		End
	End

	AnimationState = MOVING TURN_LEFT
		Animation = Moving
			AnimationName = MUMntTroll_SKL.MUMntTroll_TRNL
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = MOVING TURN_RIGHT
		Animation = Moving
			AnimationName = MUMntTroll_SKL.MUMntTroll_TRNR
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = MOVING ATTACKING
		Animation = Charging
			AnimationName = MUMntTroll_SKL.MUMntTroll_RUNB
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 0.8 0.8
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = MOVING DAMAGED
		Animation = Moving_Damaged
			AnimationName = MUMntTroll_SKL.MUMntTroll_WLKA
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	; Normal fist attacks
	AnimationState = FIRING_OR_PREATTACK_B
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_ATKA
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_ATKE
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_ATKG
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	;Building attack
	AnimationState = FIRING_OR_PREATTACK_C
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_ATKF
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
	End
	

	AnimationState = DYING SPLATTED
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_LNDA
			AnimationMode = ONCE
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript	
	End


	AnimationState = DYING DEATH_1
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_DIEA
			AnimationMode = ONCE
		End

		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
			ParticleSysBone = B_PELVIS TrollSplatDust
			ParticleSysBone = BAT_HEAD TrollSplatDust
	End

	AnimationState = DYING DEATH_2
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_DIEB
			AnimationMode = ONCE
		End

		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
			ParticleSysBone = BAT_SPINE1 TrollSplatDust1
			ParticleSysBone = BAT_HEAD TrollSplatDust1
	End

	AnimationState = DYING AFLAME
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_MFDA
			AnimationMode = ONCE
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = DYING
		Animation
			AnimationName     =  MUMntTroll_SKL.MUMntTroll_DIEB
			AnimationMode     = ONCE
		End
 		BeginScript
 			CurDrawableHideSubObject("Trunk01")
 		EndScript		
	End
	
	AnimationState				= MOVING PANICKING
		Animation				= RUNM
			AnimationName		=  MUMntTroll_SKL.MUMntTroll_MFDA
			AnimationMode		= LOOP
		End
		Flags					= RANDOMSTART
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = MOVING
		Animation = Moving
			AnimationName = MUMntTroll_SKL.MUMntTroll_WLKA
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
		BeginScript
			CurDrawableHideSubObject("Trunk01")
		EndScript
	End

	AnimationState = ENGAGED
		Animation
			AnimationName = MUMntTroll_SKL.MUMntTroll_IDLA
			AnimationMode = LOOP
		End
		BeginScript
			CurDrawableHideSubObject("Trunk01")
			Prev = CurDrawablePrevAnimationState()
			if Prev == "Throw"	then CurDrawableSetTransitionAnimState("Trans_Throwing_To_Ready") return end	
		EndScript
	End
	
	
		AnimationState =DESTROYED_WEAPON
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKA
				AnimationMode = ONCE
			End

			BeginScript
				CurDrawableHideSubObject("Trunk01")
			EndScript
		End
	

; --------- Click and Hit Reactions ------------
		
    AnimationState = HIT_REACTION HIT_LEVEL_1
			Animation = Hit_Level_1_a
	      AnimationName = MUMntTroll_SKL.MUMntTroll_HITC
		    AnimationMode = ONCE
			End
    End

    AnimationState = HIT_REACTION HIT_LEVEL_2
			Animation = Hit_Level_2
	      AnimationName = MUMntTroll_SKL.MUMntTroll_HITB
		    AnimationMode = ONCE
			End
    End

    AnimationState = HIT_REACTION HIT_LEVEL_3
			Animation = Hit_Level_3
	      AnimationName = MUMntTroll_SKL.MUMntTroll_HITA
		    AnimationMode = ONCE
			End
    End

    AnimationState = REACT_1
			Animation = Click_React_1
	      AnimationName = MUMntTroll_SKL.MUMntTroll_RCTA
		    AnimationMode = ONCE
			End
    End

    AnimationState = REACT_2
			Animation = Click_React_2
	      AnimationName = MUMntTroll_SKL.MUMntTroll_RCTB
		    AnimationMode = ONCE
			End
    End

    AnimationState = REACT_3
			Animation = Click_React_3
	      AnimationName = MUMntTroll_SKL.MUMntTroll_RCTC
		    AnimationMode = ONCE
			End
    End

    AnimationState = REACT_4
			Animation = Click_React_4
	      AnimationName = MUMntTroll_SKL.MUMntTroll_RCTD
		    AnimationMode = ONCE
			End
    End

    AnimationState = REACT_5
			Animation = Click_React_5
	      AnimationName = MUMntTroll_SKL.MUMntTroll_RCTE
		    AnimationMode = ONCE
			End
    End
    
;-----------------------------------
;Emotion
   	AnimationState = EMOTION_MORALE_HIGH
		Animation
			AnimationName	=	MUMntTroll_SKL.MUMntTroll_IDLE
			AnimationMode	=	ONCE
		End
		Animation
			AnimationName	=	MUMntTroll_SKL.MUMntTroll_IDLF
			AnimationMode	=	ONCE
		End
		
		Animation
			AnimationName	=	MUMntTroll_SKL.MUMntTroll_IDLH
			AnimationMode	=	ONCE
		End
		Flags	=	RESTART_ANIM_WHEN_COMPLETE
	End

  End
End

AddModule
	Behavior = ModelConditionUpgrade ModuleTag_EliteSoldiers
		TriggeredBy		= Upgrade_TechnologyWildHeavyArmor
		AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK
		Permanent		= Yes
	End
End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf
		TriggeredBy				= Upgrade_TechnologyWildHeavyArmor
		AttributeModifier		= BeastPower
	End
      End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr67
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End

End

Object MordorMountainTroll

CommandSet = NewMordorMountainTrollCommandSet
RemoveModule ModuleTag_01
AddModule
	Draw = W3DScriptedModelDraw ModuleTag_015


		; Some conditions and their meaning:
		;
		;	WEAPONSTATE_ONE			using tree as club
		;	WEAPONSET_TOGGLE_1		rock throwing mode
		;	SPECIAL_WEAPON_ONE		hitting a friendly troll
		;	USER_2					set from MordorMtTrollBored weapon, used when hitting a friendly troll
		;	USER_3						"				"					"					"

		WadingParticleSys		= EntRipples
		OkToChangeModelColor	= Yes		  
		StaticModelLODMode		= Yes					; Will append M or L to the skin name depending on GameLOD
	    
	    ExtraPublicBone			= Trunk					; For the tree to attach to.


		DefaultModelConditionState
			Model				= MUMntTroll_SKN
			WeaponLaunchBone	= PRIMARY Firepoint
		End

;ModelConditionState	= UPGRADE_NUMENOR_STONEWORK
	;Model				 = CHSS_TL_U_SKN
	;Skeleton			 = CHSS_TL_U_SKL
	;ModelAnimationPrefix = CHSS_TL
	;PortraitImageName	 = CPTroll
	;ButtonImageName		 = HICAHTroll
	;WeaponLaunchBone	= PRIMARY Bat_HandL
;End
		IdleAnimationState
			StateName				= Idle
			AllowRepeatInRandomPick = Yes
			SimilarRestart			= Yes
			
			Animation = IDLA
				AnimationName		= MUMntTroll_SKL.MUMntTroll_IDLA  ;JUST BREATHING
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationPriority	= 40
			End
			Animation = IDLC
				AnimationName		= MUMntTroll_SKL.MUMntTroll_IDLC  ;BELLY SCRATCH
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationPriority	= 10
			End
			Animation = IDLF
				AnimationName		= MUMntTroll_SKL.MUMntTroll_IDLF  ;BIG ROAR
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationPriority	= 3
			End
			Animation = IDLH
				AnimationName		= MUMntTroll_SKL.MUMntTroll_IDLH  ;SHORT ROAR
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationPriority	= 10
			End
			Animation = IDLI
				AnimationName		= MUMntTroll_SKL.MUMntTroll_IDLI  ;NOSE WIPE
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationPriority	= 10
			End
			Flags					= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		; Splatted death goes first, independant of death flags
		ModelConditionState = DYING DECAY SPLATTED
			Model				= MUMntTroll_DISC
			RetainSubObjects	= Yes
		End;

		AnimationState = DYING DECAY SPLATTED 
			Animation = dead1
				AnimationName	= MUMntTroll_DISC.MUMntTroll_DISC
				AnimationMode	= ONCE
			End
		End

		ModelConditionState = DYING DECAY DEATH_1
			Model				= MUMntTroll_DISA
			RetainSubObjects	= Yes
		End

		AnimationState = DYING DECAY DEATH_1 
			Animation = dead1
				AnimationName	= MUMntTroll_DISA.MUMntTroll_DISA
				AnimationMode	= ONCE
			End
		End

		ModelConditionState = DYING DECAY DEATH_2
			Model				= MUMntTroll_DISB
			RetainSubObjects	= Yes
		End

		AnimationState = DYING DECAY DEATH_2 
			Animation = dead1
				AnimationName	= MUMntTroll_DISB.MUMntTroll_DISB
				AnimationMode	= ONCE
			End
		End

		AnimationState			= CHANT_FOR_GROND	; used for cine shot in-game.
			Animation			= playingDrums
				AnimationName	= MUMntTroll_SKL.MUMntTroll_DRMA
				AnimationMode	= ONCE
			End
		End

; Flailing must go before dying in case we are dead in the air
		AnimationState = STUNNED_FLAILING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_FLYA
				AnimationMode = LOOP
			End
		End

		AnimationState = DYING DEATH_3
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLA
				AnimationMode = LOOP
			End
		End
		AnimationState = DYING SPLATTED
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_LNDA
				AnimationMode = ONCE
			End
		End


		AnimationState = DYING DEATH_1
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_DIEA
				AnimationMode = ONCE
			End

			ParticleSysBone = B_PELVIS TrollSplatDust
			ParticleSysBone = BAT_HEAD TrollSplatDust
		End

		AnimationState = DYING DEATH_2
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_DIEB
				AnimationMode = ONCE
			End

			ParticleSysBone = BAT_SPINE1 TrollSplatDust1
			ParticleSysBone = BAT_HEAD TrollSplatDust1
		End

		ModelConditionState = DYING
			Model				= MUMntTroll_SKN			
		End

		AnimationState = DYING
			Animation
				AnimationName     =  MUMntTroll_SKL.MUMntTroll_DIEB
				AnimationMode     = ONCE
			End
		End

		//Stoned!
		ModelConditionState = STONED 
			Model			= MUMntTroll_SKN
			Texture			= MUMntTroll.tga MUMntTroll_R.tga
		End 			

		AnimationState		= STONED
			Animation			= Stoned
				AnimationName		= MUMntTroll_SKL.MUMntTroll_MFDA
				AnimationMode		= MANUAL
				AnimationBlendTime	= 40
			End
			Flags	= RANDOMSTART 
		End
		
		AnimationState = EATING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_EATA
				AnimationMode = ONCE
			End
		End
	
; Flailing must go before dying in case we are dead in the air
		AnimationState = STUNNED_FLAILING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_FLYA
				AnimationMode = LOOP
			End
		End

		AnimationState				= STUNNED_STANDING_UP
			Animation				= MUMntTroll_GTPA
				AnimationName		= MUMntTroll_SKL.MUMntTroll_GTPA
				AnimationMode		= ONCE
			End
		End	

		AnimationState				= STUNNED
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_LNDA
				AnimationMode = ONCE
			End
			ParticleSysBone = B_PELVIS TrollSplatDust2
			ParticleSysBone = BAT_HEAD TrollSplatDust2
		End


		AnimationState						= PARALYZED 
			Animation
				AnimationName				= MUMntTroll_SKL.MUMntTroll_IDLA
				AnimationMode				= LOOP
			End
		End


		; --------- Just built ---------------------------------------------------------------------------------------------
	
		AnimationState = JUST_BUILT 
			Animation
				AnimationName				= MUMntTroll_SKL.MUMntTroll_WLKC ; temp
				AnimationMode				= ONCE
				AnimationBlendTime			= 0
				AnimationSpeedFactorRange	= 0.9 0.9			
			End
			LuaEvent = Frame:1 Data: show_rock
			FXEvent	= Frame:0 FireWhenSkipped Name:FX_TrollRightFootStep
			FXEvent	= Frame:16 FireWhenSkipped Name:FX_TrollLeftFootStep
			FXEvent	= Frame:30 FireWhenSkipped Name:FX_TrollRightFootStep
			FXEvent	= Frame:44 FireWhenSkipped Name:FX_TrollLeftFootStep
		End	

		;---bop our friends on the head 
		AnimationState = SPECIAL_WEAPON_ONE 
			Animation = Punch
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKH
				AnimationMode = ONCE
			End
			Animation = Backhand
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKI
				AnimationMode = ONCE
			End			
		End
			
		;---drop a tree
		AnimationState = SPECIAL_WEAPON_TWO 
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLE
				AnimationMode = ONCE
			End
		End
			
		;--Troll is angry
		AnimationState = WEAPONSET_RAMPAGE 
			Animation = GetMad
				AnimationName = MUMntTroll_SKL.MUMntTroll_RPGC
				AnimationMode = LOOP
			End
		End

    ; --------- With Club ------------

		AnimationState = FIRING_OR_PREATTACK_A WEAPONSTATE_ONE 
;			Animation
;				; Taking this one out since it doesn't work with the logic of the attack, which is a 180 knockback (this one is vertical clubbing, could be used as anti-monster anim, not anti bunch of inf)
;				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKB
;			End
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKC
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKD
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
		End

		;Running attack
		AnimationState = FIRING_OR_PREATTACK_B WEAPONSTATE_ONE 
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATRA
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
		End
			
		AnimationState = TURN_LEFT WEAPONSTATE_ONE 
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNL
				AnimationMode = LOOP
				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails
			BeginScript ; Here since normal Packing state can be skipped with a fast click.
				CurDrawableShowSubObjectPermanently("Trunk01")
			EndScript
		End

		AnimationState = TURN_RIGHT WEAPONSTATE_ONE 
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNR
				AnimationMode = LOOP
				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails
			BeginScript ; Here since normal Packing state can be skipped with a fast click.
				CurDrawableShowSubObjectPermanently("Trunk01")
			EndScript
		End

		AnimationState = MOVING WEAPONSTATE_ONE ; ATTACKING
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_RUNA  ; Running with club
				AnimationMode = LOOP
				;AnimationSpeedFactorRange = 0.77 0.77
			End
			Flags               = RANDOMSTART
			ParticleSysBone     = None InfantryDustTrails
			FXEvent	= Frame:5 FireWhenSkipped Name:FX_TrollRightFootStep
			FXEvent	= Frame:17 FireWhenSkipped Name:FX_TrollLeftFootStep
		End

		;AnimationState = MOVING WEAPONSTATE_ONE DAMAGED
		;	Animation
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB ; Walking with club
		;		AnimationMode = LOOP
		;		AnimationSpeedFactorRange = 1.3 1.3
		;	End
		;	Flags               = RANDOMSTART
		;	ParticleSysBone     = None InfantryDustTrails
		;	FXEvent	= Frame:22 FireWhenSkipped Name:FX_TrollLeftFootStep
		;	FXEvent	= Frame:45 FireWhenSkipped Name:FX_TrollRightFootStep
		;End

		;AnimationState = MOVING WEAPONSTATE_ONE
		;	Animation
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB ; Walking with club 
		;		AnimationMode = LOOP
		;		AnimationSpeedFactorRange = 1.36 1.36
		;	End
      	;	Flags               = RANDOMSTART
      	;	ParticleSysBone     = None InfantryDustTrails
		;	FXEvent	= Frame:22 FireWhenSkipped Name:FX_TrollLeftFootStep
		;	FXEvent	= Frame:45 FireWhenSkipped Name:FX_TrollRightFootStep	
		;
		;	BeginScript ; Here since normal Packing state can be skipped with a fast click.
		;		CurDrawableShowSubObjectPermanently("Trunk01")
		;	EndScript
		;End

		AnimationState = PREPARING ; Smash contained object on ground to remove leaves. note, WEAPONSTATE_ONE has 
			Animation												; not yet been set yet, so assume it's a tree.
				AnimationName = MUMntTroll_SKL.MUMntTroll_GRBC
				AnimationMode = ONCE
			End
		End

		AnimationState = PACKING WEAPONSTATE_ONE 
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_GRBD
				AnimationMode = ONCE
			End
			BeginScript
				CurDrawableShowSubObjectPermanently("Trunk01")
			EndScript
		End

		AnimationState = EMOTION_CELEBRATING WEAPONSTATE_ONE 
			Animation
				AnimationName	=	MUMntTroll_SKL.MUMntTroll_IDLF
				AnimationMode	=	LOOP
			End
		End

		AnimationState = USER_2 WEAPONSTATE_ONE 
			Animation = ReactToTrollPoke ; The two comes from the special TrollBored weapon
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITE
				AnimationMode = ONCE
			End
		End

		AnimationState = USER_3 WEAPONSTATE_ONE 
			Animation = ExpectAnotherPoke ; The three comes from the special TrollBored weapon, and lasts longer than 2
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLJ
				AnimationMode = LOOP
			End
		End

		AnimationState					= EMOTION_TAUNTING WEAPONSTATE_ONE 
			Animation
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode			= ONCE
				AnimationPriority		= 20
			End
			Animation					= Taunting3
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLH
				AnimationMode			= ONCE
				AnimationPriority		= 10
			End
			Animation					= Taunting4
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLE
				AnimationMode			= ONCE
				AnimationPriority		= 5
			End
		End
	
		AnimationState = WEAPONSTATE_ONE ;Idle with club
			AllowRepeatInRandomPick = Yes
			SimilarRestart			= Yes
		
			Animation = BreathWithClub
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode = ONCE
				AnimationPriority = 30
				AnimationSpeedFactorRange = 0.8 1.0
			End
			Animation = BreathWithClub
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode = ONCE
				AnimationPriority = 30
				AnimationSpeedFactorRange = 0.8 1.0
			End
			Animation = IDLE
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLE  ;ROAR THEN HIT GROUND (holding club only)
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 5
			End
			Animation = IDLG 
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLG  ;BUTT SCRATCH THEN BURP
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 10
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE
			BeginScript ; Here since normal Packing state can be skipped with a fast click.
				CurDrawableShowSubObjectPermanently("Trunk01")
			EndScript
		End

		; --------- With rock or infantry ----------------------------------------------------------------------------------

		;AnimationState = MOVING WEAPONSET_TOGGLE_1		; ATTACKING
		;	Animation
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_RUNA 
		;		AnimationMode = LOOP
		;		;AnimationSpeedFactorRange = 0.77 0.77
		;	End
		;	Flags = RANDOMSTART
		;	ParticleSysBone = None InfantryDustTrails
		;	FXEvent	= Frame:5 FireWhenSkipped Name:FX_TrollRightFootStep
		;	FXEvent	= Frame:17 FireWhenSkipped Name:FX_TrollLeftFootStep
		;End

		;AnimationState = MOVING WEAPONSET_TOGGLE_1 DAMAGED
		;	Animation
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB 
		;		AnimationMode = LOOP
		;		AnimationSpeedFactorRange = 1.3 1.3
		;	End
		;	Flags = RANDOMSTART
		;	ParticleSysBone = None InfantryDustTrails
		;	FXEvent	= Frame:22 FireWhenSkipped Name:FX_TrollLeftFootStep
		;	FXEvent	= Frame:45 FireWhenSkipped Name:FX_TrollRightFootStep
		;End

		;AnimationState = MOVING WEAPONSET_TOGGLE_1
		;	Animation
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_WLKB 
		;		AnimationMode = LOOP
		;		AnimationSpeedFactorRange = 1.36 1.36
		;	End
		;	Flags = RANDOMSTART
		;	ParticleSysBone = None InfantryDustTrails
		;	FXEvent	= Frame:22 FireWhenSkipped Name:FX_TrollLeftFootStep
		;	FXEvent	= Frame:45 FireWhenSkipped Name:FX_TrollRightFootStep
		;End

;		AnimationState = FIRING_OR_PREATTACK_A USING_WEAPON_A 
;			Animation
;				AnimationName		= MUMntTroll_SKL.MUMntTroll_THRW
;				AnimationMode		= ONCE
;				AnimationBlendTime	= 0
;				UseWeaponTiming		= Yes
;			End
;			FrameForPristineBonePositions = 16
;			StateName = Throw
;		End
	
		AnimationState = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1 ; Throw rock.
			StateName = Throw
			Animation
				AnimationName		= MUMntTroll_SKL.MUMntTroll_THRA
				AnimationMode		= ONCE
;				AnimationBlendTime	= 0
				UseWeaponTiming		= Yes
			End
			LuaEvent = Frame:23 Data: hide_rock
			FrameForPristineBonePositions = 23
		End
		
		AnimationState = RELOADING_A WEAPONSET_TOGGLE_1 ; Pickup rock.
			StateName = STATE_Reload
			Animation
				AnimationName		= MUMntTroll_SKL.MUMntTroll_GRBE ;MUMntTroll_SKL.MUMntTroll_GRBB
				AnimationMode		= ONCE
			End		
			LuaEvent = Frame:35 Data: show_rock
;			BeginScript
;				Prev = CurDrawablePrevAnimationState()
;				if Prev ~= "STATE_Reload" and Prev ~= "TRANS_SnatchRock"
;					then CurDrawableSetTransitionAnimState("TRANS_SnatchRock") end
;			EndScript
		End
		
;		TransitionState = TRANS_SnatchRock
;			Animation
;				AnimationName = MUMntTroll_SKL.MUMntTroll_GRBE
;				AnimationMode = ONCE
;			End
;		End
	
;		AnimationState = FIRING_OR_PREATTACK_B WEAPONSTATE_TWO
;			Animation
;				AnimationName		= MUMntTroll_SKL.MUMntTroll_THRW
;				AnimationMode		= ONCE
;				AnimationBlendTime	= 0
;				UseWeaponTiming		= Yes
;			End
;			FrameForPristineBonePositions = 21
;			StateName = Throw
;		End

;		AnimationState = PACKING WEAPONSTATE_TWO 
;			Animation
;				AnimationName = MUMntTroll_SKL.MUMntTroll_GRBB
;				AnimationMode = ONCE
;			End
;			ParticleSysBone	= BAT_HANDR TrollRockBounceSmall FollowBone:no
;			ParticleSysBone	= BAT_HANDR TrollRockPickup FollowBone:no
;		End

		;Building attack, which you can do with a rock in yo hand
		AnimationState = FIRING_OR_PREATTACK_C WEAPONSET_TOGGLE_1 
			Animation
				AnimationName	= MUMntTroll_SKL.MUMntTroll_ATKF
				AnimationMode	= ONCE
				UseWeaponTiming	= Yes
			End
		End

		AnimationState = TURN_LEFT WEAPONSET_TOGGLE_1 
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNL
				AnimationMode = LOOP
				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails
		End

		AnimationState = TURN_RIGHT WEAPONSET_TOGGLE_1 
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNR
				AnimationMode = LOOP
				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails
		End

		AnimationState = MOVING WEAPONSET_TOGGLE_1 
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_RUNA 
				AnimationMode = LOOP
				;AnimationSpeedFactorRange = 0.77 0.77
			End
			Flags = RANDOMSTART
			ParticleSysBone = None InfantryDustTrails
			FXEvent	= Frame:5 FireWhenSkipped Name:FX_TrollRightFootStep
			FXEvent	= Frame:17 FireWhenSkipped Name:FX_TrollLeftFootStep
		End
		
		; --------- Click and Hit Reactions with Rock ----------------------------------------------------------------------------------
		
		AnimationState = HIT_REACTION HIT_LEVEL_1 WEAPONSET_TOGGLE_1 
			Animation = Hit_Level_1_a
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITC
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION HIT_LEVEL_2 WEAPONSET_TOGGLE_1 
			Animation = Hit_Level_2
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITB
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION HIT_LEVEL_3 WEAPONSET_TOGGLE_1 
			Animation = Hit_Level_3
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITA
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_1 WEAPONSET_TOGGLE_1 
			Animation = Click_React_1
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTA
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_2 WEAPONSET_TOGGLE_1 
			Animation = Click_React_2
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTB
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_3 WEAPONSET_TOGGLE_1 
			Animation = Click_React_3
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTC
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_4 WEAPONSET_TOGGLE_1 
			Animation = Click_React_4
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTD
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_5 WEAPONSET_TOGGLE_1 
			Animation = Click_React_5
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTE
				AnimationMode = ONCE
			End
		End
	    
		AnimationState = USER_2 WEAPONSET_TOGGLE_1 
			Animation = ReactToTrollPoke ; The two comes from the special TrollBored weapon
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITE
				AnimationMode = ONCE
			End
		End

		AnimationState = USER_3 WEAPONSET_TOGGLE_1 
			Animation = ExpectAnotherPoke ; The three comes from the special TrollBored weapon, and lasts longer than 2
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLJ
				AnimationMode = LOOP
			End
		End

		AnimationState = SWAPPING_TO_WEAPONSET_1 WEAPONSET_TOGGLE_1 ; toggling to rock throwing. This get's the unit into a nice
			Animation														; pose to blend from, rather than playing an idle for one frame.
				AnimationName	= MUMntTroll_SKL.MUMntTroll_GRBE
				AnimationMode	= MANUAL
			End
		End
		
		AnimationState					= EMOTION_TAUNTING WEAPONSET_TOGGLE_1 
			Animation
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLB
				AnimationMode			= ONCE
				AnimationPriority		= 20
			End
			Animation					= Taunting3
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLH
				AnimationMode			= ONCE
				AnimationPriority		= 10
			End
		End
	
		AnimationState = WEAPONSET_TOGGLE_1 ; Rock throwing
			AllowRepeatInRandomPick = Yes
			SimilarRestart			= Yes
			Animation
				AnimationName				= MUMntTroll_SKL.MUMntTroll_IDLB			; sway
				AnimationMode				= ONCE
				AnimationPriority			= 10
				AnimationSpeedFactorRange	= 0.8 1.0
			End
;			Animation
;				AnimationName				= MUMntTroll_SKL.MUMntTroll_IDLE			; roar and pummel ground
;				AnimationMode				= ONCE
;				AnimationPriority			= 1
;				AnimationSpeedFactorRange	= 0.8 1.0
;			End
			Flags = RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End


		
		;// --------- With Bare Hands ------------

		AnimationState = UNPACKING ; Reach for a tree.
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_GRBA
				AnimationMode = ONCE
			End
		End

		AnimationState = TURN_LEFT 
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNL
				AnimationMode = LOOP
				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails
		End

		AnimationState = TURN_RIGHT 
			Animation = Moving
				AnimationName = MUMntTroll_SKL.MUMntTroll_TRNR
				AnimationMode = LOOP
				AnimationBlendTime = 10
			End
			ParticleSysBone = None InfantryDustTrails
		End

		;AnimationState = MOVING ATTACKING
		;	Animation = Charging
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_RUNB
		;		AnimationMode = LOOP
		;		AnimationSpeedFactorRange = 0.8 0.8
		;	End
		;	Flags = RANDOMSTART
		;	ParticleSysBone = None InfantryDustTrails
		;	FXEvent	= Frame:6 FireWhenSkipped Name:FX_TrollRightFootStep
		;	FXEvent	= Frame:17 FireWhenSkipped Name:FX_TrollLeftFootStep
		;End



		; Normal fist attacks
		AnimationState = FIRING_OR_PREATTACK_A 
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKA
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKE
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKG
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
		End

		;Building attack
		AnimationState = FIRING_OR_PREATTACK_B 
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKF
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
		End

		;Running attack
		AnimationState = FIRING_OR_PREATTACK_C 
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_ATRB
				AnimationMode = ONCE
				UseWeaponTiming		= Yes
			End
		End
			
		AnimationState				= MOVING PANICKING 
			Animation				= RUNM
				AnimationName		=  MUMntTroll_SKL.MUMntTroll_MFDA
				AnimationMode		= LOOP
			End
			Flags					= RANDOMSTART
		End
		
		;AnimationState = MOVING DAMAGED 
		;	Animation = Moving_Damaged
		;		AnimationName = MUMntTroll_SKL.MUMntTroll_WLKA 
		;		AnimationMode = LOOP
		;	End
		;	Flags = RANDOMSTART
		;	ParticleSysBone = None InfantryDustTrails
		;	FXEvent	= Frame:0 FireWhenSkipped Name:FX_TrollRightFootStep
		;	FXEvent	= Frame:16 FireWhenSkipped Name:FX_TrollLeftFootStep
		;End

		;AnimationState = MOVING UPGRADE_NUMENOR_STONEWORK
		;	Animation = Moving
		;		AnimationName		= MUMntTroll_SKL.MUMntTroll_WLKA 
		;		AnimationMode		= LOOP
		;		AnimationBlendTime	= 10
		;	End
		;	Flags = RANDOMSTART
		;	ParticleSysBone = None InfantryDustTrails
		;	FXEvent	= Frame:16 FireWhenSkipped Name:FX_TrollLeftFootStep
		;	FXEvent	= Frame:0 FireWhenSkipped Name:FX_TrollRightFootStep
		;End

		AnimationState = MOVING 
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_RUNB 
				AnimationMode = LOOP
				;AnimationSpeedFactorRange = 0.8 0.8
			End
			Flags = RANDOMSTART
			ParticleSysBone = None InfantryDustTrails
			FXEvent	= Frame:6 FireWhenSkipped Name:FX_TrollRightFootStep
			FXEvent	= Frame:17 FireWhenSkipped Name:FX_TrollLeftFootStep
		End

		AnimationState = ENGAGED 
			Animation
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLA 
				AnimationMode = LOOP
			End
			;BeginScript
			;	Prev = CurDrawablePrevAnimationState()
			;	if Prev == "Throw"	then CurDrawableSetTransitionAnimState("Trans_Throwing_To_Ready") return end	
			;EndScript
		End
	
;		AnimationState = DESTROYED_WEAPON ;this is no longer coded
;			Animation
;				AnimationName = MUMntTroll_SKL.MUMntTroll_ATKA 
;				AnimationMode = ONCE
;			End
;		End
		
		; --------- Click and Hit Reactions ----------------------------------------------------------------------------------
		
		AnimationState = HIT_REACTION HIT_LEVEL_1 
			Animation = Hit_Level_1_a
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITC 
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION HIT_LEVEL_2 
			Animation = Hit_Level_2
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITB 
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION HIT_LEVEL_3 
			Animation = Hit_Level_3
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITA 
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_1 
			Animation = Click_React_1
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTA 
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_2 
			Animation = Click_React_2
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTB 
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_3 
			Animation = Click_React_3
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTC 
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_4 
			Animation = Click_React_4
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTD 
				AnimationMode = ONCE
			End
		End

		AnimationState = REACT_5 
			Animation = Click_React_5
				AnimationName = MUMntTroll_SKL.MUMntTroll_RCTE 
				AnimationMode = ONCE
			End
		End
	    
		AnimationState = USER_2 
			Animation = ReactToTrollPoke ; The two comes from the special TrollBored weapon
				AnimationName = MUMntTroll_SKL.MUMntTroll_HITE UPGRADE_NUMENOR_STONEWORK
				AnimationMode = ONCE
			End
		End

		AnimationState = USER_3 
			Animation = ExpectAnotherPoke ; The three comes from the special TrollBored weapon, and lasts longer than 2
				AnimationName = MUMntTroll_SKL.MUMntTroll_IDLJ UPGRADE_NUMENOR_STONEWORK
				AnimationMode = LOOP
			End
		End

		;--------------------------------------------------------------------------------------------------------------------------------------------
		;Emotions

		AnimationState = EMOTION_CELEBRATING 
			Animation
				AnimationName	=	MUMntTroll_SKL.MUMntTroll_IDLF UPGRADE_NUMENOR_STONEWORK
				AnimationMode	=	LOOP
			End
		End
	
		AnimationState					= EMOTION_TAUNTING 
			Animation
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLB UPGRADE_NUMENOR_STONEWORK
				AnimationMode			= ONCE
				AnimationPriority		= 20
			End
			Animation					= Taunting3
				AnimationName			= MUMntTroll_SKL.MUMntTroll_IDLH UPGRADE_NUMENOR_STONEWORK
				AnimationMode			= ONCE
				AnimationPriority		= 10
			End

	End

End
End

AddModule
	Behavior = SubObjectsUpgrade ModuleTag_ShowFlagsAndTower66677
		TriggeredBy		= Upgrade_TechnologyWildHeavyArmor
		UpgradeTexture	= MUMntTroll.tga 0 MUAttkTroll.tga;MB
		;UpgradeTexture	= GBVet.tga 0 IBWargPit_A.tga ;MB
		;ShowSubObjects	= DrawFloorV2
		;HideSubObjects	= DrawFloor
	End
End

;AddModule
	;Behavior = ModelConditionUpgrade ModuleTag_EliteSoldiers78
		;TriggeredBy		= Upgrade_TechnologyWildHeavyArmor
		;AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK;
		;Permanent		= Yes
	;End
;End

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf
		TriggeredBy				= Upgrade_TechnologyWildHeavyArmor
		AttributeModifier		= BeastPower
	End
      End
End

CommandSet NewMordorMountainTrollCommandSet
	1	= Command_ToggleStance
	2  	= Command_ToggleMountainTrollRockThrow
	3  	= Command_SpecialAbilityTrollFindTree 
	4  	= Command_SpecialAbilityTrollFindTastyOrc
        5       = Command_CreateAHero_HowlOfRage_Level1	
	13 	= Command_AttackMove
	14 	= Command_Stop
	16	= Command_SpecialAbilityTrollGrabTree			; For context-sensitive tree grab
	17  	= Command_SetStanceBattle
	18  	= Command_SetStanceAggressive
	19  	= Command_SetStanceHoldGround
End





Object MordorDrummerTroll
CommandSet = NewMordorDrummerTrollCommandSet

AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf
		TriggeredBy				= Upgrade_TechnologyWildHeavyArmor
		AttributeModifier		= BeastPower
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced2
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End
End

Object MordorFighterHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced26
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End
End

Object MordorEasterlingHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced26
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End
End

Object MordorHaradrimHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced26
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End
End

Object MordorHaradrimLancerHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced26
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End
End

Object MordorCorsairHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced26
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End
End

Object MordorBlackOrcHorde
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced26
		TriggeredBy				= Upgrade_TechnologyIsengardHeavyArmor 
		AttributeModifier		= SuperExperience
	End
      End
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwfr6
		TriggeredBy				= Upgrade_TechnologyIsengardForgedBlades 
		AttributeModifier		= KillResources
	End
      End
End

;;;;;;;;;;;;;;;;;;;
;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
;                  ISENGARDcattivi
;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

CommandSet NewIsengardPorterCommandSet
	1  = Command_Stop
	2  = Command_PorterExtinguishFire
	3  = Command_PorterConstructIsengardFurnace
	;4  = Command_PorterConstructIsengardLumberMill
	5 = Command_ConstructIsengardTavern
	6  = Command_PorterConstructIsengardUrukPit
	7  = Command_PorterConstructIsengardWargPit
	;8  = Command_PorterConstructIsengardSiegeWorks
	;9  = Command_PorterConstructIsengardBattleTower
	;10  = Command_PorterConstructIsengardWargSentry
	;11 = Command_PorterConstructIsengardArmory
	;12 = Command_PorterConstructIsengardWallHub

	13 = Command_PorterConstructIsengardFortress 
End

CommandSet NewNewIsengardPorterCommandSet
	1  = Command_Stop
	2  = Command_PorterExtinguishFire
	3  = Command_PorterConstructIsengardFurnace
	;4  = Command_PorterConstructIsengardLumberMill
	5 = Command_ConstructIsengardTavern
	6  = Command_PorterConstructIsengardUrukPit
	7  = Command_PorterConstructIsengardWargPit
	;8  = Command_PorterConstructIsengardSiegeWorks
	;9  = Command_PorterConstructIsengardBattleTower
	10  = Command_PorterConstructIsengardWargSentry
	11 = Command_PorterConstructIsengardArmory
	12 = Command_PorterConstructIsengardWallHub

	13 = Command_PorterConstructIsengardFortress 
End

CommandSet NewNewNewIsengardPorterCommandSet
	1  = Command_Stop
	2  = Command_PorterExtinguishFire
	3  = Command_PorterConstructIsengardFurnace
	4  = Command_PorterConstructIsengardLumberMill
	5 = Command_ConstructIsengardTavern
	6  = Command_PorterConstructIsengardUrukPit
	7  = Command_PorterConstructIsengardWargPit
	8  = Command_PorterConstructIsengardSiegeWorks
	9  = Command_PorterConstructIsengardBattleTower
	10  = Command_PorterConstructIsengardWargSentry
	11 = Command_PorterConstructIsengardArmory
	12 = Command_PorterConstructIsengardWallHub

	13 = Command_PorterConstructIsengardFortress 
End

CommandSet NewIsengardSiegeWorksCommandSetLevel1
	1 = Command_ConstructIsengardBatteringRam
	2 = Command_ConstructIsengardBallista			; ;3
	3 = Command_ConstructIsengardExplosiveMine	; ;2
	4 = Command_UpgradeIsengardSiegeWorksLevel2
       ; 5 = Command_ConstructIsengardMineLauncherExpansion
	6 = Command_Sell
End

CommandSet NewIsengardSiegeWorksCommandSetLevel2
	1 = Command_ConstructIsengardBatteringRam
	2 = Command_ConstructIsengardBallista			; ;3
	3 = Command_ConstructIsengardExplosiveMine	; ;2
	4 = Command_UpgradeIsengardSiegeWorksLevel3
        ;5 = Command_ConstructIsengardMineLauncherExpansion
	6 = Command_Sell
End

CommandSet NewIsengardSiegeWorksCommandSetLevel3
	1 = Command_ConstructIsengardBatteringRam
	2 = Command_ConstructIsengardBallista			; ;3
	3 = Command_ConstructIsengardExplosiveMine
      ;  5 = Command_ConstructIsengardMineLauncherExpansion
	6 = Command_Sell
End

Object IsengardSiegeWorks
CommandSet = NewIsengardSiegeWorksCommandSetLevel1
ReplaceModule ModuleTag_IsengardSiegeWorksLevel2CommandSet
Behavior = CommandSetUpgrade ModuleTag_IsengardSiegeWorksLevel2CommandSet0
		TriggeredBy		= Upgrade_StructureLevel2
		ConflictsWith	= Upgrade_StructureLevel3
		CommandSet		= NewIsengardSiegeWorksCommandSetLevel2
	End
End
ReplaceModule ModuleTag_IsengardSiegeWorksLevel3CommandSet
	Behavior = CommandSetUpgrade ModuleTag_IsengardSiegeWorksLevel3CommandSet0
		TriggeredBy		= Upgrade_StructureLevel3
		CommandSet		= NewIsengardSiegeWorksCommandSetLevel3
	End
End
End

CommandButton Command_SpellBookPalantirVision
  	Command           	= OBJECT_UPGRADE
  	Upgrade           	= Upgrade_DwarvenFortressOilCasks ;Upgrade_IsengardFortressIronPlating		
  	;Upgrade           	= Upgrade_IsengardFortressIronPlating
	NeededUpgrade	  = Upgrade_TechnologyGondorBasicTraining
	NeededUpgradeAny		= Yes
	Options			  = CANCELABLE NEED_UPGRADE 
  	TextLabel         	= SecondAgeIS
  	ButtonImage       	= BDFortress_OilCasks
  	ButtonBorderType  	= UPGRADE
  	DescriptLabel     	= SecondAgeISDesc
  	Radial            	= Yes
  	InPalantir	   	= No
LacksPrerequisiteLabel  =  SecondAgeISLack
End



CommandButton Command_PurchaseUpgradeIsengardBasicTraining
  Command           = OBJECT_UPGRADE
  Upgrade           = Upgrade_IsengardFortressWizardsTower 
  ;Upgrade           = Upgrade_MordorFortressGorgorothSpire
	NeededUpgrade	  = Upgrade_TechnologyElvenSilverthornArrows
	;NeededUpgrade	  = Upgrade_TechnologyElvenBasicTraining
	NeededUpgradeAny		= Yes
	Options			  = CANCELABLE NEED_UPGRADE  
  TextLabel         = thirdageIS
  ButtonImage       = BDFortress_DwarvenStonework
  ButtonBorderType  = UPGRADE
  DescriptLabel     = thirdageISDesc
  Radial            = Yes
 InPalantir	   	= No
LacksPrerequisiteLabel  =  thirdageISLack
End

CommandSet NewIsengardFortressCommandSet
	InitialVisible	= 6
	//Main menu can select heroes, upgrades sub menus, or build a porter.
	1	= Command_ConstructIsengardPorter
;	2	= Command_ConstructIsengardBerserkerHorde
	2	= Command_SelectRevivablesIsengardFortress
	3	= Command_SelectUpgradesIsengardFortress
	4	= Command_IsengardWizardsTowerLightningStrike	
        5       = Command_SpellBookPalantirVision
	6	= Command_Sell
	
		//Improvements
	7	= Command_PurchaseUpgradeIsengardFortressMurderOfCrows
	8	= Command_PurchaseUpgradeIsengardFortressBurningForges
	9	= Command_PurchaseUpgradeIsengardFortressExcavations
	10	= Command_PurchaseUpgradeIsengardFortressOrcfireMunitions
	;11	= Command_PurchaseUpgradeIsengardFortressIronPlating
	;12	= Command_PurchaseUpgradeIsengardFortressWizardsTower    	
	13	= Command_SpecialAbilityMurderOfCrows
	14	= Command_RadialBack

	//Heroes
	16	= Command_RingHeroReviveSlot
	17	= Command_CreateAHeroReviveSlot		// Note we also need an extra slot for the Create A Hero
	18	= Command_GenericReviveSlot1 
	19	= Command_GenericReviveSlot2 
	20	= Command_GenericReviveSlot3 
	21	= Command_GenericReviveSlot4 
	22	= Command_GenericReviveSlot5
	23	= Command_GenericReviveSlot6 
	24	= Command_GenericReviveSlot7 
	25	= Command_RadialBack
End

CommandSet NewNewIsengardFortressCommandSet
	InitialVisible	= 6
	//Main menu can select heroes, upgrades sub menus, or build a porter.
	1	= Command_ConstructIsengardPorter
;	2	= Command_ConstructIsengardBerserkerHorde
	2	= Command_SelectRevivablesIsengardFortress
	3	= Command_SelectUpgradesIsengardFortress
	4	= Command_IsengardWizardsTowerLightningStrike	
        5       = Command_PurchaseUpgradeIsengardBasicTraining
	6	= Command_Sell
	
		//Improvements
	7	= Command_PurchaseUpgradeIsengardFortressMurderOfCrows
	8	= Command_PurchaseUpgradeIsengardFortressBurningForges
	9	= Command_PurchaseUpgradeIsengardFortressExcavations
	10	= Command_PurchaseUpgradeIsengardFortressOrcfireMunitions
	;11	= Command_PurchaseUpgradeIsengardFortressIronPlating
	;12	= Command_PurchaseUpgradeIsengardFortressWizardsTower    	
	13	= Command_SpecialAbilityMurderOfCrows
	14	= Command_RadialBack

	//Heroes
	16	= Command_RingHeroReviveSlot
	17	= Command_CreateAHeroReviveSlot		// Note we also need an extra slot for the Create A Hero
	18	= Command_GenericReviveSlot1 
	19	= Command_GenericReviveSlot2 
	20	= Command_GenericReviveSlot3 
	21	= Command_GenericReviveSlot4 
	22	= Command_GenericReviveSlot5
	23	= Command_GenericReviveSlot6 
	24	= Command_GenericReviveSlot7 
	25	= Command_RadialBack
End

;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

CommandButton Command_DeployMine
  Command                 = SPECIAL_POWER
  SpecialPower            = SpecialAbilityFakeLeadership2
  Options				  = NONPRESSABLE
  TextLabel               = minaresourc
  ButtonImage             = UCCommon_Pillage
  RadiusCursorType        = TrainingRadiusCursor
  ButtonBorderType        = ACTION
  DescriptLabel           = minaresourcDesc
  InPalantir		  = Yes
End

CommandSet NewIsengardSlaughterHouseCommandSet
	;1       = Command_EowynShieldMaiden
      ;  2       = Command_SpecialAbilityIgnite
        1	= Command_SarumanThunderBolt
        2       = Command_DeployMine
	6	= Command_Sell
End

Object IsengardFurnace Furnace
CommandSet = NewIsengardSlaughterHouseCommandSet
      AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy				= Upgrade_TechnologyMordorHeavyArmor 
		AttributeModifier		= SuperMoneymodifier
	End
      End
AddModule
Behavior = UnpauseSpecialPowerUpgrade ModuleTag_IstariLightEnabler
		SpecialPowerTemplate = SpecialAbilityLightingBolt
		TriggeredBy = Upgrade_StructureLevel2
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_IstariLightPower                      
		SpecialPowerTemplate		= SpecialAbilityLightingBolt
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= Yes
		InitiateSound				= SarumanVoiceAttackCharge
	End
End

AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IstariLightUpdate
		SpecialPowerTemplate    = SpecialAbilityLightingBolt
		SkipContinue			= Yes

		UnpackTime              = 1500
 		PreparationTime         = 1  
 		PersistentPrepTime      = 1000
 		PackTime                = 500
		AwardXPForTriggering    = 0
		StartAbilityRange		= 290; Note: This has to be smaller than the weapon range or it'll never succeed
		ApproachRequiresLOS		= Yes		
		SpecialWeapon			= SarumanLightningBlastWeapon
		MustFinishAbility		= Yes
		WhichSpecialWeapon		= 3
		BusyForDuration			= 2500
	End
End

AddModule
Behavior = FireWeaponWhenDeadBehavior ModuleTag_DIELIKETHIS
    TriggeredBy = Upgrade_StructureLevel3
    DeathWeapon = IsengardExplosiveMineExplosionWeapon   
  End
  End
End

CommandButton Command_SpecialAbilityLightTorch
	Command				= UNIT_BUILD
	Object				= AngmarDireWolfHorde
	Options				= CANCELABLE NEED_UPGRADE ; ;
	TextLabel			= berferkh
	ButtonImage			= BWFissure_Marauder
	ButtonBorderType	= BUILD											
	DescriptLabel		= berferkhDesc
	NeededUpgrade		= Upgrade_IsengardUrukPitLevel3; ;
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount	= Yes
LacksPrerequisiteLabel  =  berferkhLack
End

CommandButton Command_SpecialAbilityDeathWish
	Command			= UNIT_BUILD
	Object			= AngmarSnowTrollHorde
	Options			= CANCELABLE NEED_UPGRADE 
	NeededUpgrade		= Upgrade_IsengardUrukPitLevel2
	NeededUpgradeAny	= Yes
	TextLabel		= urukiller
	ButtonImage		= KUSnowTrollIcon
	ButtonBorderType    	= BUILD 
	DescriptLabel       	= urukillerDesc
	Radial			= Yes
	InPalantir		= Yes
	ShowProductionCount	= Yes    
LacksPrerequisiteLabel  =  urukillerLack
End

CommandSet NewIsengardUrukPitCommandSetLevel1
  1	= Command_ConstructIsengardFighterHorde
  2	= Command_ConstructIsengardUrukCrossbowHorde
  3	= Command_ConstructIsengardPikemanHorde
  4 = Command_ConstructIsengardBerserker
  ;5 = Command_UpgradeIsengardUrukPitLevel2
  6	= Command_Sell
  8     = Command_SpecialAbilityLightTorch
  9     = Command_ConstructIsengardBerserkerHorde
  10    = Command_SpecialAbilityDeathWish
End

CommandSet NewIsengardUrukPitCommandSetLevel2-
  1	= Command_ConstructIsengardFighterHorde
  2	= Command_ConstructIsengardUrukCrossbowHorde
  3	= Command_ConstructIsengardPikemanHorde
  4 = Command_ConstructIsengardBerserker
  5 = Command_UpgradeIsengardUrukPitLevel2
  6	= Command_Sell
  8     = Command_SpecialAbilityLightTorch
  9     = Command_ConstructIsengardBerserkerHorde
  10    = Command_SpecialAbilityDeathWish
End

CommandSet NewIsengardUrukPitCommandSetLevel2
  1	= Command_ConstructIsengardFighterHorde
  2	= Command_ConstructIsengardUrukCrossbowHorde
  3	= Command_ConstructIsengardPikemanHorde
  4 = Command_ConstructIsengardBerserker
  ;5 = Command_UpgradeIsengardUrukPitLevel2
  6	= Command_Sell
  8     = Command_SpecialAbilityLightTorch
  9     = Command_ConstructIsengardBerserkerHorde
  10    = Command_SpecialAbilityDeathWish
End

CommandSet NewIsengardUrukPitCommandSetLevel3-
  1	= Command_ConstructIsengardFighterHorde
  2	= Command_ConstructIsengardUrukCrossbowHorde
  3	= Command_ConstructIsengardPikemanHorde
  5 = Command_UpgradeIsengardUrukPitLevel3
  4 = Command_ConstructIsengardBerserker
  6	= Command_Sell
  8     = Command_SpecialAbilityLightTorch
  9     = Command_ConstructIsengardBerserkerHorde
  10    = Command_SpecialAbilityDeathWish
End

CommandSet NewIsengardUrukPitCommandSetLevel3
  1	= Command_ConstructIsengardFighterHorde
  2	= Command_ConstructIsengardUrukCrossbowHorde
  3	= Command_ConstructIsengardPikemanHorde
 ; 5 = Command_UpgradeIsengardUrukPitLevel3
  4 = Command_ConstructIsengardBerserker
  6	= Command_Sell
  8     = Command_SpecialAbilityLightTorch
  9     = Command_ConstructIsengardBerserkerHorde
  10    = Command_SpecialAbilityDeathWish
End

Object IsengardUrukPit
CommandSet = NewIsengardUrukPitCommandSetLevel1
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5645764
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades 
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewIsengardUrukPitCommandSetLevel2-
	End 
End

ReplaceModule ModuleTag_IsengardUrukPitLevel2CommandSet
Behavior = CommandSetUpgrade ModuleTag_IsengardUrukPitLevel2CommandSet0
		TriggeredBy		= Upgrade_IsengardUrukPitLevel2
		ConflictsWith	= Upgrade_IsengardUrukPitLevel3
		CommandSet		= NewIsengardUrukPitCommandSetLevel2
End
End

AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp5645
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewIsengardUrukPitCommandSetLevel3-
	End 
End
	
ReplaceModule ModuleTag_IsengardUrukPitLevel3CommandSet
	Behavior = CommandSetUpgrade ModuleTag_IsengardUrukPitLevel3CommandSet0
		TriggeredBy		= Upgrade_IsengardUrukPitLevel3
		CommandSet		= NewIsengardUrukPitCommandSetLevel3
	End
End
End



CommandSet NewIsengardBeserkerHordeCommandSet
	1	= Command_ToggleStance	
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
End

ChildObject AngmarDireWolf IsengardBeserker
WeaponSet
Conditions = None 
Weapon = PRIMARY    IsengardBerserkerSword
End
CommandPoints = 10
DisplayName = OBJECT:IsengardBeserker
CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
CrusherLevel = 0 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
CrushRevengeWeapon = RangedInfantryCrushRevenge
CommandSet = NewIsengardBeserkerHordeCommandSet
Side				= Isengard
ThreatLevel			= ISENGARD_BESERKER_THREAT_LEVEL
VisionRange = ISENGARD_BERSERKER_VISION_RANGE  
ShroudClearingRange = ISENGARD_BERSERKER_SHROUD_RANGE
VisionSide = 35%
VisionRear = 25%
MaxVisionBonusPercent = 300%
VisionBonusTestRadius = 200
VisionBonusPercentPerFoot = 2.0%
VoiceAttack				= BerserkerVoiceAttackMS
VoiceAttackCharge			= BerserkerVoiceAttackCharge
;VoiceCombineWithHorde		= BerserkerVoiceMove
VoiceCreated			= EVA:BerserkerCreated
VoiceFullyCreated 		= EVA:BerserkerCreated
VoiceMove				= BerserkerVoiceMoveMS
VoicePriority			= 14
VoiceSelect				= BerserkerVoiceSelectMS
VoiceSelectBattle 		= BerserkerVoiceSelectBattle
VoiceGuard				= BerserkerVoiceMove
VoiceEnterStateAttack		= BerserkerVoiceEnterStateAttack
VoiceEnterStateAttackCharge	= BerserkerVoiceEnterStateAttackCharge	
UnitSpecificSounds
VoiceEnter							= BerserkerVoiceMoveMS				;for entering SiegeLadder
VoiceEnterUnitEvilMenTransportShip	= BerserkerVoiceMoveMS
VoiceEnterUnitMordorMumakil			= BerserkerVoiceMoveMS
VoiceEnterUnitSlaughterHouse		= BerserkerVoiceMoveMS
VoiceGarrison						= BerserkerVoiceMoveMS
VoiceInitiateCaptureBuilding		= BerserkerVoiceMoveMS
End
CrowdResponseKey = Uruk
LocomotorSet
Locomotor     = BerserkerLocomotor ; HumanLocomotor
Condition     = SET_NORMAL
Speed         = 80  ;NORMAL_ISENGARD_FAST_MEMBER_SPEED
End
ReplaceModule ModuleTag_03
Behavior = AIUpdateInterface ModuleTag_030
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		AILuaEventsList				=	InfantryFunctions
		AttackPriority				= 	AttackPriority_Infantry
		BurningDeathTime			=	BURNINGDEATH_DURATION_INFANTRY
	End
End
AddModule	
	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	400		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf					=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf				=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt						=	EMOTION_POINTAT_OBJECTFILTER

		HeroScanDistance			=	150
		FearScanDistance			=	200

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=   BraceForBeingCrushed_Base
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End	
End

ReplaceModule ModuleTag_02
Body = ActiveBody ModuleTag_021
		MaxHealth         = 1000   ;
		MaxHealthDamaged  = ISENGARD_BERSERKER_HEALTH_DAMAGED		
		BurningDeathBehavior	= Yes
		BurningDeathFX			= FX_InfantryBurningFlame
		CheerRadius				= EMOTION_CHEER_RADIUS
    	DodgePercent      = 80%

	End
	End		
End

Object AngmarDireWolfHorde
CommandSet = NewIsengardBeserkerHordeCommandSet
BuildCost = 700
BuildTime = 30

	DisplayName = OBJECT:IsengardBeserker
	ButtonImage		= WOR_Berserker
	SelectPortrait	= UPIsenguard_Beserker

	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND;UNATTACKABLE 
	
	ThreatLevel			= ISENGARD_BESERKER_THREAT_LEVEL

	CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 0 ;What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
	CrushRevengeWeapon = RangedInfantryCrushRevenge

	CommandSet = NewIsengardBeserkerHordeCommandSet

	LocomotorSet
		Locomotor     = NormalChargeMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = 80   ;NORMAL_ISENGARD_FAST_HORDE_SPEED
	End

	ReplaceModule ModuleTag_HordeContain
	Behavior = HorseHordeContain ModuleTag_HordeContain67
	FrontAngle = 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload 		= AngmarDireWolf  8
		Slots 			= 8					; originally 10
		PassengerFilter 	= NONE +INFANTRY +AngmarDireWolf
		ShowPips 		= No
		RandomOffset 		= X:2 y:3
		
		MeleeBehavior 		= Amoeba
		End
		
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
		;BannerCarriersAllowed	= AngmarBannerDireSnowTroll					; types of units that are allowed as banner carriers
		;BannerCarrierPosition	= UnitType:AngmarDireWolf	Pos:X:60.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		
		RankInfo	= RankNumber:1 UnitType:AngmarDireWolf Position:X:30 Y:-35	Position:X:42 Y:-15	Position:X:50 Y:15	Position:X:30 Y:42		Position:X:-5 Y:-25	Position:X:-28 Y:0	Position:X:5 Y:5	Position:X:-10 Y:30	;	

		; RankInfo	= RankNumber:1 UnitType:AngmarDireWolf Position:X:20 Y:0	Position:X:-16.18 Y:11.76	Position:X:6.18 Y:-19.02	Position:X:6.18 Y:19.02		Position:X:-16.18 Y:-11.76	Position:X:30.54 Y:16.27	Position:X:-39.13 Y:8.32	Position:X:26.77 Y:-29.73	Position:X:-4.18 Y:39.78	Position:X:-20 Y:-34.64		Position:X:26.77 Y:29.73	Position:X:-39.13 Y:-8.32	Position:X:36.54 Y:-16.27	Position:X:-20 Y:34.64	Position:X:-4.18 Y:-39.78

		//RankInfo = RankNumber:1 UnitType:AngmarDireWolf Position:X:40 Y:0		Position:X:40 Y:15		Position:X:40 Y:-15		Position:X:40 Y:30		Position:X:40 Y:-30 
		//RankInfo = RankNumber:2 UnitType:AngmarDireWolf Position:X:10 Y:0 Leader 1 0	Position:X:10 Y:15 Leader 1 1	Position:X:10 Y:-15 Leader 1 2	Position:X:10 Y:30 Leader 1 3	Position:X:10 Y:-30 Leader 1 4
		
		RanksToReleaseWhenAttacking = 1
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
		AttributeModifiers = IsengardWargSkirmish		
	End
	End
End

Object IsengardFortressCitadel
RemoveModule AutoDepositModuleTag
ReplaceModule ModuleTag_PassOutIronPlating
	Behavior = CastleUpgrade ModuleTag_PassOutNumenorStoneworkUpgrade56
		TriggeredBy	= Upgrade_DwarvenFortressOilCasks
		Upgrade		= Upgrade_IsengardFortressIronPlating
		WallUpgradeRadius	= ISENGARD_FORTRESS_WALL_EFFECTIVE_RADIUS
	End
	End
CommandSet = NewIsengardFortressCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp894y
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewIsengardFortressCommandSet
	End 
End
End

CommandButton Command_SpellBookDragonStrike
	Command			= UNIT_BUILD
	Object			= DwarvenBattleWagon
	Options			= CANCELABLE NEED_UPGRADE 
	NeededUpgrade		= Upgrade_IsengardWargPitLevel3
	NeededUpgradeAny	= Yes
	TextLabel		= dragonis
	ButtonImage		= KUSnowTrollIcon
	ButtonBorderType    	= BUILD 
	DescriptLabel       	= dragonisDesc
	Radial			= Yes
	InPalantir		= Yes
	ShowProductionCount	= Yes   
LacksPrerequisiteLabel  =  dragonisLack
End

CommandButton Command_ConstructWargFromDefectedLair
	Command           = PLAYER_UPGRADE
	Upgrade           = Upgrade_WildSpiderVenomSackScience
	Options			  = CANCELABLE ;NEED_UPGRADE
	TextLabel         = wagpazzi
	ButtonImage       = BWSpiderPit_VenomSacks
	ButtonBorderType  = UPGRADE
	DescriptLabel     = wagpazziDesc
	NeededUpgrade	  = Upgrade_ElvenGreenPastureLevel3
	Radial            = Yes
	InPalantir	      = Yes
	LacksPrerequisiteLabel		= wagpazziLack
	;UnitSpecificSound	= TrollVoxFindTree
End


CommandSet NewIsengardWargPitCommandSetLevel1
  	1	= Command_ConstructIsengardWargPackHorde
  	2	= Command_ConstructIsengardWargRiderHorde
  	;3 	= Command_UpgradeIsengardWargPitLevel2
        4       = Command_SpellBookDragonStrike
        5       = Command_ConstructWargFromDefectedLair
  	6	= Command_Sell
End

CommandSet NewIsengardWargPitCommandSetLevel2-
  	1	= Command_ConstructIsengardWargPackHorde
  	2	= Command_ConstructIsengardWargRiderHorde
  	3 	= Command_UpgradeIsengardWargPitLevel2
        4       = Command_SpellBookDragonStrike
        5       = Command_ConstructWargFromDefectedLair
  	6	= Command_Sell
End

CommandSet NewIsengardWargPitCommandSetLevel2
  	1	= Command_ConstructIsengardWargPackHorde
  	2	= Command_ConstructIsengardWargRiderHorde
  	;3 	= Command_UpgradeIsengardWargPitLevel3
        4       = Command_SpellBookDragonStrike
        5       = Command_ConstructWargFromDefectedLair
  	6	= Command_Sell
End

CommandSet NewIsengardWargPitCommandSetLevel3-
  	1	= Command_ConstructIsengardWargPackHorde
  	2	= Command_ConstructIsengardWargRiderHorde
  	3 	= Command_UpgradeIsengardWargPitLevel3
        4       = Command_SpellBookDragonStrike
        5       = Command_ConstructWargFromDefectedLair
  	6	= Command_Sell
End

CommandSet NewIsengardWargPitCommandSetLevel3
  	1	= Command_ConstructIsengardWargPackHorde
  	2	= Command_ConstructIsengardWargRiderHorde
        4       = Command_SpellBookDragonStrike
        5       = Command_ConstructWargFromDefectedLair
  	6	= Command_Sell
End

Object IsengardWargPit
CommandSet = NewIsengardWargPitCommandSetLevel1
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp894y
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewIsengardWargPitCommandSetLevel2-
	End 
End
ReplaceModule ModuleTag_IsengardWargPitLevel2CommandSet
	Behavior = CommandSetUpgrade ModuleTag_IsengardWargPitLevel2CommandSet77
		TriggeredBy		= Upgrade_IsengardWargPitLevel2
		;ConflictsWith	= Upgrade_IsengardWargPitLevel3
		CommandSet		= NewIsengardWargPitCommandSetLevel2
	End
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp894y56
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewIsengardWargPitCommandSetLevel3-
	End 
End
ReplaceModule ModuleTag_IsengardWargPitLevel3CommandSet
	Behavior = CommandSetUpgrade ModuleTag_IsengardWargPitLevel3CommandSet7
		TriggeredBy		= Upgrade_IsengardWargPitLevel3
		CommandSet		= NewIsengardWargPitCommandSetLevel3
	End
End
End

CommandButton Command_ConstructGoblinFighterHordeFromDefectedLair
	Command			= UNIT_BUILD
	Object			= AngmarHillTrollHorde
	Options			= CANCELABLE
	;NeededUpgrade		= UpgradeAngmarDenLevel2
	;NeededUpgradeAny	= Yes
	TextLabel		= schidiuruk
	ButtonImage		= KUHillTrollIcon
	ButtonBorderType    	= BUILD 
	DescriptLabel       	= schidiurukDesc
	Radial			= Yes
	InPalantir		= Yes
	ShowProductionCount	= Yes    
End

CommandSet NewIsengardTavernCommandSetLevel1			; Added to Isengard for BFME2 Expansion
	1	= Command_ConstructIsengardWildmanHorde
	2	= Command_ConstructIsengardWildmanAxeHorde
;	3	= Command_PurchaseTechnologyMordorHeavyArmor
	;5	= Command_UpgradeIsengardTavernLevel2
	6	= Command_Sell
        7       = Command_ConstructGoblinFighterHordeFromDefectedLair
End

CommandSet NewIsengardTavernCommandSetLevel2-			; Added to Isengard for BFME2 Expansion
	1	= Command_ConstructIsengardWildmanHorde
	2	= Command_ConstructIsengardWildmanAxeHorde
;	3	= Command_PurchaseTechnologyMordorHeavyArmor
	5	= Command_UpgradeIsengardTavernLevel2
	6	= Command_Sell
        7       = Command_ConstructGoblinFighterHordeFromDefectedLair
End


CommandSet NewIsengardTavernCommandSetLevel2			; Added to Isengard for BFME2 Expansion
	1	= Command_ConstructIsengardWildmanHorde
	2	= Command_ConstructIsengardWildmanAxeHorde
;	3	= Command_PurchaseTechnologyMordorHeavyArmor
	;5	= Command_UpgradeIsengardTavernLevel3
	6	= Command_Sell
        7       = Command_ConstructGoblinFighterHordeFromDefectedLair
End

CommandSet NewIsengardTavernCommandSetLevel3-			; Added to Isengard for BFME2 Expansion
	1	= Command_ConstructIsengardWildmanHorde
	2	= Command_ConstructIsengardWildmanAxeHorde
;	3	= Command_PurchaseTechnologyMordorHeavyArmor
	5	= Command_UpgradeIsengardTavernLevel3
	6	= Command_Sell
        7       = Command_ConstructGoblinFighterHordeFromDefectedLair
End

CommandSet NewIsengardTavernCommandSetLevel3			; Added to Isengard for BFME2 Expansion
	1	= Command_ConstructIsengardWildmanHorde
	2	= Command_ConstructIsengardWildmanAxeHorde
;	3	= Command_PurchaseTechnologyMordorHeavyArmor
	6	= Command_Sell
        7       = Command_ConstructGoblinFighterHordeFromDefectedLair
End

Object IsengardTavern
  CommandSet = NewIsengardTavernCommandSetLevel1
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp894y
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewIsengardTavernCommandSetLevel2-
	End 
End
ReplaceModule ModuleTag_IsengardTavernLevel2
	Behavior = CommandSetUpgrade ModuleTag_IsengardTavernLevel26
		TriggeredBy		= Upgrade_IsengardTavernLevel2
		ConflictsWith		= Upgrade_IsengardTavernLevel3
		CommandSet		= NewIsengardTavernCommandSetLevel2
	End
End 
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp894yu
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewIsengardTavernCommandSetLevel3-
	End 
End
ReplaceModule ModuleTag_IsengardTavernLevel3
	Behavior = CommandSetUpgrade ModuleTag_IsengardTavernLevel36
		TriggeredBy		= Upgrade_IsengardTavernLevel3
		CommandSet		= NewIsengardTavernCommandSetLevel3
	End
End
End



CommandButton Command_SpellBookBlight
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE NEED_UPGRADE
        NeededUpgrade                   = Upgrade_IsengardArmoryLevel2
        NeededUpgradeAny                = Yes
	Upgrade				= Upgrade_TechnologyMordorHeavyArmor 
	TextLabel			= Monete+
	ButtonImage			= BIArmory_HeavyArmor
	ButtonBorderType	= UPGRADE
	DescriptLabel		= Monete+Desc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= Monete+Lack; ;TOOLTIP:LackLevel2OrcPitHeavyArmor
	;UnitSpecificSound	= TrollVoxFindTree
End

CommandButton Command_SpecialAbilityWormtongueCorrodeAllegiance
Command				= PLAYER_UPGRADE
	Options				= CANCELABLE NEED_UPGRADE 
	Upgrade				= Upgrade_TechnologyMordorForgedBlades 
        NeededUpgrade			= Upgrade_IsengardArmoryLevel3
        NeededUpgradeAny			= Yes
	TextLabel			= menounit
	ButtonImage			= BIArmory_ForgedBlades
	ButtonBorderType	= UPGRADE
	DescriptLabel		= menounitDesc
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= menounitLack
	;UnitSpecificSound	= TrollVoxFindTree
End

CommandSet NewIsengardArmoryCommandSetLevel1
	1 = Command_PurchaseTechnologyIsengardBasicTraining
	2 = Command_PurchaseTechnologyIsengardHeavyArmor
	3 = Command_PurchaseTechnologyIsengardForgedBlades
	4 = Command_PurchaseTechnologyIsengardFireArrows
	5 = Command_PurchaseUpgradeIsengardArmoryLevel2
	6 = Command_Sell
        7 = Command_CreateAHero_BerserkerRage_Level2
        8 = Command_SpellBookBlight
        9 = Command_SpecialAbilityWormtongueCorrodeAllegiance
End

CommandSet NewIsengardArmoryCommandSetLevel2
	1 = Command_PurchaseTechnologyIsengardBasicTraining
	2 = Command_PurchaseTechnologyIsengardHeavyArmor
	3 = Command_PurchaseTechnologyIsengardForgedBlades
	4 = Command_PurchaseTechnologyIsengardFireArrows
	;5 = Command_PurchaseUpgradeIsengardArmoryLevel3
	6 = Command_Sell
        7 = Command_CreateAHero_BerserkerRage_Level2
        8 = Command_SpellBookBlight
        9 = Command_SpecialAbilityWormtongueCorrodeAllegiance
End
CommandSet NewIsengardArmoryCommandSetLevel3-
	1 = Command_PurchaseTechnologyIsengardBasicTraining
	2 = Command_PurchaseTechnologyIsengardHeavyArmor
	3 = Command_PurchaseTechnologyIsengardForgedBlades
	4 = Command_PurchaseTechnologyIsengardFireArrows
	5 = Command_PurchaseUpgradeIsengardArmoryLevel3
	6 = Command_Sell
        7 = Command_CreateAHero_BerserkerRage_Level2
        8 = Command_SpellBookBlight
        9 = Command_SpecialAbilityWormtongueCorrodeAllegiance
End
CommandSet NewIsengardArmoryCommandSetLevel3
	1 = Command_PurchaseTechnologyIsengardBasicTraining
	2 = Command_PurchaseTechnologyIsengardHeavyArmor
	3 = Command_PurchaseTechnologyIsengardForgedBlades
	4 = Command_PurchaseTechnologyIsengardFireArrows
	6 = Command_Sell
        7 = Command_CreateAHero_BerserkerRage_Level2
        8 = Command_SpellBookBlight
        9 = Command_SpecialAbilityWormtongueCorrodeAllegiance
End

Object IsengardArmory
    AddModule 
      Behavior = CostModifierUpgrade ModuleTag_CostModifier1
		TriggeredBy				= Upgrade_TechnologyMordorForgedBlades Upgrade_IsengardFaction
                RequiresAllTriggers	= Yes		
		ObjectFilter			= ANY +INFANTRY +CAVALRY
		Percentage				= -50%
	End
      End
CommandSet = NewIsengardArmoryCommandSetLevel1
ReplaceModule ModuleTag_Level12
	Behavior = CommandSetUpgrade ModuleTag_Level127
		TriggeredBy		= Upgrade_IsengardArmoryLevel2
		CommandSet		= NewIsengardArmoryCommandSetLevel2
	End
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp894yui
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewIsengardArmoryCommandSetLevel3-
	End 
End


ReplaceModule ModuleTag_Level23
	Behavior = CommandSetUpgrade ModuleTag_Level236
		TriggeredBy		= Upgrade_IsengardArmoryLevel3
		CommandSet		= NewIsengardArmoryCommandSetLevel3
	End
End
End

Weapon DrogothIncinerate0
	IdleAfterFiringDelay		= 0
	AttackRange					= DROGOTH_INCINERATE_RANGE
	WeaponSpeed					= 401							; dist/sec 
	RadiusDamageAffects			= ENEMIES NOT_SIMILAR
	DelayBetweenShots			= 0; time between shots, msec
	PreAttackDelay				= 1000
	PreAttackType				= PER_ATTACK					; Do the delay each time we attack a new target
	PreAttackFX					= FX_DrogothPreAttackBlast		;FX_GandalfPreAttackBlast	;is this even getting triggered?
	FireFX						= FX_DrogothIncinerate			;too much delay
	FiringDuration				= 1400
;	DamageDealtAtSelfPosition	= Yes

	DamageNugget												; A basic Nugget that just does damage
		Damage			= DROGOTH_INCINERATE_DAMAGE
		Radius			= DROGOTH_INCINERATE_RADIUS
		DelayTime		= 500
		DamageType		= FLAME
		DamageFXType	= FLAME
		DeathType		= BURNED
		DamageArc		= DROGOTH_INCINERATE_ARC
		DamageMaxHeight = 50									; We won't hurt something far above us.  Birds fly at around 100
		DamageSpeed		= 400
	End
	
	DamageNugget												; A basic Nugget that just does damage
		Damage			= DROGOTH_INCINERATE_CENTRE_DAMAGE
		Radius			= DROGOTH_INCINERATE_CENTRE_RADIUS
		DelayTime		= 250
		DamageType		= FLAME
		DamageFXType	= FLAME
		DeathType		= BURNED
		DamageMaxHeight = 50									; We won't hurt something far above us.  Birds fly at around 100
		DamageSpeed		= 400
	End

End

Weapon DragonStrikeStrafeWeapon0
	IdleAfterFiringDelay = 0
	AttackRange			= 60.0
	WeaponSpeed			= 401         ; dist/sec 
	RadiusDamageAffects	= ENEMIES 
	DelayBetweenShots		= 0               ; time between shots, msec
	PreAttackDelay        = 1000
	PreAttackType         = PER_ATTACK ; Do the delay each time we attack a new target
	PreAttackFX           = FX_GandalfPreAttackBlast
	FireFX                = NONE ;FX_BalrogBreath ---- commented out for E3, now controled by particle spawning
	FiringDuration		= 1400
	DamageDealtAtSelfPosition = No 
	

	DamageNugget                        ; A basic Nugget that just does damage
		Damage			= 3000 // lots of damage
		Radius			= 25.0 // Just a spot, the update module will spray it around as it goes
		DelayTime		= 500
		DamageType		= FLAME
		DamageFXType		= FLAME
		DeathType		= BURNED
		DamageMaxHeight = 60 ;We won't hurt something far above us.  Birds fly at around 100
		DamageSpeed		= 400
		DamageScalar  = 25% ALL -STRUCTURE; 
		DamageScalar  = 25% NONE +COMMANDCENTER
	End

	DamageNugget                        ; A basic Nugget that just does damage
		Damage			= 2000 // less damage
		Radius			= 65.0 // big spray, to make sure everyone gets some!
		DelayTime		= 500
		DamageType		= FLAME
		DamageFXType		= FLAME
		DeathType		= BURNED
		DamageMaxHeight = 60 ;We won't hurt something far above us.  Birds fly at around 100
		DamageSpeed		= 400
		DamageScalar  = 25% ALL -STRUCTURE; 
		DamageScalar  = 25% NONE +COMMANDCENTER
	End


	FireLogicNugget
		LogicType		= INCREASE_FUEL
		Radius			= 40
		Damage			= 40
		MinMaxBurnRate	= 20
		MaxResistance	= 5
	End
	FireLogicNugget
		LogicType		= INCREASE_BURN_RATE
		Radius			= 20
		Damage			= 20
	End


End

CommandButton Command_DrogothFireflight
	Command                 = SPECIAL_POWER
	SpecialPower            = SpecialAbilityFakeLeadership
	Options			= NONPRESSABLE ;NEED_UPGRADE
	NeededUpgrade		= Upgrade_DreadWrath
	TextLabel               = fireyeah
	ButtonImage             = KUDreadWrathIcon
	RadiusCursorType        = TrainingRadiusCursor
	ButtonBorderType        = ACTION
	DescriptLabel           = fireyeahDesc
	InPalantir		= Yes
End

CommandSet dragogoCommandset
	1 	= Command_ToggleStance	
	2	= Command_DrogothFireflight
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End



ChildObject DwarvenBattleWagon Drogoth

	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE ARMY_SUMMARY GIANT_BIRD
	; This is required for garrisoned objects - please put in all objects.
	;ButtonImage = HIDragonStrikeDragon
    
    ; SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
	SelectPortrait = HPSummonedDragon
RemoveModule ModuleTag_01
AddModule
	Draw = W3DScriptedModelDraw ModuleTag_0167
	    OkToChangeModelColor = Yes
	    StaticModelLODMode = Yes
		DefaultModelConditionState
			Model				= DragStrike_SKN
			WeaponLaunchBone	= PRIMARY BAT_JAW
		End		
		
		IdleAnimationState
			StateName = Idle
			Animation = IDLA
				AnimationName = DragStrike_SKL.DragStrike_ATKA; WUDrogoth_SKL.WUDrogoth_FLYA
				AnimationMode = LOOP
				AnimationSpeedFactorRange = 0.95 1.05
End
			ParticleSysBone = B_FIRE DragonStrikeFireBreath FollowBone:Yes
			ParticleSysBone = B_FIRE DragonStrikeFireBreath02 FollowBone:Yes
			ParticleSysBone = BAT_HEAD DrogothFireBreath FollowBone:Yes
			ParticleSysBone = BAT_JAW balrogBreathEmbers FollowBone:Yes
			ParticleSysBone = BAT_JAW balrogBreathSmoke FollowBone:Yes
			ParticleSysBone = BAT_HEAD DrogothBreathProxy FollowBone:Yes
			
		End

  		AnimationState = DYING
   			StateName = DYING
			Animation = DyingA
				AnimationName = DragStrike_SKL.DragStrike_DTHA ////////////////////////////
  				AnimationMode = ONCE
  			End
		End

   		AnimationState = ATTACKING
   			StateName = ATTACKING
			Animation = ATTACKING
				AnimationName = DragStrike_SKL.DragStrike_ATKA //////////////////////////////
  				AnimationMode = LOOP
  				AnimationBlendTime = 10
  			End
  			;FX for DragonStrikeFire
						ParticleSysBone = B_FIRE DragonStrikeFireBreath+ FollowBone:Yes
			ParticleSysBone = B_FIRE DragonStrikeFireBreath02+ FollowBone:Yes
			ParticleSysBone = BAT_HEAD DrogothFireBreath FollowBone:Yes
			ParticleSysBone = BAT_JAW balrogBreathEmbers FollowBone:Yes
			ParticleSysBone = BAT_JAW balrogBreathSmoke FollowBone:Yes
			ParticleSysBone = BAT_HEAD DrogothBreathProxy FollowBone:Yes
		End
   		
		AnimationState = MOVING
			StateName = Moving
			Animation = Moving
				AnimationName = DragStrike_SKL.DragStrike_ATKA; DragStrike_SKL.DragStrike_FLYA //////////////////////////////
				AnimationMode = LOOP
				AnimationBlendTime = 10
End
						ParticleSysBone = B_FIRE DragonStrikeFireBreath+ FollowBone:Yes
			ParticleSysBone = B_FIRE DragonStrikeFireBreath02 FollowBone:Yes
			ParticleSysBone = BAT_HEAD DrogothFireBreath FollowBone:Yes
			ParticleSysBone = BAT_JAW balrogBreathEmbers FollowBone:Yes
			ParticleSysBone = BAT_JAW balrogBreathSmoke FollowBone:Yes
			ParticleSysBone = BAT_HEAD DrogothBreathProxy FollowBone:Yes
			
	    End

   		AnimationState = LEVELED
			Animation
				AnimationName = WUDrogoth_SKL.WUDrogoth_LVLA
				AnimationMode = ONCE
			End
		End

End
End
ReplaceModule ModuleTag_02
	Body = RespawnBody ModuleTag_026
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = 20000
		HealingBuffFx     = None
	End
End
	ArmorSet
		Conditions      = None
		Armor           = DrogothArmor
		DamageFX        = FellBeastDamageFX
	End
Scale = 0.75
		Side				= Isengard
	EditorSorting		= UNIT
	ThreatLevel			= DROGOTH_THREAT_LEVEL
	ThingClass			= LARGE_MONSTER
	TransportSlotCount	= TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
	;//DisplayMeleeDamage	= DROGOTH_PLOW_DAMAGE_INNER
 	;BuildCost			= DROGOTH_BUILDCOST				
 	;BuildTime			= DROGOTH_BUILDTIME




	RamPower			= 45
	RamZMult			= 0.5
	CrusherLevel		= 3									;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
	CrushKnockback		= 50
	CrushZFactor		= 1.0
	LocomotorSet
		Locomotor = FellBeastLocomotor
		Condition = SET_NORMAL 
		Speed     = 95  ;88
	End
	LocomotorSet
		Locomotor = FellBeastLocomotor
		Condition = SET_SUPERSONIC 
		Speed     = 150 ;114
	End
	LocomotorSet
		Locomotor = FellBeastLocomotor
		Condition = SET_WANDER 
		Speed     = 78
	End
	LocomotorSet
		Locomotor = FellBeastSwoopLocomotor
		Condition = SET_PANIC
		Speed     = 160
	End
AddModule
	Behavior = SpecialPowerModule ModuleTag_FireballStarter                      
		SpecialPowerTemplate		= SpecialAbilityDrogothFireball
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= No								; get this at level 1.
		InitiateSound			= DrogothVoxAttack
	End
End
AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate   
		SpecialPowerTemplate    = SpecialAbilityDrogothFireball
		WhichSpecialWeapon		= 1										; sets SPECIAL_WEAPON_ONE
		UnpackTime             	= 1800									; leaning back
		PreparationTime			= 10									; just a small amount
		PackTime				= 950									; returning to flap
		AwardXPForTriggering    = 0
		StartAbilityRange		= DROGOTH_FIREBALL_RANGE
		MustFinishAbility		= Yes
		SpecialWeapon			= DrogothFireball
	End
End
AddModule
	 Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAIy
	    AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
	    MoodAttackCheckRate			= 500
	    AILuaEventsList				= FellBeastFunctions	
		FollowThroughDistance		= 200
		FollowThroughCheckStep		= 50
		FollowThroughGradient		= 1.0
		
		GrabTossTimeTrigger			= 2.5
		GrabTossHeightTrigger		= 100.0
		TossFX						= FX_DiebyFalling
		SpecialContactPoints		= Swoop

		AttackPriority = AttackPriority_FellBeast
	  End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_FellbeastLevelAttack                      
		SpecialPowerTemplate      = SpecialAbilityLevelAttack
		UpdateModuleStartsAttack  = Yes
	End
End
AddModule
	Behavior = FellBeastSwoopPower ModuleTag_FellBeastSwoopPower ; special fellbeast swoop power
		SpecialPowerTemplate		= SpecialAbilityLevelAttack
		UnpackTime					= 1 ; hit the guy
		AwardXPForTriggering		= 0		
		StartAbilityRange			= 1000.0		
	End
  End
AddModule
	Behavior = SlowDeathBehavior ModuleTag_SlowDeath
		DeathTypes			= ALL  
		DestructionDelay	= 500
		ShadowWhenDead		= No
		Sound				= INITIAL DrogothVoxDie
        FX					= INITIAL FX_DrogothDeath
   	End
End
AddModule
	Behavior = SquishCollide ModuleTag_066
	End
End
AddModule
	Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan5
	End
End
	BuildCost		= 2500
AddModule
	Behavior = FireWeaponUpdate ModuleTag_DamageHandler5
		FireWeaponNugget
			WeaponName	= DragonStrikeStrafeWeapon0
			FireDelay	= 0
			OneShot		= No
		End
		FireWeaponNugget
			WeaponName	= DrogothIncinerate0
			FireDelay	= 0
			OneShot		= No
		End
	End
End
CommandSet = dragogoCommandset
AddModule
	Behavior = StrafeAreaUpdate ModuleTag_Strafe
		WeaponName		 = DragonStrikeStrafeWeapon0
		StrafeAreaRadius = 180   // defines the area of engagement
								// Match the cursor radius in SpecialPower SpellBookDragonStrike
		Sweepfrequency	 = 0.45	// how fast does he wag left and right
		SweepAmplitude   = 70 // how far does he wag from left to right	
		Slope			 = 50 // how far ahead does he fire his weapon		
		InitialSweepPhase = 1.57 // half of PI means starting in the middle of the phase	
	End
End
End

Object IsengardPorter
CommandSet = NewIsengardPorterCommandSet
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp
		TriggeredBy			= Upgrade_TechnologyGondorForgedBlades  ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewIsengardPorterCommandSet
	End 
End
AddModule
	Behavior = CommandSetUpgrade ModueTag_SecondAgeUp3
		TriggeredBy			= Upgrade_TechnologyGondorHeavyArmor  ;Upgrade_DwarvenFortressDwarvenStoneworkTrigger
		;ConflictsWith		= Upgrade_GondorBarracksLevel3
		CommandSet			= NewNewNewIsengardPorterCommandSet
	End 
End
End

Object AngmarSnowTroll

	AddModule
	Behavior = GrantUpgradeCreate ModuleTag_1
		UpgradeToGrant = Upgrade_GandalfWhite  ;
	End 
	End

	AddModule
	Behavior = SubObjectsUpgrade CorruptedWeapon_Upgrade270
	TriggeredBy			   = Upgrade_GandalfWhite
	HideSubObjects		   = Uruk_Sword_01
	HideSubObjects		   = Belthronding
	HideSubObjects		   = Uruk_Sword_02
	;HideSubObjects		   = Uruk_Sword_03




	HideSubObjects		   = Shield_1OG
	HideSubObjects		   = Shield_2OG
	HideSubObjects		   = SHLD_01


	HideSubObjects		   = HLMT_01
	HideSubObjects		   = HLMT_02
	HideSubObjects		   = HLMT_03
	HideSubObjects		   = HAIR_01 

	HideSubObjects		   = BOOT_03

	HideSubObjects		   = SLDR_01
	HideSubObjects		   = SLDR_02

	HideSubObjects		   = GNLT_01
	HideSubObjects		   = GNLT_02


	HideSubObjects		   = CHEST_01
	HideSubObjects		   = CHEST_02


	FadeTimeInSeconds      = 0.0
	RecolorHouse		   = No

	End
        End

RemoveModule ModuleTag_01
AddModule
Draw = W3DScriptedModelDraw ModuleTag_DRAW1

DefaultModelConditionState
		Model				 = CHSS_UK_U_SKN
	Skeleton			 = CHSS_UK_U_SKL
	ModelAnimationPrefix = CHSS_UK
	PortraitImageName	 = CPUruk
	ButtonImageName		 = HICAHUrukhai
	WeaponLaunchBone	= PRIMARY B_HandR
End
//================== ANIMATIONS =================================================================
	IdleAnimationState
		Animation = IDLB
			AnimationName = CHSS_UK_U_IDLB
			AnimationMode = ONCE
			AnimationPriority = 1
		End
		Animation = IDLG
			AnimationName = CHSS_UK_U_IDLA
			AnimationMode = ONCE
			AnimationPriority = 20 ;2
		End
		Flags = RANDOMSTART
		StateName = Idle
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoard") end
		EndScript
	End


	AnimationState						= PASSENGER
		Animation						= Falling
			AnimationName				= CHSS_UK_U_FLYA
			AnimationMode				= LOOP
		End
	End
	
	AnimationState						= FREEFALL
		Animation						= FLYA
			AnimationName				= CHSS_UK_U_FLYA
			AnimationMode				= LOOP
			AnimationSpeedFactorRange	= 0.5	0.5
			AnimationBlendTime			= 5
		End
	End
	
	AnimationState			= STUNNED_FLAILING
		Animation           = StunFlail
			AnimationName   = CHSS_UK_U_FLYA
			AnimationMode   = LOOP
			AnimationSpeedFactorRange	= 0.4 0.6
		End
		Flags						= MAINTAIN_FRAME_ACROSS_STATES2
	End

	AnimationState			= DYING BURNINGDEATH
		Animation
			AnimationName	= CHSS_UK_U_DIEA
			AnimationMode	= ONCE
			AnimationBlendTime = 10
		End
		Animation
			AnimationName	= CHSS_UK_U_DIEB
			AnimationMode	= ONCE
			AnimationBlendTime = 20
		End
	End

	AnimationState			= DYING SPLATTED
		Animation			= Splat
			AnimationName	= CHSS_UK_U_LNDA
			AnimationMode	= ONCE
		End
	End

    AnimationState = DYING
		Animation = DIEA
			AnimationName = CHSS_UK_U_DIEA
		    AnimationMode = ONCE
		End
		Animation = DIEB
			AnimationName = CHSS_UK_U_DIEB
		    AnimationMode = ONCE
		End
    End    

	AnimationState			= BURNINGDEATH
		Animation
			AnimationName	= CHSS_UK_U_MFDA
			AnimationMode	= LOOP
			Distance		= 50
		End
	End

	AnimationState						= PARALYZED
		Animation
			AnimationName				= CHSS_UK_U_IDLA
			AnimationMode				= LOOP
		End
	End


	AnimationState        = STUNNED
		Animation           = LNDA
			AnimationName     = CHSS_UK_U_LNDA
			AnimationMode     = ONCE
		End
	End

	AnimationState        = STUNNED_STANDING_UP
		Animation           = GTPA
			AnimationName     = CHSS_UK_U_GTPA
			AnimationMode     = ONCE
			AnimationSpeedFactorRange = 1.5 1.5
		End
	End	
		
	AnimationState        = THROWN_PROJECTILE
		Animation           = FLYA
			AnimationName     = CHSS_UK_U_FLYA
			AnimationMode     = LOOP
		End
	End
	
    AnimationState = FIRING_OR_PREATTACK_A
		Animation = ATKA
			AnimationName = CHSS_UK_U_ATKA
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		Animation = ATKC
			AnimationName = CHSS_UK_U_ATKC
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		Animation = ATKB
			AnimationName = CHSS_UK_U_ATKB
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
    End

   

    AnimationState = MOVING FIRING_OR_PREATTACK_A
		Animation = TrotAndFire
			AnimationName = CHSS_UK_U_ATRA
		    AnimationMode = LOOP
		End
		Flags = RANDOMSTART
		;ParticleSysBone = None InfantryDustTrails
    End
    
	
	; ladder climbing animations
	AnimationState = MOVING CLIMBING BACKING_UP
		Animation = Climbing_Down
			AnimationName = CHSS_UK_U_CLMA
			AnimationMode = LOOP_BACKWARDS
			AnimationSpeedFactorRange = 2.0 2.0
		End
    End

    AnimationState = MOVING CLIMBING
		Animation = Climbing_Up
			AnimationName = CHSS_UK_U_CLMA
			AnimationMode = LOOP
			AnimationSpeedFactorRange = 2.0 2.0
		End
    End

	AnimationState = MOVING EMOTION_TERROR
		Animation = TERRORIZED
			AnimationName = CHSS_UK_U_RUNC
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
	End
     
    AnimationState = MOVING BACKING_UP
		Animation = BackingUp
			AnimationName = CHSS_UK_U_BAKA
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
	End

;
    AnimationState = MOVING ALTERNATE_FORMATION
		Animation = Moving
			AnimationName = CHSS_UK_U_SPCA
		    AnimationMode = LOOP
		    Distance		= 25
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
    End
    AnimationState = MOVING
		Animation = Moving
			AnimationName = CHSS_UK_U_RUNA
		    AnimationMode = LOOP
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
    End

		; --------- Click and Hit Reactions ------------
;		AnimationState = HIT_REACTION HIT_LEVEL_1
;			Animation = Hit_Level_1_a
;				AnimationName = CHSS_UK_U_HITA
;				AnimationMode = ONCE
;			End
;			Animation = Hit_Level_1_a
;				AnimationName = CHSS_UK_U_HITB
;				AnimationMode = ONCE
;			End
;		End
		
;		AnimationState = HIT_REACTION HIT_LEVEL_2
;			Animation = Hit_Level_1_a
;				AnimationName = CHSS_UK_U_HITA
;				AnimationMode = ONCE
;			End
;		End
		
    AnimationState = WAR_CHANT
		Animation = Chant
			AnimationName = CHSS_UK_U_TNTA
			AnimationMode = LOOP
		End
		Animation = Chant
			AnimationName = CHSS_UK_U_TNTB
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
	End
    
    AnimationState							= EMOTION_UNCONTROLLABLY_AFRAID
		Animation							= FERA
			AnimationName					= CHSS_UK_U_FERA
			AnimationMode					= LOOP
		End
		Flags = RANDOMSTART
    End
    
   ;-emotions--
	; Should be before selected (if uncontrollable..)      
    AnimationState							= EMOTION_AFRAID
		Animation							= FERA
			AnimationName					= CHSS_UK_U_FERA
			AnimationMode					= LOOP
		End
		Flags = RANDOMSTART
    End
    
    AnimationState = BETWEEN_FIRING_SHOTS_A
		Animation = Wait
			AnimationName = CHSS_UK_U_IDLA
			AnimationMode = ONCE
		End
	End

     AnimationState = ATTACKING
		Animation = IdleAllAttacksComeFrom
			AnimationName = CHSS_UK_U_IDLA
			AnimationMode = LOOP
		End
	End

	AnimationState							= EMOTION_TAUNTING
		Animation							= TNTA
			AnimationName					= CHSS_UK_U_TNTA
			AnimationMode					= LOOP
			AnimationBlendTime				= 10
;			AnimationSpeedFactorRange		= 0.8 1.2
		End
		Animation							= TNTB
			AnimationName					= CHSS_UK_U_TNTB
			AnimationMode					= LOOP
			AnimationBlendTime				= 10
;			AnimationSpeedFactorRange		= 0.8 1.2
		End
		Flags								= RANDOMSTART
	End
	
	AnimationState							= EMOTION_POINTING
		Animation							= Pointing1
			AnimationName					= CHSS_UK_U_PNTA
			AnimationMode					= LOOP
		End
		Flags								= RANDOMSTART
	End
	
	AnimationState							= EMOTION_CELEBRATING
		Animation							= CHRA
			AnimationName					= CHSS_UK_U_LVLA
			AnimationMode					= ONCE
			AnimationBlendTime				= 10
		End
		Flags				= RESTART_ANIM_WHEN_COMPLETE
	End
	
	AnimationState							= EMOTION_ALERT
		Animation							= ALERT
			AnimationName					= CHSS_UK_U_IDLA
			AnimationMode					= LOOP
		End
		Flags								= RESTART_ANIM_WHEN_COMPLETE RANDOMSTART
	End


	AnimationState		= RAISING_FLAG
		Animation
			AnimationName = CHSS_UK_U_LVLA
			AnimationMode = ONCE
;			AnimationSpeedFactorRange = 0.9 1.1
		End
		Flags = RESTART_ANIM_WHEN_COMPLETE
	End

	AnimationState        = SELECTED
		StateName           = STATE_Selected
		Animation           = ATNB
			AnimationName     = CHSS_UK_U_ATNB
			AnimationMode     = LOOP
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
		EndScript
	End

	TransitionState       = TRANS_IdleToSelected
		Animation           = ATNA
			AnimationName     = CHSS_UK_U_ATNA
			AnimationMode     = ONCE
			AnimationSpeedFactorRange = 0.9 1.0
		End
	End

	TransitionState       = TRANS_SelectedToGuard
		Animation           = ATNB
			AnimationName     = CHSS_UK_U_ATNB
			AnimationMode     = ONCE
			AnimationSpeedFactorRange = 0.9 1.0
		End
	End
		
	TransitionState		= TRANS_SelectedToBoard
		Animation			= ATNC
			AnimationName	= CHSS_UK_U_ATNC
			AnimationMode	= ONCE
			AnimationSpeedFactorRange = 0.9 1.0
		End
	End
  	
	
	AnimationState WEAPONSET_PLAYER_UPGRADE
		Animation = IDLA
			AnimationName = CHSS_UK_U_IDLA
			AnimationMode = LOOP
		End
		StateName	= Idle
		Flags		= RANDOMSTART
	End
	
    AnimationState = ALTERNATE_FORMATION
		Animation = IDLB
			AnimationName = CHSS_UK_U_IDLA
			AnimationMode = LOOP
			AnimationPriority = 20
		End
    End

  End
End
									; NOTHING on this line can be present
			VoiceAttack 							= HeroUrukHaiVoiceAttack
			VoiceAttackAir							= HeroUrukHaiVoiceAttack
			VoiceAttackCharge 						= HeroUrukHaiVoiceAttack
			VoiceAttackMachine 						= HeroUrukHaiVoiceAttack
			VoiceAttackStructure 					= HeroUrukHaiVoiceAttack
			VoiceCreated							= HeroUrukHaiVoiceSalute
			VoiceFear								= HeroUrukHaiVoiceHelpMe
			VoiceFullyCreated						= HeroUrukHaiVoiceSalute
			VoiceGuard								= HeroUrukHaiVoiceMove
			VoiceMove 								= HeroUrukHaiVoiceMove
			VoiceMoveToCamp 						= HeroUrukHaiVoiceMove
			VoiceMoveWhileAttacking 				= HeroUrukHaiVoiceMove
			VoicePriority							= 95
			VoiceRetreatToCastle 					= HeroUrukHaiVoiceMove
			VoiceSelect 							= HeroUrukHaiVoiceSelectMS
			VoiceSelectBattle  						= HeroUrukHaiVoiceSelectBattle
		
			SoundImpact								= ImpactHorse
		
			UnitSpecificSounds
				VoiceEnterUnitElvenTransportShip	= HeroUrukHaiVoiceMove
				VoiceEnterUnitMordorMumakil			= HeroUrukHaiVoiceMove
				VoiceEnterUnitSlaughterHouse		= HeroUrukHaiVoiceMove
				VoiceEnterUnitTransportShip			= HeroUrukHaiVoiceMove
				VoiceGarrison						= HeroUrukHaiVoiceMove
				VoiceInitiateCaptureBuilding		= HeroUrukHaiVoiceCaptureBuilding
			End
		;End
WeaponSet
		Conditions		= None 
		Weapon			= PRIMARY    MegaUrukSword
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	CommandPoints 		= 10
End

Object AngmarSnowTrollHorde
	ButtonImage	= CPUruk
	SelectPortrait	= HICAHUrukhai
	
	Side			= Isengard
	EditorSorting		= UNIT
	EmotionRange		= 240
	DisplayName		= OBJECT:HordeIsengardFighter
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_AngmarSnowTrollHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_AngmarSnowTrollHorde
	
	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY    RohanRohirrimSpear
	End

	BuildCost		= 1400
	BuildTime		= ANGMAR_SNOWTROLL_BUILDTIME	
	CommandPoints 		= 90 	; originally 60		

	ShroudClearingRange 	= ANGMAR_SNOWTROLL_SHROUD_RANGE       
	VisionRange 		= ANGMAR_SNOWTROLL_HORDE_VISION_RANGE
	
	VisionSide = 50%
	VisionRear = 25%
	
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%	
	
		
	CrushableLevel 			= 0  	//What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel 			= 0 

	CommandSet  = SuperElvenRivendellLancerCommandSet
		
	FormationWidth = 2 	;// Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 2 	;// Depth it occupies in formations. Current choices are 1 or 2.
	
	TransportSlotCount	= TRANSPORTSLOTCOUNT_LARGE_HORDE
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain6
		FrontAngle 		= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload		= AngmarSnowTroll 9
		PassengerFilter		= NONE +CAVALRY 
		Slots			= 9
		ShowPips		= No

		ThisFormationIsTheMainFormation = Yes	;//Used to determine which armorset to use (and anything else we want!)
		
		MeleeBehavior = Amoeba
		End

		; Banner Carrier info		
		BannerCarriersAllowed	= IsengardBannerOrc ; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarSnowTroll	Pos:X:60.0 Y:0		; (DEFAULT) position of banner carrier for fighter horde		
		
		RankInfo		= RankNumber:1 UnitType:AngmarSnowTroll Position:X:30 Y:-25			Position:X:30 Y:0			Position:X:30 Y:25			;Position:X:30 Y:50			Position:X:25 Y:-50
		RankInfo		= RankNumber:2 UnitType:AngmarSnowTroll Position:X:0  Y:-25	Leader 1 0 	Position:X:0  Y:0 	Leader 1 1	Position:X:0  Y:25 	Leader 1 2	;Position:X:0 Y:-30 Leader 1 3		Position:X:0 Y:-30 Leader 1 4
                RankInfo		= RankNumber:3 UnitType:AngmarSnowTroll Position:X:-30  Y:-25	Leader 2 0 	Position:X:-30  Y:0 	Leader 2 1	Position:X:-30  Y:25 	Leader 2 2	;Position:X:-30 Y:-30 Leader 2 3	Position:X:-25 Y:-30 Leader 2 4

		RanksToReleaseWhenAttacking = 1 2
		
		UseSlowHordeMovement = Yes
		MeleeAttackLeashDistance = 150 ;// How far the hordes can move from the center of the horde when melee attacking.

	End
End
	ButtonImage		= WOR_UrukWarriors
	SelectPortrait	= UPIsenguard_UrukHai
End

CommandButton Command_ChillSoul
  Command                 = FIRE_WEAPON 
  Options		  = NONPRESSABLE 
  TextLabel               = CONTROLBAR:SpecialAbilityChillSoul
  ButtonImage             = KUChillSoulIcon
  ButtonBorderType        = ACTION 
  DescriptLabel           = CONTROLBAR:ToolTipSpecialAbilityChillSoul
  InvalidCursorName       = GenericInvalid
;  UnitSpecificSound       = 
  InPalantir			  = Yes
End

CommandSet OminiCommandset
	1 	= Command_ToggleStance	
	2	= Command_ChillSoul
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End



ChildObject AngmarHillTroll IsengardOrcOverseer
	VoiceAttack								= GoblinWarriorVoiceAttack
	VoiceAttackCharge						= GoblinWarriorVoiceAttackCharge
	VoiceAttackMachine						= GoblinWarriorVoiceAttack
	VoiceAttackStructure					= GoblinWarriorVoiceAttackBuilding
	VoiceCreated							= EVA:GoblinWarriorCreated
	VoiceFullyCreated						= EVA:GoblinWarriorCreated
	VoiceGuard								= GoblinWarriorVoiceGuard
	VoiceMove								= GoblinWarriorVoiceMove
	VoiceMoveOverWalls						= GoblinWarriorVoiceMoveWalls
	VoiceMoveToCamp							= GoblinWarriorVoiceMoveCamp
	VoiceMoveWhileAttacking					= GoblinWarriorVoiceDisengage
	VoicePriority							= 30
	VoiceRetreatToCastle					= GoblinWarriorVoiceRetreat
	VoiceSelect								= GoblinWarriorVoiceSelectMS
	VoiceSelectBattle 						= GoblinWarriorVoiceSelectBattle

	VoiceEnterStateAttack					= GoblinWarriorVoiceEnterStateAttack
	VoiceEnterStateAttackCharge				= GoblinWarriorVoiceEnterStateAttackCharge
	VoiceEnterStateAttackMachine			= GoblinWarriorVoiceEnterStateAttack
	VoiceEnterStateAttackStructure			= GoblinWarriorVoiceEnterStateAttackBuilding
	VoiceEnterStateMove						= GoblinWarriorVoiceEnterStateMove
	VoiceEnterStateMoveOverWalls			= GoblinWarriorVoiceEnterStateMoveWalls
	VoiceEnterStateMoveToCamp				= GoblinWarriorVoiceEnterStateMoveCamp
	VoiceEnterStateMoveWhileAttacking		= GoblinWarriorVoiceEnterStateDisengage
	VoiceEnterStateRetreatToCastle			= GoblinWarriorVoiceEnterStateRetreat

	SoundImpact								= ImpactHorse

	UnitSpecificSounds
		VoiceEnterUnitEvilMenTransportShip	= GoblinWarriorVoiceMoveShip
		VoiceEnterUnitMordorMumakil			= GoblinWarriorVoiceMoveGarrison
		VoiceEnterUnitSlaughterHouse		= GoblinWarriorVoiceMoveGarrison
		VoiceGarrison						= GoblinWarriorVoiceMoveGarrison
		VoiceInitiateCaptureBuilding		= GoblinWarriorVoiceCaptureBuilding
	End

	CrowdResponseKey = Goblin
	ButtonImage		= WOR_GoblinFighters
	SelectPortrait		= UPWild_GoblinWarrior
ReplaceModule ModuleTag_01
 Draw = W3DScriptedModelDraw ModuleTag_016

	  OkToChangeModelColor = Yes
	  
    DefaultModelConditionState
      Model = IUOvrseer_SKN
	ParticleSysBone   = NONE TaintSwampDrops1 FollowBone:Yes
    End

	IdleAnimationState
		Animation = IDLA
	    AnimationName = IUOvrseer_SKL.IUOvrseer_IDLA
	    AnimationMode = ONCE
			AnimationPriority = 15
		End
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
		StateName = Idle
	End
 
	AnimationState = MOVING BACKING_UP
		Animation = BackingUp
			AnimationName = IUOvrSeer_SKL.IUOvrSeer_BAKA
			AnimationMode = LOOP
		End
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
		Flags = RANDOMSTART
	End
	
	AnimationState = MOVING EMOTION_TERROR
		Animation = Moving
			AnimationName = IUOvrseer_SKL.IUOvrseer_RUNA
		    AnimationMode = LOOP
		End
		Flags = RANDOMSTART
		ParticleSysBone = None InfantryDustTrails
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
    End
 
    AnimationState = MOVING
			Animation = Moving
	      AnimationName = IUOvrseer_SKL.IUOvrseer_RUNA
		    AnimationMode = LOOP
			End
			Flags = RANDOMSTART
			ParticleSysBone = None InfantryDustTrails
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
    End

	AnimationState							= EMOTION_UNCONTROLLABLY_AFRAID
		Animation							= FERA
			AnimationName					= IUOvrseer_SKL.IUOvrseer_FERA
			AnimationMode					= LOOP
		End
		Flags = RANDOMSTART
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
	End
	
    AnimationState = ATTACKING
			Animation = Attacking
	      AnimationName = IUOvrseer_SKL.IUOvrseer_ATKA
		    AnimationMode = LOOP
			End
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
    End

    AnimationState = DYING
			Animation = Dying
	      AnimationName = IUOvrseer_SKL.IUOvrseer_DIEA
		    AnimationMode = ONCE
			End
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
    End
    
    AnimationState = WAR_CHANT
		Animation = Chant
			AnimationName = IUOvrseer_SKL.IUOvrseer_IDLA
			AnimationMode = LOOP
		End
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
	End
	
			
	;-emotions--
	AnimationState							= EMOTION_AFRAID
		Animation							= FERA
			AnimationName					= IUOvrseer_SKL.IUOvrseer_FERA
			AnimationMode					= LOOP
		End
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
		Flags = RANDOMSTART
	End
	AnimationState							= EMOTION_TAUNTING
		Animation							= TNTA
			AnimationName					= IUOvrseer_SKL.IUOvrseer_TNTA
			AnimationMode					= LOOP
		End
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
	End
	AnimationState							= EMOTION_POINTING
		Animation							= Pointing1
			AnimationName					= IUOvrseer_SKL.IUOvrseer_PNTA
			AnimationMode					= LOOP
		End
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
	End
	AnimationState							= EMOTION_CELEBRATING
		Animation                           = CHRA
			AnimationName					= IUOvrseer_SKL.IUOvrseer_CHRA
			AnimationMode					= ONCE
		End
ParticleSysBone   = NONE WizardTowerStormClouds1 FollowBone:Yes
	End
  End
End
	ButtonImage		= WOR_UrukWarriors
	SelectPortrait	= UPIsenguard_UrukHai
  CommandPoints = 5

  ArmorSet
    Conditions      = None
    Armor           = HeroArmor
    DamageFX        = None
  End
ReplaceModule ModuleTag_02
  Body = ActiveBody ModuleTag_025
    MaxHealth         = 100 ;BALANCE Laborer Health
    MaxHealthDamaged  = 5
    ;RecoveryTime      = 5000
  End
End
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    MordorWarriorAxe
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
End

Weapon ChillSoulRadiusWeapon0 ; Shot out every DelayBetweenShots
	RadiusDamageAffects = ENEMIES NOT_SIMILAR
	LeechRangeWeapon      = Yes
	AttackRange           = 50.0
	MeleeWeapon           = No
	DelayBetweenShots     = 200            ; time between shots, msec
	PreAttackDelay        = 0 ;PreAttackDelay+FiringDuration = UseWeaponTiming = Yes duration
	PreAttackType         = PER_SHOT 
	FiringDuration        = 0 

	DamageNugget                  ; A basic Nugget that just does damage
		Damage        = 1		; A whole lot of damage.
		DamageScalar  = 0% NONE +STRUCTURE +MordorBalrog +AngmarShadeWolf
		Radius        = CHILL_SOUL_EFFECT_RADIUS
		DelayTime     = 0
		DamageType    = MAGIC
		DamageFXType  = MAGIC
		DeathType     = CRUSHED
	End
	AttributeModifierNugget
		AttributeModifier = ChillSoulModifier
		DamageFXType = SWORD_SLASH  ;used to cross with their DamageFX listing to determine what effect to play
	End

End

Object AngmarHillTrollHorde
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End
	ButtonImage		= WOR_GoblinFighters
	SelectPortrait		= UPWild_GoblinWarrior
  CommandPoints = 60
	BuildCost		= 80
	BuildTime		= 20
	CommandSet  		= OminiCommandset
ReplaceModule ModuleTag_HordeContain
	Behavior = HordeContain ModuleTag_HordeContain5
		FrontAngle 		= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload		= AngmarHillTroll 12
		PassengerFilter		= NONE +INFANTRY
		Slots			= 12
		ShowPips		= No

		ThisFormationIsTheMainFormation = Yes	;//Used to determine which armorset to use (and anything else we want!)
		
		MeleeBehavior = Amoeba
		End

		; Banner Carrier info		
		BannerCarriersAllowed	= IsengardBannerOrc  ; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarHillTroll	Pos:X:60.0 Y:6.5	; (DEFAULT) position of banner carrier for fighter horde		
		
		RankInfo		= RankNumber:1 UnitType:AngmarHillTroll Position:X:30 Y:-25		Position:X:30 Y:0		Position:X:30 Y:25		Position:X:30 Y:50			;Position:X:25 Y:-50
		RankInfo		= RankNumber:2 UnitType:AngmarHillTroll Position:X:0 Y:-5  Leader 1 0	Position:X:0 Y:20 Leader 1 1	Position:X:0 Y:45 Leader 1 2	Position:X:0 Y:-30 Leader 1 3		;Position:X:0 Y:-30 Leader 1 4
		RankInfo		= RankNumber:3 UnitType:AngmarHillTroll Position:X:-30 Y:-5  Leader 2 0	Position:X:-30 Y:20 Leader 1 1	Position:X:-30 Y:45 Leader 1 2	Position:X:-30 Y:-30 Leader 1 3		;Position:X:0 Y:-30 Leader 1 4
		RanksToReleaseWhenAttacking = 1 2
		
		UseSlowHordeMovement 	= Yes
		MeleeAttackLeashDistance = 150 ;// How far the hordes can move from the center of the horde when melee attacking.

		AlternateFormation 	= AngmarHillTrollPorcupine
	End
End
AddModule
	Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
		FireWeaponNugget
			WeaponName = ChillSoulRadiusWeapon0
			Offset = X:0 Y:0 Z:0
			FireDelay = 0
			OneShot = No
		End
	End
End
End


Object IsengardWargSentry
AddModule
      	Behavior = AttributeModifierUpgrade ModuleTag_Reinforcedwf6786688
		TriggeredBy				= Upgrade_WildSpiderVenomSackScience
		AttributeModifier		= WargAttack
	End
      End
End


