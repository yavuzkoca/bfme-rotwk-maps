;;;;;;;;;;;;;;;;;;;;;==========================================================================================================;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                                                                
;  Scripted By   ;;;;          ;;;;;;;;;  ;;       ;;;;;;;;;;         ;;       ;;;     ;;                           ;;;;;      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                
;;;;;;;;;;;;;;;;;;;;;          ;;;;;;;;;  ;;       ;;;;;;;;;;         ;;;     ;;;;     ;;;         ;;;;;;   ;;    ;;;;;;       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                            
;;;;;;;;;;;;;;;;;;;;;          ;;         ;;       ;;                 ;; ;; ;;; ;;     ;;;        ;;        ;;   ;;;;          ;;;   CROATIA (Europe)  ;;;;;                         
;;;;;;;;;;;;;;;;;;;;;          ;;         ;;       ;;                 ;; ;;;;;  ;;    ;;;;;      ;;         ;;  ;;;            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                       
;;From - 15.1.2013  ;          ;;         ;;       ;;;;;;;;;;         ;;  ;;;   ;;   ;;; ;;      ;          ;;  ;;             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                      
;;;;;;;;;;;;;;;;;;;;;          ;;;;;;;;   ;;       ;;;;;;;;;;         ;;   ;    ;;   ;;  ; ;    ;;          ;;  ;;             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                      
;;;;;;;;;;;;;;;;;;;;;          ;;;;;;;;   ;;       ;;                 ;;        ;;  ;;;   ;;    ;   ;;;;;   ;;  ;;             ;;;;;;    BARANJA   ;;;;;;;;;                      
;;To - 1.11.2013  ;;          ;;         ;;       ;;                 ;;        ;;  ;;;;;;;;;   ;       ;;  ;;  ;;             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                      
;;;;;;;;;;;;;;;;;;;;;          ;;         ;;       ;;                 ;;        ;;  ;;;;;;;;;   ;;       ;  ;;  ;;;            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                       
;;;;;;;;;;;;;;;;;;;;;          ;;         ;;       ;;                 ;;        ;; ;;;      ;;   ;       ;  ;;   ;;            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                       
;;;;;;;;;;;;;;;;;;;;;          ;;;;;;;;;  ;;;;;;;; ;;                 ;;        ;; ;;;      ;;   ;;     ;;  ;;   ;;;;;;;;;     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                              
;;;;;;;;;;;;;;;;;;;;;          ;;;;;;;;;  ;;;;;;;; ;;                 ;;        ;; ;;        ;;   ;;;;;;;   ;;     ;;;;;;      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;                                                                                                          ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;                                                                                                          ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;==========================================================================================================;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;E-mail
;Elf.Magic.Bfme@gmail.com 



 ;;;;;     A WORD FROM THE AUTHOR :
 ;;;;;     I'm Elf Magic From Croatia (Europe) Region Baranja - This Map i started to create 15.1.2013 and finished 1.11.2013. 
 ;;;;;     in this map I have invested a lot of Effort & Time sometimes even 18 Hours a day,
 ;;;;;     So Please do not touch anything and Don't Edit any Staff in this map.
 ;;;;;     This Map Have Only my Author Rights. You can Learn from this map  but don't touch Anything.
 ;;;;;     This map.ini is specially created for my map : Crystals Of Ancient Ents   
 ;;;;;     I Made Whole map in ROTWK World Builder With no patch and map will work only With ROTWK Expansion
 ;;;;;     I Repeat Map Will Not Work On BFME2 Because on this map are Units From Witchking And that Units Don't Exist in BFME2 Or BFME1.                                                                                                        
 ;;;;;     This map.ini was created studying: The ini.big files from the LOTR BFME 2 ROTWK game folder (extracted with FinalBig soft);
 ;;;;;     & Other map.ini from custom maps downloaded over the internet; And Lots & Lots Unsleeped Nights and testing Whole this Lines Below
 ;;;;;     I have exported most of the animations into ###Anims.inc files that you can find in the same folder, Without This Anims.inc Game will not work 







;-------------------First i'm Gonna Modified Player's On My Map----------------------------------------------

PlayerTemplate FactionMen
StartingUnit1 = NONE                      ;;;;;  So no starting builders
StartingUnit0 = NONE
StartingBuilding = NONE                   ;;;;;  No starting fortress. This will triger the instant defeat of the faction if you don't manualy plant another building for it on the map
BuildableHeroesMP		= RohanEowyn RohanEomer GondorBoromir RohanTheoden GondorFaramir GondorAragornMP GondorGandalf 
End

PlayerTemplate FactionElves
StartingUnit1 = NONE
StartingUnit0 = NONE
StartingBuilding = NONE
BuildableHeroesMP		= ArnorCaptain ElvenHaldir ElvenArwen ElvenThranduil ElvenElrond
End


PlayerTemplate FactionDwarves
StartingUnit1 = NONE
StartingUnit0 = NONE
StartingBuilding = NONE
BuildableHeroesMP			= DwarvenGloin DwarvenDain
End

PlayerTemplate FactionIsengard       ;This will Be Enemy On My Map
StartingUnit1 = NONE
StartingUnit0 = NONE
StartingBuilding = NONE
	Side              			= Isengard
	PlayableSide      			= Yes
	Evil			  		= Yes
	StartMoney        			= 0
	MaxLevelMP				= 3000
	MaxLevelSP				= 3000
	PreferredColor				= R:216 G:175 B:48
	IntrinsicSciences			= SCIENCE_EVIL
	IntrinsicSciencesMP			= SCIENCE_ISENGARD
	DefaultPlayerAIType 			= IsengardSkirmishAI
	SpellBook				= EvilSpellBook
	SpellBookMp				= IsengardSpellBook_New            ; I Give Here Isengard Player Complete new List Of Spells Modifed Below
	PurchaseScienceCommandSet		= IsengardSpellBookCommandSet_New  ; I Give Here Isengard Player Complete new List Of Spells Modifed Below
	PurchaseScienceCommandSetMP		= IsengardSpellStoreCommandSet_New ; I Give Here Isengard Player Complete new List Of Spells Modifed Below
	DisplayName				= INI:FactionIsengard
	BeaconName				= MultiplayerBeacon
	LightPointsUpSound			= IsengardLightPointsUp
	ObjectiveAddedSound			= Gui_MissionObjectiveNew
	ObjectiveCompletedSound			= Gui_MissionObjectiveCompleted

	// NOTE: It is very important that the create-a-hero be the first buildable hero, to ensure that the create-a-hero and the ring hero are always 
	// attached to the first two buttons in the command set.

	BuildableHeroesMP			= IsengardLurtz IsengardSharku IsengardSaruman MordorGothmog MordorMouthOfSauron WildShelob AngmarKarsh MordorWitchKingOnFellBeast AngmarRogash
	BuildableRingHeroesMP			= MordorSauron_RingHero
	InitialUpgrades				= Upgrade_IsengardDualEconomyChoice Upgrade_IsengardFaction Upgrade_EvilDualEconomyChoice Upgrade_MordorDualEconomyChoice Upgrade_MordorFaction Upgrade_EvilDualEconomyChoice
	SpellStoreCurrentPowerLabel 		= APT:SpellStoreCurrentRingPower
	SpellStoreMaximumPowerLabel 		= APT:SpellStoreMaximumRingPower
	ResourceModifierObjectFilter 		= RESOURCE_MODIFIER_OBJECT_FILTER
	ResourceModifierValues			= 100 100 100 100 90 85 80 75 71 68 66
	MultiSelectionPortrait			= UPIsengard_Army
	LoadScreenMusic				= Shell2MusicForLoadScreen
End

;===================================================Here i Will Change Isengard List Of Spells==================================================================================

CommandSet IsengardSpellBookCommandSet_New   ; This is for the buttons in the left side of the screen - the spells you have purchased
        1 = Command_SpellBookCrebain
        2 = Command_SpellBookEyeofSauron
        3 = Command_SpellBookAwakenWyrm

        4 = Command_SpellBookFreezingRain 
        5 = Command_SpellBookSummonWights
        6 = Command_SpellBookSummonShadeOfWolf
	7 = Command_SpellBookWatcherAlly

	8 = Command_SpellBookBalrogAlly
	9 = Command_SpellBookDarkness
	10 = Command_SpellBookWarChant
	11 = Command_SpellBookDragonStrike
        12 = Command_SpellBookDragonAlly

End

CommandSet IsengardSpellStoreCommandSet_New   ; This is when you open the Spellbook where you wanna purchase a spell
        1 = Command_PurchaseSpellCrebain 
	2 = Command_PurchaseSpellEyeofSauron
        3 = Command_PurchaseSpellAwakenWyrm

        4 = Command_PurchaseSpellFreezingRain
        5 = Command_PurchaseSpellSummonWights 
        6 = Command_PurchaseSpellSummonShadeOfWolf
	7 = Command_PurchaseSpellWatcherAlly

	8 = Command_PurchaseSpellBalrogAlly
	9 = Command_PurchaseSpellDarkness
	10 = Command_PurchaseSpellWarChant
	11 = Command_PurchaseSpellDragonStrike
        12 = Command_PurchaseSpellDragonAlly
End



;;;;;---------------------------------------Here is Changed Spells which will be used For Isengard Enemy Player-----------------------------------------------------------------------------------------------



Object IsengardSpellBook_New

AddModule ModuleTag_Crebain_New
                Behavior                        = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	        = SpellBookCrebain
		OCL				= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= Yes
		RequirementsFilterMPSkirmish    = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic     = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
        End
AddModule ModuleTag_OCLEyeOfSauron_New
	Behavior = OCLSpecialPower	ModuleTag_OCLEyeOfSauron
		SpecialPowerTemplate	= SpellBookEyeofSauron
		OCL						= SUPERWEAPON_SpawnEyeOfSauron
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
        End
AddModule ModuleTag_AwakenWyrm_New
	Behavior = OCLSpecialPower ModuleTag_AwakenWyrm
		SpecialPowerTemplate = SpellBookAwakenWyrm
		OCL                  = OCL_Wyrm
		TriggerFX			 = FX_WrymSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
        End
AddModule ModuleTag_FreezingRain_New
	Behavior = FreezingRainSpecialPower ModuleTag_FreezingRain
		SpecialPowerTemplate			= SpellBookFreezingRain
		AttributeModifierAffects		= ALL ENEMIES
		AntiCategory					= LEADERSHIP
;		AntiFX							= FX_AntiLeadership ; FX for anti category
		AttributeModifierWeatherBased	= Yes
		WeatherDuration					= SPELL_FREEZINGRAIN_DURATION
		ChangeWeather					= RAINY
		AvailableAtStart				= Yes
		BurnRateModifier				= -100
		BurnDecayModifier				= 20
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
        End
AddModule ModuleTag_SummonWights_New
	Behavior = OCLSpecialPower ModuleTag_SummonWights
		SpecialPowerTemplate 		= SpellBookSummonWights
		OCL                  		= OCL_SpellBookSummonBarrowWights
		TriggerFX	 		= FX_SummonWights ;FX_SummonWildmen
		CreateLocation       		= CREATE_AT_LOCATION
		AvailableAtStart	 	= Yes
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
        End
AddModule ModuleTag_SummonShadeOfWolf_New
	Behavior = OCLSpecialPower ModuleTag_SummonShadeOfWolf
		SpecialPowerTemplate = SpellBookSummonShadeOfWolf
		OCL                  = OCL_ShadeofWolfSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
        End
AddModule ModuleTag_SummonWatcher_New
	Behavior = OCLSpecialPower ModuleTag_SummonWatcher
		SpecialPowerTemplate = SpellBookWatcherAlly
		OCL                  = OCL_WatcherSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End

        End
AddModule ModuleTag_SummonBalrog_New
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
        End
AddModule ModuleTag_Darkness_New  
                Behavior   = DarknessSpecialPower ModuleTag_Darkness
		SpecialPowerTemplate			= SpellBookDarkness
		AttributeModifier			= SpellBookDarkness
		AttributeModifierAffects		= ANY -INFANTRY -CAVALRY -MONSTER -HERO -HORDE ALLIES
		AttributeModifierWeatherBased	        = Yes			
		WeatherDuration				= 360000 
		ChangeWeather				= CLOUDY
		AvailableAtStart			= Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
AddModule ModuleTag_SpellBookWarChant_New
                Behavior = SpecialPowerModule SpellBookWarChant_ModuleTag
		SpecialPowerTemplate		= SpellBookWarChant
		AttributeModifier		= SpellBookWarChant
		AttributeModifierRange		= 100
		AttributeModifierAffects	= GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
		TriggerFX			= FX_SpellWarChant
		UpdateModuleStartsAttack	= No
		AvailableAtStart		= Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
AddModule ModuleTag_DragonStrike_New
	Behavior = OCLSpecialPower ModuleTag_DragonStrike
		SpecialPowerTemplate = SpellBookDragonStrike
		OCL                  = OCL_SpellBookDragonStrike
		CreateLocation       = CREATE_AT_EDGE_NEAR_TARGET_AND_MOVE_TO_LOCATION
		AvailableAtStart	 = Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
AddModule ModuleTag_DragonAlly_New
	Behavior = OCLSpecialPower ModuleTag_DragonAlly
		SpecialPowerTemplate = SpellBookDragonAlly
		OCL                  = OCL_SummonedDragon
		TriggerFX			 = FX_SummonDragon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = Yes
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
        End
     CommandSet = IsengardSpellBookCommandSet_New
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject IsengardChildSpellBook_New IsengardSpellBook_New
     CommandSet = IsengardSpellBookCommandSet_New
End

;---------------------------------------------------------------------------------------------------------------------------------------------------

Object ArnorForbiddenPool         ;Change this to be Pathable, That means units Can walk trough this
  
KindOf              = IMMOBILE PATH_THROUGH_EACH_OTHER
End

;---------------------------------------------------------------------------------------------------------------------------------------------------

Object ElvenGaladriel

RemoveModule ModuleTag_ElvenCamouflage ; no more invisibility

EvaEnemyObjectSightedEvent = None

ReplaceModule ModuleTag_DRAW           ; I Will Add Galadriel Some Spraklings Around Her                            
Draw = W3DScriptedModelDraw ModuleTag_DRAW_Override
		 DefaultModelConditionState
			Model = EUGaldrlGd_SKN
		        ParticleSysBone     = FXBone MagicDoor Followbone:YES
		        ParticleSysBone     = B_PELVIS SparklesMith FollowBone:Yes     ; The white  sparks effect taken from the goblin mineshaft ;  THIS IS A WINNER TOO ! 
		        ParticleSysBone     = NONE WindRiderFoot FollowBone:Yes          ; Yellow glowing footsteps from Glorfindel's WindRider spell
		        ParticleSysBone     = None UpgradeBuildingDwarvenFortressRipples ; Beautiful temporary yellow ripples
		        ParticleSysBone     = None UntamedAllegiance2                      ; Bluish ripples                         
		        ParticleSysBone     = None UntamedAllegiance                       ; Other yellow ripples  Taken from WargLair (Natural)
		        ParticleSysBone	    = None CloudBreakRays  ;  Golden Arrow's sunray
		        ParticleSysBone	    = None GpuParticleTest4 FollowBone:Yes
		 End
 
		#include "GaladrielAnims.inc"         ; There you'll find Galdriel's animations

End
End
End

;------------------------------------------  This Particle is The Same As original i only Change Size of Glowing Embers
FXParticleSystem WallofEmbers
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEmbersLight.tga
    Lifetime = 200 200
    SortLevel = 1
    Size = 40 40
    BurstCount = 5 5
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color2 = R:210 G:121 B:32 120
    Color3 = R:0 G:0 B:0 200
  End
  Update = DefaultUpdate
    SizeRate = 0.1 0.1
    SizeRateDamping = 0.99 0.99
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.8 0.85
    DriftVelocity = X:0 Y:0 Z:1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.4 0.4
    Y = -0.4 0.4
    Z = 0 1
  End
  EmissionVolume = BoxEmissionVolume
    HalfSize = X:75 Y:10 Z:0
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.9
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
  End
End
;---------------------------------------------------------------------------------------
FXParticleSystem MtDoomInner1   ; This Will be Huge Glowing Embers For my Big Pit In Isengard
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEmbersLight.tga
    Lifetime = 200 200
    SortLevel = 1
    Size = 70 70
    BurstCount = 5 5
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color2 = R:210 G:121 B:32 120
    Color3 = R:0 G:0 B:0 200
  End
  Update = DefaultUpdate
    SizeRate = 0.1 0.1
    SizeRateDamping = 0.99 0.99
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.8 0.85
    DriftVelocity = X:0 Y:0 Z:1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.4 0.4
    Y = -0.4 0.4
    Z = 0 1
  End
  EmissionVolume = BoxEmissionVolume
    HalfSize = X:75 Y:10 Z:0
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.9
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
  End
End

;=============================================================================================

Object GBGHGenGazB    ;I Add Some Falling Sparklings From Above To This Structure

ReplaceModule ModuleTag_Draw	
         Draw = W3DScriptedModelDraw ModuleTag_Draw_new
		OkToChangeModelColor  = Yes
		UseStandardModelNames = Yes

		DefaultModelConditionState
			Model = GBGHGenGazB
                        ParticleSysBone     = NONE Pointer FollowBone:Yes
                        ParticleSysBone     = NONE GpuParticleTest4 FollowBone:Yes
		End
	End
End
End
;---------------------------------------------------------------------------------------------------
Object WaterReflectionSkydome_GapOfRohan   ;Now This Cine SkyDome Can be Seen in Game
Scale = 0.60

ReplaceModule ModuleTag_01
      Draw = W3DScriptedModelDraw ModuleTag_01New
         DefaultModelConditionState
         Model = skybox_day   ; Here I Change original with Blue Sky Cine Object
       End
    End
END
KindOf = PRELOAD IMMOBILE UNATTACKABLE INERT INERT_SHROUD_REVEALER
End
;----------------------------------------------------------------------------------------------------------------------------------------------
Object WaterReflectionSkydome_DarkCloud3    ;Now This Cine SkyDome Can be Seen in Game
Scale = 0.40
ReplaceModule ModuleTag_01
      Draw = W3DScriptedModelDraw ModuleTag_01New
         DefaultModelConditionState
      Model = SkyBoxNight   ; Here I Change original with Dark Sky Cine Object
      ParticleSysBone = LightningNode SkyBoxNightLightning
      ParticleSysBone = None RainOfFireFlareNoTrails
       End
    End
END
KindOf = PRELOAD IMMOBILE UNATTACKABLE INERT INERT_SHROUD_REVEALER
End
;----------------------------------------------------------------------


FXParticleSystem MtDoomFireballs
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXSmokePuf07.tga
    PerParticleAttachedSystem = MtDoomFireBallFire
    Lifetime = 500 500
    SortLevel = 1
    Size = 1 1
    BurstDelay = 1 1
    BurstCount = 0 1.1
  End
  Color = DefaultColor
    Color1 = R:131 G:75 B:20 0
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.1 0.1 0
    Alpha2 = 0 0 500
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = -0.2
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -5 5
    Y = -5 5
    Z = 9 13
  End
  EmissionVolume = SphereEmissionVolume
    IsHollow = Yes
    Radius = 5
  End
  Draw = DefaultDraw
  End
End
;---------------------------------------------------------
FXParticleSystem MtDoomFireBallFire
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXexplo03.tga
    Lifetime = 30 30
    SortLevel = 1
    Size = 10 15
    BurstCount = 1 3
  End
  Color = DefaultColor
    Color2 = R:121 G:77 B:17 2
    Color3 = R:121 G:71 B:17 15
    Color4 = R:0 G:0 B:0 30
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.5 0.75 0
    Alpha2 = -0.5 0 120
  End
  Update = DefaultUpdate
    SizeRate = 2 3
    SizeRateDamping = 0.85 0.9
    AngleZ = -7 7
    AngularRateZ = -0.1 0.1
    AngularDamping = 0.9 0.95
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 0.95
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
End
;---------------------------------------------------------
Object PTFramvg08   ;This Will be Background for my Isengard I change this Model with Embers & Smoke

 KindOf = IMMOBILE PATH_THROUGH_EACH_OTHER
ReplaceModule ModuleTag_01
      Draw = W3DScriptedModelDraw ModuleTag_01New
    DefaultModelConditionState
         Model = None
      ParticleSysBone = None MtDoomInner1
      ParticleSysBone = None MtDoomFireballs
      ParticleSysBone = None MtDoomFireBallFire
       End
     End
  End
End


;==============================================================================================================================================
;========================= Below I Will change Texture Color Of Some Structures Because I Didn't Like original Colors ===========================
;_______________________________________________________________________________________________________________________________________________

Object EreborThrone          
ReplaceModule ModuleTag_01
       Draw = W3DScriptedModelDraw ModuleTag_01_new
       RandomTexture = dbundrmine.tga 0 EB_Wall01.tga
       OkToChangeModelColor = Yes
			
       DefaultModelConditionState
	       Model = EB_throne
	End
     End
  End
End
;-----------------------------------------------------------------------------

Object MenTrebuchetExpansion          
ReplaceModule ModuleTag_Draw
       Draw = W3DScriptedModelDraw ModuleTag_Draw_new
       RandomTexture = PTLoth02.tga 0 GBFortress1.tga
		OkToChangeModelColor	= Yes
		UseStandardModelNames	= Yes
		StaticModelLODMode		= Yes // Will append M or L to the skin name depending on GameLOD
        
			
       DefaultModelConditionState
	       Model = GBFTRTOWA
	End
     End
  End
End
;------------------------------------------------------------------------------
Object EBGarrisonableTower          
ReplaceModule ModuleTag_Draw
	Draw = W3DScriptedModelDraw ModuleTag_Draw_new
        RandomTexture = PTLoth02.tga 0 EB_Wall01.tga	
		ExtraPublicBone = ARROW_01
		ExtraPublicBone = ARROW_02
		ExtraPublicBone = ARROW_03
		ExtraPublicBone = ARROW_04
		ExtraPublicBone = ARROW_05
		ExtraPublicBone = ARROW_06
		ExtraPublicBone = ARROW_07
		ExtraPublicBone = ARROW_08
		ExtraPublicBone = ARROW_09
		ExtraPublicBone = ARROW_10
		ExtraPublicBone = ARROW_11
		ExtraPublicBone = ARROW_12
		
		OkToChangeModelColor  = Yes
		UseStandardModelNames = Yes
		DefaultModelConditionState
			Model = EB_tower3
			WeaponLaunchBone =   PRIMARY ARROW_
		End
         End
    End
End
;-------------------------------------------------------------------------------

Object RohanCastleElevator

ReplaceModule ModuleTag_01        
  Draw = W3DScriptedModelDraw ModuleTag_01_new
             RandomTexture = PTLoth02.tga 0 RBgate.tga
             RandomTexture = PTLoth02.tga 0 RBCastELEV.tga
		OkToChangeModelColor = Yes

		ExtraPublicBone = Elev01
		ExtraPublicBone = Elev02
		ExtraPublicBone = Elev03
		ExtraPublicBone = Elev04

	    WallBoundsMesh = P1

         DefaultModelConditionState
         Model = RBCastELEV
	End
     End
  End
End

;-------------------------------------------------------------------------------
Object RohanCastleWall

ReplaceModule Draw_Wall
	Draw = W3DScriptedModelDraw Draw_Wall_new
             RandomTexture = PTLoth02.tga 0 RBgate.tga
			OkToChangeModelColor = Yes

	    WallBoundsMesh = P1

		DefaultModelConditionState
			Model = RBCastWALL 
		End
        End
    End
End
;---------------------------------------------------------------------------
Object RohanWallTower
 
ReplaceModule ModuleTag_Draw
  Draw = W3DScriptedModelDraw ModuleTag_Draw_new
    RandomTexture = PTLoth02.tga 0 RBgate.tga
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBWallTwr
    End
    
    WallBoundsMesh = wall1
    RampMesh1 = ramp1   
    RampMesh2 = ramp2 
    
     End
  End
End
;------------------------------------------------------------------
Object RohanWallJntO
 
ReplaceModule ModuleTag_Draw
  Draw = W3DScriptedModelDraw ModuleTag_Draw_new
    RandomTexture = PTLoth02.tga 0 RBgate.tga
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBWallJntO
    End
    
    WallBoundsMesh = wall1
        
     End
  End
End
;--------------------------------------------------------------------
Object RohanEdorasWall

ReplaceModule Draw_Wall
  Draw = W3DScriptedModelDraw Draw_Wall_new
    RandomTexture = PTLoth02.tga 0 RBgate.tga
		OkToChangeModelColor = Yes

	    WallBoundsMesh = P1

		DefaultModelConditionState
			Model = RBEdorWall 
		End
     End
  End
End
;--------------------------------------------------------------------
Object RivWalkRamp

ReplaceModule ModuleTag_Draw
  Draw = W3DScriptedModelDraw ModuleTag_Draw_new
    RandomTexture = PTLoth02.tga 0 RivBuilding1.tga
    OkToChangeModelColor  = Yes
    RampMesh1 = P1
     UseStandardModelNames = Yes
	ExtraPublicBone = SIEGELADDER

    DefaultModelConditionState
      Model = RivWalkRamp
    
       End
    End
  End
End

;-------------------------------------------------------------------------------

Object HighPass_FallingIceTower                    ; MODDING IT's TEXTURE (FROM WHITE-ICE TO DARK GREY) ; from civilianprop.ini

AddModule
	Behavior = GrantUpgradeCreate ModuleTag_1
	UpgradeToGrant  = Upgrade_GandalfWhite     ; Generic, just so we can use it below
	End 
End
AddModule
	Behavior = SubObjectsUpgrade Costume_3
	TriggeredBy	= Upgrade_GandalfWhite
	UpgradeTexture	= phighpasstower01.tga      0   slwall03.tga 
	UpgradeTexture	= phighpasstower01_nrm.tga  0   slwall03.tga 
	UpgradeTexture	= prockhighpass01.tga       0   slwall03.tga 
	UpgradeTexture	= prockhighpass01_nrm.tga   0   slwall03.tga
	RecolorHouse	= No
	End
    End
End

;===================================================================================================================================================
;=================================================== Making Of Blue Flaming Sword ===============================================================
;---------------------------------------------------------------------------------------------------------------------------------------------------



;;;;;--------------This is First Particle For My Blue Flaming Sword------------------------------------

FXParticleSystem AngForgeWorksGlowV3     ; This is Lower Blue Sparkle on Sword
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXFire01.tga ; EXLnzFlar2.tga ; EXSplatHaze.tga ;  EXGassmoke09.tga ;
    Lifetime = 5 5
    SortLevel = 1
    Size = 9 25         ; 5 10
    BurstCount = 4 6
    InitialDelay = 0 0 ; 15 15
    IsParticleUpTowardsEmitter = Yes
  End
    Color = DefaultColor
    Color2 = R:36 G:73 B:255 5
    Color3 = R:40 G:40 B:185 20
  End
  Update = DefaultUpdate
    SizeRate = -0.25 -0.25
    SizeRateDamping = 1 1
    AngleZ = -7 7
    AngularDamping = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:0 Y:0 Z:20 
    EndPoint = X:0 Y:0 Z:0
  End
  Draw = DefaultDraw
  End
End


;;;;;--------------This is Second Particle For My Blue Flaming Sword------------------------------------

FXParticleSystem AngForgeWorksFireV2    ; This is Blue Flame Above The Sword
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXFireScroll3.tga
    Lifetime = 40 40
    SortLevel = 1
    Size = 1 6
    BurstCount = 1 3
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color2 = R:11 G:3 B:143 3
    Color3 = R:16 G:4 B:238 5
  End
  Update = DefaultUpdate
    SizeRate = -0.25 -0.15
    SizeRateDamping = 0.99 0.99
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = 0.02
    VelocityDamping = 0.8 0.85
    DriftVelocity = X:0.2 Y:0 Z:1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 0 1
    Y = 0 1
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:-10 Y:0 Z:15     ; (Z) is hight of Flame in Air
    EndPoint = X:0 Y:0 Z:40        ;Here is where you want to put particle on object down or above head of object (Z) is Hight from ground
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.1
    WindAngleChangeMin = 0.149924
    WindAngleChangeMax = 0.449946
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
    TurbulenceAmplitude = 0.02
    TurbulenceFrequency = 25
  End
End
;;;;;--------------This is Third Particle For My Blue Flaming Sword------------------------------------

FXParticleSystem GpuParticleTest4  ; This is Blue Bouncing Particles Above Sword
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEmbersLight.tga
    Lifetime = 50 50
    SortLevel = 1
    Size = 10 50
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color2 = R:11 G:3 B:143 4
    Color3 = R:35 G:114 B:245 5
  End
  Alpha = DefaultAlpha
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = 0 7
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = 0.05          ;Here You Can Change Speed of particles if gravity is in + particles goes Up if is in - then goes down bigger value bigger gravity
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
    Z = -0.75 -0.25
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:0 Y:0 Z:400
    EndPoint = X:0 Y:0 Z:40
  End
  Draw = DefaultDraw
  End
End

;;;;;--------------This is Fourth Particle For My Blue Flaming Sword------------------------------------

FXParticleSystem GpuParticleTest2  ; This Will be blue Fireflies Around The Sword
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEmbersLight.tga
    Lifetime = 40 40
    Size = 80 80
    BurstCount = 1 1
    IsParticleUpTowardsEmitter = Yes
  End
  Color = DefaultColor
    Color1 = R:35 G:114 B:245 5
    Color2 = R:105 G:224 B:206 4
    End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Length = 75
  End
  Draw = DefaultDraw
  End
End


;-----------------Adding To Sword Blue Flames & Other Staff-----------------------------------------
Object SwordVerticle  
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER  ; I'll make it Pathable (so the units can walk through it)

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01New
    DefaultModelConditionState
      Model = PCorpsSword02
      ParticleSysBone = MANEBONE AngForgeWorksFireV2   ;This is Modified Particle from Above for Blue Flames Above The Swords
      ParticleSysBone = NONE AngForgeWorksGlowV3   ;This is Modified Particle From Above for Blue Sparks in Lower Part of The Swords
      ParticleSysBone = NONE GpuParticleTest4 FollowBone:Yes  ;This is Blue Bouncing Glowing Particles From Above
      ParticleSysBone = NONE GpuParticleTest2 FollowBone:Yes  ;This is Green Fireflies Around the Sword
    End
  End
End
  Geometry = BOX
  GeometryMajorRadius = 6.4
  GeometryMinorRadius = 4.8
  GeometryHeight = 9.6
  GeometryIsSmall = Yes
End

;------------------------------------------------------------------------------------------------------------------
;-------------------------------- Here I Gonna Make A Glowing Crystal ---------------------------------------------
;------------------------------------------------------------------------------------------------------------------
FXParticleSystem AngFordgeDoorOpen1   ;This particle Will be Blue Spinin Energy Down The Crystal
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEclipseBlur.tga
    BurstDelay = 40 40
    Lifetime = 40 40
    Size = 2 2
    SortLevel = 1
    BurstCount = 2 2
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color2 = R:15 G:65 B:238 5
    Color3 = R:0 G:0 B:0 60
  End
  Alpha = DefaultAlpha
  End
  Update = DefaultUpdate
    SizeRate = 3 5
    SizeRateDamping = 0.9 0.95
    AngleZ = -7 7
    AngularRateZ = -0.2 0.2
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    EndPoint = X:0 Y:0 Z:20
  End
  Draw = DefaultDraw
  End
End

;-------------------------------------------------
FXParticleSystem BeaconSmokeCF8744  ; This is Green Energy Down Below The Crystal
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXBarb.tga
    Lifetime = 55 55
    BurstDelay = 60 60
    SortLevel = 1
    BurstCount = 2 2
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color2 = R:0 G:104 B:108 5
    Color3 = R:0 G:0 B:0 55
  End
  Alpha = DefaultAlpha
  End
  Update = DefaultUpdate
    SizeRate = 3 8
    SizeRateDamping = 0.9 0.95
    AngleZ = -7 7
    AngularRateZ = -0.025 0.025
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    EndPoint = X:0 Y:0 Z:10
  End
  Draw = DefaultDraw
  End
End
;------------------------------------------------------

FXParticleSystem GpuParticleTest3  ;This particle Will be Red Spinin Energy Around The Crystal
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXDebuff.tga
    Lifetime = 30 30
    SortLevel = 1
    Size = 8 8
    BurstDelay = 10 10
    BurstCount = 1 1
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color2 = R:242 G:85 B:238 10
    Color3 = R:0 G:0 B:0 30
    ColorScale = -40 40
  End
  Alpha = DefaultAlpha
  End
  Update = DefaultUpdate
    SizeRate = 0 1.25
    SizeRateDamping = 1 1
    AngleZ = -7 7
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
    Z = -0.25 0.25
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:0 Y:0 Z:15
  End
  Draw = DefaultDraw
  End
End
;------------------------------------------------------
FXParticleSystem OneRing : I Change Color,hight & Size i will use this for Green Sparklings Above Crystal
  System
    Priority = ALWAYS_RENDER
    Type = GPU_PARTICLE
    ParticleName = EXSparkle.tga
    Lifetime = 25 25
    SortLevel = 1
    Size = 10 20
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color2 = R:31 G:159 B:28 5
    Color3 = R:0 G:0 B:0 3
  End
  Update = DefaultUpdate
    SizeRate = 0.5 0.5
    SizeRateDamping = 1 1
    AngleZ = -7 7
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 5
    Length = 10
    Offset = X:0 Y:0 Z:30
  End
  Draw = GpuDraw
    FramesPerRow = 1
    TotalFrames = 1
    SpeedMultiplier = 1
  End
End

;------------------------------------------------------


Object Monument02  ; This Object i Will Change to Look Like Crystal On My Map
Scale = 0.40
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER  ; I'll make it Pathable (so the units can walk through it)

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01_new
  RandomTexture = exblackicecrystal.tga 0 PG01.tga  ; Here i change White Color of object With Black Ice Crystal Texture
            OkToChangeModelColor = Yes
    DefaultModelConditionState
      Model = GPMomument2
      ParticleSysBone = NONE GpuParticleTest4 FollowBone:Yes    ;This is Changed Particle For Sword
      ParticleSysBone = NONE AODTrailHeatWave FollowBone:Yes    ;This is Unchanged original particle
      ParticleSysBone = NONE AngFordgeDoorOpen1 FollowBone:Yes  ;Changed Particle from Above
      ParticleSysBone = NONE GpuParticleTest3 FollowBone:Yes    ;Changed Particle from Above
      ParticleSysBone = NONE AngForgeWorksGlowV3 FollowBone:Yes ;This is Changed Particle For Sword
      ParticleSysBone = NONE GpuParticleTest2 FollowBone:Yes    ;This is Changed Particle For Sword
      ParticleSysBone = NONE OneRing FollowBone:Yes             ;This is Changed Particle For Sword 
      ParticleSysBone = NONE FireFlies02 FollowBone:Yes         ;This is Unchanged original particle
      ParticleSysBone = NONE BeaconSmokeCF8744 FollowBone:Yes   ;This is Changed Particle For Sword  
     End
  End
End
  Geometry = CYLINDER
  GeometryMajorRadius = 2.4
  GeometryMinorRadius = 2.4
  GeometryHeight = 4.8
  GeometryIsSmall = Yes
End
;-----------------------------------------------------------
Object BombsStack      ; This Object i Will Totaly change into Blue Rotating Vortex, i Will Use this For My Crystals

KindOf = SHRUBBERY IMMOBILE PATH_THROUGH_EACH_OTHER
RemoveModule ModuleTagDeath_03

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01_new
    DefaultModelConditionState
      Model = None
    End
 ModelConditionState = USER_1                                            
	Model = MPBeacon    
    End
  End
End
End

;--------------------------------------------------------------------

Object MoriaPickA  ; this Object will look like Blue Yelow Fireflies

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = NONE
        ParticleSysBone      = NONE GpuParticleTest2 FollowBone:Yes
        ParticleSysBone      = NONE FireFlies02 FollowBone:Yes
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End

;------------------------------------------------------------------------------

Object Urn01         ; this Object will look like Faling Particles From Above

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01_new
    DefaultModelConditionState
        Model = NONE
        ParticleSysBone      = NONE Pointer FollowBone:Yes
        ParticleSysBone      = NONE GpuParticleTest4 FollowBone:Yes
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End
;------------------------------------------------------------------------------

Object Urn02         ; this Object will look like Glowing Embers And Black Smoke

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01_new
    DefaultModelConditionState
        Model = NONE
        ParticleSysBone   = NONE WallofEmbers FollowBone:Yes
	ParticleSysBone   = FXSMOKE SmokePit
        ParticleSysBone   = NONE FireSmokeBig
	ParticleSysBone   = NONE  TreebeardSmoke

      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End
;------------------------------------------------------------------------------

FXParticleSystem BeaconSmokeCBA0BB  ; This Will be Black Smoke Circles Similar to Smoke from the Pipe
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXSmokeRing.tga
    Lifetime = 100 100
    BurstDelay = 10 10
    Size = 1 3
    BurstCount = 3 5
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color1 = R:10 G:10 B:10 5
  End
  Alpha = DefaultAlpha
    Alpha2 = 1 1 5
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 0.1 0.15
    SizeRateDamping = 1 1
    AngleZ = 0 2
    AngularRateZ = -0.04 0.04
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1.01 1.01
  End
  EmissionVelocity = OrthoEmissionVelocity
    Z = 0.3 0.7
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 80
    Offset = X:0 Y:0 Z:50
  End
  Draw = DefaultDraw
  End
End
;-------------------------------------------

FXParticleSystem BeaconSmokeB2668A  ; This Will be White Smoke Circles Similar to Smoke from the Pipe
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXSmokeRing.tga
    Lifetime = 100 100
    BurstDelay = 10 10
    Size = 1 3
    BurstCount = 3 5
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color1 = R:215 G:226 B:236 0
  End
  Alpha = DefaultAlpha
    Alpha2 = 1 1 5
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 0.1 0.15
    SizeRateDamping = 1 1
    AngleZ = 0 2
    AngularRateZ = -0.04 0.04
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1.01 1.01
  End
  EmissionVelocity = OrthoEmissionVelocity
    Z = 0.3 0.7
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 80
    Offset = X:0 Y:0 Z:50
  End
  Draw = DefaultDraw
  End
End

;------------------------------------------------------------------------------------

Object Bag  ; This object Will be Black Smoke Circles Similar to Smoke from the Pipe

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01_new
    DefaultModelConditionState
        Model = NONE
        ParticleSysBone      = NONE BeaconSmokeCBA0BB FollowBone:Yes
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End

;------------------------------------------------------------------------------

Object CornStalk  ; This object Will be White Smoke Circles Similar to Smoke from the Pipe

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01_new
    DefaultModelConditionState
        Model = NONE
        ParticleSysBone      = NONE BeaconSmokeB2668A FollowBone:Yes
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End


;-----------------------------------------------------------------------

Object IsengardScaffolding03      ; Just adding smoke to the model
   AddModule
           Draw = W3DScriptedModelDraw ModuleTag_01_Add
		DefaultModelConditionState
                        Model               = NONE
			;ParticleSysBone   = FXSMOKE SmokePit
                        ;ParticleSysBone   = None FireSmokeBig
			ParticleSysBone     = NONE  TreebeardSmoke
                        ParticleSysBone = None WallofEmbers
                End
           End
   End
End
;-------------------------------------------------------
FXParticleSystem EnshroudingMist ; I Will Change Color Of Fog In More Blue Rather Than White
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXsmokeplume.tga
    Lifetime = 100 100
    SortLevel = 1
    Size = 15 15
    StartSizeRate = 1 1
    BurstCount = 0 2
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color1 = R:206 G:236 B:253 0
    Color2 = R:206 G:236 B:253 0
    Color3 = R:206 G:236 B:253 100
    ColorScale = -30 20
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.1 0.2 50
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 0.5 0.5
    SizeRateDamping = 1.01 1.01
    AngleZ = 0 7
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1.03 1.03
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.1 0.1
    Y = -0.1 0.1
  End
  EmissionVolume = CylinderEmissionVolume
    IsHollow = Yes
    Radius = 200
    Length = 6
    Offset = X:0 Y:0 Z:30
  End
  Draw = DefaultDraw
  End
End
;-------------------------------------------------
FXParticleSystem EnshroudingMist02 ; I Will Change Color Of Fog In More Blue Rather Than White
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXsmokeplume.tga
    Lifetime = 100 100
    SortLevel = 1
    Size = 15 15
    StartSizeRate = 1 1
    BurstDelay = 1 1
    BurstCount = 0 2
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color1 = R:206 G:236 B:253 0
    Color2 = R:206 G:236 B:253 0
    Color3 = R:206 G:236 B:253 100
    ColorScale = -30 20
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.1 0.2 50
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 0.5 0.5
    SizeRateDamping = 1.01 1.01
    AngleZ = 0 7
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1.03 1.03
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.1 0.1
    Y = -0.1 0.1
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 200
    Length = 6
    Offset = X:0 Y:0 Z:30
  End
  Draw = DefaultDraw
  End
End
;-----------------------------------------------------

Object Flag02  ; This Will be Fog - Put this Object on map and you will have fog all the time


ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01_new
    DefaultModelConditionState
        Model = NONE
        ParticleSysBone      = NONE EnshroudingMist FollowBone:Yes ; This is Around Center Wide fog
        ParticleSysBone      = NONE EnshroudingMist02 FollowBone:Yes ; This Is center Fog
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End

 ;;;;; ------------------------------------------------

Locomotor HorseLocomotor                    ; a combination between horse and crow :) used in eagle and egret
  Surfaces                = AIR ; GROUND RUBBLE
  TurnTime                = 2000 ; 1500
  TurnTimeDamaged         = 2000 ; 1500
  Acceleration = 3000 ; 1500 
  SlowTurnRadius	  = 100  ; 0.0 ;  From a standing starts, horse turns in place.
  FastTurnRadius	  = 60 ; 48.0 ; Once the catapult gets moving, still uses a 30 foot radius to turn.
  
  TurnPivotOffset                 = 1   ; where to pivot when turning (-1.0 = rear, 0.0 = center, 1.0 = front)
  Lift                            = 200%
  LiftDamaged                     = 100%  
  Braking  = 2000  ; 1 second to brake from full speed.
  MinTurnSpeed            = 40% ; 10%
  ZAxisBehavior                   = SURFACE_RELATIVE_HEIGHT
  CirclingRadius                  = 161      ; the radius at which we circle when we are trying to maintain position. 
  PreferredHeight                 = 120 ; 81 ;100
  AccDecTrigger           = 0.5       ; ratio of max speed where we trigger acc and dec model states
  ;WalkDistance            = 80         ; in unit distance
  Appearance              =  FOUR_WHEELS     ; Shouldn't this be FOUR_LEGS?
  ;StickToGround           = Yes       ; walking guys aren't allowed to catch huge (or even small) air.
  CanMoveBackwards        = No        ; Can't move backwards.

  HasSuspension = Yes           ; Calculate 4 wheel independent suspension info.
  FrontWheelTurnAngle             = 20      ; How many degrees the front wheels can turn.
  ForwardAccelerationPitchFactor = 0.00  ; How much acceleration will cause the front to lift, or dip for stops.
  LateralAccelerationRollFactor  = 0.10  ; How much cornering will cause the chassis to roll.

  CloseEnoughDist = 2.0         ; How close we must get to the end of a goal path before declaring success
End
;--------------------------------------------------------------------------------------------------------

Object Dog  ; Making Object Dog To Look's Like Flying Egret


  VoiceAlert = NoSound							
  VoiceAttack = NoSound							
  VoiceAttackAir = NoSound						
  VoiceAttackCharge = NoSound					
  VoiceAttackMachine = NoSound					
  VoiceAttackStructure = NoSound				
  VoiceCombineWithHorde = NoSound				
  VoiceCreated = NoSound						
  VoiceDefect = NoSound							
  VoiceFullyCreated = NoSound					
  VoiceFear = NoSound							
  VoiceGuard = NoSound							
  VoiceMove = NoSound							
  VoiceMoveOverWalls = NoSound					
  VoiceMoveToCamp = NoSound						
  VoiceMoveToHigherGround = NoSound				
  VoiceMoveWhileAttacking = NoSound				
  VoiceRetreatToCastle = NoSound				
												
  VoiceSelect = NoSound							
  VoiceSelectBattle = NoSound					
  VoiceTaskComplete = NoSound					

  VoiceEnterStateAttack = NoSound				
  VoiceEnterStateAttackCharge = NoSound			
  VoiceEnterStateAttackAir = NoSound			
  VoiceEnterStateAttackStructure = NoSound		
  VoiceEnterStateAttackMachine = NoSound		
  VoiceEnterStateMove = NoSound					
  VoiceEnterStateMoveToHigherGround = NoSound	
  VoiceEnterStateMoveOverWalls = NoSound		
  VoiceEnterStateRetreatToCastle = NoSound		
  VoiceEnterStateMoveToCamp = NoSound			
  VoiceEnterStateMoveWhileAttacking = NoSound

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01New
    DefaultModelConditionState
      Model               = CUEgretW_SKN     ; cinematicobjects.ini
    End
    IdleAnimationState
      Animation = Idle
        AnimationName       = CUEgretW_SKL.CUEgretW_FLY
        AnimationSpeedFactorRange = 0.8 1.2
        AnimationMode       = ONCE
      End
      Flags						= RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
    End
    AnimationState        = MOVING
      Animation = Moving
        AnimationName       = CUEgretW_SKL.CUEgretW_FLY
        AnimationSpeedFactorRange = 0.8 1.2
        AnimationMode       = LOOP
      End
      Flags               = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
    End
  End
End

ReplaceModule ModuleTagWanderAround 
  	Behavior = AnimalAIUpdate ModuleTagWanderAroundNew
		WanderPercentage = 100	;percentage of the time we should move
		MaxWanderDistance = 300  ;maximum distance to move at once
		MaxWanderRadius = 300   ; how far to wander on our own
	End
End
  LocomotorSet
	Locomotor = HorseLocomotor 
	Condition = SET_NORMAL 
	Speed     = 50
  End
  

End

 ;;;;; ------------------------------------------------

 ;----------- Changing some Moria structures not to fade anymore when you come with the camera near them -------------------------------------------------------

Object MoriaModuleDwarvenGreatHallColumnA

    DisplayName      = OBJECT:Column
    
ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = MMDGRTHALLCOLA
      End
	
	;AlphaCameraFadeOuterRadius = 500 ; 300
	;AlphaCameraFadeInnerRadius = 200
        ;AlphaCameraAtInnerRadius = 0%
    End
End
End
 ;------------------------------------------------------------------
Object MoriaModuleDwarvenGreatHallDoorB1

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = MMDGRTHALLDRB1
      End

	;AlphaCameraFadeOuterRadius = 400  ; no more fade
	;AlphaCameraFadeInnerRadius = 350
	;AlphaCameraAtInnerRadius = 0%
    End
End
End
 ;------------------------------------------------------------------
Object MoriaModuleDwarvenGreatHallColumnB

    DisplayName      = OBJECT:Column
    
ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = MMDGRTHALLCOLB
      End
	
	;AlphaCameraFadeOuterRadius = 600
	;AlphaCameraFadeInnerRadius = 200
	;AlphaCameraAtInnerRadius = 10%
    End
End
End
 ;------------------------------------------------------------------
Object MoriaModuleDwarvenGreatHallColumnC

    DisplayName      = OBJECT:Column

    
ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = MMDGRTHALLCOLC
      End
    End
End
End
 ;------------------------------------------------------------------
Object MMDBalinDrA

ReplaceModule ModuleTag_Draw02
	Draw = W3DScriptedModelDraw ModuleTag_Draw02New 
		DefaultModelConditionState
			Model = MMDBalinDr
		End

		AnimationState        = RUBBLE
			Animation
				AnimationName	= MMDBalinDr.MMDBalinDr
				AnimationMode	= ONCE
			End
			FXEvent	= Frame:1 Name:FX_BalinTombWall
		End

	;AlphaCameraFadeOuterRadius = 400
	;AlphaCameraFadeInnerRadius = 250
	;AlphaCameraAtInnerRadius = 0%
	End
End
End
 ;------------------------------------------------------------------
Object MoriaModuleDwarvenGreatHallDoorATop

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = MMDGRTHALLDRATP
      End
	
	;AlphaCameraFadeOuterRadius = 400
	;AlphaCameraFadeInnerRadius = 350
	;AlphaCameraAtInnerRadius = 0%
    End
End
End
;------------------------------------------------------------------
Object MoriaModuleDwarvenCorridorArch
  
ReplaceModule ModuleTag_01 
    Draw = W3DScriptedModelDraw ModuleTag_01_new
      DefaultModelConditionState
        Model = MMDCRDARCHA
      End
	
	AlphaCameraFadeOuterRadius = 1
	AlphaCameraFadeInnerRadius = 1
	AlphaCameraAtInnerRadius = 10%
    End
End
End

;------------------------------------------------------------------

Object MoriaModuleDwarvenThroneColumn
ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01_new
      DefaultModelConditionState
        Model = MMDTHRONECOL
      End
	
	AlphaCameraFadeOuterRadius = 1
	AlphaCameraFadeInnerRadius = 1
	AlphaCameraAtInnerRadius = 15%
    End
End
End
 ;;;;;---------------------------------------------------------------------------------------------------------------------------------------
 ;;;;;  MODDING INGAMEMARKERS AND OTHER RAY-LOOKING-LIKE OBJECTS ;;;;;


Object InGameMarker              ; From system.ini - Just removing the ground shadow 
  ReplaceModule ModuleTag_01
 	Draw = W3DScriptedModelDraw ModuleTag_01_New
    	        DefaultModelConditionState
	      	  Model = EXMarker              ; The rays (by default)
	      	  ParticleSysBone = NONE Pointer  ; Yellow falling particles (by default)
  	        End
         End
  End
End

Object InGameMarker2              ; From system.ini - Just removing the ground shadow 
  ReplaceModule ModuleTag_01 
 	Draw = W3DScriptedModelDraw ModuleTag_01_New
    	        DefaultModelConditionState
	      	Model = EXThroneShaft         ; Rays
	      	ParticleSysBone = NONE Pointer  ; Falling particles
	      	End
  	End
  End
End


Object MoriaShovelA               ; From moriamodules.ini ; To look like Object CINE_SunRays
  ReplaceModule ModuleTag_01
      Draw  = W3DScriptedModelDraw ModuleTag_01_New
         DefaultModelConditionState
         Model = LM_Sunrays2  
         End
      End
      Shadow    = NONE
  End
End
 



 ;;;;; Changing some object's model to look like clouds ;;;;; -------------------------------------------------------------------------------

Object Easterling_Banner3
ReplaceModule ModuleTag_01                   ; So it doesn't draw the original object's model enymore
  Draw = W3DScriptedModelDraw ModuleTag_01_New
    DefaultModelConditionState
      Model = NONE
      ParticleSysBone = None BlueHaze ; WhiteHaze ; BlueHaze ; CineClouds_2     ; this is all we'll see ingame ; From: fxparticlesystem.ini 
     End
  End
End
End

 ;;;;; This object will look like a wall of ... steam

Object Flag

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01New
    DefaultModelConditionState
      Model =  WispyCloud ; cinematicobjects.ini - Object SmokeyPlane ; i love this!
    End
  End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End


;;;;; -------------------------------------------------------------------------------


Object GoblinCaveTroll  ;Remove Rock In His Hand on Start
Scale = 2.5
RemoveModule Module_DoCommandUpgrade
End

Object WildBatCloud    ;This Remove to Disapear From Map after period of time
RemoveModule ModuleTag_LifetimeUpdate
End

Object WildCaveBats   ;This Remove to Disapear From Map after period of time                     
RemoveModule ModuleTag_LifetimeUpdate
End

Object RohanOathbreaker1      ;This Remove to Disapear From Map after period of time
RemoveModule ModuleTag_LifetimeUpdate
End

Object Fornost_FallingTower   ; This Remove Sinkin Of Tower When Colapse With This After Tower Fall Down Stay in Ruins Forever Don't Dissapear
RemoveModule  ModuleTag_51
End

Object DeadOrcA  ; Just making This to Be Pathable,Units can walk Trough this
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT PORTER IGNORES_SELECT_ALL
End

Object Create_A_Hero_Platform  ; Just making This to Be Pathable,Units can walk Trough this
KindOf = IMMOBILE PATH_THROUGH_EACH_OTHER
End

Object MordorFortressLavaMoat  ; Just making This to Be Pathable,Units can walk Trough this
KindOf = IMMOBILE PATH_THROUGH_EACH_OTHER
End


;-----------------------------------------


;-----------------------------------------

Object TreeLothlorien14  ;Here i remove Fading of this Tree when you come close with camera

ReplaceModule ModuleTag_01
       Draw = W3DScriptedModelDraw ModuleTag_01_new
  
       StaticModelLODMode = yes
  
  
    DefaultModelConditionState
      Model             = PTLoth14
    End

    ModelConditionState = PASSENGER CLUB
      Model = None
    End

    AnimationState = PASSENGER CLUB
      EnteringStateFX = FX_TreeBecomeClub
    End

    AnimationState = PASSENGER
      EnteringStateFX = FX_TreePickUp
    End
    
    
        StaticSortLevelWhileFading = 2
	AlphaCameraFadeOuterRadius = 100
	AlphaCameraFadeInnerRadius = 200
	AlphaCameraAtInnerRadius = 10%

  End
End
End


;;;;;---------------------------------------------------------------------------------------------------------------------------------------



Object NeutralGollum     ; I Modified Gollums Healt because frodo kill him in moria with one hit

ReplaceModule ModuleTag_02
Body = ActiveBody ModuleTag_02_new
	    MaxHealth         = 10000   ;Default is 200
	End
End
RemoveModule ModuleTag_StealthForEscape ;;Here i remove Gollums Stealth
End




;------------------------------------------------------------------------------


;;;;; Changing object's model to look like KazagDum falling rocks ;;;;; -------------------------------------------------------------------

Object MoriaSpikeA                ; will make this object look like the KazagDum falling rocks, only smaller; Code from moriamodules.ini

        Scale = 0.5
	KindOf				= IMMOBILE UNATTACKABLE INERT INERT_SHROUD_REVEALER	MOVE_ONLY

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01_New
      DefaultModelConditionState
        Model = MMCkzkARocks
      End
      IdleAnimationState
       	Animation				=	Idle
			AnimationName		=	MMCkzkARocks.MMCkzkARocks
			AnimationMode		=	LOOP
        End
      End
    End
End
End

;-----------------------------------------------------This Aod Lights Credits Goes To Stefan Nicolaescu "Seeman" From Map Dwarowdelf i take this from Him---------------------------------

 ;;;; --- Hard to describe ... here i will make some objects look like rays that spawn from de ground - the effect taken from spawning the army of the dead (AOD) -------------
 ;;;; --- As i made it not in only 1 colour i will make not only 1 object. First i must put the new particle systems and under the changed objects ----------------------------


FXParticleSystem AODLightShaftsLargeTranslucid    ; this is the default one taken from AOD, only color changed
  System
    Priority = ALWAYS_RENDER
    Shader = W3D_EMISSIVE
    Type = DRAWABLE
    ParticleName = exlight01.w3d
    Lifetime = 90 90
    SystemLifetime = 30
    SortLevel = 1
    Size = 0.1 0.1
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:40 G:40 B:40 0 ; changed here
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.2 0.2 10
    Alpha3 = 0 0 90
  End
  Update = DefaultUpdate
    SizeRate = 0.02 0.02
    SizeRateDamping = 0.99 0.99
    AngleZ = -500 500
    AngularDamping = 1 1
    Rotation = ROTATE_Z
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 50
  End
  Draw = RenderObjectDraw
  End
End
;------------------------------------------------------
FXParticleSystem AODLightShaftsLargeNewTranslucid  ; like the one above only biger
  System
    Priority = ALWAYS_RENDER
    Shader = W3D_EMISSIVE
    Type = DRAWABLE
    ParticleName = exlight01.w3d
    Lifetime = 90 90
    SystemLifetime = 30
    SortLevel = 1
    Size = 0.1 0.1
    BurstCount = 4 4
  End
  Color = DefaultColor
    Color1 = R:40 G:40 B:40 0 ; changed here
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.2 0.2 10
    Alpha3 = 0 0 90
  End
  Update = DefaultUpdate
    SizeRate = 0.02 0.02
    SizeRateDamping = 0.99 0.99
    AngleZ = -500 500
    AngularDamping = 1 1
    Rotation = ROTATE_Z
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 180
  End
  Draw = RenderObjectDraw
  End
End
;------------------------------------------------------
FXParticleSystem AODLightShaftsLargeNewRed
  System
    Priority = ALWAYS_RENDER
    Shader = W3D_EMISSIVE
    Type = DRAWABLE
    ParticleName = exlight01.w3d
    Lifetime = 90 90
    SystemLifetime = 30
    SortLevel = 1
    Size = 0.1 0.1
    BurstCount = 4 4
  End
  Color = DefaultColor
    Color1 = R:240 G:130 B:30 0   ; changed here red ... or yelowish
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.2 0.2 10
    Alpha3 = 0 0 90
  End
  Update = DefaultUpdate
    SizeRate = 0.02 0.02
    SizeRateDamping = 0.99 0.99
    AngleZ = -500 500
    AngularDamping = 1 1
    Rotation = ROTATE_Z
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 180
  End
  Draw = RenderObjectDraw
  End
End
;------------------------------------------------------
FXParticleSystem AODLightShaftsLargeNewGreen
  System
    Priority = ALWAYS_RENDER
    Shader = W3D_EMISSIVE
    Type = DRAWABLE
    ParticleName = exlight01.w3d
    Lifetime = 90 90
    SystemLifetime = 30
    SortLevel = 1
    Size = 0.1 0.1
    BurstCount = 4 4
  End
  Color = DefaultColor
    Color1 = R:179 G:255 B:179 0 ;
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.2 0.2 10
    Alpha3 = 0 0 90
  End
  Update = DefaultUpdate
    SizeRate = 0.02 0.02
    SizeRateDamping = 0.99 0.99
    AngleZ = -500 500
    AngularDamping = 1 1
    Rotation = ROTATE_Z
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 180
  End
  Draw = RenderObjectDraw
  End
End
;------------------------------------------------------
FXParticleSystem AODLightShaftsLargeNewBlue
  System
    Priority = ALWAYS_RENDER
    Shader = W3D_EMISSIVE
    Type = DRAWABLE
    ParticleName = exlight01.w3d
    Lifetime = 90 90
    SystemLifetime = 30
    SortLevel = 1
    Size = 0.1 0.1
    BurstCount = 4 4
  End
  Color = DefaultColor
    Color1 = R:36 G:73 B:120 0 ; ocean dark blue 
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.2 0.2 10
    Alpha3 = 0 0 90
  End
  Update = DefaultUpdate
    SizeRate = 0.02 0.02
    SizeRateDamping = 0.99 0.99
    AngleZ = -500 500
    AngularDamping = 1 1
    Rotation = ROTATE_Z
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 180
  End
  Draw = RenderObjectDraw
  End
End
;------------------------------------------------------
FXParticleSystem AODLightShaftsLargeNewPurple
  System
    Priority = ALWAYS_RENDER
    Shader = W3D_EMISSIVE
    Type = DRAWABLE
    ParticleName = exlight01.w3d
    Lifetime = 90 90
    SystemLifetime = 30
    SortLevel = 1
    Size = 0.1 0.1
    BurstCount = 4 4
  End
  Color = DefaultColor
    Color1 = R:60 G:50 B:140 0 ; more purple (mov)
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.2 0.2 10
    Alpha3 = 0 0 90
  End
  Update = DefaultUpdate
    SizeRate = 0.02 0.02
    SizeRateDamping = 0.99 0.99
    AngleZ = -500 500
    AngularDamping = 1 1
    Rotation = ROTATE_Z
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 180
  End
  Draw = RenderObjectDraw
  End
End

;=================================================================================================================
;                          Here I Modified Sparklings And Lightnings For Ancient Giant Warrior Ent
;=================================================================================================================

FXParticleSystem AngBuildingContructDust  ;i Modified This particle in Green Lightning Below Legs of Ancient Ent
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXBoltRadial.tga
    Lifetime = 4 6
    BurstDelay = 90 90
    SortLevel = 1
    Size = 200 200
    StartSizeRate = 1 4
    BurstCount = 3 4
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color1 = R:10 G:200 B:10 0
    Color2 = R:0 G:0 B:0 6
  End
  Alpha = DefaultAlpha
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 0.5 0.5
    AngleZ = -1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0 8.07921e+33
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 1
    Length = 20
  End
  Draw = DefaultDraw
  End
End

;------------------------------------------------------

FXParticleSystem AngBuildingContructDust2     ;i Modified This particle in Lightning Around The Ancient Ent
  System
    Priority = ALWAYS_RENDER
    Type = STREAK
    ParticleName = EXsarumanbolt2.tga
    Lifetime = 4 8
    BurstDelay = 90 90
    SortLevel = 1
    Size = 25 70
    BurstCount = 10 10
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
    Color2 = R:31 G:71 B:133 5
    Color3 = R:0 G:0 B:0 20
    ColorScale = -2 -2
  End
  Update = DefaultUpdate
    SizeRateDamping = 0.9 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 0.9
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.5 0.5
  End
  EmissionVolume = LightningEmission
    StartPoint = X:-80 Y:0 Z:350
    Amplitude1 = -200 200
    Frequency1 = -4 6
    Phase1 = -4 5
    Amplitude2 = -10 50
    Frequency2 = 0 4
    Amplitude3 = -10 50
    Frequency3 = 0 4
    Phase3 = 0 5
  End
  Draw = LightningDraw
    OffsetX = -5 5
    OffsetY = -5 5
    OffsetZ = -1 1
  End
End
;------------------------------------------------------

FXParticleSystem AngBuildingContructDust2B        ;i Modified This particle in Lightning Around The Ancient Ent
  System
    Priority = ALWAYS_RENDER
    Type = STREAK
    ParticleName = EXsarumanbolt2.tga
    Lifetime = 3 5
    BurstDelay = 90 90
    SortLevel = 1
    Size = 25 70
    BurstCount = 10 10
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
    Color2 = R:31 G:71 B:133 5
    Color3 = R:0 G:0 B:0 20
    ColorScale = -2 -2
  End
  Update = DefaultUpdate
    SizeRateDamping = 0.9 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 0.9
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.5 0.5
  End
  EmissionVolume = LightningEmission
    StartPoint = X:80 Y:0 Z:300
    Amplitude1 = -200 200
    Frequency1 = -4 6
    Phase1 = -4 5
    Amplitude2 = -10 50
    Frequency2 = 0 4
    Amplitude3 = -10 50
    Frequency3 = 0 4
    Phase3 = 0 5
  End
  Draw = LightningDraw
    OffsetX = -5 5
    OffsetY = -5 5
    OffsetZ = -1 1
  End
End
;------------------------------------------------------
FXParticleSystem AngBuildingContructDustCastles   ;i Modified This particle in Heat Wave Around The Ancient Ent Legs
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = SMUDGE.tga
    Lifetime = 30 30
    BurstDelay = 20 20
    Size = 150 150
    BurstCount = 3 3
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
  End
  Alpha = DefaultAlpha
    Alpha1 = 1 1 0
  End
  Update = DefaultUpdate
    SizeRate = 5 5
    SizeRateDamping = 0.9 0.95
    AngleZ = 0.0025 0.005
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.96 0.97
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -2 2
    Z = -1 1
  End
  EmissionVolume = BoxEmissionVolume
    IsHollow = Yes
    HalfSize = X:20 Y:20 Z:0
  End
  Draw = DefaultDraw
  End
End

;------------------------------------------------------
FXParticleSystem AngBuildingContructDustCastles2        ;i Modified This particle in Blue Fireflies Around Ancient Ent Head
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEmbersLight.tga
    Lifetime = 40 40
    Size = 80 80
    BurstCount = 1 1
    IsParticleUpTowardsEmitter = Yes
  End
  Color = DefaultColor
    Color1 = R:35 G:114 B:245 5
    Color2 = R:105 G:224 B:206 4
    End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Length = 75
  End
  Draw = DefaultDraw
  End
End

;;;---------------------------------------------------------

;----- Objects that use these partic sys --------------



Object MoriaHammerA

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = NONE
        ParticleSysBone     = None  AODLightShaftsLargeTranslucid
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End
;------------------------------------------------------
Object MoriaHammerB

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = NONE
        ParticleSysBone     = None  AODLightShaftsLargeNewTranslucid
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End
;------------------------------------------------------
Object MoriaBoxA

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = NONE
        ParticleSysBone     = None  AODLightShaftsLargeNewRed
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End
;------------------------------------------------------
Object MoriaBoxB

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = NONE
        ParticleSysBone     = None  AODLightShaftsLargeNewGreen
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End
;------------------------------------------------------
Object MoriaBoxC

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = NONE
        ParticleSysBone     = None  AODLightShaftsLargeNewBlue
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End
;------------------------------------------------------
Object MoriaBucketA

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = NONE
        ParticleSysBone     = None  AODLightShaftsLargeRed  
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End
;------------------------------------------------------
Object MoriaChairA

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01New
      DefaultModelConditionState
        Model = NONE
        ParticleSysBone     = None  AODLightShaftsLargeNewPurple 
      End
    End
End
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
End


;-------------------------------------------------------




 ;;;;;--------------------------------------------------------------------------------------------------------------------

FXParticleSystem AngBuildingContructDustExpB ; This Particle i Will Use For dark shadow for Shelob Spider
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXCloudNazgul.tga
    Lifetime = 30 30
    Size = 90 90    ;Default is 30 30
    BurstDelay = 1 1
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color2 = R:193 G:0 B:0 5
    Color3 = R:0 G:0 B:0 30
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.5 0.75 5
    Alpha3 = -0.2 0 30
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 1 1
    AngleZ = -3 3
    AngularRateZ = -0.01 0.01
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:0 Y:0 Z:20
    EndPoint = X:0 Y:0 Z:4
  End
  Draw = DefaultDraw
  End
End
 ;;;;;-----------------------------------------------------------

Object MordorShelob  ; This Code reduce MordorShelob Max Healt Without This frodo Must hit Spider More than 30 times to kill him

Scale = 2

ReplaceModule ModuleTag_RespawnBody
Body = RespawnBody ModuleTag_RespawnBody_new
		MaxHealth         = 800  ;4500 Default                ;BALANCE Shelob Health
		PermanentlyKilledByFilter	= NONE		;Who kills me permanently?
	End
End

AddModule                           ; Adding The Dark Living Shadow to Shelob
Draw = W3DScriptedModelDraw ModuleTag_Shadow
		DefaultModelConditionState
			Model = None
		End

		
		ModelConditionState = USER_2                                            
			Model = None    
			ParticleSysBone = NONE AngBuildingContructDustExpB FollowBone:Yes      ;This Is Modified Shadow From Above FxParticle             
		End
End
End
End
;;;;;-----------------------------------------------------------

FXParticleSystem AngBuildingContructDustExp                  ; This Particle i Will Use For Dark shadows for BarrowWights
 System                                                      
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXCloudNazgul.tga
    Lifetime = 30 30
    Size = 25 25
    BurstDelay = 1 1
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color2 = R:193 G:0 B:0 5
    Color3 = R:0 G:0 B:0 30
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.5 0.75 5
    Alpha3 = -0.2 0 30
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 1 1
    AngleZ = -3 3
    AngularRateZ = -0.01 0.01
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:0 Y:0 Z:20
    EndPoint = X:0 Y:0 Z:4
  End
  Draw = DefaultDraw
  End
End
;---------------------------------------------------------------
Object BarrowWight   ; Adding The Dark Living Shadow to BarrowWights

ReplaceModule ModuleTag_Draw
	Draw = W3DScriptedModelDraw ModuleTag_Draw_new
		DefaultModelConditionState
			Model               = CUWight_SKN
			Skeleton            = CUWight_SKL
            ParticleSysBone = NONE WTrails FollowBone:Yes
            ParticleSysBone = NONE AngBuildingContructDustExp FollowBone:Yes  ;This Is Modified Shadow From Above FxParticle
            End  
         #include "BarrowWightsAnims.inc"       
      End
End
;---------------------------------------------------------------


Weapon ShelobMandibles    ;This Code reduce MordorShelob Damage On Frodo Without this frodo will be Dead in Few Bites
  ClearNuggets  
  DamageNugget
    Damage        = 140
    Radius        = 15
    DelayTime     = 0
    DamageType    = HERO
    DamageFXType  = SWORD_SLASH
    DeathType     = NORMAL
    DamageArc	  = ISENGARD_BERSERKER_ARC
  End
End


;------------------------------------------------------------------------------

Object AngmarKarsh  ; This Code reduce AngmarKarsh Max Healt Without This frodo Must hit Karsh More than 30 times to kill him

ReplaceModule ModuleTag_RespawnBody
Body = RespawnBody ModuleTag_RespawnBody_new
		CheerRadius 				= EMOTION_CHEER_RADIUS
		MaxHealth         			= 800
		PermanentlyKilledByFilter	= NONE		;Who kills me permanently?
   		DodgePercent      			= HERO_DODGE_PERCENT
	End
End
End

;-----------------------------------------------------------------
Weapon KarshWightTouch    ;This Code reduce AngmarKarsh Weapon Damage On Frodo Without this frodo will be Dead in few Hits of Weapon
  ClearNuggets
        DamageNugget                        
		Damage        		= 200
		Radius        		= 10.0
		DelayTime     		= 0
		DamageType    		= MAGIC
		DamageFXType  		= SWORD_SLASH
		DeathType     		= NORMAL
		DrainLife     		= Yes
		DrainLifeMultiplier	= 0.2
	End
End
;------------------------------------------------------------------------------

Object MordorEyeOfSauron   ; Here i Swap Object Little Sauron Eye Tower with Big Cinematic Object With Animated eye
  
ReplaceModule ModuleTag_Draw
  Draw = W3DScriptedModelDraw ModuleTag_Draw_new
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = SauronEyeCine
    End
  End    
End
End
;------------------------------------------------------------------------------

Object GiantSpider  ; Here i Change NeutralGiantSpider in Little Spider With Small Shadow & Small Strike Power i need them for Moria Ballins Tomb

Scale = 0.30    ; Size of Spider
	DisplayName		= OBJECT:WildSpiderling
ReplaceModule ModuleTag_Body
Body = ActiveBody ModuleTag_Body_new
		MaxHealth = 10 ;Default is 1500              ;BALANCE Giant Spider Health
	End

WeaponSet
		Conditions			= None 
		Weapon				= PRIMARY    GollumAttack ; Default is ShelobMandibles but that's to strong punch for little spiders,i change it with Gollum punch because gollum's Punch is week
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End

;	Shadow				= SHADOW_VOLUME
          Shadow = SHADOW_DECAL
	  ShadowSizeX = 10; Deafault is 50
	  ShadowSizeY = 10; Deafault is 30
	  ShadowOffsetX = -8;
	  ShadowTexture = ShadowI;
   End
End


;-------------------------------------------------------------------

Object GoblinSpiderRider

Scale = 2  ;Size of SpiderRider

ReplaceModule ModuleTag_02                 ; Here i Reduce Healt For Longer Fight In Moria
Body = ActiveBody ModuleTag_02_new
    MaxHealth         = 800
    MaxHealthDamaged  = WILD_SPIDERRIDER_HEALTH_DAMAGED
	BurningDeathBehavior = Yes
	BurningDeathFX       = FX_CavalryBurningFlame
  End
End

AddModule                           ; Adding The Dark Living Shadow to SpiderRider
Draw = W3DScriptedModelDraw ModuleTag_Shadow
		DefaultModelConditionState
			Model = None
		End

		
		ModelConditionState = USER_1                                            
			Model = None    
			ParticleSysBone = NONE AngBuildingContructDustExpB FollowBone:Yes      ;This Is Modified Shadow For Shelob Spider             
		End
            End
       End
End

;=========================================================================================================================
;                                                    BALROG
 ;;;;;-------------------------------------------------------------------------------------------------------------------
;--------------------Below Is Changed Particles What i'm Gonna use for Balrog Look---------------------------------------

FXParticleSystem BalrogManeFire1
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXFire01.tga
    Lifetime = 5 5
    SortLevel = 1
    Size = 18 18
    BurstCount = 2 2
  End
  Color = DefaultColor
    Color2 = R:223 G:108 B:53 2
    Color3 = R:0 G:0 B:0 10
    ColorScale = -5 -5
  End
  Update = DefaultUpdate
    SizeRate = 0.4 0.4
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.5 1
    DriftVelocity = X:0 Y:-1.0 Z:-0.1
  End
  EmissionVelocity = OutwardEmissionVelocity
    Speed = -0.3 -0.3
    OtherSpeed = -0.4 -0.4
  End
  EmissionVolume = BoxEmissionVolume
    HalfSize = X:0 Y:0 Z:0
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem BalrogManeEmbers1
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEmbersLight.tga
    Lifetime = 100 100
    SortLevel = 1
    Size = 10 20
    BurstDelay = 2 5
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:255 G:135 B:80 0
    Color2 = R:0 G:0 B:0 50
    ColorScale = -5 0
  End
  Update = DefaultUpdate
    SizeRate = 6 6
    SizeRateDamping = 0.8 0.85
    AngleZ = -0.3 0.3
    AngularRateZ = -0.03 0.03
    AngularDamping = 0.99 0.99
  End
  Physics = DefaultPhysics
    Gravity = 0.008
    VelocityDamping = 0.9 0.9
    DriftVelocity = X:0 Y:0 Z:0.64
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    IsHollow = Yes
    StartPoint = X:-22 Y:0 Z:8
    EndPoint = X:25 Y:0 Z:5
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = PingPong
    WindStrength = 0.5
    WindAngleChangeMin = 0.017453
    WindAngleChangeMax = 0.034907
    WindPingPongStartAngleMax = 0.785398
    WindPingPongEndAngleMin = 5.49779
    WindPingPongEndAngleMax = 6.28319
  End
End

FXParticleSystem BalrogManeFlare1
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXLnzFlar1.tga
    Lifetime = 20 20
    SortLevel = 1
    Size = 20 20
    BurstCount = 1 2
  End
  Color = DefaultColor
    Color2 = R:255 G:119 B:45 2
    Color3 = R:0 G:0 B:0 20
    ColorScale = -15 -5
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 1
    DriftVelocity = X:0 Y:0 Z:2
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.4 -0.4
    Y = -0.4 -0.4
  End
  EmissionVolume = BoxEmissionVolume
    HalfSize = X:12 Y:7 Z:5
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem BalrogSwordFlare1
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXLnzFlar1.tga
    Lifetime = 60 60
    SortLevel = 1
    Size = 35 45
    BurstCount = 1 2
  End
  Color = DefaultColor
    Color2 = R:180 G:108 B:49 5
    Color3 = R:0 G:0 B:0 30
    ColorScale = -5 0
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 2.9 1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 0 2
    Y = 0 2
    Z = 0 2
  End
  EmissionVolume = LineEmissionVolume
    IsHollow = Yes
    EndPoint = X:0 Y:0 Z:70
  End
  Draw = DefaultDraw
  End
  Wind = DefaultWind
    WindMotion = Circular
    WindStrength = 1
    WindAngleChangeMin = 0.872665
    WindAngleChangeMax = 2.61799
  End
End

FXParticleSystem BalrogWingSmokeLite1
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXCloud06.tga
    Lifetime = 175 175
    SortLevel = 1
    Size = 25 40
    BurstDelay = 3 7
    BurstCount = 1 2
    IsEmitAboveGroundOnly = Yes
  End
  Color = DefaultColor
    Color1 = R:191 G:77 B:0 1
    Color2 = R:44 G:37 B:31 35
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.2 0.4 50
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 2 4
    SizeRateDamping = 0.96 0.98
    AngleZ = 0 7
    AngularRateZ = -0.03 0.03
    AngularDamping = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.95 0.9
    DriftVelocity = X:0.08 Y:0.08 Z:0.8
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = 1 0.4
    Y = -0.4 0.4
    Z = -0.4 3
  End
  EmissionVolume = CylinderEmissionVolume
    IsHollow = Yes
    Radius = 8
  End
  Draw = DefaultDraw
  End
End

 ;;;;;--------------------------------------------------------------------
;-----------------------------------------------------------------------------------------------------------------
Object MordorBalrog ; Here i Change Balrog Look i Add Some Lightning And Heatwaves around Him and other Stuff
 
Scale = 1.2

RemoveModule ModuleTag_LifetimeUpdate         ;;;;; SO HE CAN LIVE UNTILL KILLED (no longer expires) ;;;;;

ReplaceModule ModuleTag_02                    ; Changing his Hp
    Body             = ActiveBody ModuleTag_Overide
    MaxHealth        = 30000                      
    MaxHealthDamaged = 100
    End
End

ReplaceModule ModuleTag_IgniteUpdate                                        ; I only wanna change the Ignite duration cause i don't like the model look. Code from: neutralunits.ini                          
	Behavior = HeroModeSpecialAbilityUpdate ModuleTag_IgniteUpdate_New   
		SpecialPowerTemplate    = SpecialAbilityHeroMode
		UnpackingVariation	= 1
		UnpackTime              = 1800 
		PackTime                = 1600
		AwardXPForTriggering    = 0
		HeroAttributeModifier = BalrogIgniteState
		HeroEffectDuration = 5000 ; 30000                ; 5 sec from 30
	End
End

ReplaceModule ModuleTag_BodyDraw
	Draw = W3DScriptedModelDraw ModuleTag_BodyDraw1
		OkToChangeModelColor = Yes
		ExtraPublicBone = ZZZPASSENGERBON
		ExtraPublicBone = ZZZWHIPCOIL
		ExtraPublicBone = SWORD
		;-------------------------
		ModelConditionState = NONE ; Not DefaultConditionState, because that keyword copies anything in here to every other state
			Model = MUBalrog_SKN
			ParticleSysBone = SWORD BalrogSwordFlare FollowBone:yes		
			ParticleSysBone = SWORD BalrogSwordFlare1 FollowBone:yes
			ParticleSysBone = SWORD BalrogSwordEmbers FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFlare FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFlare1 FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeEmbers FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeEmbers1 FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFire FollowBone:yes
			ParticleSysBone = BAT_JAW BalrogManeFire1 FollowBone:yes
			ParticleSysBone = RTWINGBONE BalrogSwordEmbers FollowBone:yes
			ParticleSysBone = LFWINGBONE BalrogSwordEmbers FollowBone:yes
			ParticleSysBone = RTWINGBONE BalrogWingSmokeLite1 FollowBone:yes
			ParticleSysBone = LFWINGBONE BalrogWingSmokeLite1 FollowBone:yes
			ParticleSysBone = NONE AngBuildingContructDust2 FollowBone:yes       ; This is Modified Lightning Particle i Use from Ancient Ent Because it's Fit To Balrog Size
			ParticleSysBone = NONE AngBuildingContructDust2B FollowBone:yes      ; This is Modified Lightning Particle i Use from Ancient Ent
			ParticleSysBone = NONE AngBuildingContructDustCastles FollowBone:yes ; This is Modified Heat Wave Around Balrog
		End

               ModelConditionState = HIT_LEVEL_2                                     ; This is triggered by the single player only HitReaction module for the lightningsword	
			Model = MUBalLIT_SKN
;			ParticleSysBone     = RTHANDBONE BalrogSwordFlare FollowBone:yes	; This particle system is for the "balled up whip"
;			ParticleSysBone = MANEBONE BalrogManeFlare FollowBone:yes
;			ParticleSysBone = MANEBONE BalrogManeEmbers FollowBone:yes
;			ParticleSysBone = RTWINGBONE BalrogWingSmokeLite FollowBone:yes
;			ParticleSysBone = LFWINGBONE BalrogWingSmokeLite FollowBone:yes
		End

		ModelConditionState = HERO
			Model = MUBalIGNT_SKN
			ParticleSysBone = MANEBONE BalrogManeFlare FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeEmbers FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFire FollowBone:yes
;			ParticleSysBone = RTWINGBONE BalrogWingSmokeLite FollowBone:yes
;			ParticleSysBone = LFWINGBONE BalrogWingSmokeLite FollowBone:yes
			ParticleSysBone = RTWINGBONE BalrogWingEmbers FollowBone:yes
			ParticleSysBone = LFWINGBONE BalrogWingEmbers FollowBone:yes
			ParticleSysBone = SWORD BalrogSwordFlare FollowBone:yes		
			ParticleSysBone = SWORD BalrogSwordEmbers FollowBone:yes
	                ParticleSysBone = NONE BalrogIgniteHeatWave FollowBone:no
		End
	#include "BalrogAnims.inc"
	End
End
End

;=========================================================================================================================================================================================
;=========================================================================================================================================================================================

Object DragonsEntrance                                                         ;;;;; I'll make it pathable (so the units can walk through it) 
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER           ;;;;; CAN_CAST_REFLECTIONS  STRUCTURE IMMOBILE  SELECTABLE
End


;-------------------------------------------------------------------------------------------------------------------------------------------------

Object RohanEntBase  ; I will change this Ent to stand with Spread Arms all the time - This will be Ancient Ents Crystal Guardians

	
	ButtonImage		= HIEnt
	SelectPortrait	= UPElven_Ent

ReplaceModule ModuleTag_01	
	Draw = W3DScriptedModelDraw ModuleTag_01_new
	


		DefaultModelConditionState
			Model               = RUEntFir_SKN
			Skeleton			= RUTreeberd_SKL


   		End

 		
                ModelConditionState = USER_1
                        Model               = EBFVEnt_SKN
			Skeleton	    = EBFVEnt_SKL
	
   		End



	End
End
End

;--------------------------------------------------------------------------------------------------------------------------------------------

FXParticleSystem GpuParticleTest     ;i Modified This particle in Strikning Lightning Around The Ancient Ents Crystal Guardians When Wakes up
  System
    Priority = ALWAYS_RENDER
    Type = STREAK
    ParticleName = EXsarumanbolt2.tga
    Lifetime = 4 8
    SystemLifetime = 60
    BurstDelay = 5 5
    SortLevel = 1
    Size = 25 70
    BurstCount = 10 10
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
    Color2 = R:31 G:71 B:133 5
    Color3 = R:0 G:0 B:0 20
    ColorScale = -2 -2
  End
  Update = DefaultUpdate
    SizeRateDamping = 0.9 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 0.9
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.5 0.5
  End
  EmissionVolume = LightningEmission
    StartPoint = X:-80 Y:0 Z:350
    Amplitude1 = -200 200
    Frequency1 = -4 6
    Phase1 = -4 5
    Amplitude2 = -10 50
    Frequency2 = 0 4
    Amplitude3 = -10 50
    Frequency3 = 0 4
    Phase3 = 0 5
  End
  Draw = LightningDraw
    OffsetX = -5 5
    OffsetY = -5 5
    OffsetZ = -1 1
  End
End
;-------------------------------------------------------------------------------------------------------------------------------------------------

FXParticleSystem AngSanctumCharge04        ;i Modified This particle in Strikning Lightning Around The Ancient Ents Crystal Guardians When Wakes up
  System
    Priority = ALWAYS_RENDER
    Type = STREAK
    ParticleName = EXsarumanbolt2.tga
    Lifetime = 3 5
    SystemLifetime = 60
    BurstDelay = 5 5
    SortLevel = 1
    Size = 25 70
    BurstCount = 10 10
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
    Color2 = R:31 G:71 B:133 5
    Color3 = R:0 G:0 B:0 20
    ColorScale = -2 -2
  End
  Update = DefaultUpdate
    SizeRateDamping = 0.9 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.9 0.9
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -0.5 0.5
  End
  EmissionVolume = LightningEmission
    StartPoint = X:80 Y:0 Z:300
    Amplitude1 = -200 200
    Frequency1 = -4 6
    Phase1 = -4 5
    Amplitude2 = -10 50
    Frequency2 = 0 4
    Amplitude3 = -10 50
    Frequency3 = 0 4
    Phase3 = 0 5
  End
  Draw = LightningDraw
    OffsetX = -5 5
    OffsetY = -5 5
    OffsetZ = -1 1
  End
End
;------------------------------------------------------------------------------------------------------------------------------------------


Object DwarvenBanner ; will remove the model from this object and add only the Lightning particlesYstem Modified from above. Removed weapons also. So when you spawn in the map one of this units they will look like temporary Lighning.

VisionRange = 0
ShroudClearingRange = 0

    VoiceSelect = NoSound
    VoiceMove = NoSound
    VoiceMoveWhileAttacking = NoSound
	VoiceCreated = NoSound
	VoiceFullyCreated = NoSound
	VoicePriority = 0
	VoiceSelectBattle  = NoSound
	SoundImpact = NoSound

RemoveModule ModuleTag_05   ; So it doesn't make a sound when he dies
RemoveModule ModuleTag_foo
RemoveModule ModuleTag_AnimAudioBehavior

	WeaponSet                        
		Conditions				= None
		Weapon					= PRIMARY NONE
	End

  ReplaceModule ModuleTag_01
 	Draw = W3DScriptedModelDraw ModuleTag_01_New
    	        DefaultModelConditionState
		  Model                       = NONE          
	      	  ParticleSysBone = NONE AngSanctumCharge04     ; Described just above
	      	  ParticleSysBone = NONE GpuParticleTest 
		End
        End
  End
End

;------------------------------------------------------------------------------------------------------------------------------------------
FXParticleSystem MtDoomHeat    ; I Will Change This into Dust to Appears All The Time For Ballins Tomb
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXsnowcloud02.tga
    Lifetime = 250 250
    BurstDelay = 300 300 ; Default is (SystemLifetime = 1) i change this With BurstDelay. 300 frames is 10 seconds,one Second is 30 frames That means Dust will Appear every 10 Seconds
    SortLevel = 1
    Size = 10 30
    BurstCount = 75 75
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.3 0.5 5
    Alpha3 = -1 0 250
  End
  Update = DefaultUpdate
    SizeRate = 3 5
    SizeRateDamping = 0.9 0.95
    AngleZ = 0 7
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.85 0.88
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -10 20
    Y = -10 10
  End
  EmissionVolume = BoxEmissionVolume
    HalfSize = X:0 Y:20 Z:30
  End
  Draw = DefaultDraw
  End
End


;------------------------------------------------------------------------------------------------------------------------------------------

Object MoriaModuleBalinsTombB                        ; Here i Add To Balins Tomb Changed Dust In Tomb And Falling White Particles

ReplaceModule ModuleTag_01
    Draw = W3DScriptedModelDraw ModuleTag_01_new
      DefaultModelConditionState
        Model = MMDBALIN
	ParticleSysBone = NONE MtDoomHeat   ;Here is Changed Dust in Tomb
	ParticleSysBone = NONE Pointer         ;Here is Falling White Particles
      End
    End
 End
End

;--------------------------------------------------------------------------------------------------------------------------------------------------------

Object PTFramvg07              ; This Will Be Only Dust Without Any Model Just place this Object and you will have only Dust
KindOf  = IMMOBILE PATH_THROUGH_EACH_OTHER
ReplaceModule ModuleTag_01
      Draw = W3DScriptedModelDraw ModuleTag_01New
    DefaultModelConditionState
         Model = None
	ParticleSysBone = NONE MtDoomHeat
       End
     End
  End
End

;------------------------------------------------------------------------

Object MoriaWenchA   ;This Object i Will Change into Invisible Treasure Chest When Picked up Player gain Rank + . This i will put in front every crystal

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01_new
    DefaultModelConditionState
      Model = None
      ParticleSysBone = NONE GoldChestGlimmer
      ParticleSysBone = NONE GoldChestGlimmer02
      ParticleSysBone = NONE GoldChestRedGlimmer
      ParticleSysBone = NONE GoldChestGreenGlimmer
      ParticleSysBone = NONE GoldChestAura
    End
  End
End

  KindOf = SELECTABLE PARACHUTABLE IMMOBILE NOT_AUTOACQUIRABLE UNATTACKABLE CRATE;Only Salvage crates are marked Selectable so the Mouse can interact with them and give Salvage voices.  Being dead makes them not actually selectable

  ThreatLevel = 0.0
AddModule  
  Body = HighlanderBody ModuleTag_04 ;Can take damage, but won't die.  Can only die from ::kill() or other unresistable damage
    MaxHealth      = 1.0
  End
End
AddModule     
  Behavior = SalvageCrateCollide ModuleTag_02
    ForbiddenKindOf = PROJECTILE ENVIRONMENT IGNORED_IN_GUI
;    PickupScience = SCIENCE_GLA   ; Only GLA players can pick this up (Draw module makes it so only they can see it)
    ExecuteFX = FX_GoldChestPickup    ; FXList to play when sucessfully picked up

    BannerChance = 10%		    ;   
    LevelUpChance = 100%        ; This is the chance we gain a level
    LevelUpRadius = 100.0		;
    ResourceChance = 20%             ; And this is the chance we get money.  Level + Money = 100%.  Weapon is an idependant FirstChance
    MinResource = 25                 ; If we get money, this is how much we get.  Make them different to get a random range.
    MaxResource = 75
    AllowAIPickup = No
  End 
End   
AddModule 
  Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
    MinLifetime = 30000   
    MaxLifetime = 35000   
  End
End
  Geometry = BOX
  GeometryMajorRadius = 12.0
  GeometryMinorRadius = 12.0
  GeometryHeight = 12.0     
  GeometryIsSmall = Yes    
  Shadow          = SHADOW_VOLUME

End

;------------------------------------------------------------------------------------------------------------------------------------------

Object ElvenBattleTower   ; I will Add to this tower Some Falling Particles From Above

ReplaceModule ModuleTag_Draw
  Draw = W3DScriptedModelDraw ModuleTag_Draw_new
  
	ExtraPublicBone	= Arrow_01
	ExtraPublicBone	= Arrow_02
	ExtraPublicBone	= Arrow_03
	ExtraPublicBone	= Arrow_04
	ExtraPublicBone	= Arrow_05
	ExtraPublicBone	= Arrow_06
	ExtraPublicBone	= Arrow_07
	ExtraPublicBone	= Arrow_08
	ExtraPublicBone	= Arrow_09
	ExtraPublicBone	= Arrow_10
	ExtraPublicBone	= Arrow_11
	ExtraPublicBone	= Arrow_12

	
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD  
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    
    DefaultModelConditionState
		Model				= EBBbattleTwr
		WeaponLaunchBone	= PRIMARY Arrow_
        ParticleSysBone      = NONE Pointer FollowBone:Yes          ;Added Changed Particles
        ParticleSysBone      = NONE GpuParticleTest4 FollowBone:Yes ;Added Changed Particles
       End
   End
End
End

;------------------------------------------------------------------------------------------------------------------------------------------
;---------------------------------------Here i will try to make Butterflyes And Pixies to move around Ancient City--------------------------

FXParticleSystem ButterflyDrawTest     ; i will Change this Particle to be Like Blue Butterflyes and below i will add this to object
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXButterFly.tga
    Lifetime = 40 40
    SortLevel = 1
    Size = 1.5 2.5          ; 2 3
    BurstDelay = 8 8
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:16 G:53 B:226 5
    Color2 = R:10 G:221 B:10 4
    ColorScale = -40 40
  End
  Alpha = DefaultAlpha
    Alpha1 = 1 1 0
    Alpha2 = 1 1 70
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.25 -0.3
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
    DriftVelocity = X:0 Y:0 Z:1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -2 2
    Y = -2 2
    Z = 0 0.5
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 5
    Length = 5
  End
  Draw = ButterflyDraw
  End
  Wind = DefaultWind
    WindMotion = Circular
    WindStrength = 0.5
    WindAngleChangeMin = 0.005
    WindAngleChangeMax = 0.005
    WindPingPongStartAngleMax = 0
    WindPingPongEndAngleMin = 7
    WindPingPongEndAngleMax = 7
  End
End
;------------------------------------------------------------------------------------------------------------------------------------------
FXParticleSystem CCC     ; i will Change this Particle to be Like Green Butterflyes and below i will add this to object
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXButterFly.tga
    Lifetime = 40 40
    SortLevel = 1
    Size = 1.5 2.5          ; 2 3
    BurstDelay = 8 8
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:10 G:255 B:10 5
    Color2 = R:10 G:221 B:10 4
    ColorScale = -40 40
  End
  Alpha = DefaultAlpha
    Alpha1 = 1 1 0
    Alpha2 = 1 1 70
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.25 -0.3
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
    DriftVelocity = X:0 Y:0 Z:1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -2 2
    Y = -2 2
    Z = 0 0.5
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 5
    Length = 5
  End
  Draw = ButterflyDraw
  End
  Wind = DefaultWind
    WindMotion = Circular
    WindStrength = 0.5
    WindAngleChangeMin = 0.005
    WindAngleChangeMax = 0.005
    WindPingPongStartAngleMax = 0
    WindPingPongEndAngleMin = 7
    WindPingPongEndAngleMax = 7
  End
End
;------------------------------------------------------------------------------------------------------------------------------------------
FXParticleSystem ColorTestDust01     ; i will Change this Particle to be Like Orange Butterflyes and below i will add this to object
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXButterFly.tga
    Lifetime = 40 40
    SortLevel = 1
    Size = 1.5 2.5          ; 2 3
    BurstDelay = 8 8
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
    Color2 = R:242 G:174 B:72 3
    ColorScale = -40 40
  End
  Alpha = DefaultAlpha
    Alpha1 = 1 1 0
    Alpha2 = 1 1 70
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.25 -0.3
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
    DriftVelocity = X:0 Y:0 Z:1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -2 2
    Y = -2 2
    Z = 0 0.5
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 5
    Length = 5
  End
  Draw = ButterflyDraw
  End
  Wind = DefaultWind
    WindMotion = Circular
    WindStrength = 0.5
    WindAngleChangeMin = 0.005
    WindAngleChangeMax = 0.005
    WindPingPongStartAngleMax = 0
    WindPingPongEndAngleMin = 7
    WindPingPongEndAngleMax = 7
  End
End

;------------------------------------------------------------------------------------------------------------------------------------------
FXParticleSystem SnowColorTest     ; i will Change this Particle to be Like Red Butterflyes and below i will add this to object
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXButterFly.tga
    Lifetime = 40 40
    SortLevel = 1
    Size = 1.5 2.5          ; 2 3
    BurstDelay = 8 8
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:255 G:255 B:255 0
    Color2 = R:222 G:58 B:177 5
    ColorScale = -40 40
  End
  Alpha = DefaultAlpha
    Alpha1 = 1 1 0
    Alpha2 = 1 1 70
    Alpha3 = 0 0 100
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = -5 5
    AngularRateZ = -0.25 -0.3
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
    DriftVelocity = X:0 Y:0 Z:1
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -2 2
    Y = -2 2
    Z = 0 0.5
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 5
    Length = 5
  End
  Draw = ButterflyDraw
  End
  Wind = DefaultWind
    WindMotion = Circular
    WindStrength = 0.5
    WindAngleChangeMin = 0.005
    WindAngleChangeMax = 0.005
    WindPingPongStartAngleMax = 0
    WindPingPongEndAngleMin = 7
    WindPingPongEndAngleMax = 7
  End
End
;-----------------------------------------------------------------------------------------------------------------------

FXParticleSystem FireTest  ; This Will be green Fireflies
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEmbersLight.tga
    Lifetime = 40 40
    Size = 30 30
    BurstCount = 1 1
    IsParticleUpTowardsEmitter = Yes
  End
  Color = DefaultColor
    Color1 = R:35 G:114 B:245 2
    Color2 = R:10 G:255 B:10 4
    End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Length = 75
  End
  Draw = DefaultDraw
  End
End

;-----------------------------------------------------------------------------------------------------------------------

FXParticleSystem FireworksTestParticle  ; This Will be yellow Fireflies
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEmbersLight.tga
    Lifetime = 40 40
    Size = 30 30
    BurstCount = 1 1
    IsParticleUpTowardsEmitter = Yes
  End
  Color = DefaultColor
    Color1 = R:35 G:114 B:245 2
    Color2 = R:255 G:255 B:190 4
    End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Length = 75
  End
  Draw = DefaultDraw
  End
End

;-------------------------------------------------------------------------------------------------------------------------------
FXParticleSystem QuadRenderDrawTest  ; This Will be blue Fireflies
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXEmbersLight.tga
    Lifetime = 40 40
    Size = 40 40
    BurstCount = 1 1
    IsParticleUpTowardsEmitter = Yes
  End
  Color = DefaultColor
    Color1 = R:35 G:114 B:245 5
    Color2 = R:105 G:224 B:206 4
    End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Length = 75
  End
  Draw = DefaultDraw
  End
End

;---------------------------------------------------------------------------------------------------------------------------------------
Object Crow                                    ;i Will Change Flying Crow To Butterflyes & Pixies     

ReplaceModule ModuleTag_01
  Draw = W3DScriptedModelDraw ModuleTag_01_new
    DefaultModelConditionState
      Model               = None  ; i deleted Model of crow it will be blank with no model just particles will flyin around
        ParticleSysBone      = NONE QuadRenderDrawTest FollowBone:Yes
        ParticleSysBone      = NONE FireTest FollowBone:Yes
        ParticleSysBone      = NONE ButterflyDrawTest FollowBone:Yes
        ParticleSysBone      = NONE CCC FollowBone:Yes
        ParticleSysBone      = NONE ColorTestDust01 FollowBone:Yes
        ParticleSysBone      = NONE FireworksTestParticle FollowBone:Yes
        ParticleSysBone      = NONE SnowColorTest FollowBone:Yes
    End
End
End 

  VoiceSelect = NoSound
  VoiceMove = NoSound
  VoiceAttack = NoSound
  VoiceFear = NoSound
  VoiceGuard = NoSound
;  SoundDie = NoSound
;  SoundDieFire = NoSound
  SoundStealthOn = NoSound
  SoundStealthOff = NoSound
  
  UnitSpecificSounds
    VoiceGarrison         = NoSound
    VoiceEnter            = NoSound
    VoiceEnterHostile     = NoSound
    VoiceGetHealed        = NoSound
  End
  RadarPriority = NOT_ON_RADAR
  KindOf = PRELOAD IGNORED_IN_GUI INFANTRY PATH_THROUGH_EACH_OTHER NOT_AUTOACQUIRABLE NO_BASE_CAPTURE;NO_COLLIDE
  

  LocomotorSet
    Locomotor = CrowLocomotor
    Condition = SET_NORMAL 
    Speed     = 30
  End
End
;---------------------------------------------------------------------------------------------------------------------------------------
;================================ Hobbit House =========================================================================================

Object ShireGeneric01   ; This will be My Hobbit House here you can build Hobbit Heroes

CommandSet = Hobbit_BuiltHouseCommandset   ;This Command Set i Changed Below
  KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE FS_FACTORY AUTO_RALLYPOINT ; This is Important to Structure That can build Units

ReplaceModule ModuleTag_Draw                      ; I Adding only pipe smoke to building
  Draw = W3DScriptedModelDraw ModuleTag_Draw_new
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes

    DefaultModelConditionState
      Model = SBgen_01		
		ParticleSysBone     = FXbone ElvenForgeSmoke FollowBone:Yes
		ParticleSysBone     = NONE BeaconSmokeB2668A FollowBone:Yes ; I Add Some White Pipe Smoke to building
	  End
       End
  End
AddModule                                                ;This is Important to add because when unit is build here we give direction where unit must show up
 Behavior = QueueProductionExitUpdate ModuleTag_07_new   ;Whithout this unit will show up in center of house or somewhere else.
    UnitCreatePoint		= X:20.0 Y:20.0 Z:0.0
    NaturalRallyPoint	= X:30.0 Y:30.0 Z:0.0
    ExitDelay			= STANDARD_HORDE_EXIT_DELAY
    PlacementViewAngle	= 45
    End
End                                  ; Geometry is important also i give smaller geometry because when enemy attack building if geometry is bigger
  Geometry              = CYLINDER   ; Rock or Attack on building will result high above structure or far in diameter.
  GeometryMajorRadius   = 8.0
  GeometryMinorRadius   = 8.0
  GeometryHeight        = 10

	GeometryIsSmall       = yes
	  
	Shadow                = SHADOW_VOLUME
End
;================================================== Here Are Buttons For Hobbit House ===================================================================
;-----------------------I Try everything to get icons of heroes on House  but they don't show up only names Can be displayed Because I make new ---------
;---------------------------------------------- Buttons and game will not recognize new buttons only existed ---------------------------                                              

CommandButton Frodo
	Command				= UNIT_BUILD
        ButtonImage			= HIFrodo
        Options                         = NEED_UPGRADE CANCELABLE HIDE_WHILE_DISABLED   ;I put This For frodo only because i don't want Frodo Build on start of the game 
	NeededUpgrade		        = Upgrade_AragornLeadership                     ;he will show later in game and then i give to house this upgrade and thrn if frodo dies you can build another Frodo 
	Object			 	= RohanFrodo                                    ; If you wanna frodo on start to be build just Delete "NEED_Upgrade" & Whole Line Below "NeededUpgrade = Upgrade_AragornLeadership"
	TextLabel			= CONTROLBAR:HobbitFrodo
	ButtonBorderType    		= BUILD 
        UnitSpecificSound               = FrodoVoiceRespawn
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= No    
End
CommandButton Sam
	Command				= UNIT_BUILD
	Object				= RohanSam
	Options				= HIDE_WHILE_DISABLED CANCELABLE
	TextLabel			= CONTROLBAR:HobbitSam
	ButtonImage			= HISam
	ButtonBorderType    		= BUILD 
        UnitSpecificSound               = SamVoiceRespawn
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= No    
End
CommandButton Merry
	Command				= UNIT_BUILD
	Object				= RohanMerry
	Options				= HIDE_WHILE_DISABLED CANCELABLE
	TextLabel			= CONTROLBAR:HobbitMerry
	ButtonImage			= HIMerry
	ButtonBorderType    		= BUILD 
        UnitSpecificSound               = MerryVoiceRespawn
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= No    
End
CommandButton Pippin
	Command				= UNIT_BUILD
	Object				= RohanPippin
	Options				= HIDE_WHILE_DISABLED CANCELABLE
	TextLabel			= CONTROLBAR:HobbitPippin
	ButtonImage			= HIPippin
	ButtonBorderType    		= BUILD 
        UnitSpecificSound               = PippinVoiceRespawn
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= No    
End
CommandButton Bilbo
	Command				= UNIT_BUILD
	Object				= AngmarHwaldar
	Options				= HIDE_WHILE_DISABLED CANCELABLE
	TextLabel			= CONTROLBAR:HobbitBilboBagins
        DescriptLabel            	= CONTROLBAR:BilboBaginsDescript
	ButtonImage			= HIPippin
	ButtonBorderType    		= BUILD 
        UnitSpecificSound               = MEShire_Hobbit09
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= No    
End

CommandSet Hobbit_BuiltHouseCommandset    ; This will be  Commandset for Hobbit House

	1   = Command_StartSelfRepair
	2   = Frodo
	3   = Sam 
	4   = Merry		
	5   = Pippin
        6   = Bilbo
End

;----------------------------------------------------------------------
Object ShireBagend ; i Change only geometry because original is too big and units must walk much around this object now they walks near this object
  DisplayName         = OBJECT:Bagend
  Side                = Civilian
  EditorSorting       = STRUCTURE
  Browser = REGION Shire STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 500
  BuildTime           = 15.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160


	CommandSet          = GenericSelfRepairCommandSet
  Geometry              = CYLINDER
  GeometryMajorRadius   = 8.0
  GeometryMinorRadius   = 8.0
  GeometryHeight        = 10

	GeometryIsSmall       = yes
	  
	Shadow                = SHADOW_VOLUME
End

;-----------------------------------------------------------------------------
Object RohanFrodo

CommandSet = RohanFrodoCommandSet_New

AddModule      ; Here i give A Hero Rank 10 Right on Start when he Show up in Game
Behavior = ExperienceLevelCreate ModuleTag_LevelBonus  
                LevelToGrant    = 10
                MPOnly                  = No
        End
End
	RadarPriority = UNIT
	KindOf = HOBBIT_KINDOF
	SelectPortrait         = HPFrodo
	ButtonImage	       = HIFrodo
	MaxSimultaneousOfType	= 1         ;This means Only One can exists At The Same time in Game
   	BuildCost = 3000
    	BuildTime = 15

;------------------------------------------- Frodos New Power - Istari Light  ---------------------------------------------------


AddModule 
	Behavior = SpecialPowerModule ModuleTag_IstariLightPower                      
		SpecialPowerTemplate		= SpecialAbilityIstariLight
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= no
		InitiateSound			= GandalfVoiceAttackIstariLight	;this plays when he targets, not when he fires
	End
End
AddModule 
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IstariLightUpdate
		SpecialPowerTemplate    = SpecialAbilityIstariLight
		SkipContinue			= Yes
		UnpackTime              = 2000 
 		PreparationTime         = 1  
 		PersistentPrepTime      = 2000
 		PackTime                = 500
		AwardXPForTriggering    = 0
		StartAbilityRange		= GANDALF_PHASER_CAST_RANGE ; Note: This has to be smaller than the weapon range or it'll never succeed
		ApproachRequiresLOS		= Yes		
		SpecialWeapon			= GandalfStaffWeapon
		MustFinishAbility		= Yes
		WhichSpecialWeapon		= 3
		BusyForDuration			= 2500
	End
End
;------------------------------------------- Frodos New Power - Birds Scouts (Reveal Area & Detect Stealth) ---------------------------------------------------

AddModule
Behavior = OCLSpecialPower ModuleTag_CreateAHeroSummonFamiliarPower_Level3
	SpecialPowerTemplate	= SpecialAbilityCreateAHeroSummonFamiliar_Level3
	OCL						= OCL_CreateAHeroSummonFamiliar_Level3
	CreateLocation			= CREATE_AT_LOCATION
	StartsPaused			= no
	SetModelCondition		= ModelConditionState:USER_1
	SetModelConditionTime	= 8.1
      End
   End
End
;-----------------------------------------------
CommandSet RohanFrodoCommandSet_New
	1	= Command_ToggleStance  
	2	= Command_ToggleFrodoWeapon
	3	= Command_SpecialAbilityElfCloak
	4	= Command_SpecialAbilityPhialOfGaladriel
        5       = Command_CreateAHero_SummonFamiliar_Level3 ;Birds Scouts
        6       = Command_GondorGandalfIstariLight          ;Istari Light
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
	16  = Command_SetStanceBattle
	17  = Command_SetStanceAggressive
	18  = Command_SetStanceHoldGround
End
;-----------------------------------------------------------------------------
Object RohanSam

AddModule  ; Here i give A Hero Rank 10 Right on Start when he Show up in Game
Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
                LevelToGrant    = 10
                MPOnly                  = No
        End
End
	RadarPriority = UNIT
	KindOf = HOBBIT_KINDOF
	SelectPortrait         = HPSam
	ButtonImage	       = HISam
	MaxSimultaneousOfType	= 1      ;This means Only One can exists At The Same time in Game
   	BuildCost = 2000
    	BuildTime = 15
End
;-----------------------------------------------------------------------------
Object RohanPippin

AddModule        ; Here i give A Hero Rank 10 Right on Start when he Show up in Game
Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
                LevelToGrant    = 10
                MPOnly                  = No
        End
End
	RadarPriority = UNIT
	KindOf = HOBBIT_KINDOF
	SelectPortrait         = HPPippin
	ButtonImage	       = HIPippin
	MaxSimultaneousOfType	= 1         ;This means Only One can exists At The Same time in Game
   	BuildCost = 2000
    	BuildTime = 15
End
;-----------------------------------------------------------------------------
Object RohanMerry

AddModule       ; Here i give A Hero Rank 10 Right on Start when he Show up in Game
Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
                LevelToGrant    = 10
                MPOnly                  = No
        End
End
	RadarPriority = UNIT
	KindOf = HOBBIT_KINDOF
	SelectPortrait         = HPMerry
	ButtonImage	       = HIMerry
	MaxSimultaneousOfType	= 1      ;This means Only One can exists At The Same time in Game
   	BuildCost = 2000
    	BuildTime = 15
End

;================================================ Bilbo Bagins =====================================================================
;-------------------------------- This will be Total Conversion of Angmar Hero To Bilbo Bagins Hero --------------------------------

Object AngmarHwaldar    ; I will Change this Angmar Hero To Bilbo Bagins Hero With Powers 

Side = Civilian
ButtonImage		= UPHobbits ; Here i Give Button Image To Bilbo Baggins
SelectPortrait	        = UPHobbits
	
MaxSimultaneousOfType	= 1 ;This means Only One can exists At The Same time in Game
   	BuildCost = 3000    ; How Money he will Cost
    	BuildTime = 15      ; In Seconds

DisplayName     =  BilboBagins
	ThingClass		= CHARACTER_UNIT
	HeroSortOrder = 10
	TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
	BountyValue = ROHAN_FRODO_BOUNTY_VALUE
	CrushableLevel = 0
KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS HERO CAVALRY SCARY HEAVY_MELEE_HITTER SCORE HOBBIT THROWN_OBJECT ; This i Changed Because i want him To Cast spells

CommandSet = BilboCommandSet1  ; I Give him Changed Commandset from below
CommandPoints = 25

ReplaceModule ModuleTag_DRAW                            ; Here i Change original AngmarHwaldar Model with Little Hobbit Model
	Draw = W3DScriptedModelDraw ModuleTag_DRAW_new
	  
		OkToChangeModelColor = Yes
	  
		StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

		RandomTexture						= GUHbtShfA.tga	0	GUHbtShfA.tga
		RandomTexture						= GUHbtShfB.tga	0	GUHbtShfA.tga
		RandomTexture						= GUHbtShfC.tga	0	GUHbtShfA.tga
		RandomTexture						= GUHbtShfD.tga	0	GUHbtShfA.tga

		DefaultModelConditionState
			Model               = GUHbtShfA_SKN
			Skeleton            = GUHbtShf_SKL
			WeaponLaunchBone    = PRIMARY B_HANDR		;sometimes it's in primary sometimes in secondary.
			WeaponLaunchBone    = SECONDARY B_HANDR
		End
          
    
         #include "BilboBaginsAnims.inc"  ; I give this Model Changed Animation Set & I put this in sam directory with map
                                          ; Whitout this Anims Model will Not have Movement in game he will be Freez
End
;-------------------- I Add Weapon for Bilbo Baggins ------------------------------------------------------------------------
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    HobbitSword
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	
	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1
		Weapon = PRIMARY    HobbitRockThrow  
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	
	ArmorSet
		Conditions      = None
		Armor           = SoldierArmor
		DamageFX        = NormalDamageFX
	End

ReplaceModule ModuleTag_RespawnBody                  ; Healt of Bilbo Bagins
  	Body = RespawnBody ModuleTag_RespawnBody_new
		CheerRadius = EMOTION_CHEER_RADIUS
		MaxHealth		= 5000
		MaxHealthDamaged	= HOBBIT_HEALTH_DAMAGED
		RecoveryTime		= HOBBIT_HEALTH_RECOVERY_TIME
		BurningDeathBehavior = Yes
		BurningDeathFX       = FX_InfantryBurningFlame
  	End
End
	; *** AUDIO Parameters *** For Bilbo Bagins

	VoiceAttack				= HobbitShirriffVoiceAttack
	VoiceAttackAir				= NoSound
	VoiceAttackCharge			= PeasantMaleVoiceAttackCharge
	VoiceAttackMachine			= NoSound
	VoiceAttackStructure		        = PeasantMaleVoiceAttackBuilding
	VoiceFear 				= MEShire_Hobbit05
	VoiceCreated				= NoSound
	VoiceFullyCreated 			= PhialOn
	VoiceGuard				= NoSound
	VoiceMove				= HobbitShirriffVoiceMove
	VoiceMoveToCamp				= NoSound
	VoiceMoveWhileAttacking		        = NoSound
	VoicePriority				= 92
	VoiceSelect				= MEShire_Hobbit09
	VoiceSelectBattle 			= HobbitShirriffVoiceSelectBattle
	VoiceEnterStateAttackCharge	        = PeasantMaleVoiceEnterStateAttackCharge
	SoundImpact				= NoSound

	UnitSpecificSounds
		VoiceEnterUnitEvilMenTransportShip	= NoSound
		VoiceEnterUnitMordorMumakil		= NoSound
		VoiceEnterUnitSlaughterHouse		= NoSound
		VoiceGarrison				= NoSound
		VoiceInitiateCaptureBuilding		= HobbitShirriffVoiceCaptureBuilding
	End
;-----------------------------------------This Modules i Must Remove from Hwaldir because i don't want To Bilbo Have this Options------------------

RemoveModule ModuleTag_AnimAudioBehavior
RemoveModule ModueTag_HwaldarCommandSetLvl10
RemoveModule ModuleTag_HwaldarSummon1Enabler
RemoveModule ModuleTag_OCLSpecialPowerSummon1
RemoveModule ModuleTag_HwaldarSummon2Enabler
RemoveModule ModuleTag_OCLSpecialPowerSummon2
RemoveModule ModuleTag_Brigandage
RemoveModule ModuleTag_BrigandageUpdate
RemoveModule ModuleTag_Brigandage2
RemoveModule ModuleTag_DainLeadershipUpdate
RemoveModule ModuleTag_Leadership
;------------------------------------------------------------------------------
  LocomotorSet
    Locomotor = HeroHumanLocomotor
    Condition = SET_NORMAL 
    Speed = 30               ; He's slow cause he's so old
   End
	Geometry = CYLINDER       ; I Change Geometry to Small because Bilbo is Smaller Than Hwaldir
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 18;
  ShadowSizeY = 18;
  ShadowTexture = ShadowI;

AddModule                                             ; Here i give A Hero Rank 10 Right on Start when he Show up in Game
Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
                LevelToGrant    = 10
                MPOnly                  = No
        End
    End
;==================================================== BILBO POWERS  =====================================================================
;------------------------------ Here i will Give Bilbo Bagins New Powers --------------------------------------------

;-------------------------------------------- POWER: Word Of Power ----------------------------------------------------

AddModule
    Behavior = SpecialPowerModule ModuleTag_WordStarter_new    
        SpecialPowerTemplate      = SpecialAbilityWordOfPower
        UpdateModuleStartsAttack  = Yes
        StartsPaused                = no
    End
End

AddModule     ; This is Word of Power
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate_Bilbo 
        SpecialPowerTemplate    = SpecialAbilityWordOfPower
        WhichSpecialWeapon        = 1
        SkipContinue            = Yes

        UnpackTime              = 1700
        PackTime                = 1   
        FreezeAfterTriggerDuration = 2500 ; Hold AI for this long after we fire.
       
        AwardXPForTriggering    = 0       
        StartAbilityRange        = 80.0
       
        SpecialWeapon            = GandalfWordOfPower
    End
End
;-------------------------------------------- POWER: Morgul Blade ----------------------------------------------------

AddModule 
	Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter_new
		SpecialPowerTemplate		= SpecialAbilityBlackRiderMorgulBlade
		UpdateModuleStartsAttack	= Yes
		StartsPaused				= no
	End
End

AddModule 
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate_new
		SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
		SkipContinue			= Yes

		UnpackTime				= 250
		PreparationTime			= 1
		PersistentPrepTime		= 500
		PackTime				= 100
		
		AwardXPForTriggering	= 0		
		StartAbilityRange		= 15.0
		
		SpecialWeapon			= EvilMenBlackRiderMorgulBlade
		WhichSpecialWeapon		= 1
	End
End

AddModule 
	Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility_new
		SpecialAbility	= SpecialAbilityBlackRiderMorgulBlade
		ForbiddenStatus = INSIDE_GARRISON
		AllowSelf		= No
		Query			= 1 MORGULBLADE_OBJECT_FILTER
	End
    End

;-------------------------------------------- POWER: Istari Light  ---------------------------------------------------


AddModule 
	Behavior = SpecialPowerModule ModuleTag_IstariLightPower                      
		SpecialPowerTemplate		= SpecialAbilityIstariLight
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= no
		InitiateSound			= GandalfVoiceAttackIstariLight	;this plays when he targets, not when he fires
	End
End
AddModule 
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IstariLightUpdate
		SpecialPowerTemplate    = SpecialAbilityIstariLight
		SkipContinue			= Yes
		UnpackTime              = 2000 
 		PreparationTime         = 1  
 		PersistentPrepTime      = 2000
 		PackTime                = 500
		AwardXPForTriggering    = 0
		StartAbilityRange		= GANDALF_PHASER_CAST_RANGE ; Note: This has to be smaller than the weapon range or it'll never succeed
		ApproachRequiresLOS		= Yes		
		SpecialWeapon			= GandalfStaffWeapon
		MustFinishAbility		= Yes
		WhichSpecialWeapon		= 3
		BusyForDuration			= 2500
	End
End
;-------------------------------------------- POWER: FireBall  ---------------------------------------------------

AddModule 
Behavior = SpecialPowerModule ModuleTag_FireballStarter_Level1
	SpecialPowerTemplate	 = SpecialAbilityHeroFireball_Level1
	UpdateModuleStartsAttack = Yes
	StartsPaused			 = no
     End
End

AddModule 
Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate_Level1
	SpecialPowerTemplate = SpecialAbilityHeroFireball_Level1
	WhichSpecialWeapon	 = 1 // This sets SPECIAL_WEAPON_ONE
	SkipContinue		 = Yes

	UnpackTime			 = 800
	PreparationTime		 = 1   
	PersistentPrepTime	 = 1000	
	PackTime			 = 100
	
	AwardXPForTriggering = 0
	
	StartAbilityRange	 = CREATE_A_HERO_FIREBALL_RANGE
	MustFinishAbility	 = Yes
	SpecialWeapon		 = WizardFireballL1
      End
   End
;-------------------------------------------- POWER: Energy Shield  ---------------------------------------------------
AddModule 
Behavior = SpecialPowerModule ModuleTag_CreateAHeroChargeStarter_Level3
	SpecialPowerTemplate      = SpecialAbilityCreateAHeroCharge_Level3
	UpdateModuleStartsAttack  = Yes
	StartsPaused			 = no
End
End

AddModule 
Behavior = SpecialAbilityUpdate ModuleTag_CreateAHeroChargeUpdate_Level3
	SpecialPowerTemplate		= SpecialAbilityCreateAHeroCharge_Level3
	StartAbilityRange			= 150.0 ;//Negative distances will cause the unit to overshoot the destination.
	AbilityAbortRange			= 50.0
	PreparationTime				= 0 
	PackTime					= 3000  ;// without this pack time, the charge would not complete
	//TriggerSound				= GondorSoldierVoiceEnterStateAttackCharge
	TriggerAttributeModifier	= CreateAHeroChargeBonus_Level3
	AttributeModifierDuration	= 20000
	ChargeAttackSpeedBoost		= Yes
	IgnoreFacingCheck			= Yes
      End
   End
End

CommandSet BilboCommandSet1                      ; This is Buttons With Powers For Bilbo Bagins
         1      = Command_ToggleHobbitRockThrow
         2      = Command_CreateAHero_Charge_Level3
         3      = Command_AngmarMorgomirMorgulBlade
         4      = Command_GondorGandalfIstariLight
         5      = Command_CreateAHero_Fireball_Level1
         6      = Command_SpecialAbilityWordOfPower
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16      = Command_SetStanceBattle
	17      = Command_SetStanceAggressive
	18      = Command_SetStanceHoldGround
End

;----------------------------------------------------------------------------------------------------
;============================================= Legolas ==============================================


Object ElvenLegolas

ReplaceModule ModuleTag_01_
	Draw = W3DScriptedModelDraw ModuleTag_01_new

		OkToChangeModelColor = Yes
	  
		StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

		DefaultModelConditionState
			Model               = RULegolas_SKN
			Skeleton			= RULegolas_SKL
			WeaponLaunchBone    = PRIMARY ARROW
		End
		 
		ModelConditionState = WEAPONLOCK_SECONDARY
			Model               = RULegolas_SKN
			Skeleton            = RULegolas_SKL
			ParticleSysBone		= BAT_HEAD Slayer FollowBone:Yes
		End
               
                ModelConditionState = WEAPONSET_HERO_MODE          ; I Add This Condition, this is Sparklings Around Legolas when you choose Deadly sniper 
                        ParticleSysBone = BAT_HEAD ThranDeadEye FollowBone:Yes
			ParticleSysBone	= NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
			ParticleSysBone	= NONE Predator02 FollowBone:Yes Persist:HOLD PersistID:100
                  End
           #include "LegolasAnims.inc"     ; I Change Some animations of legolas so he can use Deadly sniper, Animation are in map folder
End

CommandSet = LegolasNewCommandSet       ;This Will be New Commandset Changed below For Legolas With New Powers

	MaxSimultaneousOfType	= 1     ;This means Only One can exists At The Same time in Game

RemoveModule ModuleTag_ElvenCamouflage  ; no more invisibility

ReplaceModule ModuleTag_RespawnBody  ; Legolas Healt
	Body = RespawnBody ModuleTag_RespawnBody_new
		CheerRadius 			= EMOTION_CHEER_RADIUS
		MaxHealth         		= 5000  ; Default is (2000) LEGOLAS_HEALTH	;BALANCE Legolas Health
		PermanentlyKilledByFilter	= NONE		;Who kills me permanently?
   		DodgePercent      		= HERO_DODGE_PERCENT
	End
End
AddModule                               ; Here i give A Hero Rank 10 Right on Start when he Show up in Game
        Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
                LevelToGrant    = 10
                MPOnly                  = No
        End
    End

;------------------------- I Will Give legolas New Power "Deadly Arrow Sniper" ----------------

AddModule
	Behavior = SpecialPowerModule ModuleTag_DeadlySniperStarter                      
		SpecialPowerTemplate      = SpecialAbilityDamrodHeroMode
		UpdateModuleStartsAttack  = Yes
		StartsPaused = No
	End
    End

AddModule
	Behavior = HeroModeSpecialAbilityUpdate ModuleTag_DeadlySniper  
		SpecialPowerTemplate    = SpecialAbilityDamrodHeroMode
		UnpackingVariation		= 1

		UnpackTime              = 1 ;instant unpack
		PreparationTime         = 0    ;  
		PackTime                = 0 ;

		AwardXPForTriggering    = 0
		
		;HeroAttributeModifier = DamrodDeadlySniper
		HeroEffectDuration = 10000
		StopUnitBeforeActivating = yes
	End
    End


;------------------------- I Will Give legolas New Power "LongShot Arrows" ----------------
AddModule
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate		= SpecialAbilityMenLongShot
		OCL							= OCL_LongShotAbility
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		
		;// Need to set a model condition (unused by the horde anyway) in order to
		;// freeze the horde for the duration of the spell
		SetModelCondition			= ModelConditionState:USER_1
		SetModelConditionTime		= 5.0
		DisableDuringAnimDuration	= Yes
	End
End

AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate   
		SpecialPowerTemplate    = SpecialAbilityMenLongShot
		PackTime				= 5000									// returning to flap
		MustFinishAbility		= Yes
		SpecialWeapon			= MenLongShotWeapon
		NeedLivingTargets		= No
		;PackSound				= LongshotRangerCall	;this worked!
		;UnpackSound				= LongshotRangerCall	;this didn't work
		;PrepSoundLoop			= LongshotRangerCall	;this worked!
		TriggerSound			= RangerVoiceLongShot
		ApproachRequiresLOS		= No
	End
    End
	WeaponSet
		Conditions = None 
		Weapon				= PRIMARY	LegolasBow
		Weapon				= SECONDARY	LegolasSword
	    AutoChooseSources	= SECONDARY NONE
	End

	WeaponSet
		Conditions		= WEAPONSET_HERO_MODE
		Weapon			= PRIMARY	DamrodBowDeadlySniper
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
End
;-----------------------------------------------------------------------------------------------------------------------------
CommandButton Command_SpecialAbilityTrainArchers    ;This Button I Change Into Deadly Sniper because i need This palantir Icon
	Command			= SPECIAL_POWER 
	SpecialPower		= SpecialAbilityDamrodHeroMode
        Options                 = OK_FOR_MULTI_SELECT
	TextLabel		= CONTROLBAR:LegolasDeadlySniper
	DescriptLabel		= CONTROLBAR:ToolTipLegolasDeadlySniper
	ButtonImage		= HSLegolasTrainArchers
	ButtonBorderType	= ACTION
	InPalantir		= Yes
  DisableOnModelCondition = WEAPONSET_TOGGLE_1
End

CommandSet LegolasNewCommandSet   ;This is New Legolas Buttons in Palantir
	1	= Command_ToggleStance
	2  	= Command_LegolasHawkStrike
	3  	= Command_LegolasKnifeFightingMode
	4  	= Command_AngmarLongShotAbility
	5  	= Command_SpecialAbilityArrowStorm
	6	= Command_SpecialAbilityTrainArchers
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

;=========================================== GIMLI ================================================
;--------------------------------------------------------------------------------------------------

Object DwarvenGimli

CommandSet = RohanGimliCommandSet_New

	MaxSimultaneousOfType	= 1    ;This means Only One can exists At The Same time in Game

AddModule       ; Here i give A Hero Rank 10 Right on Start when he Show up in Game
        Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
                LevelToGrant    = 10
                MPOnly                  = No
        End
    End
;-------------------------------------------- POWER: FireBall  ---------------------------------------------------

AddModule 
Behavior = SpecialPowerModule ModuleTag_FireballStarter_L3
	SpecialPowerTemplate	 = SpecialAbilityHeroFireball_Level3
	UpdateModuleStartsAttack = Yes
	StartsPaused			 = no
     End
End

AddModule 
Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate_L3
	SpecialPowerTemplate = SpecialAbilityHeroFireball_Level3
	WhichSpecialWeapon	 = 1
	SkipContinue		 = Yes

	UnpackTime			 = 800
	PreparationTime		 = 1   
	PersistentPrepTime	 = 1000	
	PackTime			 = 100
	
	AwardXPForTriggering = 0
	
	StartAbilityRange	 = CREATE_A_HERO_FIREBALL_RANGE
	MustFinishAbility	 = Yes
	SpecialWeapon		 = WizardFireballL3
      End
   End
;-------------------------------------------- POWER: Ruin Buildings ---------------------------------------------------

AddModule 
	Behavior = SpecialPowerModule ModuleTag_RuinStarter       
		SpecialPowerTemplate      = SpecialAbilityAngmarMorgramirRuin
		UpdateModuleStartsAttack  = Yes
		StartsPaused		  	  = no
		InitiateSound				= DwarfCatapultVoiceAttackBuilding
	End
End

AddModule 
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_RuinWeaponFireUpdate
		SpecialPowerTemplate    = SpecialAbilityAngmarMorgramirRuin
		SpecialWeapon			= AngmarMorgramirRuinWeapon
		WhichSpecialWeapon		= 2			; Corresponds to SPECIAL_WEAPON_TWO
		StartAbilityRange		= 75.0

		SkipContinue			= Yes
		UnpackTime				= 2000		; Trigger on frame 42 (of 115)
		PackTime				= 500		; Remaining 73 frames (of 115)
		MustFinishAbility		= Yes
	End
    End
End

Weapon RohanGimliAxe                   ; making gimli shoot a little faster
  DelayBetweenShots     = 100   ; GIMLI_DELAYBETWEENSHOTS 		; time between shots, msec
  PreAttackDelay        = GIMLI_PREATTACKDELAY       			; 400 is sword swing delay time before contact with target.
  FiringDuration        = 300 ; GIMLI_FIRINGDURATION  			; Duration of the sword swing
End

Weapon RohanGimliSuperAxe
  DelayBetweenShots     = 200
  FiringDuration        = 400
End

CommandSet RohanGimliCommandSet_New
	1	= Command_ToggleStance
	2  	= Command_GimliAxeThrow
	3  	= Command_RohanGimliLeap
	4  	= Command_SpecialAbilitySlayer
        5       = Command_CreateAHero_Fireball_Level3
        6       = Command_SpecialAbilityAngmarMorgramirRuin
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  = Command_SetStanceBattle
	17  = Command_SetStanceAggressive
	18  = Command_SetStanceHoldGround
End

;============================================== DAMROD (I Add this Arnor Hero to Elves Side) ============================

Object ArnorCaptain

CommandSet = DamrodCommandSet

	MaxSimultaneousOfType	= 1    ;This means Only One can exists At The Same time in Game
   	BuildCost = 3000    ; How Money he will Cost
    	BuildTime = 15      ; In Seconds

AddModule       ; Here i give A Hero Rank 10 Right on Start when he Show up in Game
        Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
                LevelToGrant    = 10
                MPOnly                  = No
        End
    End

; I will remove Below Some Old Damrod Abilitys

RemoveModule ModuleTag_08
RemoveModule SpecialPowerDamrodRallyRangersAI

;------------------------------ I Will Add somme New Powers To Damrod --------------------------------------------------

;------------------------- I Will Give Damrod New Power "LongShot Arrows" ----------------
AddModule
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate		= SpecialAbilityMenLongShot
		OCL							= OCL_LongShotAbility
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		
		;// Need to set a model condition (unused by the horde anyway) in order to
		;// freeze the horde for the duration of the spell
		SetModelCondition			= ModelConditionState:USER_1
		SetModelConditionTime		= 5.0
		DisableDuringAnimDuration	= Yes
	End
End

AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate   
		SpecialPowerTemplate    = SpecialAbilityMenLongShot
		PackTime				= 5000									// returning to flap
		MustFinishAbility		= Yes
		SpecialWeapon			= MenLongShotWeapon
		NeedLivingTargets		= No
		;PackSound				= LongshotRangerCall	;this worked!
		;UnpackSound				= LongshotRangerCall	;this didn't work
		;PrepSoundLoop			= LongshotRangerCall	;this worked!
		TriggerSound			= RangerVoiceLongShot
		ApproachRequiresLOS		= No
	End
    End

;--------------------------------------- POWER: Wounding Arrow ------------------------------------------------------------------------------

AddModule	
	Behavior = SpecialPowerModule ModuleTag_WoundArrow
		SpecialPowerTemplate      = SpecialAbilityWoundArrow
		UpdateModuleStartsAttack  = Yes
    		InitiateSound             = FaramirRangerVoiceWoundingArrow
	End
End

AddModule	
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WoundArrowUpdate
		SpecialPowerTemplate    = SpecialAbilityWoundArrow
		SkipContinue		= Yes
		UnpackTime              = 2000 
		PreparationTime         = 1   
		PersistentPrepTime      = 1000 
		PackTime                = 1
		
		AwardXPForTriggering    = 0
		StartAbilityRange = 325.0 ; Note: This has to be smaller than the weapon range or it'll never succeed
		
		ApproachRequiresLOS		= Yes		
		
		SpecialWeapon = FaramirWoundArrow
		WhichSpecialWeapon = 1
	End
End

;------------------------------------------- POWER: Birds Scouts (Reveal Area & Detect Stealth) ---------------------------------------------------

AddModule
Behavior = OCLSpecialPower ModuleTag_CreateAHeroSummonFamiliarPower_Level3
	SpecialPowerTemplate	= SpecialAbilityCreateAHeroSummonFamiliar_Level3
	OCL						= OCL_CreateAHeroSummonFamiliar_Level3
	CreateLocation			= CREATE_AT_LOCATION
	StartsPaused			= no
	SetModelCondition		= ModelConditionState:USER_1
	SetModelConditionTime	= 8.1
      End
   End
End

CommandSet DamrodCommandSet
	1	= Command_ToggleStance
	2	= Command_ToggleDamrodWeapon
	3	= Command_SpecialAbilityWoundArrow
	4	= Command_SpecialAbilityDamrodDeadlySniper
	5	= Command_AngmarLongShotAbility             ;LongShot
        6       = Command_CreateAHero_SummonFamiliar_Level3 ;Birds Scouts
	12 = Command_CaptureBuilding
	13 = Command_AttackMove
	14 = Command_Stop
	16  = Command_SetStanceBattle
	17  = Command_SetStanceAggressive
	18  = Command_SetStanceHoldGround
End

;=======================================================================================================================
;;;------------------------------------- Giant Ancient Ent Warrior -----------------------------------------------------
;=======================================================================================================================

Object RohanTreeBerd

Scale = 3.50         ;This is Size Of Ancient Ent

CommandSet = RohanTreeBeardCommandSet_new

ReplaceModule ModuleTag_01                               
	Draw = W3DScriptedModelDraw ModuleTag_01_Ripples
		StaticModelLODMode = Yes
		WadingParticleSys = EntRipples
		WadingParticleSys = EntSplash

		OkToChangeModelColor = Yes
	
		ExtraPublicBone = B_POINT1R
		ExtraPublicBone = PASSENGER
		ExtraPublicBone = IMPACT


		DefaultModelConditionState
			Model               = RUTreeberd_SKN
			Skeleton	    = RUTreeberd_SKL
			WeaponLaunchBone    = PRIMARY Firepoint
			WeaponLaunchBone    = SECONDARY Firepoint

			ParticleSysBone     = BAT_SPINE1 TreeBeardIdleLeaves FollowBone: no
                        ParticleSysBone     = NONE AngBuildingContructDust FollowBone:Yes
                        ParticleSysBone     = NONE Pointer FollowBone:Yes
                        ParticleSysBone     = NONE AngBuildingContructDust2 FollowBone:Yes
                        ParticleSysBone     = NONE AngBuildingContructDustCastles  FollowBone:Yes
                        ParticleSysBone     = NONE AngBuildingContructDust2B FollowBone:Yes
                        ParticleSysBone     = NONE WallofEmbers FollowBone:Yes
                        ParticleSysBone     = NONE FireFlies02 FollowBone:Yes
                        ParticleSysBone     = NONE AngBuildingContructDustCastles2 FollowBone:Yes
                        ParticleSysBone     = BAT_HEAD AngBuildingContructDustCastles2 FollowBone:Yes
 			ParticleSysBone     = BAT_HEAD AngFordgeDoorOpen1 FollowBone:yes
 			ParticleSysBone     = BAT_HEAD BeaconSmokeCF8744 FollowBone:yes
 			ParticleSysBone     = BAT_HEAD GpuParticleTest3 FollowBone:yes
 			ParticleSysBone     = BAT_HEAD GpuParticleTest4 FollowBone:yes
 			ParticleSysBone     = NONE BeaconSmokeCF8744 FollowBone:yes
 			ParticleSysBone     = NONE GpuParticleTest3 FollowBone:yes
 			ParticleSysBone     = NONE GpuParticleTest4 FollowBone:yes
		End

  		ModelConditionState = AFLAME
			Model               = RUTreeberd_SKN
			Skeleton			= RUTreeberd_SKL

			ParticleSysBone     = BAT_HEAD TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
  			ParticleSysBone     = BAT_HEAD TreebeardSmoke FollowBone:yes FXTrigger:NONE Persist:SPAWN
 			ParticleSysBone     = BAT_SPINE1 TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
  			ParticleSysBone     = BAT_PELVIS TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
 			ParticleSysBone     = BAT_PELVIS TreebeardEmbers FollowBone:yes FXTrigger:NONE Persist:SPAWN
 			ParticleSysBone     = BAT_PELVIS TreebeardFlare FollowBone:yes FXTrigger:NONE Persist:SPAWN
                End

         #include "AncientEntWarriorAnims.inc"
End
End

	ReplaceModule ModuleTag_ActiveBody
		Body = ActiveBody ModuleTag_ActiveBody_Healt
			MaxHealth         = 30000				  ;BALANCE Ent Health
			CheerRadius 			= EMOTION_CHEER_RADIUS
		End
          End

AddModule       ; Here i give A Hero Rank 10 Right on Start when he Show up in Game
        Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
                LevelToGrant    = 10
                MPOnly                  = No
        End
    End

RemoveModule Module_DoCommandUpgrade                                              ;Here i remove Rock from his hand on start

        Side				= Neutral   ;Default is Elves
	EditorSorting			= UNIT
	ThreatLevel			= 8000   ;Default is TREEBEARD_THREAT_LEVEL
	ThingClass			= MEDIUM_MONSTER
        CrusherLevel		        = 4 ; Default is 2
	MaxSimultaneousOfType	        = 1
	TransportSlotCount		= TRANSPORTSLOTCOUNT_MONSTER
	CommandPoints			= 0
	
        WeaponSet
		Conditions          = None
		Weapon              = PRIMARY	RohanTreeBeardPunch
		Weapon              = SECONDARY	RohanBuildingTeardown
		OnlyAgainst         = SECONDARY	STRUCTURE BLOCKING_GATE
	End

	WeaponSet
		Conditions          = WEAPONSET_TOGGLE_1
		Weapon              = PRIMARY	None
	End

;--------------------------------------------------------------------------------------------------------------------------------------
;;;;;;=================================== Ancient Ent Warrior New Special Powers  =====================================================

;----------------------------------------------- POWER: Ents Energy Wave ------------------------------------------------------------------------
AddModule
    Behavior = SpecialPowerModule ModuleTag_WordStarter_new    
        SpecialPowerTemplate      = SpecialAbilityWordOfPower
        UpdateModuleStartsAttack  = Yes
        StartsPaused                = no
    End
End

AddModule
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate_new
        SpecialPowerTemplate    = SpecialAbilityWordOfPower
        WhichSpecialWeapon        = 1
        SkipContinue            = Yes

        UnpackTime              = 1700
        PackTime                = 1   
        FreezeAfterTriggerDuration = 2500 ; Hold AI for this long after we fire.
       
        AwardXPForTriggering    = 0       
        StartAbilityRange        = 80.0
       
        SpecialWeapon            = GandalfWordOfPower
      End
   End

;----------------------------------------------- POWER: Tornado ------------------------------------------------------------------------

AddModule
Behavior = OCLSpecialPower	ModuleTag_OCLSpawnTornado_Level3
	SpecialPowerTemplate	= SpecialPowerCreateAHeroSpawnTornado_Level3
	OCL						= OCL_CreateAHeroSpawnTornado_Level3
	CreateLocation			= CREATE_AT_LOCATION
	StartsPaused			= no
     End
  End
;----------------------------------------------- POWER: Light Blast ------------------------------------------------------------------------

AddModule
Behavior = SpecialPowerModule ModuleTag_LightBlastPower_L3
	SpecialPowerTemplate	 = SpecialAbilityLightBlast_L3
	UpdateModuleStartsAttack = Yes
	StartsPaused			 = No
    End
End

AddModule
Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_LightBlastPower_L3_Update
	SpecialPowerTemplate = SpecialAbilityLightBlast_L3
	SkipContinue		 = Yes
	UnpackTime			 = 2000	
	PreparationTime		 = 1  
	PersistentPrepTime	 = 2000
	PackTime			 = 500
	AwardXPForTriggering = 0
	StartAbilityRange	 = CREATE_A_HERO_LIGHTBLAST_CAST_RANGE // Note: This has to be	smaller	than the weapon	range or it'll never succeed
	ApproachRequiresLOS	 = Yes		 
	SpecialWeapon		 = CreateAHeroLightBlastWeapon_L3
	MustFinishAbility	 = Yes
	WhichSpecialWeapon	 = 3
	BusyForDuration		 = 2500
     End
  End

;----------------------------------------------- POWER: Ball Lightning ------------------------------------------------------------------------

AddModule
Behavior = SpecialPowerModule ModuleTag_SpecialAbilityBallLightning_L3
	SpecialPowerTemplate	 = SpecialAbilityBallLightning_L3
	UpdateModuleStartsAttack = Yes
	StartsPaused			 = No
    End
End

AddModule
Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BallLightningUpdate_L3
	SpecialPowerTemplate = SpecialAbilityBallLightning_L3
	SkipContinue		 = Yes
	UnpackTime			 = 1000
	PreparationTime		 = 1  
	PersistentPrepTime	 = 1000
	PackTime			 = 500
	AwardXPForTriggering = 0
	StartAbilityRange	 = CREATE_A_HERO_BALL_LIGHTNING_START_RANGE //	Note: This has to be smaller than the weapon range or it'll	never succeed
	ApproachRequiresLOS	 = Yes		 
	SpecialWeapon		 = CreateAHerBallLightningWeapon_L3
	MustFinishAbility	 = Yes
	WhichSpecialWeapon	 = 3
	BusyForDuration		 = 2500
      End
   End

;----------------------------------------------- POWER: Earthquake ------------------------------------------------------------------------

AddModule
Behavior = SpecialPowerModule ModuleTag_CreateAHeroEarthShakerStarter_Level3
	SpecialPowerTemplate      = SpecialAbilityCreateAHeroEarthShaker_Level3
	UpdateModuleStartsAttack  = Yes
	StartsPaused			= no
  End
End

AddModule
Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_CreateAHeroEarthShakerUpdate_Level3
	SpecialPowerTemplate    = SpecialAbilityCreateAHeroEarthShaker_Level3
	SpecialWeapon			= CreateAHeroEarthShaker_Level3
	WhichSpecialWeapon		= 3			; Corresponds to SPECIAL_WEAPON_THREE
	StartAbilityRange		= 1.0
	
	SkipContinue			= Yes
	UnpackTime				= 2000		; Trigger on frame 60 (of 100)
	PackTime				= 1333		; Remaining 40 frames (of 100)
	MustFinishAbility		= Yes
     End
   End
End
;------------------------------------------------------------------------------

Weapon RohanTreeBeardPunch  ; BALANCE TreeBeard Weapon Normal
  LeechRangeWeapon = Yes
  AttackRange				= 80.0   ; Default is 30 But i change it because Ent is too big & need bigger Radius of Damage
  MeleeWeapon				= Yes
  DelayBetweenShots			= 1000  ; Default is 2000          ; time between shots, msec
  FiringDuration			= 1900            ; min 1900 for anim
  PreAttackDelay			= 1100
  PreAttackType				= PER_SHOT ; Do the delay each time we attack a new target
  FireFX					= FX_TreeBeardPunch
  RadiusDamageAffects		= ENEMIES
  DamageDealtAtSelfPosition = Yes ; A melee based AoE.  Arc radiates from me, not them

ClearNuggets
  DamageNugget                        ; A basic Nugget that just does damage
    Damage        = 2000   ; Default is ROHAN_TREEBEARD_PUNCH_DAMAGE
    Radius        = 200    ; Default is ROHAN_TREEBEARD_PUNCH_RADIUS
    DelayTime     = 0
    DamageType    = SIEGE
    DamageFXType  = CLUBBING
    DeathType     = NORMAL
    DamageArc	  = 100
  End
End
;----------------------------------------------------------------------------------------------------

CommandButton Command_CreateAHero_SpecialAbilityWordOfPower            ; This button i will Change into Ent Word of Power
	Command			   = SPECIAL_POWER
	SpecialPower	           = SpecialAbilityWordOfPower
	Options			   = OK_FOR_MULTI_SELECT
	TextLabel		   = CONTROLBAR:EntsEnergyWave
	ButtonImage		   = CAHBlastofLight
	RadiusCursorType           = DominateRadiusCursor
	ButtonBorderType           = ACTION
	DescriptLabel	           = CONTROLBAR:ToolTipEntsEnergyWave
	InPalantir		   = Yes
        UnitSpecificSound          = EntMootTheEntsAreGoingToWar	
End


CommandSet RohanTreeBeardCommandSet_new
    1    = Command_ToggleStance
    2    = Command_CreateAHero_SpecialAbilityWordOfPower ; Changed button Above into Ent Word of Power
    3    = Command_CreateAHero_SpawnTornado_Level3       ; Tornado
    4    = Command_CreateAHero_LightBlast_L3             ; Light Blast
    5    = Command_CreateAHero_BallLightning_L3          ; Lightning Strike
    6    = Command_CreateAHero_EarthShaker_Level3        ; Earthquake
    13   = Command_AttackMove
    14   = Command_Stop
    16   = Command_SetStanceBattle
    17   = Command_SetStanceAggressive
    18   = Command_SetStanceHoldGround
End

;==========================================================================================================================================================

