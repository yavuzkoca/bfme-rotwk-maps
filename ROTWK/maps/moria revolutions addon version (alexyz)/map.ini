;//////////////////////////////////////////////////////////////////////////////
;INI by Alexyz ////////////////////////////////////////////////////
;//////////////////////////////////////////////////////////////////////////////


;; -------------------------------------
;; INTRINSIC (Base-Level) Sciences for multiplayer
;; -------------------------------------

Science SCIENCE_MEN
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_ELVES
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_DWARVES
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_ISENGARD
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_MORDOR
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_WILD
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

;; -------------------------------------
;; INTRINSIC (Base-Level) Sciences for single player
;; -------------------------------------

Science SCIENCE_GOOD
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_EVIL
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

;; -------------------------------------
;; Good Sciences
;; -------------------------------------

Science SCIENCE_HobbitAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ISENGARD OR SCIENCE_WILD OR SCIENCE_MORDOR OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES OR SCIENCE_ANGMAR
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_ElvenGifts
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_HobbitAllies
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 12
  IsGrantable = Yes
End

Science SCIENCE_Heal
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ArrowVolleyEvil OR SCIENCE_ArrowVolleyGood
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 20
  IsGrantable = Yes
End

Science SCIENCE_Farsight
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ELVES
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_EnshroudingMistSP
  PrerequisiteSciences = SCIENCE_GOOD
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_RallyingCall
  PrerequisiteSciences = SCIENCE_EnshroudingMistSP
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

;; The MP version of the RallyingCall is available at Level 1.
Science SCIENCE_RallyingCallMP
  PrerequisiteSciences = SCIENCE_DWARVES OR SCIENCE_ELVES OR SCIENCE_MEN
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End
Science SCIENCE_EnshroudingMistMP
  PrerequisiteSciences = SCIENCE_RallyingCallMP
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End



Science SCIENCE_ElvenWood
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ELVES SCIENCE_Heal OR SCIENCE_ELVES SCIENCE_Farsight
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End


Science SCIENCE_Rebuild
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_Heal OR SCIENCE_ElvenWood OR SCIENCE_MEN OR SCIENCE_DWARVES
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_TomBombadil
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_SpiderlingAllies
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 12
  IsGrantable = Yes
End

Science SCIENCE_HobbitAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ANGMAR OR SCIENCE_ISENGARD OR SCIENCE_WILD OR SCIENCE_MORDOR OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES
  SciencePurchasePointCost = 3
  SciencePurchasePointCostMP = 4
  IsGrantable = Yes
End

Science SCIENCE_SpawnLoneTower
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ElvenWood OR SCIENCE_MEN SCIENCE_Rebuild OR SCIENCE_DWARVES SCIENCE_Heal OR SCIENCE_DWARVES SCIENCE_Rebuild
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_ArrowVolleyGood
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ChillWind OR SCIENCE_SummonOrcs
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 8
  IsGrantable = Yes
End

Science SCIENCE_DwarvenRiches
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_ElvenGifts OR SCIENCE_GOOD SCIENCE_Heal OR SCIENCE_DWARVES SCIENCE_RallyingCallMP OR SCIENCE_DWARVES SCIENCE_Rebuild
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_MenOfDaleAllies
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_RallyingCall OR SCIENCE_GOOD SCIENCE_TomBombadil OR SCIENCE_DWARVES SCIENCE_RallyingCallMP
  SciencePurchasePointCost = GOOD_RANK_3_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_CloudBreak
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_CaveBats
  SciencePurchasePointCost = GOOD_RANK_3_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_RohanAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_MEN SCIENCE_TomBombadil OR SCIENCE_MEN SCIENCE_SpawnLoneTower
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_DunedainAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_MEN SCIENCE_HobbitAllies OR SCIENCE_MEN SCIENCE_ArrowVolleyGood
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_EntAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ELVES SCIENCE_ElvenWood OR SCIENCE_ELVES SCIENCE_TomBombadil
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_EagleAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ELVES SCIENCE_ArrowVolleyGood OR SCIENCE_ELVES SCIENCE_EnshroudingMistMP
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_Undermine
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_DwarvenRiches OR SCIENCE_GOOD SCIENCE_Rebuild OR SCIENCE_DWARVES SCIENCE_HobbitAllies OR SCIENCE_DWARVES SCIENCE_SpawnLoneTower
  SciencePurchasePointCost = GOOD_RANK_3_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_Bombard
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_SummonOrcs
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 12
  IsGrantable = Yes
End

Science SCIENCE_ArmyoftheDead
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Flood OR SCIENCE_RainOfFire
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 24
  IsGrantable = Yes
End

Science SCIENCE_Earthquake
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Heal OR SCIENCE_Sunflare
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 20
  IsGrantable = Yes
End

Science SCIENCE_Flood
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Bombard OR SCIENCE_ArrowVolleyGood
  SciencePurchasePointCost = GOOD_RANK_4_COST
  SciencePurchasePointCostMP = 20
  IsGrantable = Yes
End

Science SCIENCE_Sunflare
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_TomBombadil OR SCIENCE_ArrowVolleyEvil
  SciencePurchasePointCost = GOOD_RANK_4_COST
  SciencePurchasePointCostMP = 20
  IsGrantable = Yes
End

Science SCIENCE_Citadel
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_DWARVES SCIENCE_Undermine OR SCIENCE_DWARVES SCIENCE_CloudBreak
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 25
  IsGrantable = Yes
End

;; -------------------------------------
;; Evil Sciences
;; -------------------------------------
; This is the shared Mordor and Wild Taint. Isengard has its own.
Science SCIENCE_Taint
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_MORDOR OR SCIENCE_WILD
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End


Science SCIENCE_FrozenLand
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_SpiderlingAllies
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 12
  IsGrantable = Yes
End

Science SCIENCE_ChillWind
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ANGMAR OR SCIENCE_ISENGARD OR SCIENCE_WILD OR SCIENCE_MORDOR OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 4
  IsGrantable = Yes
End

Science SCIENCE_SummonOrcs
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ANGMAR OR SCIENCE_ISENGARD OR SCIENCE_WILD OR SCIENCE_MORDOR OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_Crebain
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES OR  SCIENCE_WILD OR SCIENCE_MORDOR
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 4
  IsGrantable = Yes
End

Science SCIENCE_CaveBats
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_WILD OR SCIENCE_MORDOR OR SCIENCE_ISENGARD OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 4
  IsGrantable = Yes
End

Science SCIENCE_EyeofSauron
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_MORDOR
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_PalantirVision
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_WarChant
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD OR SCIENCE_WILD OR SCIENCE_MORDOR
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_WildMenAllies
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD SCIENCE_Crebain OR SCIENCE_ISENGARD SCIENCE_WarChant OR SCIENCE_WILD SCIENCE_WarChant
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_Barricade
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_CaveBats OR SCIENCE_EVIL SCIENCE_WarChant OR SCIENCE_MORDOR SCIENCE_Taint
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

; Mordor's Taint and Isengard's Taint are available at different levels, thus
; their prices are different and so they need separate entries
Science SCIENCE_IsengardTaint
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD SCIENCE_WarChant OR SCIENCE_ISENGARD SCIENCE_PalantirVision
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_Scavenger
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_WILD SCIENCE_Taint OR SCIENCE_WILD SCIENCE_WarChant
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_Devastation
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_WildMenAllies OR SCIENCE_EVIL SCIENCE_Taint OR SCIENCE_ISENGARD SCIENCE_PalantirVision
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_UntamedAllegiance
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_Taint OR SCIENCE_EVIL SCIENCE_Scavenger OR SCIENCE_MORDOR SCIENCE_EyeofSauron OR SCIENCE_MORDOR SCIENCE_Taint OR SCIENCE_WILD SCIENCE_Taint OR SCIENCE_WILD SCIENCE_CaveBats
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_SpiderlingAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ANGMAR OR SCIENCE_ISENGARD OR SCIENCE_WILD OR SCIENCE_MORDOR OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_EvilEyeofSauron
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_UntamedAllegiance OR SCIENCE_EVIL SCIENCE_SpiderlingAllies
  SciencePurchasePointCost = 15
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

; Mordor's CallTheHorde and Wild's CallTheHorde are available at different levels, thus
; their prices are different and so they need separate entries
Science SCIENCE_CalltheHorde
  PrerequisiteSciences = SCIENCE_WILD SCIENCE_WarChant
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End
Science SCIENCE_EvilCalltheHorde
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_UntamedAllegiance OR SCIENCE_EVIL SCIENCE_SpiderlingAllies
  SciencePurchasePointCost = EVIL_RANK_3_COST
  IsGrantable = Yes
End

Science SCIENCE_Industry
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_UntamedAllegiance OR SCIENCE_EVIL SCIENCE_Devastation OR SCIENCE_MORDOR SCIENCE_EyeofSauron OR SCIENCE_MORDOR SCIENCE_WarChant OR SCIENCE_ISENGARD SCIENCE_Crebain
  SciencePurchasePointCost = EVIL_RANK_3_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_Darkness
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_HobbitAllies
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 12
  IsGrantable = Yes
End

Science SCIENCE_WatcherAlly
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_CaveBats OR SCIENCE_ISENGARD SCIENCE_Devastation OR SCIENCE_ISENGARD SCIENCE_IsengardTaint OR SCIENCE_WILD SCIENCE_UntamedAllegiance OR SCIENCE_WILD SCIENCE_SpiderlingAllies
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_ArrowVolleyEvil
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ChillWind OR SCIENCE_HobbitAllies
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 8
  IsGrantable = Yes
End

Science SCIENCE_MordorCalltheHorde
  PrerequisiteSciences = SCIENCE_MORDOR SCIENCE_Industry OR SCIENCE_MORDOR SCIENCE_ArrowVolleyEvil
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_EvilBombard
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_CaveBats
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_AwakenWyrm
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_WatcherAlly OR SCIENCE_EVIL SCIENCE_Barricade OR SCIENCE_MORDOR SCIENCE_UntamedAllegiance OR SCIENCE_MORDOR SCIENCE_Barricade OR SCIENCE_WILD SCIENCE_Scavenger OR SCIENCE_WILD SCIENCE_WildMenAllies
  SciencePurchasePointCost = EVIL_RANK_3_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_FueltheFires
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_Darkness OR SCIENCE_EVIL SCIENCE_Devastation OR SCIENCE_ISENGARD SCIENCE_Industry OR SCIENCE_ISENGARD SCIENCE_WildMenAllies
  SciencePurchasePointCost = EVIL_RANK_3_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_FreezingRain
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD SCIENCE_WildMenAllies OR SCIENCE_ISENGARD SCIENCE_IsengardTaint
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_BalrogAlly
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_RainOfFire OR SCIENCE_Sunflare
  SciencePurchasePointCost = EVIL_RANK_4_COST
  SciencePurchasePointCostMP = 20
  IsGrantable = Yes
End

Science SCIENCE_RainOfFire
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ArrowVolleyEvil OR SCIENCE_ArrowVolleyGood
  SciencePurchasePointCost = EVIL_RANK_4_COST
  SciencePurchasePointCostMP = 20
  IsGrantable = Yes
End

Science SCIENCE_DragonAlly
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_AwakenWyrm OR SCIENCE_EVIL SCIENCE_ArrowVolleyEvil OR SCIENCE_ISENGARD SCIENCE_FreezingRain OR SCIENCE_ISENGARD SCIENCE_WatcherAlly OR SCIENCE_WILD SCIENCE_AwakenWyrm OR SCIENCE_WILD SCIENCE_Darkness
  SciencePurchasePointCost = EVIL_RANK_4_COST
  SciencePurchasePointCostMP = 20
  IsGrantable = Yes
End

Science SCIENCE_DragonStrike
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_RainOfFire OR SCIENCE_Sunflare
  SciencePurchasePointCost = EVIL_RANK_4_COST
  SciencePurchasePointCostMP = 20
  IsGrantable = Yes
End

Science SCIENCE_Avalanche
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Flood OR SCIENCE_Heal
  SciencePurchasePointCost = EVIL_RANK_4_COST
  SciencePurchasePointCostMP = 20
  IsGrantable = Yes
End


CommandSet MenSpellBookCommandSet_Override
	1 = Command_SpellBookSummonOrcs
	2 = Command_SpellBookChillWind
	3 = Command_SpellBookSpiderlingAllies
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookTomBombadil
	8 = Command_SpellBookFlood
	9 = Command_SpellBookHeal
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookAvalanche
	12 = Command_SpellBookEarthquake
End


CommandSet MenSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellSummonOrcs
	2 = Command_PurchaseSpellChillWind
	3 = Command_PurchaseSpellSpiderlingAllies
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellTomBombadil
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellHeal
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellAvalanche
	12 = Command_PurchaseSpellEarthquake
End


Object MenSpellBook_Override

	AddModule ModuleTag_SummonSpiderlings_Override
	Behavior = OCLSpecialPower ModuleTag_SummonSpiderlings
		SpecialPowerTemplate = SpellBookSpiderlingAllies
		OCL                  = OCL_SpawnSpiderlingsEgg
        TriggerFX			 = FX_SpiderlingsSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_Spiderlings
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_TomBombadil_Override
	Behavior = OCLSpecialPower ModuleTag_TomBombadil
		SpecialPowerTemplate = SpellBookTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_Earthquake_Override
	Behavior = OCLSpecialPower ModuleTag_Earthquake
		SpecialPowerTemplate = SpellBookEarthquake
		OCL                  = OCL_SpellBookEarthquake
        ;TriggerFX			 = FX_ElvenAlliesSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Avalanche_Override
	Behavior = OCLSpecialPower ModuleTag_Avalanche
		SpecialPowerTemplate 		= SpellBookAvalanche
		OCL                  		= OCL_SpellBookAvalancheEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX			 = FX_Avalanche
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_FrozenLand_Override
	Behavior = OCLSpecialPower		ModuleTag_FrozenLand
		SpecialPowerTemplate		= SpellBookFrozenLand
		TriggerFX					= FX_FrozenLandFX
		OCL							= OCL_SpecialPowerFrozenLand
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ChillWind_Override
	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonOrcs_Override
	Behavior = OCLSpecialPower ModuleTag_SummonOrcs
		SpecialPowerTemplate = SpellBookSummonOrcs
		OCL                  = OCL_SpellBookSummonOrcs
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonHobbits_Override
	Behavior = OCLSpecialPower ModuleTag_SummonHobbits
		SpecialPowerTemplate = SpellBookHobbitAllies
		OCL                  = OCL_SpawnHobbitsEgg
        TriggerFX			 = FX_HobbitSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_HobbitFriends
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

     CommandSet = MenSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject MenChildSpellBook_Override MenSpellBook_Override
     CommandSet = MenSpellBookCommandSet_Override
End

PlayerTemplate FactionMen
     PurchaseScienceCommandSetMP = MenSpellStoreCommandSet_Override
     SpellBookMp = MenSpellBook_Override
End


CommandSet ElvenSpellBookCommandSet_Override
	1 = Command_SpellBookSummonOrcs
	2 = Command_SpellBookChillWind
	3 = Command_SpellBookSpiderlingAllies
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookTomBombadil
	8 = Command_SpellBookFlood
	9 = Command_SpellBookHeal
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookAvalanche
	12 = Command_SpellBookEarthquake
End


CommandSet ElvenSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellSummonOrcs
	2 = Command_PurchaseSpellChillWind
	3 = Command_PurchaseSpellSpiderlingAllies
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellTomBombadil
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellHeal
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellAvalanche
	12 = Command_PurchaseSpellEarthquake
End

Object ElvenSpellBook_Override

	AddModule ModuleTag_Earthquake_Override
	Behavior = OCLSpecialPower ModuleTag_Earthquake
		SpecialPowerTemplate = SpellBookEarthquake
		OCL                  = OCL_SpellBookEarthquake
        ;TriggerFX			 = FX_ElvenAlliesSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_SummonSpiderlings_Override
	Behavior = OCLSpecialPower ModuleTag_SummonSpiderlings
		SpecialPowerTemplate = SpellBookSpiderlingAllies
		OCL                  = OCL_SpawnSpiderlingsEgg
        TriggerFX			 = FX_SpiderlingsSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_Spiderlings
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End



	AddModule ModuleTag_TomBombadil_Override
	Behavior = OCLSpecialPower ModuleTag_TomBombadil
		SpecialPowerTemplate = SpellBookTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_Avalanche_Override
	Behavior = OCLSpecialPower ModuleTag_Avalanche
		SpecialPowerTemplate 		= SpellBookAvalanche
		OCL                  		= OCL_SpellBookAvalancheEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX			 = FX_Avalanche
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_FrozenLand_Override
	Behavior = OCLSpecialPower		ModuleTag_FrozenLand
		SpecialPowerTemplate		= SpellBookFrozenLand
		TriggerFX					= FX_FrozenLandFX
		OCL							= OCL_SpecialPowerFrozenLand
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ChillWind_Override
	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonOrcs_Override
	Behavior = OCLSpecialPower ModuleTag_SummonOrcs
		SpecialPowerTemplate = SpellBookSummonOrcs
		OCL                  = OCL_SpellBookSummonOrcs
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonHobbits_Override
	Behavior = OCLSpecialPower ModuleTag_SummonHobbits
		SpecialPowerTemplate = SpellBookHobbitAllies
		OCL                  = OCL_SpawnHobbitsEgg
        TriggerFX			 = FX_HobbitSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_HobbitFriends
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


     CommandSet = ElvenSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject ElvenChildSpellBook_Override ElvenSpellBook_Override
     CommandSet = ElvenSpellBookCommandSet_Override
End

PlayerTemplate FactionElves
     PurchaseScienceCommandSetMP = ElvenSpellStoreCommandSet_Override
     SpellBookMp = ElvenSpellBook_Override
End


CommandSet DwarvenSpellBookCommandSet_Override
	1 = Command_SpellBookSummonOrcs
	2 = Command_SpellBookChillWind
	3 = Command_SpellBookSpiderlingAllies
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookTomBombadil
	8 = Command_SpellBookFlood
	9 = Command_SpellBookHeal
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookAvalanche
	12 = Command_SpellBookEarthquake
End


CommandSet DwarvenSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellSummonOrcs
	2 = Command_PurchaseSpellChillWind
	3 = Command_PurchaseSpellSpiderlingAllies
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellTomBombadil
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellHeal
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellAvalanche
	12 = Command_PurchaseSpellEarthquake
End

Object DwarvenSpellBook_Override

	AddModule ModuleTag_Earthquake_Override
	Behavior = OCLSpecialPower ModuleTag_Earthquake
		SpecialPowerTemplate = SpellBookEarthquake
		OCL                  = OCL_SpellBookEarthquake
        ;TriggerFX			 = FX_ElvenAlliesSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_SummonSpiderlings_Override
	Behavior = OCLSpecialPower ModuleTag_SummonSpiderlings
		SpecialPowerTemplate = SpellBookSpiderlingAllies
		OCL                  = OCL_SpawnSpiderlingsEgg
        TriggerFX			 = FX_SpiderlingsSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_Spiderlings
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End



	AddModule ModuleTag_TomBombadil_Override
	Behavior = OCLSpecialPower ModuleTag_TomBombadil
		SpecialPowerTemplate = SpellBookTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_Avalanche_Override
	Behavior = OCLSpecialPower ModuleTag_Avalanche
		SpecialPowerTemplate 		= SpellBookAvalanche
		OCL                  		= OCL_SpellBookAvalancheEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX			 = FX_Avalanche
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_FrozenLand_Override
	Behavior = OCLSpecialPower		ModuleTag_FrozenLand
		SpecialPowerTemplate		= SpellBookFrozenLand
		TriggerFX					= FX_FrozenLandFX
		OCL							= OCL_SpecialPowerFrozenLand
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ChillWind_Override
	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonOrcs_Override
	Behavior = OCLSpecialPower ModuleTag_SummonOrcs
		SpecialPowerTemplate = SpellBookSummonOrcs
		OCL                  = OCL_SpellBookSummonOrcs
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonHobbits_Override
	Behavior = OCLSpecialPower ModuleTag_SummonHobbits
		SpecialPowerTemplate = SpellBookHobbitAllies
		OCL                  = OCL_SpawnHobbitsEgg
        TriggerFX			 = FX_HobbitSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_HobbitFriends
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

     CommandSet = DwarvenSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject DwarvenChildSpellBook_Override DwarvenSpellBook_Override
     CommandSet = DwarvenSpellBookCommandSet_Override
End

PlayerTemplate FactionDwarves
     PurchaseScienceCommandSetMP = DwarvenSpellStoreCommandSet_Override
     SpellBookMp = DwarvenSpellBook_Override
End


CommandSet IsengardSpellBookCommandSet_Override
	1 = Command_SpellBookSummonOrcs
	2 = Command_SpellBookChillWind
	3 = Command_SpellBookSpiderlingAllies
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookTomBombadil
	8 = Command_SpellBookFlood
	9 = Command_SpellBookHeal
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookAvalanche
	12 = Command_SpellBookEarthquake
End


CommandSet IsengardSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellSummonOrcs
	2 = Command_PurchaseSpellChillWind
	3 = Command_PurchaseSpellSpiderlingAllies
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellTomBombadil
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellHeal
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellAvalanche
	12 = Command_PurchaseSpellEarthquake
End

Object IsengardSpellBook_Override

	AddModule ModuleTag_Earthquake_Override
	Behavior = OCLSpecialPower ModuleTag_Earthquake
		SpecialPowerTemplate = SpellBookEarthquake
		OCL                  = OCL_SpellBookEarthquake
        ;TriggerFX			 = FX_ElvenAlliesSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_SummonSpiderlings_Override
	Behavior = OCLSpecialPower ModuleTag_SummonSpiderlings
		SpecialPowerTemplate = SpellBookSpiderlingAllies
		OCL                  = OCL_SpawnSpiderlingsEgg
        TriggerFX			 = FX_SpiderlingsSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_Spiderlings
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End



	AddModule ModuleTag_TomBombadil_Override
	Behavior = OCLSpecialPower ModuleTag_TomBombadil
		SpecialPowerTemplate = SpellBookTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_Avalanche_Override
	Behavior = OCLSpecialPower ModuleTag_Avalanche
		SpecialPowerTemplate 		= SpellBookAvalanche
		OCL                  		= OCL_SpellBookAvalancheEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX			 = FX_Avalanche
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_FrozenLand_Override
	Behavior = OCLSpecialPower		ModuleTag_FrozenLand
		SpecialPowerTemplate		= SpellBookFrozenLand
		TriggerFX					= FX_FrozenLandFX
		OCL							= OCL_SpecialPowerFrozenLand
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ChillWind_Override
	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonOrcs_Override
	Behavior = OCLSpecialPower ModuleTag_SummonOrcs
		SpecialPowerTemplate = SpellBookSummonOrcs
		OCL                  = OCL_SpellBookSummonOrcs
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonHobbits_Override
	Behavior = OCLSpecialPower ModuleTag_SummonHobbits
		SpecialPowerTemplate = SpellBookHobbitAllies
		OCL                  = OCL_SpawnHobbitsEgg
        TriggerFX			 = FX_HobbitSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_HobbitFriends
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


     CommandSet = IsengardSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject IsengardChildSpellBook_Override IsengardSpellBook_Override
     CommandSet = IsengardSpellBookCommandSet_Override
End

PlayerTemplate FactionIsengard
     PurchaseScienceCommandSetMP = IsengardSpellStoreCommandSet_Override
     SpellBookMp = IsengardSpellBook_Override
End

CommandSet MordorSpellBookCommandSet_Override
	1 = Command_SpellBookSummonOrcs
	2 = Command_SpellBookChillWind
	3 = Command_SpellBookSpiderlingAllies
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookTomBombadil
	8 = Command_SpellBookFlood
	9 = Command_SpellBookHeal
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookAvalanche
	12 = Command_SpellBookEarthquake
End


CommandSet MordorSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellSummonOrcs
	2 = Command_PurchaseSpellChillWind
	3 = Command_PurchaseSpellSpiderlingAllies
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellTomBombadil
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellHeal
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellAvalanche
	12 = Command_PurchaseSpellEarthquake
End

Object MordorSpellBook_Override

	AddModule ModuleTag_Earthquake_Override
	Behavior = OCLSpecialPower ModuleTag_Earthquake
		SpecialPowerTemplate = SpellBookEarthquake
		OCL                  = OCL_SpellBookEarthquake
        ;TriggerFX			 = FX_ElvenAlliesSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	
	AddModule ModuleTag_SummonSpiderlings_Override
	Behavior = OCLSpecialPower ModuleTag_SummonSpiderlings
		SpecialPowerTemplate = SpellBookSpiderlingAllies
		OCL                  = OCL_SpawnSpiderlingsEgg
        TriggerFX			 = FX_SpiderlingsSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_Spiderlings
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End



	AddModule ModuleTag_TomBombadil_Override
	Behavior = OCLSpecialPower ModuleTag_TomBombadil
		SpecialPowerTemplate = SpellBookTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	

	AddModule ModuleTag_Avalanche_Override
	Behavior = OCLSpecialPower ModuleTag_Avalanche
		SpecialPowerTemplate 		= SpellBookAvalanche
		OCL                  		= OCL_SpellBookAvalancheEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX			 = FX_Avalanche
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_FrozenLand_Override
	Behavior = OCLSpecialPower		ModuleTag_FrozenLand
		SpecialPowerTemplate		= SpellBookFrozenLand
		TriggerFX					= FX_FrozenLandFX
		OCL							= OCL_SpecialPowerFrozenLand
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ChillWind_Override
	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonOrcs_Override
	Behavior = OCLSpecialPower ModuleTag_SummonOrcs
		SpecialPowerTemplate = SpellBookSummonOrcs
		OCL                  = OCL_SpellBookSummonOrcs
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonHobbits_Override
	Behavior = OCLSpecialPower ModuleTag_SummonHobbits
		SpecialPowerTemplate = SpellBookHobbitAllies
		OCL                  = OCL_SpawnHobbitsEgg
        TriggerFX			 = FX_HobbitSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_HobbitFriends
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

     CommandSet = MordorSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject MordorChildSpellBook_Override MordorSpellBook_Override
     CommandSet = MordorSpellBookCommandSet_Override
End

PlayerTemplate FactionMordor
     PurchaseScienceCommandSetMP = MordorSpellStoreCommandSet_Override
     SpellBookMp = MordorSpellBook_Override
End

CommandSet WildSpellBookCommandSet_Override
	1 = Command_SpellBookSummonOrcs
	2 = Command_SpellBookChillWind
	3 = Command_SpellBookSpiderlingAllies
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookDarkness
	8 = Command_SpellBookFlood
	9 = Command_SpellBookHeal
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookAvalanche
	12 = Command_SpellBookEarthquake
End


CommandSet WildSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellSummonOrcs
	2 = Command_PurchaseSpellChillWind
	3 = Command_PurchaseSpellSpiderlingAllies
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellDarkness
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellHeal
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellAvalanche
	12 = Command_PurchaseSpellEarthquake
End

Object WildSpellBook_Override

	AddModule ModuleTag_Earthquake_Override
	Behavior = OCLSpecialPower ModuleTag_Earthquake
		SpecialPowerTemplate = SpellBookEarthquake
		OCL                  = OCL_SpellBookEarthquake
        ;TriggerFX			 = FX_ElvenAlliesSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_SummonSpiderlings_Override
	Behavior = OCLSpecialPower ModuleTag_SummonSpiderlings
		SpecialPowerTemplate = SpellBookSpiderlingAllies
		OCL                  = OCL_SpawnSpiderlingsEgg
        TriggerFX			 = FX_SpiderlingsSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_Spiderlings
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End



	AddModule ModuleTag_TomBombadil_Override
	Behavior = OCLSpecialPower ModuleTag_TomBombadil
		SpecialPowerTemplate = SpellBookTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_Avalanche_Override
	Behavior = OCLSpecialPower ModuleTag_Avalanche
		SpecialPowerTemplate 		= SpellBookAvalanche
		OCL                  		= OCL_SpellBookAvalancheEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX			 = FX_Avalanche
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_FrozenLand_Override
	Behavior = OCLSpecialPower		ModuleTag_FrozenLand
		SpecialPowerTemplate		= SpellBookFrozenLand
		TriggerFX					= FX_FrozenLandFX
		OCL							= OCL_SpecialPowerFrozenLand
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ChillWind_Override
	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonOrcs_Override
	Behavior = OCLSpecialPower ModuleTag_SummonOrcs
		SpecialPowerTemplate = SpellBookSummonOrcs
		OCL                  = OCL_SpellBookSummonOrcs
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonHobbits_Override
	Behavior = OCLSpecialPower ModuleTag_SummonHobbits
		SpecialPowerTemplate = SpellBookHobbitAllies
		OCL                  = OCL_SpawnHobbitsEgg
        TriggerFX			 = FX_HobbitSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_HobbitFriends
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Darkness_Override
 	Behavior   = DarknessSpecialPower ModuleTag_Darkness
		SpecialPowerTemplate			= SpellBookDarkness
		AttributeModifier				= SpellBookDarkness
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO -HORDE ALLIES
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_DARKNESS_DURATION
		ChangeWeather					= CLOUDY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

     CommandSet = WildSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject WildChildSpellBook_Override WildSpellBook_Override
     CommandSet = WildSpellBookCommandSet_Override
End

PlayerTemplate FactionWild
     PurchaseScienceCommandSetMP = WildSpellStoreCommandSet_Override
     SpellBookMp = WildSpellBook_Override
End

CommandSet AngmarSpellBookCommandSet_Override
	1 = Command_SpellBookSummonOrcs
	2 = Command_SpellBookChillWind
	3 = Command_SpellBookSpiderlingAllies
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookTomBombadil
	8 = Command_SpellBookFlood
	9 = Command_SpellBookHeal
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookAvalanche
	12 = Command_SpellBookEarthquake
End


CommandSet AngmarSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellSummonOrcs
	2 = Command_PurchaseSpellChillWind
	3 = Command_PurchaseSpellSpiderlingAllies
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellTomBombadil
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellHeal
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellAvalanche
	12 = Command_PurchaseSpellEarthquake
End

Object AngmarSpellBook_Override

	AddModule ModuleTag_Earthquake_Override
	Behavior = OCLSpecialPower ModuleTag_Earthquake
		SpecialPowerTemplate = SpellBookEarthquake
		OCL                  = OCL_SpellBookEarthquake
        ;TriggerFX			 = FX_ElvenAlliesSummon
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_SummonSpiderlings_Override
	Behavior = OCLSpecialPower ModuleTag_SummonSpiderlings
		SpecialPowerTemplate = SpellBookSpiderlingAllies
		OCL                  = OCL_SpawnSpiderlingsEgg
        TriggerFX			 = FX_SpiderlingsSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_Spiderlings
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	
	AddModule ModuleTag_TomBombadil_Override
	Behavior = OCLSpecialPower ModuleTag_TomBombadil
		SpecialPowerTemplate = SpellBookTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_Avalanche_Override
	Behavior = OCLSpecialPower ModuleTag_Avalanche
		SpecialPowerTemplate 		= SpellBookAvalanche
		OCL                  		= OCL_SpellBookAvalancheEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX			 = FX_Avalanche
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


	AddModule ModuleTag_FrozenLand_Override
	Behavior = OCLSpecialPower		ModuleTag_FrozenLand
		SpecialPowerTemplate		= SpellBookFrozenLand
		TriggerFX					= FX_FrozenLandFX
		OCL							= OCL_SpecialPowerFrozenLand
		CreateLocation				= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ChillWind_Override
	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonOrcs_Override
	Behavior = OCLSpecialPower ModuleTag_SummonOrcs
		SpecialPowerTemplate = SpellBookSummonOrcs
		OCL                  = OCL_SpellBookSummonOrcs
		TriggerFX			 = FX_SummonWildmen
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonHobbits_Override
	Behavior = OCLSpecialPower ModuleTag_SummonHobbits
		SpecialPowerTemplate = SpellBookHobbitAllies
		OCL                  = OCL_SpawnHobbitsEgg
        TriggerFX			 = FX_HobbitSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_HobbitFriends
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

     CommandSet = AngmarSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject AngmarChildSpellBook_Override AngmarSpellBook_Override
     CommandSet = MenSpellBookCommandSet_Override
End

PlayerTemplate FactionAngmar
     PurchaseScienceCommandSetMP = AngmarSpellStoreCommandSet_Override
     SpellBookMp = AngmarSpellBook_Override
End


SpecialPower SpellBookHeal
	InitiateAtLocationSound 	= SpellHeal
	Enum                		= SPECIAL_SPELL_BOOK_HEAL
	Flags				= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	ReloadTime         		= 150000
	RequiredSciences     		= SCIENCE_Heal
	RadiusCursorRadius  		= SPELL_HEAL_RADIUS_CURSOR	
End


SpecialPower SpellBookCrebain
	Enum			= SPECIAL_SPELL_BOOK_CREBAIN
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	ReloadTime		= 90000
	RadiusCursorRadius	= 75.0
	RequiredSciences		= SCIENCE_Crebain
	InitiateAtLocationSound	= SpellSummonCrebain
End


SpecialPower SpellBookSpiderlingAllies
	Enum			= SPECIAL_SPELL_BOOK_SPIDERLING_ALLIES
	RequiredSciences		= SCIENCE_SpiderlingAllies
	ReloadTime		= 90000
	InitiateAtLocationSound	= SpellSummonSpiderlingsMS
	RadiusCursorRadius	= 65.0
	Flags					= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter	= NO_SUMMON_NEAR_OBJECT_FILTER
	ForbiddenObjectRange	= 100.0
End


SpecialPower SpellBookCaveBats
	Enum			= SPECIAL_SPELL_BOOK_CAVE_BATS
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	ReloadTime		= 90000
	RadiusCursorRadius	= 75.0
	RequiredSciences		= SCIENCE_CaveBats
	InitiateAtLocationSound	= SpellCaveBats
End


SpecialPower SpellBookArrowVolleyGood
	Enum				= SPECIAL_SPELL_BOOK_ARROW_VOLLEY_GOOD
	RadiusCursorRadius		= 95
	RequiredSciences			= SCIENCE_ArrowVolleyGood
	ReloadTime			= 90000
	InitiateAtLocationSound		= SpellArrowVolleyMS
	ViewObjectDuration		= 10000
	ViewObjectRange			= 200
	Flags					= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookArrowVolleyEvil
	Enum				= SPECIAL_SPELL_BOOK_ARROW_VOLLEY_EVIL
	RadiusCursorRadius		= 95
	RequiredSciences				= SCIENCE_ArrowVolleyEvil
	ReloadTime			= 90000
	InitiateAtLocationSound		= SpellArrowVolleyMS
	ViewObjectDuration		= 10000
	ViewObjectRange			= 200
	Flags					= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookBombard
	Enum					= SPECIAL_SPELL_BOOK_BOMBARD
	Flags					= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	RadiusCursorRadius		= 200
	RequiredSciences  		= SCIENCE_Bombard
	ReloadTime       		= 150000
	InitiateAtLocationSound	= SpellBarrageStartMS
End


SpecialPower SpellBookArmyoftheDead
	Enum			= SPECIAL_SPELL_BOOK_ARMY_OF_THE_DEAD
	RequiredSciences		= SCIENCE_ArmyoftheDead
	ReloadTime      	= 900000
	InitiateAtLocationSound = ArmyDeadEnterMono		;ArmyDeadEnterStereo	
	RadiusCursorRadius	= 200.0  
	ViewObjectDuration	= 5000
	ViewObjectRange		= 150
	Flags					= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter	= NO_SUMMON_UNDERMINE_NEAR_OBJECT_FILTER
	ForbiddenObjectRange	= 200.0
End


SpecialPower SpellBookEarthquake
	Enum					= SPECIAL_SPELL_BOOK_EARTHQUAKE
	RadiusCursorRadius		= 300
	RequiredSciences		= SCIENCE_Earthquake
	ReloadTime				= 420000
	InitiateAtLocationSound	= SpellEarthquakeMS
	ViewObjectDuration		= 10000
	ViewObjectRange			= 200
	Flags					= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookFlood
	Enum			= SPECIAL_SPELL_BOOK_FLOOD
	RadiusCursorRadius	= 175
	RequiredSciences		= SCIENCE_Flood
	ReloadTime		= 420000
	ViewObjectDuration 	= 10000
	ViewObjectRange	 	= 200
	InitiateAtLocationSound	= SpellFloodMS
	Flags					= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookSunflare
	Enum			= SPECIAL_SPELL_BOOK_SUNFLARE
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	RadiusCursorRadius	= SPELL_SUNFLARE_EFFECT_RADIUS
	RequiredSciences		= SCIENCE_Sunflare
	ReloadTime		= 420000
	ViewObjectDuration	= SPELL_SUNFLARE_VIEW_OBJECT_DURATION
	ViewObjectRange		= SPELL_SUNFLARE_VIEW_OBJECT_RANGE
	InitiateAtLocationSound = SpellSunflareMS
End

SpecialPower SpellBookRainOfFire
	Enum			= SPECIAL_SPELL_BOOK_RAIN_OF_FIRE
	RadiusCursorRadius	= 200
	RequiredSciences		= SCIENCE_RainOfFire
	ReloadTime		= 420000
	InitiateSound = SpellRainOfFireMS
	ViewObjectDuration = 10000
	ViewObjectRange = 200
	Flags			= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookBalrogAlly
	Enum						= SPECIAL_SPELL_BOOK_BALROG_ALLY
	ReloadTime					= 900000
	RadiusCursorRadius			= 75.0 ; Match the radius in FXList SummonBalrogStart
	RequiredSciences				= SCIENCE_BalrogAlly
	ViewObjectDuration = 5000
	ViewObjectRange = 100
	Flags					= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter	= NO_SUMMON_NEAR_OBJECT_FILTER
	ForbiddenObjectRange	= 75.0
End


SpecialPower SpellBookHobbitAllies
	Enum					= SPECIAL_SPELL_BOOK_HOBBIT_ALLIES
	RequiredSciences		= SCIENCE_HobbitAllies
	ReloadTime				= 90000
	InitiateAtLocationSound	= SpellSummonHobbitsMS
	RadiusCursorRadius		= 100.0
	Flags					= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter	= NO_SUMMON_NEAR_OBJECT_FILTER
	ForbiddenObjectRange	= 100.0
End


SpecialPower SpellBookChillWind
	Enum				= SPECIAL_SPELL_BOOK_CHILL_WIND
	RadiusCursorRadius		= CHILL_WIND_EFFECT_RADIUS			; Match the radius in FXList TaintFX
	RequiredSciences		= SCIENCE_ChillWind
	ReloadTime			= 60000		; in milliseconds
	InitiateAtLocationSound 	= ChillWind
	Flags				= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookFrozenLand
	Enum					= SPECIAL_SPELL_BOOK_CHILL_WIND
	RadiusCursorRadius		= SPELLBOOK_TAINT_RADIUS			; Match the radius in FXList TaintFX
	RequiredSciences		= SCIENCE_FrozenLand
	ReloadTime				= 150000		; in milliseconds
	InitiateAtLocationSound = SpellFrozenLand
	ViewObjectDuration		= 5000
	ViewObjectRange			= 175
	Flags					= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter	= NONE +WatcherHead +WatcherHittingArm +WatcherCaldera
	ForbiddenObjectRange	= SPELLBOOK_TAINT_RADIUS
End


SpecialPower SpellBookSummonOrcs
	Enum						= SPECIAL_SPELL_BOOK_GENERAL_SUMMON
	ReloadTime					= 90000   ; in milliseconds
	RadiusCursorRadius			= 75.0
	RequiredSciences				= SCIENCE_SummonOrcs
	ViewObjectDuration = 5000
	ViewObjectRange = 100
	InitiateAtLocationSound			= SpellWildMenAlliesMS
	Flags						= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter		= NO_SUMMON_NEAR_OBJECT_FILTER
	ForbiddenObjectRange		= 75.0
End


SpecialPower SpellBookAvalanche
	Enum				= SPECIAL_SPELL_BOOK_CHILL_WIND
	RadiusCursorRadius		= 175
	RequiredSciences		= SCIENCE_Avalanche
	ReloadTime			= 420000 ; in milliseconds
	ViewObjectDuration 		= 10000
	ViewObjectRange	 		= 200
	InitiateAtLocationSound		= AvalancheRumble
	Flags				= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookTomBombadil
	Enum				= SPECIAL_SPELL_BOOK_TOM_BOMBADIL
	ReloadTime			= 150000
	RadiusCursorRadius		= 15.0
	RequiredSciences			= SCIENCE_TomBombadil
	InitiateAtLocationSound 	= SpellSummonTomBombadilMS	;SpellPalantirVision
	Flags					= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter	= NO_SUMMON_NEAR_OBJECT_FILTER
	ForbiddenObjectRange	= 15.0
End


Object MordorBalrog

	ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_01
		MinLifetime		= 120000
		MaxLifetime		= 120000
		DeathType		= FADED
	End
	End
End


Object AngmarShadeWolf

	ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_01
		MinLifetime		= 1200000
		MaxLifetime		= 1200000
		DeathType		= FADED
	End
	End
End


Object RohanOathbreaker1

	ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_01
		MinLifetime		= 90000
		MaxLifetime		= 90000
		DeathType		= FADED
	End
	End
End


ObjectReskin RohanOathbreaker2 RohanOathbreaker1

	ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_01
		MinLifetime		= 90000
		MaxLifetime		= 90000
		DeathType		= FADED
	End
	End
End


ObjectReskin RohanOathbreaker3 RohanOathbreaker1

	ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_01
		MinLifetime		= 90000
		MaxLifetime		= 90000
		DeathType		= FADED
	End
	End
End


Object Wyrm

	ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_01
		MinLifetime = 2400000
		MaxLifetime = 2400000
		DeathType		= FADED
	End
	End
End


Object WatcherHead

	ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_01
		MinLifetime = 720000
		MaxLifetime = 720000
		DeathType		= FADED
	End
	End

	ReplaceModule ModuleTag_Body

		Body = ActiveBody ModuleTag_BodyWatcherHead
			MaxHealth 		= 12000
		End

	End

End


Object WatcherHittingArm

	ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_01
		MinLifetime = 720000
		MaxLifetime = 720000
		DeathType		= FADED
	End
	End
End


Object WatcherCaldera

	ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_01
		MinLifetime = 720000
		MaxLifetime = 720000
		DeathType		= FADED
	End
	End
End
