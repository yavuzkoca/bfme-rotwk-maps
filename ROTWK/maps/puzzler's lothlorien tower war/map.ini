Locomotor ExplosiveMineLocomotor
	Surfaces            = GROUND RUBBLE CLIFF IMPASSABLE
	TurnTime            = 7500
	TurnTimeDamaged     = 7500
	TurnThreshold       = 3 ; If we are turning more than 5 degrees, we set the turning modelconditions		
	FastTurnRadius		= 1 ; Can turn in a 10 foot radius circle when moving.
	SlowTurnRadius		= 1 ; Turns in place from a standing start.
	Acceleration		= 510  ; .5 second to accelerate to full speed.
	Braking				= 100  ; quick brake to prevent foot sliding
	FormationPriority	= MELEE1 ;ARTILLERY2
	MinTurnSpeed        = 66%
	ZAxisBehavior       = NO_Z_MOTIVE_FORCE
	Appearance          = HUGE_TWO_LEGS
	StickToGround       = Yes       ; walking guys aren't allowed to catch huge (or even small) air.
	CanMoveBackwards    = Yes   ; Can move backwards when afraid.
	BackingUpSpeed		= 33%
End

Locomotor BerserkerLocomotor
	Surfaces              = GROUND RUBBLE CLIFF IMPASSABLE
	TurnTime              = 500
	TurnTimeDamaged       = 500
	FastTurnRadius		= 3 ; Can turn in a 10 foot radius circle when moving.
	SlowTurnRadius		= 1 ; Turns in place from a standing start.
	Acceleration = 510  ; .5 second to accelerate to full speed.
	FormationPriority		= NO_FORMATION

	Braking  = 510  ; .51 second to brake from full speed.
	MinTurnSpeed          = 0%
	ZAxisBehavior         = NO_Z_MOTIVE_FORCE
	Appearance            = TWO_LEGS
	StickToGround         = Yes       ; walking guys aren't allowed to catch huge (or even small) air.
	CanMoveBackwards       = No   ; Can move backwards when afraid.
	BackingUpSpeed		=	33%
End

Locomotor TrollLocomotor
  Surfaces                = GROUND RUBBLE CLIFF IMPASSABLE
  TurnTime                = 1000 ;4000
  TurnTimeDamaged         = 1000 ;4000
  TurnThreshold           = 3		; small because monsters look awful rotating on the spot without playing an anim.
  TurnThresholdHS         = 120
  EnableHighSpeedTurnModelconditions = No ; We only want turning model conditions for slow turns. 

  Acceleration = 100  ; 0.1 second to accelerate to full speed.

  Braking  = 100  ; 0.1 second to brake from full speed.
  MinTurnSpeed            = 0%
  FastTurnRadius		  = 0 ; Can turn in a 10 foot radius circle when moving.
  SlowTurnRadius		  = 0 ; Turns in place from a standing start.
;,;  ChargeAvailable         = No ;;,;; Yes     ; Locomotor has defined charging attack values to use
;;,;;  ChargeSpeed             = 120%
  FormationPriority		  = MELEE1 ;CAVALRY3

  ZAxisBehavior           = NO_Z_MOTIVE_FORCE
  Appearance              = TWO_LEGS ;,; HUGE_TWO_LEGS
  StickToGround           = Yes       ; walking guys aren't allowed to catch huge (or even small) air.
End

Object GiantSpider
ReplaceModule ModuleTag_Body
	Body = ActiveBody ModuleTag_Body_NEW
		MaxHealth = 36000
	End
End
End

Locomotor FiredrakeLocomotor
  Surfaces                        = GROUND CLIFF IMPASSABLE
  SlowTurnRadius				  = 2.0 ;12.0 ;  From a standing starts, 30 foot radius.
  FastTurnRadius		          = 30.0 ;12.0 ; Once the catapult gets moving, still uses a 30 foot radius to turn.
  TurnTime						  = 1500
  TurnTimeDamaged				  = 1500
  Acceleration = 500  ; 1 second to accelerate to full speed.
  FormationPriority				  = MELEE1 ;ARTILLERY2

  Braking  = 250 ;;,;; 500  ; 1 second to brake from full speed.
  MinTurnSpeed                    = 100%
  TurnPivotOffset                 = 1.0 ;-0.264   ; where to pivot when turning (-1.0 = rear, 0.0 = center, 1.0 = front)
  ZAxisBehavior                   = NO_Z_MOTIVE_FORCE
  Appearance                      = FOUR_WHEELS
                                  
  AccelerationPitchLimit          = 0      ; Angle limit how far chassis will lift or roll from acceleration.
  BounceAmount                    = 12              ;  simulates hitting random rocks.  0==smooth pavement, 200 = bumpy.
  PitchStiffness                  = 0.5             ;  stiffness of the "springs" in the suspension forward & back.
  RollStiffness                   = 0.5            ;  stiffness of the "springs" in the suspension side to side.
  PitchDamping                    = 1.0;              ;  How fast it damps.  0=perfect spring, bounces forever.  1=glued to terrain.
  RollDamping                     = 1.0;               ;  How fast it damps.  0=perfect spring, bounces forever.  1=glued to terrain.
  ForwardAccelerationPitchFactor  = 0.0  ; How much acceleration will cause the front to lift, or dip for stops.
  LateralAccelerationRollFactor   = 0.0   ;  How much cornering will cause the chassis to roll.
  UseTerrainSmoothing             = Yes         ; Smooth out the normals by multisampling
                                  
  HasSuspension                   = Yes           ; Calculate 4 wheel independent suspension info.
  CanMoveBackwards                = No        ; Can move backwards.
  MaximumWheelExtension           = -2.3  ; Maximum distance the wheels will drop on the model.
  MaximumWheelCompression         = 1.4 ; Maximum distance the wheel will move up into the chassis.
  FrontWheelTurnAngle             = 0      ; How many degrees the front wheels can turn.
End

Weapon DrogothWingBlast
	IdleAfterFiringDelay		= 0
	AttackRange					= 60.0
	WeaponSpeed					= 100         ; dist/sec 
	RadiusDamageAffects			= ALLIES ENEMIES NOT_SIMILAR
	DelayBetweenShots			= 1000               ; time between shots, msec
	PreAttackDelay				= 0
	PreAttackType				= PER_ATTACK ; Do the delay each time we attack a new target
	PreAttackFX					= FX_GandalfPreAttackBlast
	;FireFX						=
	FiringDuration				= 500
	DamageDealtAtSelfPosition	= Yes 

	DamageNugget                        ; A basic Nugget that just does damage
		Damage			= 90 ;30
		Radius			= DROGOTH_WING_FLAP_RADIUS_SMALL
		DelayTime		= 0
		DamageType		= CRUSH
		DamageFXType	= FLAME
		DeathType		= NORMAL
		AcceptDamageAdd	= No			; No extra damage when going up levels, otherwise we'll just kill the victims outright.
		DamageScalar	= 0% ALL ALLIES	; only meta impact for allied units
	End

	DamageNugget                        ; A basic Nugget that just does damage
		Damage			= 60 ;10
		Radius			= DROGOTH_WING_FLAP_RADIUS_LARGE
		DelayTime		= 0
		DamageType		= CRUSH
		DamageFXType	= FLAME
		DeathType		= NORMAL
		AcceptDamageAdd	= No			; No extra damage when going up levels, otherwise we'll just kill the victims outright.
		DamageScalar	= 0% ALL ALLIES	; only meta impact for allied units
	End

	; Fan the flames...
	FireLogicNugget
		LogicType		= INCREASE_FUEL_ON_EXISTING_FIRE
		Radius			= DROGOTH_WING_FLAP_RADIUS_SMALL
		Damage			= 40
		MinMaxBurnRate	= 20
		MaxResistance	= 5
	End
	FireLogicNugget
		LogicType		= INCREASE_BURN_RATE_ON_EXISTING_FIRE
		Radius			= DROGOTH_WING_FLAP_DAMAGE_LARGE
		Damage			= 20
	End

	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .75
		ShockWaveAmount		= DROGOTH_WING_FLAP_SHOCK_AMOUNT_SMALL
		ShockWaveRadius		= DROGOTH_WING_FLAP_SHOCK_RADIUS_SMALL
		ShockWaveTaperOff	= 0.5
		ShockWaveZMult		= 1.5
	End

	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .75
		ShockWaveAmount		= DROGOTH_WING_FLAP_SHOCK_AMOUNT_LARGE
		
		ShockWaveRadius		= DROGOTH_WING_FLAP_SHOCK_RADIUS_LARGE
		ShockWaveTaperOff	= 0.5
		ShockWaveZMult		= 1.2
	End
  
End

Object MordorMumakil
ReplaceModule ModuleTag_02
	Body = DelayedDeathBody ModuleTag_02_NEW
		CheerRadius 				= EMOTION_CHEER_RADIUS
		MaxHealth				= 34000
		DoHealthCheck				= No			; Don't want to get the delayed death behaviour when we die normally.
		DelayedDeathTime			= 5000
		CanRespawn				= No			; Unit can't get revived.
		ImmortalUntilDeathTime		= No			; Not immune to damage during rampage.  So you can keep him from running stuff over.
		BurningDeathBehavior		= Yes
		BurningDeathFX				= FX_CavalryBurningFlame
	End
End
End

Weapon AvalancheRadiusWeapon			// Shot out every DelayBetweenShots
	RadiusDamageAffects		= ENEMIES NOT_SIMILAR
	LeechRangeWeapon		= Yes
	AttackRange				= 9999999.0
	MeleeWeapon				= No
	DelayBetweenShots		= 0				// time between shots, msec
	PreAttackDelay			= 0				// PreAttackDelay+FiringDuration = UseWeaponTiming = Yes duration
	PreAttackType			= PER_SHOT 
;	FireFX               		= FX_PackWolfHit
	FiringDuration			= 0 

	// A basic Nugget that just does damage
	DamageNugget							
		Damage        = AVALANCHE_DAMAGE	// A whole lot of damage.
		Radius        = AVALANCHE_RADIUS
		DelayTime     = 0
		DamageType    = HERO
		DamageFXType  = BIG_ROCK
		DeathType     = CRUSHED
;		DamageScalar  = 33% NONE +STRUCTURE					// No damage to allied structures.
	End


	// A Nugget that throws things back with force
	MetaImpactNugget                    
		HeroResist		= .75
		ShockWaveAmount		= 50.0
		ShockWaveArc		= 90
		ShockWaveRadius		= 40.0
		ShockWaveTaperOff	= 0.75
		ShockWaveZMult		= 1.000
		ShockWaveSpeed		= 300.0 
	End
End


;------------------------------------------------------------------------------
Weapon AvalancheCrush  .
  LeechRangeWeapon      = Yes
  AttackRange           = 50.0
  MeleeWeapon           = No
  DelayBetweenShots     = 0            ; time between shots, msec
  PreAttackDelay        = 0 ;PreAttackDelay+FiringDuration = UseWeaponTiming = Yes duration
  PreAttackType         = PER_SHOT 
  FiringDuration        = 0 ;
;  FireFX		= FX_GenericCrushImpactSound

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        = BALROG_CRUSH_DAMAGE				; A whole lot of damage.
    Radius        = 50.0
    DelayTime     = 0
    DamageType    = CRUSH
    DeathType     = CRUSHED
  End
End

CommandButton Command_ConstructMordorHaradrimArcherHorde
	Command				= UNIT_BUILD
	Object				= MordorHaradrimArcherHorde
	Options				= NEED_UPGRADE CANCELABLE
	NeededUpgrade			= Upgrade_MordorHaradrimPalaceLevel2
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:ConstructMordorHaradrimArcherHorde
	ButtonImage			= BMHaradrimPalace_Haradrim
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildMordorHaradrimArcherHorde
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
End

CommandButton Command_ConstructDwarvenMenOfDaleHorde
	Command				= UNIT_BUILD
	Object				= DwarvenMenOfDaleHorde
	Options				= CANCELABLE NEED_UPGRADE
	NeededUpgrade			= Upgrade_DwarvenArcheryRangeLevel2
	TextLabel			= CONTROLBAR:ConstructDwarvenMenOfDale
	ButtonImage			= BDArcheryRange_MenofDale
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildDwarvenMenOfDaleHorde
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
   	UnitSpecificSound   		= GondorArcherVoiceBuy      
End

Weapon DwarvenMenOfDaleBlackArrows ; Also default arrow for spider riders
	AttackRange         = 450
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= #MULTIPLY( DWARVEN_MENOFDALE_RANGE .01 )
	
	WeaponSpeed			= 381         ; dist/sec 
	MinWeaponSpeed      = 301
	MaxWeaponSpeed      = 621      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	FireFX              = FX_RohanArcherBowWeapon
	ScaleWeaponSpeed    = Yes ; Used for lob weapons, scales speed proportional to range
	HitPercentage       = 100     ;When this weapon is used it will hit exactly 50% of the time.
	ScatterRadius       = 16.0     ;When this weapon misses it can randomly miss by as much as this distance.

	AcceptableAimDelta	= 20	; prevent twitchy reaiming in horde on horde
	DelayBetweenShots   = 600
	PreAttackDelay      = 567
	PreAttackRandomAmount     = 100  
	PreAttackType       = PER_SHOT
	FiringDuration      = 2000   

	ClipSize			= 1
	AutoReloadsClip		= Yes
	AutoReloadWhenIdle	= 1	
	ClipReloadTime		= Min:DWARVEN_MENOFDALE_BOW_RELOADTIME_MIN Max:DWARVEN_MENOFDALE_BOW_RELOADTIME_MAX

	AntiAirborneVehicle	= Yes
	AntiAirborneMonster	= Yes
	HitPassengerPercentage	= 20%
	CanBeDodged				= Yes ; Will check for a DodgePercent on the target to have a second chance at failing HitPercent

	ProjectileNugget	; Default arrow
		ProjectileTemplateName  = BlackArrowsProjectile
		WarheadTemplateName     = DwarvenMenOfDaleBlackArrowWarhead
	End
End

Object GoblinSpiderRider
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY WildSpiderRiderSword
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
		
	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1
		Weapon = PRIMARY DwarvenMenOfDaleBlackArrows
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
End

/////////////////////////////////////////////////////////////////////////////////
// Spellbooks /////////////////////////////////////////////////////////////////// Spellbooks
/////////////////////////////////////////////////////////////////////////////////

Rank 1
	SkillPointsNeededDefault	= 0
	SkillPointsNeededCampaign	= 0 
	SciencePurchasePointsGranted	= 5
End

// Sciences ///////////////////////////////////////////////////////////////////// Sciences

Science SCIENCE_Scavenger
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_EVIL
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

Science SCIENCE_Lottery
PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_EVIL
SciencePurchasePointCost = 1
SciencePurchasePointCostMP = 1
IsGrantable = Yes
End

Science SCIENCE_ElvenWood
  PrerequisiteSciences = SCIENCE_GOOD
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_RallyingCallMP
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_EVIL
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_SpawnLoneTower
  PrerequisiteSciences = NONE
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_MenOfDaleAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ElvenWood
  SciencePurchasePointCost = 10
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_TomBombadil
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ElvenWood OR SCIENCE_RallyingCallMP
  SciencePurchasePointCost = 10
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_ArrowVolleyGood
  PrerequisiteSciences = SCIENCE_RallyingCallMP OR SCIENCE_SpawnLoneTower
  SciencePurchasePointCost = 10
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_DunedainAllies
  PrerequisiteSciences = SCIENCE_SpawnLoneTower
  SciencePurchasePointCost = 10
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_CloudBreak
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_MenOfDaleAllies OR SCIENCE_GOOD SCIENCE_TomBombadil
  SciencePurchasePointCost = 10
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_EagleAllies
  PrerequisiteSciences = SCIENCE_TomBombadil OR SCIENCE_ArrowVolleyGood
  SciencePurchasePointCost = 15
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_Bombard
  PrerequisiteSciences = SCIENCE_RallyingCallMP OR SCIENCE_ArrowVolleyGood OR SCIENCE_DunedainAllies
  SciencePurchasePointCost = 25
  SciencePurchasePointCostMP = 25
  IsGrantable = Yes
End

Science SCIENCE_Flood
PrerequisiteSciences = SCIENCE_GOOD SCIENCE_MenOfDaleAllies SCIENCE_CloudBreak OR SCIENCE_TomBombadil SCIENCE_CloudBreak OR SCIENCE_EagleAllies
SciencePurchasePointCost = 25
SciencePurchasePointCostMP = 25
IsGrantable = Yes
End

Science SCIENCE_Sunflare
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Bombard OR SCIENCE_GOOD SCIENCE_EagleAllies
  SciencePurchasePointCost = 25
  SciencePurchasePointCostMP = 25
  IsGrantable = Yes
End

Science SCIENCE_Crebain
  PrerequisiteSciences = SCIENCE_EVIL
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_WarChant
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_EVIL
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_EyeofSauron
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_MORDOR
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_AwakenWyrm
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_Crebain
  SciencePurchasePointCost = 10
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_ChillWind
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_EVIL SCIENCE_Crebain OR SCIENCE_EVIL SCIENCE_WarChant
  SciencePurchasePointCost = 10
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_Devastation
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_WarChant OR SCIENCE_EVIL SCIENCE_EyeofSauron
  SciencePurchasePointCost = 15
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_ArrowVolleyEvil
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_EyeofSauron
  SciencePurchasePointCost = 10
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_FrozenLand
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_AwakenWyrm OR SCIENCE_EVIL SCIENCE_ChillWind
  SciencePurchasePointCost = 15
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_WatcherAlly
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ChillWind OR SCIENCE_EVIL SCIENCE_Devastation
  SciencePurchasePointCost = 15
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_EvilBombard
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_Devastation OR SCIENCE_ArrowVolleyEvil OR SCIENCE_Devastation
  SciencePurchasePointCost = 25
  SciencePurchasePointCostMP = 25
  IsGrantable = Yes
End

Science SCIENCE_RainOfFire
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_Blight OR SCIENCE_EVIL SCIENCE_WatcherAlly
  SciencePurchasePointCost = 25
  SciencePurchasePointCostMP = 25
  IsGrantable = Yes
End

Science SCIENCE_Avalanche
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_WatcherAlly OR SCIENCE_EVIL SCIENCE_EvilBombard
  SciencePurchasePointCost = 25
  SciencePurchasePointCostMP = 25
  IsGrantable = Yes
End

Science SCIENCE_SummonBalrog
PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_EVIL
SciencePurchasePointCost = 1
SciencePurchasePointCostMP = 1
IsGrantable = Yes
End

Science SCIENCE_Heal
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_EVIL
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

Science SCIENCE_Snowbind
PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_EVIL
SciencePurchasePointCost = 1
SciencePurchasePointCostMP = 1
IsGrantable = Yes
End

Science SCIENCE_Darkness
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_WarChant OR SCIENCE_EVIL SCIENCE_WildMenAllies OR SCIENCE_MORDOR SCIENCE_Industry OR SCIENCE_MORDOR SCIENCE_UntamedAllegiance OR SCIENCE_WILD SCIENCE_UntamedAllegiance OR SCIENCE_WILD SCIENCE_Scavenger
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

Science SCIENCE_FreezingRain
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD SCIENCE_WildMenAllies OR SCIENCE_ISENGARD SCIENCE_IsengardTaint OR SCIENCE_ANGMAR SCIENCE_SummonOrcs OR SCIENCE_ANGMAR SCIENCE_FrozenLand
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

Science SCIENCE_PalantirVision
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_GOOD
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

Science SCIENCE_DragonAlly
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_AwakenWyrm OR SCIENCE_EVIL SCIENCE_ArrowVolleyEvil OR SCIENCE_ISENGARD SCIENCE_FreezingRain OR SCIENCE_ISENGARD SCIENCE_WatcherAlly OR SCIENCE_WILD SCIENCE_AwakenWyrm OR SCIENCE_WILD SCIENCE_Darkness
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

Science SCIENCE_SummonShadeOfWolf
  PrerequisiteSciences = SCIENCE_ANGMAR SCIENCE_SummonWights OR SCIENCE_ANGMAR SCIENCE_FreezingRain
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

Science SCIENCE_Undermine
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_EVIL
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

// Special Powers ///////////////////////////////////////////////////////////////////// Special Powers

SpecialPower SpellBookScavenger
	Enum			= SPECIAL_SPELL_BOOK_SCAVENGER
    RequiredSciences		= SCIENCE_Scavenger
    ReloadTime			= 0   ; in milliseconds
    Flags				= RESPECT_RECHARGE_TIME_DISCOUNT
End

SpecialPower SpellBookEyeofSauron
	Enum			= SPECIAL_SPELL_BOOK_EYE_OF_SAURON
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	ReloadTime		= SPELL_RECHARGE_TIME_TIER_1 ; in milliseconds
	RadiusCursorRadius	= 75.0
	RequiredSciences		= SCIENCE_EyeofSauron
	InitiateAtLocationSound		= EyeOfSauronCreated
End

SpecialPower SpellBookLottery
	Enum				= SPECIAL_SPELL_BOOK_EYE_OF_SAURON
	RequiredSciences		= SCIENCE_Lottery
	ReloadTime      		= 400000 ; in milliseconds
End

SpecialPower SpellBookRallyingCall
	Enum				= SPECIAL_SPELL_BOOK_RALLYING_CALL
	ReloadTime			= SPELL_RECHARGE_TIME_TIER_1 ; in milliseconds
	RadiusCursorRadius		= 75.0
	Flags					= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	RequiredSciences			= SCIENCE_RallyingCall SCIENCE_RallyingCallMP
	InitiateAtLocationSound 	= SpellRallyingCallMS
End

SpecialPower SpellBookArrowVolleyGood
	Enum				= SPECIAL_SPELL_BOOK_ARROW_VOLLEY_GOOD
	RadiusCursorRadius		= 75
	RequiredSciences		= SCIENCE_ArrowVolleyGood
	ReloadTime			= SPELL_RECHARGE_TIME_TIER_2
	InitiateAtLocationSound		= SpellArrowVolleyMS
	ViewObjectDuration		= 10000
	ViewObjectRange			= 200
	Flags				= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
End

SpecialPower SpellBookArrowVolleyEvil
	Enum				= SPECIAL_SPELL_BOOK_ARROW_VOLLEY_EVIL
	RadiusCursorRadius		= 75
	RequiredSciences		= SCIENCE_ArrowVolleyEvil
	ReloadTime			= SPELL_RECHARGE_TIME_TIER_2
	InitiateAtLocationSound		= SpellArrowVolleyMS
	ViewObjectDuration		= 10000
	ViewObjectRange			= 200
	Flags				= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
End

SpecialPower SpellBookFlood
	Enum			= SPECIAL_SPELL_BOOK_FLOOD
	RadiusCursorRadius	= 75
	RequiredSciences	= SCIENCE_Flood
	ReloadTime		= SPELL_RECHARGE_TIME_TIER_4 ; in milliseconds
	ViewObjectDuration 	= 10000
	ViewObjectRange	 	= 200
	InitiateAtLocationSound	= SpellFloodMS
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
End

SpecialPower SpellBookSunflare
	Enum			= SPECIAL_SPELL_BOOK_SUNFLARE
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	RadiusCursorRadius	= 75
	RequiredSciences	= SCIENCE_Sunflare
	ReloadTime		= SPELL_RECHARGE_TIME_TIER_4 ;// in milliseconds
	ViewObjectDuration	= SPELL_SUNFLARE_VIEW_OBJECT_DURATION
	ViewObjectRange		= SPELL_SUNFLARE_VIEW_OBJECT_RANGE
	InitiateAtLocationSound = SpellSunflareMS
End

Weapon SunflareWeapon
	RadiusDamageAffects		= ENEMIES NEUTRALS	

	//Turn the troll effectively to stone
	AttributeModifierNugget
		AttributeModifier        = SunFlareTrollToStone
		Radius			 = 75	
		SpecialObjectFilter      = ANY +MordorAttackTroll +MordorDrummerTroll +MordorMountainTroll +MordorCaveTroll +GoblinCaveTroll +GoblinCaveTroll_FromTrollLair +CaveTroll_Slaved
	End            	

	// A basic Nugget that just does damage
	DamageNugget                
		Damage        = SPELL_SUNFLARE_DAMAGE
		Radius        = 75
		DelayTime     = 0
		DamageType    = FLAME
		DamageFXType  = FLAME
		DeathType     = BURNED
	End

	//Start a fire
	FireLogicNugget 
		LogicType	=	INCREASE_BURN_RATE
		Radius		=	75
		Damage		=	SPELL_SUNFLARE_FIRE_DAMAGE
	End

	//Design knob
	FireLogicNugget
		LogicType		=	INCREASE_FUEL
		Radius			=	75
		Damage			=	SPELL_SUNFLARE_FIRE_FUEL
		MinMaxBurnRate		=	SPELL_SUNFLARE_FIRE_MINMAX_BURNRATE
		MinDecay		=	1
		MaxResistance		=	0
	End

	//Paralyze everything that's light sensitive
	ParalyzeNugget				
		Radius			= 75
		Duration		= SPELL_SUNFLARE_DURATION
		SpecialObjectFilter     = ANY +MordorFighter +MordorBlackOrc +MordorArcher +MordorBannerOrc +WildBannerGoblin +WildBannerMarauder +WildBannerSpiderling +GoblinFighter +GoblinArcher +WildSpiderling +GoblinSpiderRider +WildShelob +MordorGoblinSwordsman +MordorGoblinArcher +BarrowWight ENEMIES
	End
End

SpecialPower SpellBookElvenWood
	Enum				= SPECIAL_SPELL_BOOK_ELVEN_WOOD
	RadiusCursorRadius		= 120
	RequiredSciences		= SCIENCE_ElvenWood
	ReloadTime      		= SPELL_RECHARGE_TIME_TIER_2
	InitiateAtLocationSound 	= SpellElvenWood
	ViewObjectDuration 		= 5000
	ViewObjectRange 		= 150
	Flags				= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter		= NONE +WatcherHead +WatcherHittingArm +Caldera
	ForbiddenObjectRange		= 100
End

Object ElvenGrove
ReplaceModule ModuleTag_ElvenGroveOne
	Behavior = AttributeModifierAuraUpdate ModuleTag_ElvenGroveOne_SMALLER
		StartsActive		= Yes											; If no, requires upgrade to turn on.
		BonusName		= GenericBuff
		RefreshDelay		= 2000
		Range			= 120
		ObjectFilter		= GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
		RunWhileDead		= Yes
		RequiredConditions	= ELVEN_WOOD									; In case elven wood and taint overlap, this flag makes it double check the cell type of the target
	End
End
End

ObjectCreationList OCL_ElvenWoodSeed
	CreateObject
		ObjectNames		= ElvenWoodTreeSeed
		Count			= 10
		SpreadFormation		= Yes
		MinDistanceAFormation	= 10.0
		MinDistanceBFormation	= 120.0
		MaxDistanceFormation	= 120.0
	End
End

Object SpellBookFlood
ReplaceModule ModuleTag_FloodCentral
	Behavior = FloodUpdate ModuleTag_FloodCentral_NEW
		AngleOfFlow = 25	; In degrees, with 0 as screen right
		DirectionIsRelative = No ; If it is relative, it adds the facing of the flood object.
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-100 Y:10 Z:0	; Offset from center point of flood.
			ControlPointOffsetTwo =		X:0 Y:50 Z:0
			ControlPointOffsetThree =	X:0 Y:-50 Z:0
			ControlPointOffsetFour =	X:100 Y:-50 Z:0
			MemberSpeed = 25
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-100 Y:0 Z:0
			ControlPointOffsetTwo =		X:-50 Y:0 Z:0
			ControlPointOffsetThree =	X:50 Y:0 Z:0
			ControlPointOffsetFour =	X:100 Y:0 Z:0
			MemberSpeed = 25
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-100 Y:-10 Z:0
			ControlPointOffsetTwo =		X:0 Y:-50 Z:0
			ControlPointOffsetThree =	X:0 Y:50 Z:0
			ControlPointOffsetFour =	X:100 Y:50 Z:0
			MemberSpeed = 25
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-110 Y:15 Z:0	; Offset from center point of flood.
			ControlPointOffsetTwo =		X:0 Y:55 Z:0
			ControlPointOffsetThree =	X:0 Y:-55 Z:0
			ControlPointOffsetFour =	X:110 Y:-55 Z:0
			MemberSpeed = 15
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-110 Y:0 Z:0
			ControlPointOffsetTwo =		X:-55 Y:0 Z:0
			ControlPointOffsetThree =	X:55 Y:0 Z:0
			ControlPointOffsetFour =	X:110 Y:0 Z:0
			MemberSpeed = 15
		End
		FloodMember
			MemberTemplateName = FloodHorse
			ControlPointOffsetOne =		X:-110 Y:-11 Z:0
			ControlPointOffsetTwo =		X:0 Y:-55 Z:0
			ControlPointOffsetThree =	X:0 Y:55 Z:0
			ControlPointOffsetFour =	X:110 Y:55 Z:0
			MemberSpeed = 15
		End
	End
End
End

SpecialPower SpellBookBombard
	Enum				= SPECIAL_SPELL_BOOK_BOMBARD
	Flags				= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	RadiusCursorRadius		= 75
	RequiredSciences  		= SCIENCE_Bombard
	ReloadTime       		= SPELL_RECHARGE_TIME_TIER_3
	InitiateAtLocationSound		= SpellBarrageStartMS
End

SpecialPower SpellBookEvilBombard
	Enum				= SPECIAL_SPELL_BOOK_BOMBARD
	Flags				= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	RadiusCursorRadius		= 75
	RequiredSciences  		= SCIENCE_EvilBombard
	ReloadTime       		= SPELL_RECHARGE_TIME_TIER_3
	InitiateAtLocationSound		= SpellBarrageStartMS	;SpellBarrageStartMSSpellCloudBreakStereo
End

ObjectCreationList OCL_SpellBookBombardSeed
	CreateObject
		ObjectNames			= SpellBookBombardSeed
		Disposition			= ON_GROUND_ALIGNED USE_WATER_SURFACE USE_CLIFF
		Count				= 20
		SpreadFormation			= Yes
		MinDistanceAFormation		= 10.0
		MinDistanceBFormation		= 75.0
		MaxDistanceFormation		= 75.0
		OrientInSecondaryDirection	= Yes			; Orient away from fortress.
		OrientationOffset		= 0
		IssueMoveAfterCreation		= No			; Stops assert, as spell book does not have AI.
		IgnoreAllObjects		= Yes			; Don't try and adjust position according to existing objects.
	End
End

SpecialPower SpellBookChillWind
	Enum				= SPECIAL_SPELL_BOOK_CHILL_WIND
	RadiusCursorRadius		= 100
	RequiredSciences		= SCIENCE_ChillWind
	ReloadTime			= SPELL_RECHARGE_TIME_TIER_1
	InitiateAtLocationSound 	= ChillWind
	Flags				= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
End

SpecialPower SpellBookDevastation
	Enum			= SPECIAL_SPELL_BOOK_DEVASTATION
	ReloadTime		= SPELL_RECHARGE_TIME_TIER_2 ; in milliseconds
	RadiusCursorRadius	= 150 ;75.0
	RequiredSciences		= SCIENCE_Devastation
	InitiateAtLocationSound = SpellDevastation
	ViewObjectDuration = 7500
	ViewObjectRange = 150
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
End

Weapon DevastationEntWeapon_NEW
	DamageNugget
		SpecialObjectFilter	= ANY +MONSTER +MACHINE +SHIP ENEMIES
		Damage			= 14000
		Radius			= SPECIALPOWER_DEVASTATION_RADIUS	
		DamageType		= SLASH
		DamageFXType		= BIG_ROCK
		DeathType		= NORMAL
		DamageArc 		= 360
	End
End

SpecialPower SpellBookFrozenLand
	Enum				= SPECIAL_SPELL_BOOK_CHILL_WIND
	RadiusCursorRadius		= 75			; Match the radius in FXList TaintFX
	RequiredSciences		= SCIENCE_FrozenLand
	ReloadTime			= SPELL_RECHARGE_TIME_TIER_2		; in milliseconds
	InitiateAtLocationSound 	= SpellFrozenLand
	ViewObjectDuration		= 1000
	ViewObjectRange			= 175
	Flags				= WATER_OK NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter		= NONE +WatcherHead +WatcherHittingArm +WatcherCaldera
	ForbiddenObjectRange		= 75
End

FXList FX_FrozenLandFX

  ParticleSystem			
    Name = Necro_BlackIce_Embers
    Offset = X:0.0 Y:0.0 Z:0.0
  End
 ParticleSystem					;Particle System 1 of 3
    Name = Necro_SoulFreeze_Whirl
    Offset = X:0.0 Y:0.0 Z:0.0
  End
  ParticleSystem				;Particle System 2 of 3
    Name = Necro_SoulFreeze_Embers ;Necro_BlackIce_EmbersNecro_SoulFreeze_Shafts
    Offset = X:0.0 Y:0.0 Z:0.0
  End
  ParticleSystem				;Particle System 2 of 3
    Name = Necro_SoulFreeze_Shafts
    Offset = X:0.0 Y:0.0 Z:0.0
  End
  ParticleSystem		
    Name = FrozenLandFlare
    Offset = X:0.0 Y:0.0 Z:0.0
  End

 DynamicDecal	; A decal that belongs to nobody, but updates internally to fade and tint and such
		DecalName		= EXSnowBlastPrint
		Size			= 150		
		Color			= R:255 G:255 B:255

		OpacityStart		= 0
		OpacityFadeTimeOne	= 1200
		OpacityPeak		= 255
		OpacityPeakTime		= 15000
		OpacityFadeTimeTwo	= 3000
		OpacityEnd		= 0
		StartingDelay		= 0
		Lifetime		= 40000
  End

    DynamicDecal           ; A decal that belongs to nobody, but updates internally to fade and tint and such

        DecalName                   = EXFrozenLand
        ;Shader			    = SUBTRACT
        Size                        = 150
        Color                       = R:255 G:255 B:255
        OpacityStart                = 0
        OpacityFadeTimeOne          = FROZEN_LAND_EFFECT_FADE_ONE
        OpacityPeak                 = 200
        OpacityPeakTime             = FROZEN_LAND_EFFECT_FADE_PEAK
        OpacityFadeTimeTwo          = FROZEN_LAND_EFFECT_FADE_TWO
        OpacityEnd                  = 0
        StartingDelay               = 0
        Lifetime                    = FROZEN_LAND_EFFECT_DURATION
	End
End

ModifierList BlackIceModifier
	Category					= DEBUFF
    	Modifier                    			= SPEED 25%			; originally 70% 
	Duration					= ANGMAR_NECRO_BLACK_ICE_DURATION
	FX						= FX_BarrowWightDebuff
	ReplaceInCategoryIfLongest			= Yes
End

Object FrozenLandPing
ReplaceModule ModuleTag_LifetimeUpdate
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate_NEW
		MinLifetime	= FROZEN_LAND_EFFECT_DURATION
		MaxLifetime	= FROZEN_LAND_EFFECT_DURATION
	End	
End
ReplaceModule ModuleTag_WeLikeSnow
	Behavior = AttributeModifierAuraUpdate ModuleTag_WeLikeSnow_NEW
		StartsActive	= Yes
		BonusName	= GenericHeroLeadership
		RefreshDelay	= 2000
		Range		= 75
		TargetEnemy	= No
		ObjectFilter	= GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End
End

AddModule ModuleTag_IcyIce
	Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage_NEW
		StartsActive	= Yes
		BonusName	= BlackIceModifier
		RefreshDelay	= 2000
		Range		= 80
		TargetEnemy	= Yes
		AntiCategory	= LEADERSHIP BUFF ; This means cancel all previous leadership bonuses
		ObjectFilter	= GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End
End
End

SpecialPower SpellBookWatcherAlly
	Enum				= SPECIAL_SPELL_BOOK_WATCHER_ALLY
	Flags				= WATER_OK NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ReloadTime			= SPELL_RECHARGE_TIME_TIER_3
	RadiusCursorRadius		= 25.0
	RequiredSciences		= SCIENCE_WatcherAlly
	ViewObjectDuration 		= 5000
	ViewObjectRange 		= 100
	ForbiddenObjectFilter		= NO_SUMMON_NEAR_OBJECT_FILTER
	ForbiddenObjectRange		= 25.0
End

Weapon RainOfFirePhaseOneWeapon
	RadiusDamageAffects = ENEMIES NEUTRALS
	FireFX = FX_RainOfFirePhaseOne
	DamageNugget                        ; A basic Nugget that just does damage
		Damage        = 7250
		DamageScalar  = 50% NONE +MONSTER
		DamageTaperOff = 200
		Radius        = 125
		DamageMaxHeightAboveTerrain = 1
		DelayTime     = 0
		DamageType    = SIEGE
		DeathType     = NORMAL
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .99
		ShockWaveAmount		= 50.0
		ShockWaveTaperOff	= 1.0
		ShockWaveRadius		= 50
	End
	FireLogicNugget						; Increase the fuel where it hits
		LogicType		= INCREASE_FUEL
		Radius			= 75
		Damage			= 25
		MinMaxBurnRate	= 10
		MaxResistance	= 5
	End
	FireLogicNugget						; Light everything on fire
		LogicType		= INCREASE_BURN_RATE
		Radius			= 75
		Damage			= 100
	End
End

Weapon RainOfFirePhaseOneWeapon02
	RadiusDamageAffects = ENEMIES NEUTRALS
	FireFX = FX_RainOfFirePhaseOne02
	DamageNugget                        ; A basic Nugget that just does damage
		Damage        = 7250
		DamageScalar  = 50% NONE +MONSTER
		DamageTaperOff = 200
		Radius        = 120
		DamageMaxHeightAboveTerrain = 1
		DelayTime     = 0
		DamageType    = SIEGE
		DeathType     = NORMAL
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .99
		ShockWaveAmount		= 50.0
		ShockWaveTaperOff	= 1.0
		ShockWaveRadius		= 50
	End
	FireLogicNugget						; Increase the fuel where it hits
		LogicType		= INCREASE_FUEL
		Radius			= 75
		Damage			= 25
		MinMaxBurnRate	= 10
		MaxResistance	= 5
	End
	FireLogicNugget						; Light everything on fire
		LogicType		= INCREASE_BURN_RATE
		Radius			= 75
		Damage			= 100
	End
End

SpecialPower SpellBookRainOfFire
	Enum				= SPECIAL_SPELL_BOOK_RAIN_OF_FIRE
	RadiusCursorRadius		= 150
	RequiredSciences		= SCIENCE_RainOfFire
	ReloadTime			= SPELL_RECHARGE_TIME_TIER_4 ; in milliseconds
	InitiateSound 			= SpellRainOfFireMS
	ViewObjectDuration 		= 10000
	ViewObjectRange 		= 200
	Flags				= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
End

FXList FX_Avalanche_SnowPrint
 DynamicDecal	; A decal that belongs to nobody, but updates internally to fade and tint and such
		DecalName		= EXSnowBlastPrint
		Size			= 180		
		Color			= R:255 G:255 B:255

		OpacityStart		= 0
		OpacityFadeTimeOne	= 400
		OpacityPeak		= 255
		OpacityPeakTime		= 5000
		OpacityFadeTimeTwo	= 5000
		OpacityEnd		= 0
		StartingDelay		= 0
		Lifetime		= 18000
  End
End

FXList FX_Avalanche_SnowPrint2
 DynamicDecal	; A decal that belongs to nobody, but updates internally to fade and tint and such
		DecalName		= EXSnowBlastPrint2
		Size			= 180		
		Color			= R:255 G:255 B:255

		OpacityStart		= 0
		OpacityFadeTimeOne	= 400
		OpacityPeak		= 255
		OpacityPeakTime		= 5000
		OpacityFadeTimeTwo	= 5000
		OpacityEnd		= 0
		StartingDelay		= 0
		Lifetime		= 18000
  End
End

FXParticleSystem AvalancheSnowChunks
  System
    Priority = VERY_LOW_OR_ABOVE
    Shader = W3D_ALPHA
    Type = DRAWABLE
    ParticleName = EXSnowChunk.w3d
    PerParticleAttachedSystem = SnowChunkSmoke
    Lifetime = 25 25
    SystemLifetime = 80
    Size = 0.75 1.5
    BurstDelay = 2 3
    BurstCount = 2 3
    InitialDelay = 40 40
  End
  Color = DefaultColor
    Color1 = R:207 G:170 B:232 0
    Color2 = R:241 G:247 B:250 35
  End
  Alpha = DefaultAlpha
    Alpha1 = 1 1 0
  End
  Update = DefaultUpdate
    SizeRate = -0.01 -0.01
    SizeRateDamping = 1 1
    AngleZ = -500 500
    AngularRateZ = -0.1 0.1
    AngularDamping = 1 1
    Rotation = ROTATE_Y
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = -0.2
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
    Speed = 4 10
  End
  EmissionVolume = CylinderEmissionVolume
    Radius = 30
    Offset = X:0 Y:0 Z:40
  End
  Draw = RenderObjectDraw
  End
  Wind = DefaultWind
    WindStrength = 1
    WindAngleChangeMin = 0.05
    WindAngleChangeMax = 0.05
    TurbulenceAmplitude = 1
    TurbulenceFrequency = 0.1
  End
  Event = TerrainCollision
    HeightOffset = 0 0
    EventFX = FX_SnowChunkGroundHit
    OrientFXToTerrain = No
    PerParticle = Yes
    KillAfterEvent = Yes
  End
End

FXParticleSystem AvalancheSnowChunks2
  System
    Priority = VERY_LOW_OR_ABOVE
    Shader = W3D_DIFFUSE
    Type = DRAWABLE
    ParticleName = EXSnowChunk.w3d
    Lifetime = 30 30
    SystemLifetime = 85
    Size = 0.5 2.5
    BurstDelay = 1 2
    BurstCount = 2 2
    InitialDelay = 55 55
  End
  Color = DefaultColor
    Color1 = R:202 G:221 B:249 0
    Color2 = R:240 G:247 B:251 30
  End
  Alpha = DefaultAlpha
    Alpha1 = 1 1 0
  End
  Update = DefaultUpdate
    SizeRate = -0.01 -0.01
    SizeRateDamping = 1 1
    AngleZ = -500 500
    AngularRateZ = 0.1 0.25
    AngularDamping = 1 1
    Rotation = ROTATE_Y
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = -0.3
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
    Speed = 4 7
  End
  EmissionVolume = CylinderEmissionVolume
    IsHollow = Yes
    Radius = 10
    RadiusRate = 2.5
    Offset = X:0 Y:0 Z:40
  End
  Draw = RenderObjectDraw
  End
  Wind = DefaultWind
    WindStrength = 1
    WindAngleChangeMin = 0.05
    WindAngleChangeMax = 0.05
    TurbulenceAmplitude = 1
    TurbulenceFrequency = 0.1
  End
  Event = TerrainCollision
    HeightOffset = 0 0
    EventFX = FX_Avalanche_SnowPrintSmall2
    OrientFXToTerrain = Yes
    PerParticle = Yes
    KillAfterEvent = Yes
  End
End

FXParticleSystem AvalancheSnowChunks3
  System
    Priority = VERY_LOW_OR_ABOVE
    Shader = W3D_DIFFUSE
    Type = DRAWABLE
    ParticleName = EXSnowChunk.w3d
    Lifetime = 30 30
    SystemLifetime = 85
    Size = 1.5 3.5
    BurstDelay = 3 4
    BurstCount = 2 4
    InitialDelay = 55 55
  End
  Color = DefaultColor
    Color1 = R:202 G:221 B:249 0
    Color2 = R:240 G:247 B:251 30
  End
  Alpha = DefaultAlpha
    Alpha1 = 1 1 0
  End
  Update = DefaultUpdate
    SizeRate = -0.01 -0.01
    SizeRateDamping = 1 1
    AngleZ = -500 500
    AngularRateZ = 0.1 1.25
    AngularDamping = 1 1
    Rotation = ROTATE_Y
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = -0.5
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
    Speed = 4 5
  End
  EmissionVolume = CylinderEmissionVolume
    IsHollow = Yes
    Radius = 10
    RadiusRate = 1.55
    Offset = X:0 Y:0 Z:30
  End
  Draw = RenderObjectDraw
  End
  Wind = DefaultWind
    WindStrength = 1
    WindAngleChangeMin = 0.05
    WindAngleChangeMax = 0.05
    TurbulenceAmplitude = 1
    TurbulenceFrequency = 0.1
  End
  Event = TerrainCollision
    HeightOffset = 0 0
    EventFX = FX_Avalanche_SnowPrintSmall2
    OrientFXToTerrain = Yes
    PerParticle = Yes
    KillAfterEvent = Yes
  End
End

FXList FX_Avalanche
  ParticleSystem
      Name = AvalancheSnowChunkColumn
  End
  ParticleSystem
      Name = AvalancheSnowChunkColumn2
  End
  ParticleSystem
      Name = AvalancheSparkleColumn
  End
  ParticleSystem
      Name = AvalancheSparkleColumn2
  End
  ParticleSystem
      Name = AvalancheSparkle
  End
  ParticleSystem
      Name = AvalancheSparkle2
  End
  ParticleSystem
      Name = AvalancheDustColumn
  End
  ParticleSystem
      Name = AvalancheSnowChunks
  End
  ParticleSystem
      Name = AvalancheSnowChunks2
  End
  ParticleSystem
      Name = AvalancheSnowChunks3
  End
  ParticleSystem
      Name = AvalancheSnowDust
      Offset = X:0.0 Y:0.0 Z:5.0
  End
  ParticleSystem
      Name = AvalancheSnowDust2
      Offset = X:0.0 Y:0.0 Z:5.0
  End
  ParticleSystem
      Name = AvalancheSnowFoam
      Offset = X:0.0 Y:0.0 Z:8.0
  End
  ParticleSystem
      Name = AvalancheSnowWave
  End
      ViewShake
      Type = SEVERE
  End
    CameraShakerVolume
      Radius = 1000
      Duration_Seconds = 5
      Amplitude_Degrees = 0.7
  End
End

SpecialPower SpellBookAvalanche
	Enum				= SPECIAL_SPELL_BOOK_CHILL_WIND
	RadiusCursorRadius		= 150
	RequiredSciences		= SCIENCE_Avalanche
	ReloadTime			= SPELL_RECHARGE_TIME_TIER_4 ; in milliseconds
	ViewObjectDuration 		= 10000
	ViewObjectRange	 		= 200
	InitiateAtLocationSound		= AvalancheRumble
	Flags				= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
End

SpecialPower SpellBookUndermine
	Enum             		= SPECIAL_SPELL_BOOK_CLOUD_BREAK
	RequiredSciences  		= SCIENCE_Undermine
	ReloadTime       		= SPELL_RECHARGE_TIME_TIER_2   ; in milliseconds
	InitiateSound 			= SpellUndermine
End

SpecialPower SpellBookPalantirVision
	Enum			= SPECIAL_SPELL_BOOK_PALANTIR_VISION
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	ReloadTime		= SPELL_RECHARGE_TIME_TIER_1 ; in milliseconds
	RadiusCursorRadius	= 80.0
	RequiredSciences	= SCIENCE_PalantirVision
	InitiateAtLocationSound = SpellPalantirVision
End

SpecialPower SpellBookBalrogAlly
	Enum			= SPECIAL_SPELL_BOOK_CLOUD_BREAK
	ReloadTime		= SPELL_RECHARGE_TIME_TIER_4   ; in milliseconds
	RequiredSciences	= SCIENCE_BalrogAlly
End

SpecialPower SpellBookSummonShadeOfWolf
	Enum			= SPECIAL_SPELL_BOOK_CLOUD_BREAK
	ReloadTime		= SPELL_RECHARGE_TIME_TIER_4   ; in milliseconds
	RequiredSciences	= SCIENCE_SummonShadeOfWolf
End

SpecialPower SpellBookDragonAlly
	Enum			= SPECIAL_SPELL_BOOK_CLOUD_BREAK
	ReloadTime		= SPELL_RECHARGE_TIME_TIER_4
	RequiredSciences	= SCIENCE_DragonAlly
	InitiateAtLocationSound = SpellDragonAllyMS
End

// Command buttons ///////////////////////////////////////////////////////////////////// Command buttons

CommandButton Command_SpellBookUndermine
	Command			= SPELL_BOOK
    SpecialPower		= SpellBookUndermine
	Options			= CANCELABLE
	TextLabel		= LABEL:Undermine
    ButtonImage			= SBGood_Undermine
	ButtonBorderType	= ACTION
	DescriptLabel		= DESCRIPTION:Undermine
End

CommandButton Command_SpellBookBalrogAlly
	Command			= SPELL_BOOK
	SpecialPower		= SpellBookBalrogAlly
	Options			= CANCELABLE
	TextLabel		= CONTROLBAR:SummonBalrog
	ButtonImage		= SBEvil_BalrogAlly
	ButtonBorderType	= ACTION
	DescriptLabel		= CONTROLBAR:TooltipSummonBalrog
End

CommandButton Command_SpellBookSummonShadeOfWolf
	Command			= SPELL_BOOK
	SpecialPower		= SpellBookSummonShadeOfWolf
	Options			= CANCELABLE
	TextLabel		= CONTROLBAR:SummonShadeOfWolf
	ButtonImage		= KUShadeOfTheWolfIcon
	ButtonBorderType	= ACTION
	DescriptLabel		= CONTROLBAR:TooltipSummonShadeOfWolf
End

CommandButton Command_SpellBookDragonAlly
	Command				= SPELL_BOOK
	SpecialPower		= SpellBookDragonAlly
	Options				= CANCELABLE
	TextLabel			= CONTROLBAR:DragonAlly
	ButtonImage			= SBEvil_SummonDragonBlue
	ButtonBorderType	= ACTION 
	DescriptLabel		= CONTROLBAR:TooltipDragonAlly
End

Object AngmarShadeWolf
ReplaceModule ModuleTag_02
  Body            = ActiveBody ModuleTag_02_NEW
    MaxHealth         = 5000
  End
End
RemoveModule ModuleTag_LifetimeUpdate
End

Object SummonedDragonJH1
ReplaceModule ModuleTag_Body
	Body = ActiveBody ModuleTag_Body_NEW
		MaxHealth = 20000
	End
End
RemoveModule ModuleTag_LifetimeUpdate
End

// Command sets ///////////////////////////////////////////////////////////////////// Command sets

CommandSet CreepKillerGoodSpellStore
	1 = Command_PurchaseSpellElvenWood
	2 = Command_PurchaseSpellRallyingCallMP
	3 = Command_PurchaseSpellLoneTower

	4 = Command_PurchaseSpellMenOfDaleAllies
	5 = Command_PurchaseSpellTomBombadil
	6 = Command_PurchaseSpellArrowVolleyGood
	7 = Command_PurchaseSpellDunedainAllies

	8 = Command_PurchaseSpellCloudBreak
	9 = Command_PurchaseSpellEagleAllies
	10 = Command_PurchaseSpellBombard

	11 = Command_PurchaseSpellFlood
	12 = Command_PurchaseSpellSunflare
End

CommandSet CreepKillerEvilSpellStore
	1 = Command_PurchaseSpellCrebain
	2 = Command_PurchaseSpellWarChant
	3 = Command_PurchaseSpellEyeofSauron

	4 = Command_PurchaseSpellAwakenWyrm
	5 = Command_PurchaseSpellChillWind
	6 = Command_PurchaseSpellDevastation
	7 = Command_PurchaseSpellArrowVolleyEvil

	8 = Command_PurchaseSpellFrozenLand
	9 = Command_PurchaseSpellWatcherAlly
	10 = Command_PurchaseSpellEvilBombard

	11 = Command_PurchaseSpellRainOfFire
	12 = Command_PurchaseSpellAvalanche
End

CommandSet SpellBook
	1 = Command_SpellBookScavenger
	2 = Command_SpellBookCrebain
	3 = Command_SpellBookWarChant
	4 = Command_SpellBookEyeofSauron
	5 = Command_SpellBookElvenWood
	6 = Command_SpellBookRallyingCall
	7 = Command_SpellBookLoneTowerDwarf
	8 = Command_SpellBookChillWind
	9 = Command_SpellBookUndermine
	10 = Command_SpellBookAwakenWyrm
	11 = Command_SpellBookDevastation
	12 = Command_SpellBookDarkness
	13 = Command_SpellBookFrozenLand
	14 = Command_SpellBookPalantirVision
	15 = Command_SpellBookArrowVolleyGood
	16 = Command_SpellBookArrowVolleyEvil
	17 = Command_SpellBookTomBombadil
	18 = Command_SpellBookMenOfDaleAllies
	19 = Command_SpellBookDunedainAllies
	20 = Command_SpellBookCloudBreak
	21 = Command_SpellBookEagleAllies
	22 = Command_SpellBookBombard
	23 = Command_SpellBookFlood
	24 = Command_SpellBookSunflare
	25 = Command_SpellBookWatcherAlly
	26 = Command_SpellBookEvilBombard
	27 = Command_SpellBookRainOfFire
	28 = Command_SpellBookAvalanche
	29 = Command_SpellBookHeal
	30 = Command_SpellBookDragonAlly
	31 = Command_SpellBookBalrogAlly
	32 = Command_SpellBookSummonShadeOfWolf
End

// Spellbooks /////////////////////////////////////////////////////////////////////////////// Spellbooks

////////////////////////////////////////// GOOD /////////////////////////////////////////////

Object CreepKillerGoodSpellBook
CommandSet          = SpellBook
RadarPriority       = NOT_ON_RADAR
KindOf              = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT

AddModule
	Behavior = ScavengerSpecialPower ModuleTag_Scavenger
		SpecialPowerTemplate	= SpellBookScavenger
		BountyPercent			= 1.0
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

   AddModule 
	Behavior = SpecialPowerModule		SpellBookLottery_ModuleTag
		SpecialPowerTemplate		= SpellBookLottery
		UpdateModuleStartsAttack	= No
		AffectAllies			= No ; Should not try to affect ally units
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
   End

AddModule
 	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = SpecialPowerModule ModuleTag_RallyingCall
		SpecialPowerTemplate		= SpellBookRallyingCall
		AttributeModifier			= SpellBookRallyingCallModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= GENERIC_BUFF_RECIPIENT_OBJECT_FILTER ;;,;; ANY +HORDE +INFANTRY -HERO -MordorBlackRiderHorde -MordorBlackRider -GondorKnightsofDol -GondorKnightsofDolHorde -IsengardFanatic -IsengardBerserkerHorde  -DwarvenZerker -DwarvenZerkerHorde -NoldorWarrior -NoldorWarriorHorde -WildBabyDrakeHorde -WildBabyDrake ;;.;; Added rest of MHH
		TriggerFX					= FX_SpellRallyingCall
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_BombardEvil
		SpecialPowerTemplate = SpellBookEvilBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
 	Behavior   = SpecialPowerModule ModuleTag_Snowbind
		SpecialPowerTemplate		= SpellBookSnowbind
		AttributeModifier		= SpellBookSnowbind
		AttributeModifierRange		= SNOWBIND_EFFECT_RADIUS
		AttributeModifierAffects	= SNOWBIND_TYPE_SPELL_OBJECT_FILTER
		TriggerFX			= FX_SnowbindSpellFX
		UpdateModuleStartsAttack	= No
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		;TargetEnemy 		= Yes	//This is VERY important because it defaults to false and overrides the AttributeModifier filter above!!!
		TargetAllSides = Yes
	End 
End

AddModule
	Behavior = SpecialPowerModule		SpellBookWarChant_ModuleTag
		SpecialPowerTemplate		= SpellBookWarChant
		AttributeModifier			= SpellBookWarChant
		AttributeModifierRange		= 110
		AttributeModifierAffects	= ANY +INFANTRY +CAVALRY +MACHINE -IMMOBILE -DOZER +HERO -STRUCTURE -BASE_FOUNDATION -HORDE +DwarvenBattleWagon -RohanOathbreaker -MordorRamCrew +MordorWorker -IsengardRamCrew +IsengardBeserker
		TriggerFX					= FX_SpellWarChant
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
 	Behavior   = DarknessSpecialPower ModuleTag_Darkness
		SpecialPowerTemplate			= SpellBookDarkness
		AttributeModifier				= SpellBookDarkness
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO -HORDE ALLIES
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= 450000
		ChangeWeather					= CLOUDY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior           = ElvenWoodSpecialPower ModuleTag_ElvenWood
		SpecialPowerTemplate	= SpellBookElvenWood
		ElvenGroveObject		= ElvenGrove
		ElvenWoodRadius			= 120
		ElvenWoodFX			= FX_ElvenWoodSpellFX
		ElvenWoodOCL			= OCL_ElvenWoodSeed
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_SpawnLoneTowerDwarf
		SpecialPowerTemplate = SpellBookSpawnLoneTowerDwarf
		OCL                  = OCL_DwarfSpellBookSpawnLoneTower
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
		//UseDistanceFromCommandCenter	= Yes
		//DistanceFromCommandCenter		= LONE_TOWER_EFFECTIVE_RADIUS
	End	
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_MenOfDaleAllies
		SpecialPowerTemplate = SpellBookMenOfDaleAllies
		OCL                  = OCL_SpawnMenOfDaleEgg
        TriggerFX			 = FX_DunedainSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_MenOfDaleAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_TomBombadil
		SpecialPowerTemplate = SpellBookTomBombadil
		OCL                  = OCL_SpawnTomBombadilEgg
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_SummonDunedain
		SpecialPowerTemplate = SpellBookDunedainAllies
		OCL                  = OCL_SpawnDunedainRangersEgg
        TriggerFX			 = FX_DunedainSummon
		CreateLocation       = CREATE_AT_LOCATION
		UpgradeName			 = Upgrade_DunedainAllies
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = CloudBreakSpecialPower	ModuleTag_CloudBreak
		SpecialPowerTemplate			= SpellBookCloudBreak
    	SunbeamObject					= CloudBreakSunbeam
		ObjectSpacing					= 300
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes ; cancel negative effects on good guys
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_CLOUDBREAK_DURATION
		ChangeWeather					= SUNNY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_SummonEagles
		SpecialPowerTemplate = SpellBookEagleAllies
		OCL                  = OCL_SpawnEagles
		CreateLocation       = CREATE_ABOVE_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 		= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased		= Yes			
		WeatherDuration				= SPELL_SUNFLARE_DURATION
		ChangeWeather				= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_PalantirVision
		SpecialPowerTemplate = SpellBookPalantirVision
		OCL                  = SpecialPowerPalantirVision
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = SpecialPowerModule ModuleTag_Undermine
		SpecialPowerTemplate = SpellBookUndermine
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
  	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 0.6 ;1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_DragonAlly
		SpecialPowerTemplate = SpellBookDragonAlly
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_SummonShadeOfWolf
		SpecialPowerTemplate = SpellBookSummonShadeOfWolf
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End
End

////////////////////////////////////////// EVIL /////////////////////////////////////////////

Object CreepKillerEvilSpellBook
CommandSet          = SpellBook
RadarPriority       = NOT_ON_RADAR
KindOf              = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT


AddModule
	Behavior = ScavengerSpecialPower ModuleTag_Scavenger
		SpecialPowerTemplate	= SpellBookScavenger
		BountyPercent			= 1.0
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

   AddModule 
	Behavior = SpecialPowerModule		SpellBookLottery_ModuleTag
		SpecialPowerTemplate		= SpellBookLottery
		UpdateModuleStartsAttack	= No
		AffectAllies			= No ; Should not try to affect ally units
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
   End

   AddModule 
	Behavior = OCLSpecialPower	ModuleTag_OCLEyeOfSauron
		SpecialPowerTemplate	= SpellBookEyeofSauron
		OCL						= SUPERWEAPON_SpawnEyeOfSauron
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
   End

   AddModule 
	Behavior = OCLSpecialPower	ModuleTag_OCLEvilEyeOfSauron
		SpecialPowerTemplate	= SpellBookEvilEyeofSauron
		OCL						= SUPERWEAPON_SpawnEyeOfSauron
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
   End

AddModule
	Behavior = SpecialPowerModule		SpellBookWarChant_ModuleTag
		SpecialPowerTemplate		= SpellBookWarChant
		AttributeModifier			= SpellBookWarChant
		AttributeModifierRange		= 110
		AttributeModifierAffects	= ANY +INFANTRY +CAVALRY +MACHINE -IMMOBILE -DOZER +HERO -STRUCTURE -BASE_FOUNDATION -HORDE +DwarvenBattleWagon -RohanOathbreaker -MordorRamCrew +MordorWorker -IsengardRamCrew +IsengardBeserker
		TriggerFX					= FX_SpellWarChant
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = DevastateSpecialPower	ModuleTag_DevastateSpecialPower
		SpecialPowerTemplate		= SpellBookDevastation
		Radius				= SPECIALPOWER_DEVASTATION_RADIUS
		TreeValueMultiplier	= 50%	;The value sqeezed out of each tree is multiplied by this compared to what a worker would have gotten for it
		TreeValueTotalCap	= 1500	;And the most you can get for the enitre spell is this, so you can't find the one map that has a 20000 patch of trees in the corner
		TriggerFX			= FX_DevastationFlare
		FX					= FX_Devastation
		AvailableAtStart	= No
		FireWeapon			= DevastationEntWeapon_NEW
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_AwakenWyrm
		SpecialPowerTemplate = SpellBookAwakenWyrm
		OCL                  = OCL_Wyrm
		TriggerFX	     = FX_WrymSummonStart
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_SummonWatcher
		SpecialPowerTemplate = SpellBookWatcherAlly
		OCL                  = OCL_WatcherSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
  	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
 	Behavior   = OCLSpecialPower ModuleTag_ChillWind
		SpecialPowerTemplate	= SpellBookChillWind
		OCL				= OCL_SpellBookChillWind
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_Undermine
		SpecialPowerTemplate = SpellBookUndermine
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End 
End

AddModule
    Behavior = OCLSpecialPower		ModuleTag_FrozenLand
		SpecialPowerTemplate		= SpellBookFrozenLand
		TriggerFX			= FX_FrozenLandFX
		OCL				= OCL_SpecialPowerFrozenLand
		CreateLocation			= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
 	Behavior   = DarknessSpecialPower ModuleTag_Darkness
		SpecialPowerTemplate			= SpellBookDarkness
		AttributeModifier				= SpellBookDarkness
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO -HORDE ALLIES
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= 450000
		ChangeWeather					= CLOUDY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_BombardEvil
		SpecialPowerTemplate = SpellBookEvilBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = FreezingRainSpecialPower ModuleTag_FreezingRain
		SpecialPowerTemplate			= SpellBookFreezingRain
		AttributeModifierAffects		= ALL ENEMIES
		AntiCategory					= LEADERSHIP
;		AntiFX						= FX_AntiLeadership ; FX for anti category
		AttributeModifierWeatherBased	= Yes
		WeatherDuration					= SPELL_FREEZINGRAIN_DURATION
		ChangeWeather					= RAINY
		AvailableAtStart				= No
		BurnRateModifier				= -100
		BurnDecayModifier				= 20
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_PalantirVision
		SpecialPowerTemplate = SpellBookPalantirVision
		OCL                  = SpecialPowerPalantirVision
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = SpecialPowerModule ModuleTag_RallyingCall
		SpecialPowerTemplate		= SpellBookRallyingCall
		AttributeModifier			= SpellBookRallyingCallModifier
		AttributeModifierRange		= 100
		AttributeModifierAffects	= GENERIC_BUFF_RECIPIENT_OBJECT_FILTER ;;,;; ANY +HORDE +INFANTRY -HERO -MordorBlackRiderHorde -MordorBlackRider -GondorKnightsofDol -GondorKnightsofDolHorde -IsengardFanatic -IsengardBerserkerHorde  -DwarvenZerker -DwarvenZerkerHorde -NoldorWarrior -NoldorWarriorHorde -WildBabyDrakeHorde -WildBabyDrake ;;.;; Added rest of MHH
		TriggerFX					= FX_SpellRallyingCall
		UpdateModuleStartsAttack	= No
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
  	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 0.6 ;1.0	; 0.5 = 50% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_DragonAlly
		SpecialPowerTemplate = SpellBookDragonAlly
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_SummonShadeOfWolf
		SpecialPowerTemplate = SpellBookSummonShadeOfWolf
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End

AddModule
	Behavior = OCLSpecialPower ModuleTag_Avalanche
		SpecialPowerTemplate 		= SpellBookAvalanche
		OCL                  		= OCL_SpellBookAvalancheEgg
		CreateLocation       		= CREATE_AT_LOCATION
		TriggerFX			 = FX_Avalanche
		AvailableAtStart	 	= No
		RequirementsFilterMPSkirmish 	= SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic 	= SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
End
End

/////////////////////////////////////////////////////////////////////////// Player templates

PlayerTemplate FactionCivilian  ; makes AI able to fire spells
IntrinsicSciencesMP = SCIENCE_EVIL SCIENCE_GOOD
PurchaseScienceCommandSetMP = CreepKillerEvilSpellStore
SpellBookMp = CreepKillerEvilSpellBook
;StartingBuilding = NONE
;StartingUnit0 = NONE
;StartingUnit1 = NONE
End

PlayerTemplate FactionMen
IntrinsicSciencesMP = SCIENCE_EVIL SCIENCE_GOOD
PurchaseScienceCommandSetMP = CreepKillerGoodSpellStore
SpellBookMp = CreepKillerGoodSpellBook
;StartingBuilding = NONE
;StartingUnit0 = NONE
;StartingUnit1 = NONE
End

PlayerTemplate FactionElves
IntrinsicSciencesMP = SCIENCE_EVIL SCIENCE_GOOD
PurchaseScienceCommandSetMP = CreepKillerGoodSpellStore
SpellBookMp = CreepKillerGoodSpellBook
;StartingBuilding = NONE
;StartingUnit0 = NONE
;StartingUnit1 = NONE
End

PlayerTemplate FactionDwarves
IntrinsicSciencesMP = SCIENCE_EVIL SCIENCE_GOOD
PurchaseScienceCommandSetMP = CreepKillerGoodSpellStore
SpellBookMp = CreepKillerGoodSpellBook
;StartingBuilding = NONE
;StartingUnit0 = NONE
;StartingUnit1 = NONE
End

PlayerTemplate FactionIsengard
IntrinsicSciencesMP = SCIENCE_EVIL SCIENCE_GOOD
PurchaseScienceCommandSetMP = CreepKillerEvilSpellStore
SpellBookMp = CreepKillerEvilSpellBook
;StartingBuilding = NONE
;StartingUnit0 = NONE
;StartingUnit1 = NONE
End

PlayerTemplate FactionWild
IntrinsicSciencesMP = SCIENCE_EVIL SCIENCE_GOOD
PurchaseScienceCommandSetMP = CreepKillerEvilSpellStore
SpellBookMp = CreepKillerEvilSpellBook
;StartingBuilding = NONE
;StartingUnit0 = NONE
;StartingUnit1 = NONE
End

PlayerTemplate FactionMordor
IntrinsicSciencesMP = SCIENCE_EVIL SCIENCE_GOOD
PurchaseScienceCommandSetMP = CreepKillerEvilSpellStore
SpellBookMp = CreepKillerEvilSpellBook
;StartingBuilding = NONE
;StartingUnit0 = NONE
;StartingUnit1 = NONE
End

PlayerTemplate FactionAngmar
IntrinsicSciencesMP = SCIENCE_EVIL SCIENCE_GOOD
PurchaseScienceCommandSetMP = CreepKillerEvilSpellStore
SpellBookMp = CreepKillerEvilSpellBook
;StartingBuilding = NONE
;StartingUnit0 = NONE
;StartingUnit1 = NONE
End

///////////////////////////////////////////////////////////////////////////////// Upgrades for hordes

Upgrade Upgrade_DwarvenBasicTraining
	DisplayName     		= UPGRADE:DwarvenBasicTraining
	Type            		= OBJECT
	Tooltip				= UPGRADE:DwarvenBasicTraining
	BuildCost			= 25
	BuildTime			= 1
	;ResearchCompleteEvaEvent	= UpgradeBannerCarrierReady
	RequiredObjectFilter		= NONE +DwarfBarracks
	StrategicIcon			= AptStrategicUnitUpgradeBannerCarrier
End

Upgrade Upgrade_DwarvenMithrilMail
	DisplayName     	= UPGRADE:DwarvenMithrilMail
	Type            	= OBJECT
	Tooltip			= TOOLTIP:DwarvenMithrilMail
	BuildCost		= 100
	BuildTime		= 1	
	ResearchSound		= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverMithrilMail
	ButtonImage		= BuildingNoArt
	Cursor			= WeaponUpgrade
	RequiredObjectFilter 	= NONE +DwarvenSiegeWorks
	StrategicIcon		= AptStrategicUnitUpgradeArmor
End

Upgrade Upgrade_AngmarBasicTraining
	DisplayName     		= UPGRADE:AngmarBasicTraining
	Type            		= OBJECT
	Tooltip				= UPGRADE:AngmarBasicTraining
	BuildCost			= 25
	BuildTime			= 1
	ResearchCompleteEvaEvent	= UpgradeBannerCarrierReady
	RequiredObjectFilter		= NONE +AngmarBarracks
	StrategicIcon			= AptStrategicUnitUpgradeBannerCarrier
End

Upgrade Upgrade_AngmarDarkIronArmor
	DisplayName     	= UPGRADE:AngmarDarkIronArmor
	Type            	= OBJECT
	Tooltip			= TOOLTIP:AngmarDarkIronArmor
	BuildCost		= 100
	BuildTime		= 1
	ResearchSound		= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverForgedBlades
	ButtonImage		= BuildingNoArt
	Cursor			= WeaponUpgrade
	RequiredObjectFilter 	= NONE +AngmarForgeWorks
	StrategicIcon		= AptStrategicUnitUpgradeArmor
End

Upgrade Upgrade_AngmarSpikedCollar
	DisplayName     	= UPGRADE:AngmarSpikedCollar
	Type            	= OBJECT
	Tooltip			= TOOLTIP:AngmarSpikedCollar
	BuildCost		= 50
	BuildTime		= 1
	ResearchSound		= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverForgedBlades
	ButtonImage		= BuildingNoArt
	Cursor			= WeaponUpgrade
	RequiredObjectFilter 	= NONE +AngmarDen
	StrategicIcon		= AptStrategicUnitUpgradeArmor
End

Upgrade Upgrade_GondorBasicTraining
	DisplayName       		= UPGRADE:GondorBasicTraining
	Type              		= OBJECT
	Tooltip				= UPGRADE:GondorBasicTraining
	BuildCost			= 25
	BuildTime			= 1
	ResearchCompleteEvaEvent	= UpgradeBannerCarrierReady
	RequiredObjectFilter 		= NONE +GondorForge
	StrategicIcon			= AptStrategicUnitUpgradeBannerCarrier
End

Upgrade Upgrade_GondorHeavyArmor
	DisplayName       	= UPGRADE:GondorHeavyArmor
	Tooltip			= TOOLTIP:GondorHeavyArmor
	Type             	= OBJECT
	BuildCost		= 100
	BuildTime		= 1
	ResearchSound		= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverHeavyArmor
	RequiredObjectFilter 	= NONE +GondorForge
	StrategicIcon		= AptStrategicUnitUpgradeArmor
End

Upgrade Upgrade_GondorKnightShield
	DisplayName       	= UPGRADE:GondorKnightShield
  	Tooltip			= TOOLTIP:GondorKnightShields
	Type              	= OBJECT
	BuildCost		= 75
	BuildTime		= 1
	ResearchSound		= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverHorseShields
	RequiredObjectFilter 	= NONE +GondorStable
	StrategicIcon		= AptStrategicUnitUpgradeHorseShield
End

Upgrade Upgrade_ArnorBasicTraining
	DisplayName       		= UPGRADE:ArnorBasicTraining
	Type              		= OBJECT
	Tooltip				= UPGRADE:ArnorBasicTraining
	BuildCost			= 25
	BuildTime			= 1
	ResearchCompleteEvaEvent	= UpgradeBannerCarrierReady
	RequiredObjectFilter 		= NONE +ArnorForge
	StrategicIcon			= AptStrategicUnitUpgradeBannerCarrier
End

Upgrade Upgrade_ArnorHeavyArmor
	DisplayName       	= UPGRADE:ArnorHeavyArmor
	Tooltip			= TOOLTIP:ArnorHeavyArmor
	Type              	= OBJECT
	BuildCost		= 100
	BuildTime		= 1
	ResearchSound		= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverHeavyArmor
	RequiredObjectFilter 	= NONE +ArnorForge
	StrategicIcon		= AptStrategicUnitUpgradeArmor
End

Upgrade Upgrade_ArnorKnightShield
	DisplayName       	= UPGRADE:ArnorKnightShield
  	Tooltip			= TOOLTIP:ArnorKnightShields
	Type             	= OBJECT
	BuildCost		= 75
	BuildTime		= 1
	ResearchSound		= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverHorseShields
	RequiredObjectFilter	= NONE +ArnorStable
	StrategicIcon		= AptStrategicUnitUpgradeHorseShield
End

Upgrade Upgrade_ElvenBasicTraining
	DisplayName       = UPGRADE:ElvenBasicTraining
	Type              = OBJECT
	Tooltip		= UPGRADE:ElvenBasicTraining
	BuildCost		= 25
	BuildTime		= 1
	ResearchCompleteEvaEvent	= UpgradeBannerCarrierReady
	RequiredObjectFilter = ANY +EregionForge ;+ElvenGreenPasture 
	StrategicIcon	= AptStrategicUnitUpgradeBannerCarrier
End

Upgrade Upgrade_ElvenHeavyArmor
	DisplayName       = UPGRADE:ElvenHeavyArmor
	Tooltip		= TOOLTIP:ElvenHeavyArmor
	Type              = OBJECT
	BuildCost		= 100
	BuildTime		= 1
	ResearchSound	= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverHeavyArmor
	RequiredObjectFilter = NONE +EregionForge
	StrategicIcon	= AptStrategicUnitUpgradeArmor
End

Upgrade Upgrade_WildBasicTraining 
	DisplayName     = UPGRADE:WildBasicTraining 
	Type            = OBJECT
	Tooltip			= UPGRADE:WildBasicTraining 
	BuildCost		= 25	
	BuildTime		= 1	
	//ResearchSound	= UpgradeHeavyArmor
	//UpgradeFX		= FX_PorterDeliverHeavyArmor
	ButtonImage     = BuildingNoArt
	//Cursor			= WeaponUpgrade
	RequiredObjectFilter = NONE +WildTreasureTrove
	StrategicIcon	= AptStrategicUnitUpgradeBannerCarrier
End

Upgrade Upgrade_WildHeavyArmor
	DisplayName     = UPGRADE:WildHeavyArmor
	Type            = OBJECT
	Tooltip			= TOOLTIP:WildHeavyArmor
	BuildCost		= 100
	BuildTime		= 1
	ResearchSound	= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverHeavyArmor
	ButtonImage     = BuildingNoArt
	Cursor			= WeaponUpgrade
	RequiredObjectFilter = NONE +WildTreasureTrove
	StrategicIcon	= AptStrategicUnitUpgradeArmor
End

Upgrade Upgrade_IsengardBasicTraining
	DisplayName       = UPGRADE:IsengardBasicTraining
	Type              = OBJECT
	Tooltip		= UPGRADE:IsengardBasicTraining
	BuildCost		= 25
	BuildTime		= 1
	ResearchCompleteEvaEvent	= UpgradeBannerCarrierReady
	RequiredObjectFilter = NONE +IsengardArmory
	StrategicIcon	= AptStrategicUnitUpgradeBannerCarrier
End

Upgrade Upgrade_IsengardHeavyArmor
	DisplayName       = UPGRADE:IsengardHeavyArmor
	Type              = OBJECT
	Tooltip		= TOOLTIP:IsengardHeavyArmor
	BuildCost		= 100
	BuildTime		= 1
	ResearchSound	= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverHeavyArmor
	ButtonImage       = BuildingNoArt
	Cursor				= WeaponUpgrade
	RequiredObjectFilter = NONE +IsengardArmory
	StrategicIcon	= AptStrategicUnitUpgradeArmor
End

Upgrade Upgrade_MordorBasicTraining
	DisplayName       	= UPGRADE:MordorBasicTraining
	Type             	= OBJECT
	Tooltip			= UPGRADE:MordorBasicTraining
	BuildCost		= 25
	BuildTime		= 1
	ResearchCompleteEvaEvent  = UpgradeBannerCarrierReady
	RequiredObjectFilter 	= NONE +MordorOrcPit
	StrategicIcon		= AptStrategicUnitUpgradeBannerCarrier
End

Upgrade Upgrade_MordorHeavyArmor
	DisplayName       	= UPGRADE:MordorHeavyArmorUpgrade
	Type              	= OBJECT
	Tooltip			= TOOLTIP:MordorHeavyArmor
	BuildCost		= 100
	BuildTime		= 1
	ResearchSound		= UpgradeHeavyArmor
	UpgradeFX		= FX_PorterDeliverHeavyArmor
	RequiredObjectFilter 	= NONE +MordorSiegeWorks
	StrategicIcon		= AptStrategicUnitUpgradeArmor
End

Upgrade Upgrade_BattleWagonAxeThrowers
	Type			= OBJECT
	BuildCost		= 0
	BuildTime		= 1
	ResearchSound	= DwarfBattleWagonVoiceUpgradeAxeThrower
	DisplayName       = UPGRADE:BattlewagonAxeThrowers
End

Upgrade Upgrade_BattleWagonBannerCarrier
	Type			= OBJECT
	BuildCost		= 0
	BuildTime		= 1
	ResearchSound	= DwarfBattleWagonUpgradeBannerCarrierMS
	DisplayName       = UPGRADE:BattlewagonBannerCarrier
End

Upgrade Upgrade_BattleWagonMenOfDale
	Type			= OBJECT
	BuildCost		= 0
	BuildTime		= 1
	ResearchSound	= DwarfBattleWagonVoiceUpgradeMenOfDale
	DisplayName       = UPGRADE:BattlewagonMenofDale
End

Upgrade Upgrade_BattleWagonHearth
	Type			= OBJECT
	BuildCost		= 0
	BuildTime		= 1
	ResearchSound	= DwarfBattleWagonUpgradeHearthMS
	DisplayName       = UPGRADE:BattlewagonHearth
End

/////////////////////////////////////////////////////////////////////////// Fortresses

Object MenFortressCitadel
RemoveModule AutoDepositModuleTag
End

Object ElvenCitadel
RemoveModule AutoDepositModuleTag
End

Object DwarvenFortressCitadel
RemoveModule AutoDepositModuleTag
End

Object MordorFortressCitadel
RemoveModule AutoDepositModuleTag
End

Object IsengardFortressCitadel
RemoveModule AutoDepositModuleTag
End

Object AngmarFortressCitadel
RemoveModule AutoDepositModuleTag
End

Object WildFortressCitadel
RemoveModule AutoDepositModuleTag
End

/////////////////////////////////////////////////////////////////////////// Expansion commandsets

CommandSet AngmarFortressExpansionPad
	1 	= Command_ConstructAngmarBattleTowerExpansion
	2 	= Command_ConstructAngmarStoneThrowerExpansion
End

Object AngmarFortressExpansionPadCorner
CommandSet = AngmarFortressExpansionPad
End

Object AngmarFortressExpansionPadSide
CommandSet = AngmarFortressExpansionPad
End

CommandSet WildFortressExpansionPad
	1 	= Command_ConstructWildArrowDenExpansion
	2 	= Command_ConstructWildGiantSentryExpansion	
	3 	= Command_ConstructWildBurrowsExpansion
End

Object WildFortressExpansionPadCorner
CommandSet = WildFortressExpansionPad
End

Object WildFortressExpansionPadSide
CommandSet = WildFortressExpansionPad
End

CommandSet IsengardFortressExpansionPad
	1 = Command_ConstructIsengardTowerExpansion
	2 = Command_ConstructIsengardBallistaExpansion
	3 = Command_ConstructIsengardMineLauncherExpansion
End

Object IsengardFortressExpansionPadCorner
CommandSet = IsengardFortressExpansionPad
End

Object IsengardFortressExpansionPadSide
CommandSet = IsengardFortressExpansionPad
End

CommandSet ElvenFortressExpansionPad
 	1 	= Command_ConstructElvenWatchtowerExpansion
	2 	= Command_ConstructElvenVigilantEntExpansion
	3 	= Command_ConstructElvenFloodgateExpansion
End

Object ElvenFortressExpansionPadCorner
CommandSet = ElvenFortressExpansionPad
End

Object ElvenFortressExpansionPadSide
CommandSet = ElvenFortressExpansionPad
End

///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////    BUILDINGS
///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////       FOR
///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////     PLAYERS
///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////	  1-4
///////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////

// Command buttons for fortress expansions ////////////////////////////////////////// Command buttons for fortress expansions

CommandButton Command_ConstructMenTrebuchetExpansion 
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = MenTrebuchetExpansion
	TextLabel        = CONTROLBAR:ConstructMenTrebuchetExpansion
	ButtonImage      = BGFortress_Trebuchet
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructMenTrebuchetExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructMenArrowTowerExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = MenArrowTowerExpansion
	TextLabel        = CONTROLBAR:ConstructMenArrowTowerExpansion
	ButtonImage      = BGFortress_ArrowTower
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructMenArrowTowerExpansion
	Radial           = Yes  
End 

CommandButton Command_ConstructMenGarrisonDormitory
	Command          = DOZER_CONSTRUCT
	Options			 = CANCELABLE
	Object           = MenGarrisonTowerExpansion
	TextLabel        = CONTROLBAR:ConstructMenDormitory
	ButtonImage      = BGFortress_Dormitory
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructMenDormitory
	Radial           = Yes  
End

CommandButton Command_ConstructElvenWatchtowerExpansion
	Command          	= DOZER_CONSTRUCT
    Options			= CANCELABLE
	Object           	= ElvenWatchtowerExpansion
	TextLabel        	= CONTROLBAR:ConstructElvenWatchtowerExpansion
	ButtonImage      	= BEBattleTower 
	ButtonBorderType 	= BUILD 
	DescriptLabel    	= CONTROLBAR:ToolTipConstructElvenWatchtowerExpansion
	Radial           	= Yes
End

CommandButton Command_ConstructElvenVigilantEntExpansion
	Command          	= DOZER_CONSTRUCT
    Options			= CANCELABLE
	Object           	= ElvenVigilantEntExpansion
	TextLabel        	= CONTROLBAR:ConstructElvenVigilantEntExpansion
	ButtonImage      	= BEEntMoot_Ents
	ButtonBorderType 	= BUILD 
	DescriptLabel    	= CONTROLBAR:ToolTipConstructElvenVigilantEntExpansion
	Radial           	= Yes
End

CommandButton Command_ConstructElvenFloodgateExpansion
	Command          	= DOZER_CONSTRUCT
    Options			= CANCELABLE
	Object           	= ElvenFloodgateExpansion
	TextLabel        	= CONTROLBAR:ConstructElvenFloodgateExpansion
	ButtonImage      	= SBGood_Flood 
	ButtonBorderType 	= BUILD 
	DescriptLabel    	= CONTROLBAR:ToolTipConstructElvenFloodgateExpansion
	Radial           	= Yes
End

CommandButton Command_ConstructDwarvenCatapultExpansion
	Command          = DOZER_CONSTRUCT
	Object           = DwarvenCatapultExpansion
	TextLabel        = CONTROLBAR:ConstructDwarvenCatapultExpansion
	ButtonImage      = BDFortress_Catapult
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructDwarvenCatapultExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructDwarvenEreborTowerTowerExpansion
	Command          = DOZER_CONSTRUCT
	Object           = DwarvenEreborTowerTowerExpansion
	TextLabel        = CONTROLBAR:ConstructDwarvenEreborTowerTowerExpansion
	ButtonImage      = BDFortress_AxeTower
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructDwarvenEreborTowerTowerExpansion
	Radial           = Yes  
End 

CommandButton Command_ConstructDwarvenHallExpansion
	Command          = DOZER_CONSTRUCT
	Object           = DwarvenHallExpansion
	TextLabel        = CONTROLBAR:ConstructDwarvenHallExpansion
	ButtonImage      = BDFortress_Bunker
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructDwarvenHallExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructAngmarStoneThrowerExpansion
	Command          = DOZER_CONSTRUCT
	Object           = AngmarCatapultExpansion
	TextLabel        = CONTROLBAR:ConstructAngmarStoneThrowerExpansion
	ButtonImage      = KUWallBuildTrollSlingIcon
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructAngmarStoneThrowerExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructAngmarBattleTowerExpansion
	Command          = DOZER_CONSTRUCT
	Object           = AngmarBattleTowerExpansion
	TextLabel        = CONTROLBAR:ConstructAngmarBattleTowerExpansion
	ButtonImage      = KUBattleTowerIcon
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructAngmarBattleTowerExpansion
	Radial           = Yes  
End 

CommandButton Command_ConstructAngmarKennelExpansion
	Command          = DOZER_CONSTRUCT
	Object           = AngmarKennelExpansion
	TextLabel        = CONTROLBAR:ConstructAngmarKennelExpansion
	ButtonImage      = KUKennelIcon
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructAngmarKennelExpansion
	Radial           = Yes  
End 


CommandButton Command_ConstructIsengardTowerExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = IsengardTowerExpansion
	TextLabel        = CONTROLBAR:ConstructIsengardTowerExpansion
	ButtonImage      = BIFortress_ArrowTower
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructIsengardTowerExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructIsengardBallistaExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = IsengardBallistaExpansion
	TextLabel        = CONTROLBAR:ConstructIsengardBallistaExpansion
	ButtonImage      = BISiegeWorks_SeigeBallista 
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructIsengardBallistaExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructIsengardMineLauncherExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = IsengardMineLauncherExpansion
	TextLabel        = CONTROLBAR:ConstructIsengardMineLauncherExpansion
	ButtonImage      = BIFortress_MineLauncher 
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructIsengardMineLauncherExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructMordorWallCatapultExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = MordorWallCatapultExpansion
	TextLabel        = CONTROLBAR:ConstructMordorWallCatapultExpansion
	ButtonImage      = BMFortress_Catapult
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructMordorWallCatapultExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructMordorBarricadeExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = MordorFortressBarricadeExpansion
	TextLabel        = CONTROLBAR:ConstructMordorBarricadeExpansion
	ButtonImage      = SBEvil_Barricade 
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructElvenWatchtowerExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructMordorGateWatchersExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = MordorGateWatchersExpansion
	TextLabel        = CONTROLBAR:ConstructMordorGateWatchersExpansion
	ButtonImage      = BMFortress_GateWatchers
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructMordorGateWatchersExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructWildArrowDenExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = WildArrowDenExpansion
	TextLabel        = CONTROLBAR:ConstructWildArrowDenExpansion
	ButtonImage      = BWFortress_ArrowDen
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructWildArrowDenExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructWildSpiderHolesExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = WildSpiderHolesExpansion
	TextLabel        = CONTROLBAR:ConstructWildSpiderHolesExpansion
	ButtonImage      = SBEvil_SummonSpiderlings
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructWildSpiderHolesExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructWildGiantSentryExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = WildGiantSentryExpansion
	TextLabel        = CONTROLBAR:ConstructWildGiantSentryExpansion
	ButtonImage      = BWFissure_Giant
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructWildGiantSentryExpansion
	Radial           = Yes  
End

CommandButton Command_ConstructWildBurrowsExpansion
	Command          = DOZER_CONSTRUCT
    Options			 = CANCELABLE
	Object           = WildBurrowsExpansion
	TextLabel        = CONTROLBAR:ConstructWildBurrowsExpansion
	ButtonImage      = BWFortress_Burrows
	ButtonBorderType = BUILD 
	DescriptLabel    = CONTROLBAR:ToolTipConstructWildBurrowsExpansion
	Radial           = Yes  
End

// Command sets for builders ////////////////////////////////////////////// Command sets for builders

CommandSet MenPorter
   1  = Command_Stop
   2  = Command_PorterExtinguishFire
   3  = Command_PorterConstructMenArcheryRange
   4  = Command_PorterConstructMenWorkshop
   5  = Command_PorterConstructMenWell
   6  = Command_PorterConstructMenStatue
   7  = Command_PorterConstructMenSentryTower
   8  = Command_ConstructMenTrebuchetExpansion
   9  = Command_ConstructMenArrowTowerExpansion
   10 = Command_ConstructMenGarrisonDormitory
   11 = Command_PorterConstructMenWallHub
   12 = Command_PorterConstructMenFortress
End

Object MenPorter
CommandSet = MenPorter
End

CommandSet ElvenPorter  
   1  = Command_Stop
   2  = Command_PorterExtinguishFire
   3  =	Command_ConstructElvenBarracks  //////////// Remove melee, changes archers and silverthorns
   4  =	Command_ConstructElvenEntMoot
   5  = Command_ConstructElvenMirrorOfGaladriel
   6  = Command_ConstructElvenStatue
   7  =	Command_ConstructElvenWatchTower
   8  = Command_ConstructElvenVigilantEntExpansion
   9  = Command_ConstructElvenWatchtowerExpansion
   10 = Command_ConstructElvenFloodgateExpansion
   11 = Command_ConstructElvenFortress
End

Object ElvenPorter
CommandSet = ElvenPorter
End

CommandSet DwarvenPorter
   1  = Command_Stop
   2  = Command_PorterExtinguishFire
   3  = Command_ConstructDwarvenArcheryRange
   4  = Command_ConstructDwarvenForgeWorks ////////// Remove demolisher, heavy armour
   5  =	Command_ConstructDwarvenHearth
   6  = Command_ConstructDwarvenStatue
   7  = Command_ConstructDwarvenSentryTower
   8  = Command_ConstructDwarvenWallHub
   9  = Command_ConstructDwarvenCatapultExpansion
   10  = Command_ConstructDwarvenEreborTowerTowerExpansion
   11  = Command_ConstructDwarvenHallExpansion
   12 =	Command_PorterConstructDwarvenFortress
End

Object DwarvenPorter
CommandSet = DwarvenPorter
End

CommandSet AngmarPorter
   	1  	= Command_Stop
   	2  	= Command_PorterExtinguishFire
   	3 	= Command_ConstructAngmarBarracks ///////// 1: Axe throwers 2: Rangers 3: Ice Arrows
   	4  	= Command_ConstructAngmarHallofTwilight
   	5  	= Command_ConstructAngmarForgeWorks //////// Remove melee upgrades, ice shot at level 2
   	6  	= Command_ConstructAngmarSentryTower
	7	= Command_ConstructAngmarStoneThrowerExpansion
	8	= Command_ConstructAngmarBattleTowerExpansion
   	9 	= Command_ConstructAngmarWallHub
   	10 	= Command_PorterConstructAngmarFortress 
End

Object AngmarPorter
CommandSet = AngmarPorter
End

CommandSet IsengardPorter
	1 = Command_Stop
	2 = Command_PorterExtinguishFire
	3 = Command_PorterConstructIsengardUrukPit //// Add axe throwers, remove melee
	4 = Command_PorterConstructIsengardSiegeWorks //// Remove ram
	5 = Command_PorterConstructIsengardBattleTower
	6 = Command_ConstructIsengardTowerExpansion
	7 = Command_ConstructIsengardBallistaExpansion
	8 = Command_ConstructIsengardMineLauncherExpansion
	9 = Command_PorterConstructIsengardFortress 
End

Object IsengardPorter
CommandSet = IsengardPorter
End

CommandSet MordorPorter
	1 = Command_Stop
	2 = Command_PorterExtinguishFire
	3 = Command_PorterConstructMordorHaradrimPalace /////// Add Mordor Archers
	4 = Command_PorterConstructMordorSiegeWorks ////////// Add cave troll, drummer troll
	5 = Command_PorterconstructMordorBattleTower
	6 = Command_ConstructMordorBarricadeExpansion
	7 = Command_ConstructMordorWallCatapultExpansion
	8 = Command_ConstructMordorGateWatchersExpansion
	9 = Command_PorterConstructMordorFortress
End

Object MordorPorter
CommandSet = MordorPorter
End

CommandSet WildPorter
        1  = Command_Stop
	2  = Command_PorterExtinguishFire
	3  = Command_PorterConstructWildCave /// Add spider rider horde and fire arrows
	4  = Command_PorterConstructWildFissure /// Remove melee, add drummer troll
	5  = Command_PorterConstructWildSentryTower
	6  = Command_ConstructWildArrowDenExpansion
	8  = Command_ConstructWildGiantSentryExpansion
	9  = Command_ConstructWildBurrowsExpansion
	10 = Command_PorterConstructWildFortress
End

Object WildPorter
CommandSet = WildPorter
End

// Building objects without commandset upgrades ////////////////////////////////////////////////////////// Building objects without commandset upgrades

Object MenWorkshop
BuildTime = 15
End

Object MenSentryTower
BuildTime = 15
End

Object MenWell
BuildTime = 15
End

Object MenStatue
BuildTime = 15
End

Object MenWallHub
BuildTime = 15
End

Object ElvenEntMoot
BuildTime = 15
End

Object ElvenStatue
BuildTime = 15
End

Object ElvenBattleTower
BuildTime = 15
End

Object ElvenMirrorOfGaladriel
BuildTime = 15
End

Object DwarvenArcheryRange
BuildTime = 15
End

Object DwarvenSentryTower
BuildTime = 15
End

Object DwarvenHearth
BuildTime = 15
End

Object DwarvenStatue
BuildTime = 15
End

Object DwarvenWallHub
BuildTime = 15
End

Object AngmarHallofTwilight
BuildTime = 15
End

Object AngmarSentryTower
BuildTime = 15
End

Object AngmarWallHub
BuildTime = 15
End

Object IsengardBattleTower
BuildTime = 15
End

Object IsengardWallHub
BuildTime = 15
End

Object MordorBattleTower
BuildTime = 15
End

Object WildSentryTower
BuildTime = 15
End

Object MenTrebuchetExpansion
BuildCost = 300
BuildTime = 15
End

Object MenArrowTowerExpansion
BuildCost = 200
BuildTime = 10
End

Object MenGarrisonTowerExpansion
BuildCost = 300
BuildTime = 15
MaxSimultaneousOfType = 5
End

Object ElvenWatchtowerExpansion
BuildCost = 200
BuildTime = 10
End

Object ElvenVigilantEntExpansion
BuildCost = 300
End

Object ElvenFloodgateExpansion
BuildCost = 1500
BuildTime = 40
MaxSimultaneousOfType = 5
End

Object DwarvenCatapultExpansion
BuildCost = 600
BuildTime = 30
End

Object DwarvenEreborTowerTowerExpansion
BuildCost = 200
BuildTime = 10
End

Object DwarvenHallExpansion
BuildCost = 300
BuildTime = 15
End

Object AngmarCatapultExpansion
BuildCost = 300
BuildTime = 15
End

Object AngmarBattleTowerExpansion
BuildCost = 200
BuildTime = 10
End

Object IsengardTowerExpansion
BuildCost = 200
BuildTime = 10
End

Object IsengardBallistaExpansion
BuildCost = 300
BuildTime = 15
End

Object IsengardMineLauncherExpansion
BuildCost = 1500
BuildTime = 40
MaxSimultaneousOfType = 5
End

Object MordorWallCatapultExpansion
BuildCost = 600
BuildTime = 30
End

Object MordorFortressBarricadeExpansion
BuildCost = 200
BuildTime = 10
End

Object MordorGateWatchersExpansion
BuildCost = 800
BuildTime = 25
End

Object WildArrowDenExpansion
BuildCost = 200
BuildTime = 10
End

Object WildGiantSentryExpansion
BuildCost = 300
BuildTime = 15
End

Object WildBurrowsExpansion
BuildCost = 300
BuildTime = 15
MaxSimultaneousOfType = 5
End

// Construct unit horde commandbuttons  /////////////////////////////////////////////////////////////////////////// Construct unit horde commandbuttons

CommandButton Command_ConstructElvenRivendellArchers
	Command				= UNIT_BUILD
	Object				= ElvenRivendellArcherHorde
	Options				= CANCELABLE
	;NeededUpgrade			= Upgrade_ElvenGreenPastureLevel2
	TextLabel			= CONTROLBAR:BuildElvenRivendellArchers
	ButtonImage			= BEGreenPasture_RivendellArcherIcon
	ButtonBorderType		= BUILD													
	DescriptLabel			= CONTROLBAR:ToolTipBuildElvenRivendellArchers
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
End

CommandButton Command_ConstructNoldorWarriorHorde
	Command				= UNIT_BUILD
	Object				= NoldorWarriorHorde
	Options				= NEED_UPGRADE CANCELABLE
	NeededUpgrade			= Upgrade_ElvenBarracksLevel3
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:ConstructNoldorWarriorHorde
	ButtonImage			= BEElvenBarracks_NoldorWarriorsIcon
	ButtonBorderType    		= BUILD 
	DescriptLabel       		= CONTROLBAR:ToolTipBuildNoldorWarriorHorde
	Radial				= Yes
	InPalantir			= Yes
	ShowProductionCount		= Yes    
End

CommandButton Command_ConstructElvenMirkwoodArcherHorde
	Command				= UNIT_BUILD
	Object				= ElvenMirkwoodArcherHorde
	Options				= NEED_UPGRADE CANCELABLE
	NeededUpgrade			= Upgrade_ElvenBarracksLevel2
	TextLabel			= CONTROLBAR:ConstructElvenMirkwoodArcherHorde
	ButtonImage			= BEElvenBarracks_MirkwoodArcher
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildElvenMirkwoodArcherHorde
	Radial				= Yes
	InPalantir	   		= Yes
	IsClickable			= Yes
	ShowProductionCount		= Yes    
End

CommandButton Command_UpgradeThrallMasterRhudaurSlingers
	Command			= UNIT_BUILD
	Object			= AngmarRhudaurSlingers
	Options			= CANCELABLE
	TextLabel		= CONTROLBAR:ThrallMasterUpgradeRhudaurSlingers
	ButtonImage		= KURhudarAxemanPortrait
	ButtonBorderType    	= BUILD 
	DescriptLabel		= CONTROLBAR:ToolTipThrallMasterUpgradeRhudaurSlingers
	Radial			= Yes
	InPalantir		= Yes
	ShowProductionCount	= Yes    
End

CommandButton Command_ConstructAngmarDarkRangerHorde
	Command			= UNIT_BUILD
	Object			= AngmarDarkRangerHorde
	Options			= NEED_UPGRADE CANCELABLE
	NeededUpgrade		= UpgradeAngmarBarracksLevel2
	NeededUpgradeAny	= Yes
	TextLabel		= CONTROLBAR:ConstructAngmarDarkRangerHorde
	ButtonImage		= KUDarkRangersIcon
	ButtonBorderType	= BUILD 
	DescriptLabel		= CONTROLBAR:ToolTipBuildAngmarDarkRangerHorde
	Radial			= Yes
	InPalantir	   	= Yes
	ShowProductionCount	= Yes
End

CommandButton Command_ConstructIsengardWildmanAxeHorde
	Command				= UNIT_BUILD
	Object				= IsengardWildmanAxeHorde
	Options				= CANCELABLE
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:ConstructIsengardWildmanAxeHorde
	ButtonImage			= BIClanSteading_WildAxemenIcon
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildIsengardWildmanAxeHorde
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
End

CommandButton Command_ConstructIsengardBallista
	Command			= UNIT_BUILD
	Object			= IsengardBallista
	Options			= CANCELABLE
	TextLabel		= CONTROLBAR:ConstructIsengardSiegeBallista
	ButtonImage		= BISiegeWorks_SeigeBallista
	ButtonBorderType	= BUILD 
	DescriptLabel		= CONTROLBAR:ToolTipBuildIsengardSiegeBallista
	Radial			= Yes
	InPalantir	   	= Yes
	ShowProductionCount	= Yes
End

CommandButton Command_ConstructIsengardExplosiveMine
	Command			= UNIT_BUILD
	Object			= IsengardExplosiveMine
 	Options			= NEED_UPGRADE CANCELABLE
 	NeededUpgrade		= Upgrade_IsengardSiegeWorksLevel2
	NeededUpgradeAny	= Yes
	TextLabel		= CONTROLBAR:ConstructIsengardExplosiveMine
	ButtonImage		= BISiegeWorks_DemoTeam
	ButtonBorderType	= BUILD 
	DescriptLabel		= CONTROLBAR:ToolTipBuildIsengardExplosiveMine
	Radial			= Yes
	InPalantir	   	= Yes
	ShowProductionCount	= Yes     
End

CommandButton Command_ConstructMordorCorsairsOfUmbarHorde
	Command				= UNIT_BUILD
	Object				= MordorCorsairsOfUmbarHorde
	Options				= CANCELABLE
	TextLabel			= CONTROLBAR:ConstructMordorCorsairsOfUmbarHorde
	ButtonImage			= BMTavern_Corsair
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildMordorCorsairsOfUmbarHorde
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
End

CommandButton Command_ConstructMordorCatapult
	Command				= UNIT_BUILD
	Object				= MordorCatapult
	Options				= CANCELABLE
	TextLabel			= CONTROLBAR:ConstructMordorCatapult
	ButtonImage			= BMGreatSiegeWorks_Catapult
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildMordorCatapult
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes   
End

CommandButton Command_ConstructMordorDrummerTroll
	Command				= UNIT_BUILD
	Object				= MordorDrummerTroll
	Options				= NEED_UPGRADE CANCELABLE
	NeededUpgrade			= Upgrade_MordorSiegeWorksLevel2 Upgrade_WildFissureLevel3 /// added to Gobin Fissure
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:ConstructMordorDrummerTrolls
	ButtonImage			= BMTrollCages_DrummerTroll
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipConstructMordorDrummerTrolls
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
End

CommandButton Command_ConstructMordorAttackTroll
	Command				= UNIT_BUILD
	Object				= MordorAttackTroll
	Options				= CANCELABLE NEED_UPGRADE
	NeededUpgrade			= Upgrade_MordorSiegeWorksLevel3
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:ConstructMordorAttackTroll
	ButtonImage			= BMTrollCages_AttackTroll
	ButtonBorderType		= BUILD 
	DescriptLabel			= CONTROLBAR:ToolTipBuildMordorAttackTroll
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
End

CommandButton Command_ConstructWildSpiderRiderHorde
	Command				= UNIT_BUILD
	Object				= GoblinSpiderRiderHorde
	Options				= CANCELABLE NEED_UPGRADE
	TextLabel			= CONTROLBAR:ConstructWildSpiderRiderHorde
	ButtonImage			= BWSpiderPit_SpiderRider
	ButtonBorderType    		= BUILD
	NeededUpgrade			= Upgrade_StructureLevel2 Upgrade_WildSpiderVenomSackScience
	NeededUpgradeAny		= Yes
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes      
End

CommandButton Command_ConstructWildMountainGiant
	Command			= UNIT_BUILD
	Object			= WildMountainGiant
	Options			= CANCELABLE
	TextLabel		= CONTROLBAR:ConstructWildMountainGiant
	ButtonImage		= BWFissure_Giant
	ButtonBorderType	= BUILD											
	DescriptLabel		= CONTROLBAR:ToolTipBuildWildMountainGiant
	Radial			= Yes
	InPalantir	   	= Yes
	ShowProductionCount	= Yes
End

CommandButton Command_ConstructGoblinTroll
	Command				= UNIT_BUILD
	Object				= GoblinCaveTroll
	Options				= CANCELABLE NEED_UPGRADE
	NeededUpgrade			= Upgrade_WildFissureLevel2
	TextLabel			= CONTROLBAR:ConstructGoblinCaveTroll
	ButtonImage			= BWFissure_CaveTroll
	ButtonBorderType		= BUILD
	Radial				= Yes
	InPalantir	   		= Yes
	ShowProductionCount		= Yes
End

// Purchase technology commandbuttons  /////////////////////////////////////// Purchase technology commandbuttons

CommandButton Command_PurchaseTechnologyGondorFireArrows
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyGondorFireArrows 
	NeededUpgrade		= Upgrade_GondorArcheryRangeLevel3
	NeededUpgradeAny	= Yes
	TextLabel			= CONTROLBAR:PurchaseTechnologyGondorFireArrows
	ButtonImage			= BGArcheryRange_FireArrows
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CONTROLBAR:ToolTipPurchaseTechnologyGondorFireArrows
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackGondorFireArrowsTechnology
End

CommandButton Command_PurchaseTechnologyDwarvenFireArrows ;building
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyDwarvenFireArrows 
	NeededUpgrade			= Upgrade_DwarvenArcheryRangeLevel3
	TextLabel			= CONTROLBAR:PurchaseTechnologyRohanFireArrows
	ButtonImage			= BGArcheryRange_FireArrows
	ButtonBorderType		= UPGRADE
	DescriptLabel			= CONTROLBAR:ToolTipPurchaseTechnologyRohanFireArrows
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackLevel2ArcheryRange
End

CommandButton Command_PurchaseTechnologyElvenSilverthornArrows
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyElvenSilverthornArrows
	NeededUpgrade			= Upgrade_ElvenBarracksLevel3
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:PurchaseTechnologyElvenSilverthornArrows
	ButtonImage			= BEEregionForge_SilverthornArrows
	ButtonBorderType		= UPGRADE
	DescriptLabel			= CONTROLBAR:ToolTipPurchaseTechnologyElvenSilverthornArrows
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackSilverthornTechnology
End

CommandButton Command_PurchaseTechnologyRohanHeavyArmor
	Command				= PLAYER_UPGRADE
	Options				= CANCELABLE
	;Options				= NEED_UPGRADE			
	Upgrade				= Upgrade_TechnologyRohanHeavyArmor 
	TextLabel			= CONTROLBAR:PurchaseTechnologyRohanHeavyArmor
	ButtonImage			= BRArmory_HeavyArmor
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CONTROLBAR:ToolTipPurchaseTechnologyRohanHeavyArmor
	Radial				= Yes
	InPalantir	   		= Yes
End

CommandButton Command_PurchaseTechnologyAngmarIceArrows
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyAngmarIceArrows 
	NeededUpgrade			= UpgradeAngmarBarracksLevel3
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:PurchaseTechnologyAngmarIceArrows
	ButtonImage			= KUTIceArrowUpgradeIcon
	ButtonBorderType		= UPGRADE
	DescriptLabel			= CONTROLBAR:ToolTipPurchaseTechnologyAngmarIceArrows
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackLevel2DarkIronForge
End

CommandButton Command_PurchaseTechnologyAngmarIceShot
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyAngmarIceShot
	NeededUpgrade			= Upgrade_AngmarForgeWorksLevel2
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:PurchaseTechnologyAngmarIceShot
	ButtonImage			= KUIceShotIcon
	ButtonBorderType		= UPGRADE
	DescriptLabel			= CONTROLBAR:ToolTipPurchaseTechnologyAngmarIceShot
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackLevel3DarkIronForge
End

CommandButton Command_PurchaseTechnologyIsengardFireArrows
	Command				= PLAYER_UPGRADE
	Upgrade				= Upgrade_TechnologyIsengardFireArrows 
	Options				= CANCELABLE NEED_UPGRADE
	NeededUpgrade			= Upgrade_IsengardUrukPitLevel2
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:PurchaseTechnologyIsengardFireArrows
	ButtonImage			= BIArmory_FlamingArrows
	ButtonBorderType		= UPGRADE
	DescriptLabel			= CONTROLBAR:ToolTipPurchaseTechnologyIsengardFireArrows
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackIsengardFireArrowsTech
End

CommandButton Command_PurchaseTechnologyWildFireArrows
	Command				= PLAYER_UPGRADE
	Options				= NEED_UPGRADE CANCELABLE
	Upgrade				= Upgrade_TechnologyWildFireArrows 
	NeededUpgrade			= Upgrade_StructureLevel3
	NeededUpgradeAny		= Yes
	TextLabel			= CONTROLBAR:PurchaseTechnologyWildFireArrows
	ButtonImage			= BMOrcPit_FlamingArrows
	ButtonBorderType		= UPGRADE
	DescriptLabel			= CONTROLBAR:ToolTipPurchaseTechnologyWildFireArrows
	Radial				= Yes
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackLevel3TreasureTrove
End

// Command sets for buildings (except level 3) ////////////////////////////////////////////// Command sets for buildings (except level 3)

CommandSet GondorArcherRange1
	1 	= Command_ConstructGondorArcherHorde
	2 	= Command_ConstructGondorRangerHorde
	3 	= Command_PurchaseTechnologyGondorFireArrows
	4 	= Command_PurchaseUpgradeGondorArcheryRangeLevel2
	6 	= Command_Sell
End

CommandSet GondorArcherRange2
	1 	= Command_ConstructGondorArcherHorde
	2 	= Command_ConstructGondorRangerHorde
	3 	= Command_PurchaseTechnologyGondorFireArrows
	4 	= Command_PurchaseUpgradeGondorArcheryRangeLevel3
	6 	= Command_Sell
End

CommandSet ElvenBarracks1
  	1 	= Command_ConstructElvenLorienArcherHorde
  	2 	= Command_ConstructElvenRivendellArchers
  	3 	= Command_ConstructElvenMirkwoodArcherHorde
  	4 	= Command_ConstructNoldorWarriorHorde
	5 	= Command_PurchaseTechnologyElvenSilverthornArrows
  	6 	= Command_Sell
  	7 	= Command_PurchaseUpgradeElvenBarracksLevel2
End

CommandSet ElvenBarracks2
  	1 	= Command_ConstructElvenLorienArcherHorde
  	2 	= Command_ConstructElvenRivendellArchers
  	3 	= Command_ConstructElvenMirkwoodArcherHorde
  	4 	= Command_ConstructNoldorWarriorHorde
	5 	= Command_PurchaseTechnologyElvenSilverthornArrows
  	6 	= Command_Sell
  	7 	= Command_PurchaseUpgradeElvenBarracksLevel3
End

CommandSet DwarvenForgeWorks1
 	1 	= Command_ConstructDwarvenBattleWagon
 	2 	= Command_ConstructDwarvenCatapult
 	3 	= Command_PurchaseTechnologyDwarvenForgedBlades
 	4 	= Command_PurchaseTechnologyDwarvenFlamingShot
 	5 	= Command_UpgradeDwarvenForgeWorksLevel2
 	6 	= Command_Sell
End

CommandSet DwarvenForgeWorks2
 	1 	= Command_ConstructDwarvenBattleWagon
 	2 	= Command_ConstructDwarvenCatapult
 	3 	= Command_PurchaseTechnologyDwarvenForgedBlades
 	4 	= Command_PurchaseTechnologyDwarvenFlamingShot
 	5 	= Command_UpgradeDwarvenForgeWorksLevel3
 	6 	= Command_Sell
End

CommandSet AngmarBarracks1
  	1 = Command_UpgradeThrallMasterRhudaurSlingers //////// builds rhudaur slingers
  	2 = Command_ConstructAngmarDarkRangerHorde
  	3 = Command_PurchaseTechnologyAngmarIceArrows
  	4 = Command_UpgradeAngmarBarracksLevel2
  	6 = Command_Sell
End

CommandSet AngmarBarracks2
  	1 = Command_UpgradeThrallMasterRhudaurSlingers
  	2 = Command_ConstructAngmarDarkRangerHorde
  	3 = Command_PurchaseTechnologyAngmarIceArrows
  	4 = Command_UpgradeAngmarBarracksLevel3
  	6 = Command_Sell
End

CommandSet AngmarForgeWorks1
 	1 = Command_ConstructAngmarTrollSling
 	2 = Command_PurchaseTechnologyAngmarIceShot
 	3 = Command_UpgradeAngmarForgeWorksLevel2
 	6 = Command_Sell
End

CommandSet AngmarForgeWorks2
 	1 = Command_ConstructAngmarTrollSling
 	2 = Command_PurchaseTechnologyAngmarIceShot
 	3 = Command_UpgradeAngmarForgeWorksLevel3
 	6 = Command_Sell
End

CommandSet IsengardUrukPit1
	1 = Command_ConstructIsengardWildmanAxeHorde
  	2 = Command_ConstructIsengardUrukCrossbowHorde
  	3 = Command_ConstructIsengardBerserker
  	4 = Command_PurchaseTechnologyIsengardFireArrows
  	5 = Command_UpgradeIsengardUrukPitLevel2
  	6 = Command_Sell
End

CommandSet IsengardUrukPit2
	1 = Command_ConstructIsengardWildmanAxeHorde
  	2 = Command_ConstructIsengardUrukCrossbowHorde
  	3 = Command_ConstructIsengardBerserker
  	4 = Command_PurchaseTechnologyIsengardFireArrows
  	5 = Command_UpgradeIsengardUrukPitLevel3
  	6 = Command_Sell
End

CommandSet IsengardSiegeWorks1
	1 = Command_ConstructIsengardBallista
	2 = Command_ConstructIsengardExplosiveMine		
	3 = Command_UpgradeIsengardSiegeWorksLevel2
	6 = Command_Sell
End

CommandSet IsengardSiegeWorks2
	1 = Command_ConstructIsengardBallista
	2 = Command_ConstructIsengardExplosiveMine		
	3 = Command_UpgradeIsengardSiegeWorksLevel3
	6 = Command_Sell
End

CommandSet MordorHaradrimPalace1
  	1	= Command_ConstructMordorCorsairsOfUmbarHorde
	2	= Command_ConstructMordorOrcArcherHorde
	3	= Command_ConstructMordorHaradrimArcherHorde
	4	= Command_PurchaseTechnologyMordorFireArrows
  	5 	= Command_UpgradeMordorHaradrimPalaceLevel2
  	6	= Command_Sell
End

CommandSet MordorHaradrimPalace2
  	1	= Command_ConstructMordorCorsairsOfUmbarHorde
	2	= Command_ConstructMordorOrcArcherHorde
	3	= Command_ConstructMordorHaradrimArcherHorde
	4	= Command_PurchaseTechnologyMordorFireArrows
  	5 	= Command_UpgradeMordorHaradrimPalaceLevel3
  	6	= Command_Sell
End

CommandSet MordorSiegeWorks1
  	1  = Command_ConstructMordorCatapult
	2  = Command_ConstructMordorDrummerTroll
  	3  = Command_ConstructMordorAttackTroll
  	4  = Command_UpgradeMordorSiegeWorksLevel2
  	6  = Command_Sell
End

CommandSet MordorSiegeWorks2
  	1  = Command_ConstructMordorCatapult
	2  = Command_ConstructMordorDrummerTroll
  	3  = Command_ConstructMordorAttackTroll
  	4  = Command_UpgradeMordorSiegeWorksLevel3
  	6  = Command_Sell
End

CommandSet GoblinCave1
	1 = Command_ConstructGoblinArcherHorde
	2 = Command_ConstructWildSpiderRiderHorde
	3 = Command_PurchaseTechnologyWildFireArrows
	4 = Command_PurchaseUpgradeWildCaveLevel2
	6 = Command_Sell
End

CommandSet GoblinCave2
	1 = Command_ConstructGoblinArcherHorde
	2 = Command_ConstructWildSpiderRiderHorde
	3 = Command_PurchaseTechnologyWildFireArrows
	4 = Command_PurchaseUpgradeWildCaveLevel3
	6 = Command_Sell
End

CommandSet GoblinFissure1
	1 = Command_ConstructWildMountainGiant
	2 = Command_ConstructGoblinTroll
	3 = Command_ConstructMordorDrummerTroll
	4 = Command_ConstructWildBabyDrakeHorde
	5 = Command_UpgradeWildFissureLevel2
	6 = Command_Sell
End

CommandSet GoblinFissure2
	1 = Command_ConstructWildMountainGiant
	2 = Command_ConstructGoblinTroll
	3 = Command_ConstructMordorDrummerTroll
	4 = Command_ConstructWildBabyDrakeHorde
	5 = Command_PurchaseUpgradeWildFissureLevel3
	6 = Command_Sell
End

// Command sets for buildings (level 3) ////////////////////////////////////////////// Command sets for buildings (level 3)

CommandSet GondorArcherRange3
	1 	= Command_ConstructGondorArcherHorde
	2 	= Command_ConstructGondorRangerHorde
	3 	= Command_PurchaseTechnologyGondorFireArrows
	6 	= Command_Sell
End

CommandSet ElvenBarracks3
  	1 	= Command_ConstructElvenLorienArcherHorde
  	2 	= Command_ConstructElvenRivendellArchers
  	3 	= Command_ConstructElvenMirkwoodArcherHorde
  	4 	= Command_ConstructNoldorWarriorHorde
	5 	= Command_PurchaseTechnologyElvenSilverthornArrows
  	6 	= Command_Sell
End

CommandSet DwarvenForgeWorks3
 	1 	= Command_ConstructDwarvenBattleWagon
 	2 	= Command_ConstructDwarvenCatapult
 	3 	= Command_PurchaseTechnologyDwarvenForgedBlades
 	4 	= Command_PurchaseTechnologyDwarvenFlamingShot
 	6 	= Command_Sell
End

CommandSet AngmarBarracks3
  	1 = Command_UpgradeThrallMasterRhudaurSlingers
  	2 = Command_ConstructAngmarDarkRangerHorde
  	3 = Command_PurchaseTechnologyAngmarIceArrows
  	6 = Command_Sell
End

CommandSet AngmarForgeWorks3
 	1 = Command_ConstructAngmarTrollSling
 	2 = Command_PurchaseTechnologyAngmarIceShot
 	6 = Command_Sell
End

CommandSet IsengardUrukPit3
	1 = Command_ConstructIsengardWildmanAxeHorde
  	2 = Command_ConstructIsengardUrukCrossbowHorde
  	3 = Command_ConstructIsengardBerserker
  	4 = Command_PurchaseTechnologyIsengardFireArrows
  	6 = Command_Sell
End

CommandSet IsengardSiegeWorks3
	1 = Command_ConstructIsengardBallista
	2 = Command_ConstructIsengardExplosiveMine
	6 = Command_Sell
End

CommandSet MordorHaradrimPalace3
  	1	= Command_ConstructMordorCorsairsOfUmbarHorde
	2	= Command_ConstructMordorOrcArcherHorde
	3	= Command_ConstructMordorHaradrimArcherHorde
	4	= Command_PurchaseTechnologyMordorFireArrows
  	6	= Command_Sell
End

CommandSet MordorSiegeWorks3
  	1  = Command_ConstructMordorCatapult
	2  = Command_ConstructMordorDrummerTroll
  	3  = Command_ConstructMordorAttackTroll
  	6  = Command_Sell
End

CommandSet GoblinCave3
	1 = Command_ConstructGoblinArcherHorde
	2 = Command_ConstructWildSpiderRiderHorde
	3 = Command_PurchaseTechnologyWildFireArrows
	4 = Command_PurchaseUpgradeWildCaveLevel3
	6 = Command_Sell
End

CommandSet GoblinFissure3
	1 = Command_ConstructWildMountainGiant
	2 = Command_ConstructGoblinTroll
	3 = Command_ConstructMordorDrummerTroll
	4 = Command_ConstructWildBabyDrakeHorde
	6 = Command_Sell
End

// Building objects with commandset upgrades ///////////////////////////////////////////////////////// Building objects with commandset upgrades

Object GondorArcherRange
CommandSet = GondorArcherRange1
BuildTime = 15
ReplaceModule ModueTag_ArcheryRangeLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_ArcheryRange2
		TriggeredBy			= Upgrade_GondorArcheryRangeLevel2
		ConflictsWith		= Upgrade_GondorArcheryRangeLevel3
		CommandSet			= GondorArcherRange2
	End
End
ReplaceModule ModueTag_ArcheryRangeLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_ArcheryRange3
		TriggeredBy			= Upgrade_GondorArcheryRangeLevel3		
		CommandSet			= GondorArcherRange3
	End
End
End

Object ElvenBarracks
CommandSet = ElvenBarracks1
BuildTime = 15

ReplaceModule ModueTag_ElvenBarracksLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_ElvenBarracks2
		TriggeredBy      = Upgrade_ElvenBarracksLevel2
		ConflictsWith    = Upgrade_ElvenBarracksLevel3
		CommandSet       = ElvenBarracks2
	End
End

ReplaceModule ModueTag_ElvenBarracksLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_ElvenBarracks3
		TriggeredBy      = Upgrade_ElvenBarracksLevel3
		CommandSet       = ElvenBarracks3
	End
End
End
Object DwarvenSiegeWorks
CommandSet = DwarvenForgeWorks1
BuildTime = 15
ReplaceModule ModuleTag_DwarvenForgeWorksLevel2CommandSet
	Behavior = CommandSetUpgrade ModuleTag_DwarvenForgeWorks2
		TriggeredBy		= Upgrade_DwarvenForgeWorksLevel2
		ConflictsWith		= Upgrade_DwarvenForgeWorksLevel3
		CommandSet		= DwarvenForgeWorks2
	End
End
ReplaceModule ModuleTag_DwarvenForgeWorksLevel3CommandSet
	Behavior = CommandSetUpgrade ModuleTag_DwarvenForgeWorks3
		TriggeredBy		= Upgrade_DwarvenForgeWorksLevel3
		CommandSet		= DwarvenForgeWorks3
	End
End
End

Object AngmarBarracks
CommandSet = AngmarBarracks1
BuildTime = 15
ReplaceModule ModueTag_BarracksLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_AngmarBarracks2
		TriggeredBy	= UpgradeAngmarBarracksLevel2
		ConflictsWith	= UpgradeAngmarBarracksLevel3
		CommandSet	= AngmarBarracks2
	End
End
ReplaceModule ModueTag_BarracksLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_AngmarBarracks3
		TriggeredBy	= UpgradeAngmarBarracksLevel3		
		CommandSet	= AngmarBarracks3
	End
End
End

Object AngmarForgeWorks
CommandSet = AngmarForgeWorks1
BuildTime = 15
ReplaceModule ModuleTag_AngmarForgeWorksLevel2CommandSet
	Behavior = CommandSetUpgrade ModuleTag_AngmarForgeWorks2
		TriggeredBy		= Upgrade_AngmarForgeWorksLevel2
		ConflictsWith		= Upgrade_AngmarForgeWorksLevel3
		CommandSet		= AngmarForgeWorks2
	End
End
ReplaceModule ModuleTag_AngmarForgeWorksLevel3CommandSet
	Behavior = CommandSetUpgrade ModuleTag_AngmarForgeWorks3
		TriggeredBy		= Upgrade_AngmarForgeWorksLevel3
		CommandSet		= AngmarForgeWorks3
	End
End
End

Object IsengardUrukPit
CommandSet = IsengardUrukPit1
BuildTime = 15
ReplaceModule ModuleTag_IsengardUrukPitLevel2CommandSet
	Behavior = CommandSetUpgrade ModuleTag_IsengardUrukPit2
		TriggeredBy		= Upgrade_IsengardUrukPitLevel2
		ConflictsWith		= Upgrade_IsengardUrukPitLevel3
		CommandSet		= IsengardUrukPit2
	End
End
ReplaceModule ModuleTag_IsengardUrukPitLevel3CommandSet
	Behavior = CommandSetUpgrade ModuleTag_IsengardUrukPit3
		TriggeredBy		= Upgrade_IsengardUrukPitLevel3
		CommandSet		= IsengardUrukPit3
	End
End
End

Object IsengardSiegeWorks
CommandSet = IsengardSiegeWorks1
BuildTime = 15
ReplaceModule ModuleTag_IsengardSiegeWorksLevel2CommandSet
	Behavior = CommandSetUpgrade ModuleTag_IsengardSiegeWorks2
		TriggeredBy		= Upgrade_StructureLevel2
		ConflictsWith	= Upgrade_StructureLevel3
		CommandSet		= IsengardSiegeWorks2
	End
End
ReplaceModule ModuleTag_IsengardSiegeWorksLevel3CommandSet
	Behavior = CommandSetUpgrade ModuleTag_IsengardSiegeWorks3
		TriggeredBy		= Upgrade_StructureLevel3
		CommandSet		= IsengardSiegeWorks3
	End
End
End

Object MordorHaradrimPalace
CommandSet = MordorHaradrimPalace1
BuildTime = 15
ReplaceModule ModuleTag_MordorHaradrimPalaceLevel2
	Behavior = CommandSetUpgrade ModuleTag_MordorHaradrimPalace2
		TriggeredBy		= Upgrade_MordorHaradrimPalaceLevel2
		ConflictsWith		= Upgrade_MordorHaradrimPalaceLevel3
		CommandSet		= MordorHaradrimPalace2
	End
End
ReplaceModule ModuleTag_MordorHaradrimPalaceLevel3
	Behavior = CommandSetUpgrade ModuleTag_MordorHaradrimPalace3
		TriggeredBy		= Upgrade_MordorHaradrimPalaceLevel3
		CommandSet		= MordorHaradrimPalace3
	End
End
End

Object MordorSiegeWorks
CommandSet = MordorSiegeWorks1
BuildTime = 15
ReplaceModule ModuleTag_MordorSiegeWorksLevel2
	Behavior = CommandSetUpgrade ModuleTag_MordorSiegeWorks2
		TriggeredBy		= Upgrade_MordorSiegeWorksLevel2
		ConflictsWith	= Upgrade_MordorSiegeWorksLevel3
		CommandSet		= MordorSiegeWorks2
	End
End
ReplaceModule ModuleTag_MordorSiegeWorksLevel3
	Behavior = CommandSetUpgrade ModuleTag_MordorSiegeWorks3
		TriggeredBy		= Upgrade_MordorSiegeWorksLevel3
		CommandSet		= MordorSiegeWorks3
	End
End
End

Object GoblinCave
CommandSet = GoblinCave1
BuildTime = 15
ReplaceModule ModueTag_CaveLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_CaveLevel2
		TriggeredBy			= Upgrade_StructureLevel2
		ConflictsWith		= Upgrade_StructureLevel3
		CommandSet			= GoblinCave2
	End   
End
ReplaceModule ModueTag_CaveLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_CaveLevel3
		TriggeredBy			= Upgrade_StructureLevel3
		CommandSet			= GoblinCave3
	End
End
End

Object GoblinFissure
CommandSet = GoblinFissure1
BuildTime = 15
ReplaceModule ModueTag_FissureLevel2CommandSet
	Behavior = CommandSetUpgrade ModueTag_Fissure2
		TriggeredBy			= Upgrade_StructureLevel2
		ConflictsWith		= Upgrade_StructureLevel3
		CommandSet			= GoblinFissure2
	End
End   
ReplaceModule ModueTag_FissureLevel3CommandSet
	Behavior = CommandSetUpgrade ModueTag_Fissure3
		TriggeredBy			= Upgrade_StructureLevel3		
		CommandSet			= GoblinFissure3
	End
End
End

// Unit commandsets /////////////////////////////////////////////////////////////////////////////// Unit commandsets

CommandSet NoldorWarriorHorde
	1	= Command_ToggleStance
	2	= Command_ArcherBombard
	3 	= Command_SpecialAbilityNoldorWeaponSong
	12	= Command_CaptureBuilding	
	13	= Command_AttackMove
	14	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

CommandSet ElvenMirkwoodArcherHorde
	1	= Command_ToggleStance
	2	= Command_ArcherBombard
	3	= Command_SpecialAbilityElfCloak
	4	= Command_PurchaseUpgradeElvenSilverthornArrows
	5 	= Command_PurchaseUpgradeElvenBasicTraining
	12 	= Command_CaptureBuilding
	13 	= Command_AttackMove
	14 	= Command_Stop
	16  	= Command_SetStanceBattle
	17  	= Command_SetStanceAggressive
	18  	= Command_SetStanceHoldGround
End

// Unit objects ////////////////////////////////////////////////////////////////////////////////// Unit objects

Object GondorArcherHorde
BuildCost = 200
BuildTime = 5
End

Object GondorRangerHorde
BuildCost = 500
BuildTime = 15
End

Object ElvenLorienArcherHorde
BuildCost = 200
BuildTime = 5
End

Object ElvenRivendellArcherHorde
BuildCost = 250
BuildTime = 5
End

Object NoldorWarriorHorde
CommandSet = NoldorWarriorHorde
BuildTime = 30
End

Object ElvenMirkwoodArcherHorde
CommandSet = ElvenMirkwoodArcherHorde
BuildTime = 25
End

Object DwarvenAxeThrowerHorde
BuildCost = 250
BuildTime = 5
End

Object DwarvenMenOfDaleHorde
BuildCost = 500
BuildTime = 15
End

Object DwarvenBattleWagon
BuildCost = 300
BuildTime = 10
End

Object DwarvenCatapult
BuildCost = 600
BuildTime = 20
End

Object AngmarThrallMasterRhudaurSlingers
BuildCost = 200
BuildTime = 5
End

Object AngmarDarkRangerHorde
BuildCost = 500
BuildTime = 15
End

Object AngmarTrollSling
BuildCost = 300
BuildTime = 10
End

Object IsengardWildmanAxeHorde
BuildCost = 250
BuildTime = 5
End

Object IsengardUrukCrossbowHorde
BuildCost = 300
BuildTime = 10
End

Object IsengardBeserker
BuildCost = 150
BuildTime = 1
	LocomotorSet
		Locomotor     = BerserkerLocomotor		; HumanLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_FAST_MEMBER_SPEED
	End
End

Object IsengardBallista
BuildCost = 300
BuildTime = 10
End

Object IsengardExplosiveMine
BuildCost = 250
BuildTime = 15
	LocomotorSet
			Locomotor     = ExplosiveMineLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_SIEGE_FAST_HORDE_SPEED   ;40 ;12
	End
End

Object MordorCorsairsOfUmbarHorde
BuildCost = 150
BuildTime = 1
End

Object MordorOrcArcherHorde
BuildCost = 200
BuildTime = 5
End

Object MordorHaradrimArcherHorde
BuildCost = 500
BuildTime = 15
End

Object MordorCatapult
BuildCost = 600
BuildTime = 15
End

Object GoblinArcherHorde
BuildCost = 250
BuildTime = 5
End

Object MordorArcherHorde
BuildCost = 200
BuildTime = 5
End

Object GoblinSpiderRiderHorde
BuildCost = 500
BuildTime = 15
End

Object GoblinCaveTroll
BuildCost = 500
BuildTime = 20
MaxSimultaneousOfType = 3
End

Object MordorDrummerTroll
BuildCost = 500
BuildTime = 15
MaxSimultaneousOfType = 3
End

Object WildMountainGiant
BuildCost = 300
BuildTime = 15
End

Object MordorAttackTroll
BuildCost = 750
BuildTime = 20
MaxSimultaneousOfType = 3
End

Weapon NormalMeleeHordeRangefinder_NEW
	AttackRange		= 100.0
	DelayBetweenShots	= 1000 ; one second.
	AcceptableAimDelta	= 0
	MeleeWeapon		= Yes
	FinishAttackOnceStarted = No
	HordeAttackNugget
	End
End

CommandButton Command_SpecialAbilityFDBTerribleFury
  Command                 = SPECIAL_POWER
  SpecialPower            = SpecialAbilityScreech
  Options                 = OK_FOR_MULTI_SELECT
  TextLabel               = CONTROLBAR:TerribleFury
  ButtonImage             = HSSauronTerribleFury
  ButtonBorderType        = ACTION 
  DescriptLabel           = CONTROLBAR:TooltipFDBTerribleFury
  InPalantir			  = Yes
  AutoAbility			  = No									; Don't auto ability this.
  PresetRange			  = 150
End

CommandSet WildBabyDrakeHorde
	1 = Command_ToggleStance
	2 = Command_FireDrakeBroodInferno
	3 = Command_SpecialAbilityFDBTerribleFury
	13 = Command_AttackMove
	14 = Command_Stop
	16  = Command_SetStanceBattle
	17  = Command_SetStanceAggressive
	18  = Command_SetStanceHoldGround
End

Object WildBabyDrakeHorde
CommandSet = WildBabyDrakeHorde
BuildCost = 500
MaxSimultaneousOfType = 5
	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY    NormalMeleeHordeRangefinder_NEW
	End
	LocomotorSet
		Locomotor = FiredrakeLocomotor
		Condition = SET_NORMAL
		Speed     = 90
	End
AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechUnPause
		SpecialPowerTemplate		= SpecialAbilityScreech
		TriggeredBy			= Upgrade_MiniHordeLvl7
		ObeyRechageOnTrigger		= Yes
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_Screech                      
		SpecialPowerTemplate		= SpecialAbilityScreech
		UpdateModuleStartsAttack	= Yes
		TriggerFX			= FX_FearBlast
		StartsPaused			= Yes
	End
End
AddModule
	Behavior = SpecialAbilityUpdate ModuleTag_TerribleFuryUpdate  
		SpecialPowerTemplate		= SpecialAbilityScreech
		UnpackTime			= 0  
		TriggerSound			= FireDrakeVoxAttack
		TriggerModelCondition		= ModelConditionState:SPECIAL_POWER_1	;triggered during the unpack phase
		TriggerModelConditionDuration	= 35	;in frames
		UnpackTime			= 2000  ;this adds a delay in so that the trigger model condition has time to fire off
		Instant				= Yes
		EffectRange			= 110
	End
End
End

;-------------------------------------------------------------------

Armor HaradrimArmor
  Armor = DEFAULT         100%   ; 100%
  Armor = SLASH           100%   ; 100%
  Armor = PIERCE           25%   ;  50%
  Armor = SPECIALIST      100%   ;  50%
  Armor = CRUSH           200%   ; 200%
  Armor = CAVALRY	  200% ;
  Armor = SIEGE           100%   ;
  Armor = FLAME           100%   ;  30%
  Armor = MAGIC           100%   ;
  Armor = HERO            200%   ;
  Armor = HERO_RANGED     100%   ; 
  Armor = STRUCTURAL    100%    
  FlankedPenalty 	 = 50%    
  Armor = CAVALRY_RANGED   50% ; ;
End

;====================

Object BarrowWight
	LocomotorSet
		Locomotor = BarrowWightLocomotor
		Condition = SET_NORMAL
		Speed     = 50
	End
End

Armor GoblinFighterArmor
  Armor = DEFAULT         100%   ; 
  Armor = SLASH           150%   ; ; ; 100
  Armor = PIERCE           115%   ;  ; ; 150
  Armor = SPECIALIST      15%   ; ; ; 40
  Armor = CAVALRY	  150%   ;
  Armor = CRUSH           125%   ;  ; ; 100
  Armor = SIEGE           100%   ;
  Armor = FLAME           100%   ; 
  Armor = MAGIC           100%   ;
  Armor = HERO            200%   ;
  Armor = HERO_RANGED     200%   ; 
  Armor = STRUCTURAL	  100%	
  FlankedPenalty 	 = 33%     ; ; 50
  Armor = CAVALRY_RANGED   150% ; ;
End

Armor WildFighterScavengedArmor
  Armor = DEFAULT         50%   ; 
  Armor = SLASH           40%   ; 
  Armor = PIERCE           30%   ;  ; ; 75; ; 40
  Armor = SPECIALIST      10%   ; 
  Armor = CAVALRY	  120%   ;; ; 75
  Armor = CRUSH           65%   ;  ; ; 50
  Armor = SIEGE           50%   ;
  Armor = FLAME           30%   ; ; ; 50
  Armor = MAGIC           20%   ;; ; 50; ; 30
  Armor = HERO            100%   ;
  Armor = HERO_RANGED     100%   ; 
  Armor = STRUCTURAL	  20%	
  FlankedPenalty 	 = 50%      
  Armor = URUK   50% ; ;
End

Armor GoblinArcherArmor
  Armor = DEFAULT         100%   ; 100%
  Armor = SLASH           150%   ; 100%; ; 100
  Armor = PIERCE          75%   ;  50%
  Armor = SPECIALIST       100%   ;  50%
  Armor = CRUSH            45%   ; 200% ; ; 200
  Armor = SIEGE           150%   ;; ; 100
  Armor = FLAME           100%   ;  30%
  Armor = MAGIC           60%   ;
  Armor = HERO            200%   ;
  Armor = HERO_RANGED     75%   ;
  Armor = CAVALRY	  200%  
  Armor = STRUCTURAL	  100%	
  FlankedPenalty 	 = 50%    
End

Armor WildMarauderHeavyArmor
  Armor = DEFAULT             50% ;40%
  Armor = SLASH               105% ;; ; 100; ; 90
  Armor = PIERCE             80% ; 20%; ; 65
  Armor = SPECIALIST          95% ; ; 50; ; 70
  Armor = CAVALRY	      5% ;
  Armor = CRUSH               5%  ;40%
  Armor = SIEGE               50% ;100%
  Armor = FLAME               75%  ; 0%; ; 50
  Armor = MAGIC               75% ;100%; ; 50
  Armor = HERO                80% ; 50%; ; 100
  Armor = HERO_RANGED         75% ; 50%  ; ; 100
  Armor = STRUCTURAL	  20%	
  FlankedPenalty 	 = 75%     
  Armor = CAVALRY_RANGED   30% ; ;
  Armor = URUK   115% ; ;
  Armor = POISON   25% ; ;
  DamageScalar = 130% ; ;
End

;=============attack troll no longer dies in 1s to pikes

Armor AttackTrollArmor
  Armor = DEFAULT         25%   
  Armor = SLASH           40%  ;50%
  Armor = PIERCE          25%   
  Armor = SPECIALIST     125%  ;  200%
  Armor = CRUSH            1%  
  Armor = CAVALRY	  25% 
  Armor = SIEGE           50%   ;
  Armor = FLAME           50% 
  Armor = MAGIC           35%   ;50%
  Armor = HERO            100%   ;
  Armor = HERO_RANGED     100%  
  Armor = STRUCTURAL    25%    
  FlankedPenalty 	 = 50%    
  Armor = CAVALRY_RANGED   50% ; ;
End

;================same about drummer

Armor TrollHeavyArmor
  Armor = DEFAULT         80%   ; 100%
  Armor = SLASH           65%   ; 100%
  Armor = PIERCE           15%   ;  50%; ; 50
  Armor = SPECIALIST      65%   ;  50%
  Armor = CRUSH           100%   ; 200%
  Armor = CAVALRY	  50% ;
  Armor = SIEGE           100%   ;
  Armor = FLAME           15%   ;  30%; ; 100
  Armor = MAGIC           15%   ;; ; 100
  Armor = HERO            150%   ;
  Armor = HERO_RANGED     75%   ; ; ; 200
  Armor = STRUCTURAL    10%    
  FlankedPenalty 	 = 50%    
  Armor = CAVALRY_RANGED   50% ; ;
End

;==========make mirks own other archers

Armor MirkwoodArcherArmor
  Armor = DEFAULT         100%   
  Armor = SLASH           150%   
  Armor = PIERCE          50%     ;70%   ; 
  Armor = SPECIALIST      100%   ;
  Armor = CAVALRY	 200%   ;
  Armor = CRUSH           200%  
  Armor = SIEGE           100%   ;
  Armor = FLAME           40%   ;
  Armor = MAGIC           60%   ;
  Armor = HERO            200%   ;
  Armor = HERO_RANGED     200%   ; 
  Armor = STRUCTURAL	  100%	  
  FlankedPenalty 	 = 50%      
End

Weapon WildSpiderRiderBow     ; BALANCE Wild Spider Rider bow Weapon
	AttackRange         	= 450 ; 400
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( WILD_SPIDERRIDER_RANGE .01 )  
	
	WeaponSpeed         	= 321         ; dist/sec 
	MinWeaponSpeed      	= 241
	MaxWeaponSpeed      	= 481      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	FireFX              	= FX_RohanArcherBowWeapon
	ScaleWeaponSpeed    	= Yes		;Used for lob weapons, scales speed proportional to range
	HitPercentage       	= 100		;When this weapon is used it will hit exactly 50% of the time.
	ScatterRadius       	= 16.0		;When this weapon misses it can randomly miss by as much as this distance.
	  
	AcceptableAimDelta		= 20		; prevent twitchy reaiming in horde on horde
	
	DelayBetweenShots   	= 0
	
	PreAttackDelay      	= WILD_SPIDERRIDER_BOW_PREATTACKDELAY 
	PreAttackType			= PER_SHOT
	;PreAttackRandomAmount	= 200   
	FiringDuration			= 0
	RequireFollowThru		= Yes

	  
	;AutoReloadWhenIdle		= 1	
	
	ClipSize			= 1
	AutoReloadsClip			= Yes
	ClipReloadTime			= Min:600 Max:800
	
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	HitPassengerPercentage	= 20%
	CanBeDodged				= Yes ; Will check for a DodgePercent on the target to have a second chance at failing HitPercent

	ProjectileNugget                    ; Default arrow
	    ProjectileTemplateName    = EvilFactionArrow
	    WarheadTemplateName       = WildSpiderRiderBowWarhead
	    ForbiddenUpgradeNames     = Upgrade_WildFireArrows
	End	
  		
	ProjectileNugget    ; Fire Arrow
		ProjectileTemplateName  = EvilFactionFireArrow
		WarheadTemplateName      = WildSpiderRiderBowFireWarhead
		RequiredUpgradeNames     = Upgrade_WildFireArrows
	End
End

Weapon GoblinArcherMissileHordeRangefinder
	AttackRange			= 330   ; ;100 ;Slightly shorter than the archer's actual weapon
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( GOBLIN_ARCHER_RANGE .01 )
	
	DelayBetweenShots		= 1500 ;1500
	LeechRangeWeapon		= Yes
	AcceptableAimDelta		= 45
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	CanFireWhileMoving		= Yes		; When aboard a mumakil.
	FinishAttackOnceStarted = No
	HordeAttackNugget
	End
End

Weapon GoblinArcherMissileHordeRangefinderBombard
	AttackRange				= 330   ; ;100 
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( GOBLIN_ARCHER_BOMBARD_MAXRANGE .01 )
	
	MinimumAttackRange		= GOBLIN_ARCHER_BOMBARD_MINRANGE
	DelayBetweenShots		= 1500 ;1500
	LeechRangeWeapon		= Yes
	AcceptableAimDelta		= 45
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	CanFireWhileMoving		= Yes		; When aboard a mumakil.
	FinishAttackOnceStarted = No
	NoVictimNeeded			= Yes
	BombardType				= Yes	
	ScatterRadius			= ARCHER_BOMBARD_SCATTER_RADIUS		; Only used for cursor radius
	HordeAttackNugget
	End
End



Weapon HaradrimArcherMissileHordeRangefinder
	AttackRange			= 350   ; ;100  ; Slightly shorter than the archer's actual weapon
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( MORDOR_HARADRIM_BOW_RANGE .01 )
	
	DelayBetweenShots		= 1500 ;1500
	LeechRangeWeapon		= Yes
	AcceptableAimDelta		= 45
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	CanFireWhileMoving		= Yes		; When aboard a mumakil.
	FinishAttackOnceStarted = No
	HordeAttackNugget
	End
End

Weapon HaradrimArcherMissileHordeRangefinderBombard
	AttackRange			= 350  ; ;100 
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( MORDOR_HARADRIM_BOW_BOMBARD_MAXRANGE .01 )
	
	MinimumAttackRange		= MORDOR_HARADRIM_BOW_BOMBARD_MINRANGE
	DelayBetweenShots		= 1500 ;1500
	LeechRangeWeapon		= Yes
	AcceptableAimDelta		= 45
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	CanFireWhileMoving		= Yes		; When aboard a mumakil.
	FinishAttackOnceStarted = No
	NoVictimNeeded			= Yes
	BombardType				= Yes	
	ScatterRadius			= ARCHER_BOMBARD_SCATTER_RADIUS		; Only used for cursor radius
	HordeAttackNugget
	End
End


Weapon GoblinArcherBow       ; BALANCE Archer Weapon ;orc archer
	AttackRange			= 450    ;Horde member so it needs to be bigger than the horde weapon attack range.
   
   	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( GOBLIN_ARCHER_RANGE .01 )
   
   
    LeechRangeWeapon    = Yes
	WeaponSpeed			= 300         ; dist/sec 
	MinWeaponSpeed		= 121
	MaxWeaponSpeed		= 400      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	FireFX				= FX_RohanArcherBowWeapon  
	ScaleWeaponSpeed	= Yes ; Used for lob weapons, scales speed proportional to range
	HitPercentage		= 100     ;When this weapon is used it will hit exactly 50% of the time.
	ScatterRadius		= 20.0     ;When this weapon misses it can randomly miss by as much as this distance.
	
	AcceptableAimDelta	= 20	; prevent twitchy reaiming in horde on horde
	DelayBetweenShots	= 0
	PreAttackDelay      = GOBLIN_ARCHER_PREATTACKDELAY
	PreAttackType       = PER_POSITION
	PreAttackRandomAmount     = 200 
	FiringDuration      = 0
	
	ClipSize			= 1
	AutoReloadsClip		= Yes
	AutoReloadWhenIdle	= 1	
	ClipReloadTime		= Min:1050 Max:1400
	ContinuousFireOne	= 0
	ContinuousFireCoast	= 1600 
	
	AntiAirborneVehicle	= Yes
	AntiAirborneMonster	= Yes
	HitPassengerPercentage	= 20%
	CanBeDodged				= Yes ; Will check for a DodgePercent on the target to have a second chance at failing HitPercent


End



Weapon GoblinArcherBowBombard       ; BALANCE Archer Weapon ;orc archer
	AttackRange			= 450
	MinimumAttackRange	= #SUBTRACT( GOBLIN_ARCHER_BOMBARD_MINRANGE 75 )
    LeechRangeWeapon    = Yes
	WeaponSpeed			= 300         ; dist/sec 
	MinWeaponSpeed		= 121
	MaxWeaponSpeed		= 400      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	FireFX				= FX_RohanArcherBowWeapon  
	ScaleWeaponSpeed	= Yes ; Used for lob weapons, scales speed proportional to range
	HitPercentage       = 0     ;Always scatter
	ScatterRadius       = ARCHER_BOMBARD_SCATTER_RADIUS      ;When this weapon misses it can randomly miss by as much as this distance.
	
	AcceptableAimDelta	= 20	; prevent twitchy reaiming in horde on horde
	DelayBetweenShots	= 0
	PreAttackDelay      = GOBLIN_ARCHER_PREATTACKDELAY
	PreAttackType       = PER_POSITION
	PreAttackRandomAmount     = 200 
	FiringDuration      = 0
	
	ClipSize			= 1
	AutoReloadsClip		= Yes
	AutoReloadWhenIdle	= 1	
	ClipReloadTime		= Min:GOBLIN_ARCHER_BOW_RELOADTIME_MIN Max:GOBLIN_ARCHER_BOW_RELOADTIME_MAX
	ContinuousFireOne	= 0
	ContinuousFireCoast	= GOBLIN_ARCHER_BOW_RELOADTIME_MAX 
	
	AntiAirborneVehicle	= Yes
	AntiAirborneMonster	= Yes
	HitPassengerPercentage	= 20%
	CanBeDodged				= Yes ; Will check for a DodgePercent on the target to have a second chance at failing HitPercent
	NoVictimNeeded			= Yes
	BombardType				= Yes


End


Weapon HaradrimBow ; BALANCE Archer Weapon ;orc archer
  AttackRange 			= 450
  
  	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( MORDOR_HARADRIM_BOW_RANGE .01 )   
  
  LeechRangeWeapon      = Yes
  WeaponSpeed 			= 270 ; ;401         ; dist/sec 
  MinWeaponSpeed 		= 121
  MaxWeaponSpeed 		= 440 ; ;601      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
  FireFX 				= FX_RohanArcherBowWeapon  
  ScaleWeaponSpeed	 	= Yes ; Used for lob weapons, scales speed proportional to range
  HitPercentage     	= 100     ;When this weapon is used it will hit exactly 50% of the time.
  ScatterRadius     	= 40.0     ;When this weapon misses it can randomly miss by as much as this distance.
  DelayBetweenShots 	= 650
  PreAttackDelay        = MORDOR_HARADRIM_BOW_PREATTACKDELAY
  PreAttackRandomAmount     = 200 
  PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
  FiringDuration      	= MORDOR_HARADRIM_BOW_FIRINGDURATION     ; Duration of the archer firing shot is 500ms.
  AntiAirborneVehicle	= Yes
  AntiAirborneMonster	= Yes
  CanBeDodged				= Yes



End

Weapon HaradrimBowBombard ; BALANCE Archer Weapon ;orc archer
	AttackRange 			= 450
	MinimumAttackRange	= #SUBTRACT( MORDOR_HARADRIM_BOW_BOMBARD_MINRANGE 75 )

	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( MORDOR_HARADRIM_BOW_BOMBARD_MAXRANGE .01 )  
  
	LeechRangeWeapon      = Yes
	WeaponSpeed 			= 270 ; ;401         ; dist/sec 
	MinWeaponSpeed 		= 121
	MaxWeaponSpeed 		= 440 ; ;601      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	FireFX 				= FX_RohanArcherBowWeapon  
	ScaleWeaponSpeed	 	= Yes ; Used for lob weapons, scales speed proportional to range
	HitPercentage     	= 0     ;Always scatter
	ScatterRadius     	= ARCHER_BOMBARD_SCATTER_RADIUS     ;When this weapon misses it can randomly miss by as much as this distance.
	DelayBetweenShots 	= MORDOR_HARADRIM_BOW_DELAYBETWEENSHOTS
	PreAttackDelay        = MORDOR_HARADRIM_BOW_PREATTACKDELAY
	PreAttackRandomAmount     = 200 
	PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
	FiringDuration      	= MORDOR_HARADRIM_BOW_FIRINGDURATION    ; Duration of the archer firing shot is 500ms.
	AntiAirborneVehicle	= Yes
	AntiAirborneMonster	= Yes
	CanBeDodged			= Yes
	NoVictimNeeded		= Yes
	BombardType			= Yes



End


Weapon IsengardArcherHordeRangeFinder
	AttackRange				= 340
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( ISENGARD_URUKCROSSBOW_RANGE .01 )
	
	LeechRangeWeapon		= Yes
	DelayBetweenShots		= 1500
	AcceptableAimDelta		= 45
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	FinishAttackOnceStarted = No
	CanFireWhileMoving		= No
	HordeAttackNugget
	End
End

Weapon IsengardArcherHordeRangeFinderBombard
	AttackRange				= 340   ; ;100
	MinimumAttackRange		= ISENGARD_URUKCROSSBOW_BOMBARD_MINRANGE
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( ISENGARD_URUKCROSSBOW_BOMBARD_MAXRANGE .01 )
	
	LeechRangeWeapon		= Yes
	DelayBetweenShots		= 1500
	AcceptableAimDelta		= 45
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	FinishAttackOnceStarted = No
	CanFireWhileMoving		= No
	NoVictimNeeded			= Yes
	BombardType				= Yes
	ScatterRadius			= ARCHER_BOMBARD_SCATTER_RADIUS		; Only used for cursor radius
	HordeAttackNugget
	End
End



Weapon IsengardArcherBow         ; BALANCE Archer Weapon
  AttackRange				= 500 
  
  	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( ISENGARD_URUKCROSSBOW_RANGE .01 )
	
	
  LeechRangeWeapon		    = Yes
  WeaponSpeed				= 321         ; dist/sec 
  MinWeaponSpeed			= 61
  MaxWeaponSpeed			= 481      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range    
  FireFX = FX_RohanArcherBowWeapon 
  ScaleWeaponSpeed			= Yes ; Used for lob weapons, scales speed proportional to range
  HitPercentage				= 100     ;When this weapon is used it will hit exactly 50% of the time.
  ScatterRadius				= 16.0     ;When this weapon misses it can randomly miss by as much as this distance.
  PreAttackRandomAmount 	= 200     ; amount of additional preattack variance for archer type attacks only 
  DelayBetweenShots			= 2200	; time between shots, msec
  PreAttackDelay			= ISENGARD_URUKCROSSBOW_PREATTACKDELAY  	; 733 is the prep time for archer.
  PreAttackType				= PER_POSITION ; ;PER_SHOT ; Do the delay each time we attack a new target
  FiringDuration			= ISENGARD_URUKCROSSBOW_FIRINGDURATION 		; Duration of the archer firing shot is 500ms.
  CanFireWhileMoving		= No
  IsAimingWeapon            = Yes
  
  AcceptableAimDelta		= 20	; prevent twitchy reaiming in horde on horde
  AntiAirborneVehicle		= Yes
  AntiAirborneMonster		= Yes

  CanBeDodged = Yes ; Will check for a DodgePercent on the target to have a second chance at failing HitPercent



End

Weapon IsengardArcherBowBombard         ; BALANCE Archer Weapon
  AttackRange				= 500
  MinimumAttackRange		= #SUBTRACT( ISENGARD_URUKCROSSBOW_BOMBARD_MINRANGE 75 )
  
  	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( ISENGARD_URUKCROSSBOW_BOMBARD_MAXRANGE .01 )
	
	
  LeechRangeWeapon		    = Yes
  WeaponSpeed				= 321         ; dist/sec 
  MinWeaponSpeed			= 61
  MaxWeaponSpeed			= 481      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range    
  FireFX = FX_RohanArcherBowWeapon 
  ScaleWeaponSpeed			= Yes ; Used for lob weapons, scales speed proportional to range
  HitPercentage				= 0     ;Always scatter
  ScatterRadius				= ARCHER_BOMBARD_SCATTER_RADIUS     ;When this weapon misses it can randomly miss by as much as this distance.
  PreAttackRandomAmount 	= 200     ; amount of additional preattack variance for archer type attacks only 
  DelayBetweenShots			= ISENGARD_URUKCROSSBOW_DELAYBETWEENSHOTS 	; time between shots, msec
  PreAttackDelay			= ISENGARD_URUKCROSSBOW_PREATTACKDELAY 	; 733 is the prep time for archer.
  PreAttackType				= PER_POSITION ; ;PER_SHOT ; Do the delay each time we attack a new target
  FiringDuration			= ISENGARD_URUKCROSSBOW_FIRINGDURATION 		; Duration of the archer firing shot is 500ms.
  CanFireWhileMoving		= No
  IsAimingWeapon            = Yes
  
  AcceptableAimDelta		= 20	; prevent twitchy reaiming in horde on horde
  AntiAirborneVehicle		= Yes
  AntiAirborneMonster		= Yes

  CanBeDodged = Yes ; Will check for a DodgePercent on the target to have a second chance at failing HitPercent
  
  NoVictimNeeded			= Yes
	BombardType				= Yes


End


Weapon IsengardArcherBowFireArrow       ; BALANCE Archer Weapon
	AttackRange               = 500
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( ISENGARD_URUKCROSSBOW_RANGE .01 )
	
	
	WeaponSpeed               = 321         ; dist/sec 
	MinWeaponSpeed            = 241
	MaxWeaponSpeed            = 481      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	FireFX                    = FX_RohanArcherBowWeapon
	ScaleWeaponSpeed          = Yes ; Used for lob weapons, scales speed proportional to range
	HitPercentage             = 100     ;When this weapon is used it will hit exactly 50% of the time.
	ScatterRadius             = 16.0     ;When this weapon misses it can randomly miss by as much as this distance.
	DelayBetweenShots         = 2100
	PreAttackDelay            = ISENGARD_URUKCROSSBOW_PREATTACKDELAY    ; 1467 is the prep time for archer.
	PreAttackRandomAmount     = 200    ; amount of additional preattack variance for archer type attacks only  
	PreAttackType             = PER_POSITION ; ;PER_SHOT ; Do the delay each time we attack a new target
	FiringDuration            = ISENGARD_URUKCROSSBOW_FIRINGDURATION    ; Duration of the archer firing shot is 500ms.
	CanFireWhileMoving		  = No	
	IsAimingWeapon            = Yes
	
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	AcceptableAimDelta		= 20	; prevent twitchy reaiming in horde on horde

  	CanBeDodged = Yes ; Will check for a DodgePercent on the target to have a second chance at failing HitPercent
	
	DamageType				  = FLAME

End

Weapon IsengardArcherBowBombardFireArrow       ; BALANCE Archer Weapon
	AttackRange               = 500
	MinimumAttackRange        = #SUBTRACT( ISENGARD_URUKCROSSBOW_BOMBARD_MINRANGE 75 )
	
	RangeBonusMinHeight	= 10
	RangeBonus		= 1
	RangeBonusPerFoot	= 1 ; ;#MULTIPLY( ISENGARD_URUKCROSSBOW_BOMBARD_MAXRANGE .01 )
	
	
	WeaponSpeed               = 321         ; dist/sec 
	MinWeaponSpeed            = 241
	MaxWeaponSpeed            = 481      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	FireFX                    = FX_RohanArcherBowWeapon
	ScaleWeaponSpeed          = Yes ; Used for lob weapons, scales speed proportional to range
	HitPercentage             = 100     ;When this weapon is used it will hit exactly 50% of the time.
	ScatterRadius             = 16.0     ;When this weapon misses it can randomly miss by as much as this distance.
	DelayBetweenShots         = ISENGARD_URUKCROSSBOW_DELAYBETWEENSHOTS
	PreAttackDelay            = ISENGARD_URUKCROSSBOW_PREATTACKDELAY    ; 1467 is the prep time for archer.
	PreAttackRandomAmount     = 200    ; amount of additional preattack variance for archer type attacks only  
	PreAttackType             = PER_POSITION ; ;PER_SHOT ; Do the delay each time we attack a new target
	FiringDuration            = ISENGARD_URUKCROSSBOW_FIRINGDURATION    ; Duration of the archer firing shot is 500ms.
	CanFireWhileMoving		  = No	
	IsAimingWeapon            = Yes
	
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	AcceptableAimDelta		= 20	; prevent twitchy reaiming in horde on horde

  	CanBeDodged = Yes ; Will check for a DodgePercent on the target to have a second chance at failing HitPercent
  	
  	NoVictimNeeded			= Yes
	BombardType				= Yes	
	DamageType				  = FLAME

End

;========================Wildmen torches no longer hurt themselves

Weapon IsengardWildmanCudgel  ; BALANCE
	LeechRangeWeapon	= Yes
	AttackRange			= 30.0
	MeleeWeapon			= Yes
	DelayBetweenShots	= ISENGARD_WILDMAN_DELAYBETWEENSHOTS            ; time between shots, msec
	PreAttackDelay		= ISENGARD_WILDMAN_PREATTACKDELAY             ; 433 is natural time of the stabbing animation.
	PreAttackType		= PER_SHOT ; Do the delay each time we attack a new target
	FiringDuration		= ISENGARD_WILDMAN_FIRINGDURATION            ; min 600 for anim
	FireFX				= FX_GondorSwordHit
	FireFlankFX			= FX_Flanking
        RadiusDamageAffects = ENEMIES NOT_SIMILAR

End

;------------------------------------------------------------------------
;;FIXING BUG WITH HARADRIM ARCHERS + adding them fire arrows

ExperienceLevel	EvilEliteLevel1
	TargetNames							=	EVIL_ELITE
	RequiredExperience					=	EXPERIENCE_REQUIRED_EVIL_ELITE_1
	ExperienceAward						=	EXPERIENCE_AWARD_EVIL_ELITE_1
	ExperienceAwardOwnGuysDie			= 	0
	ShowLevelUpTint						=	Yes	
	Rank								=	1
	LevelUpTintColor					=	R:255 G:255	B:255
	LevelUpTintPreColorTime				=	500	
	LevelUpTintPostColorTime			=	3000
	LevelUpTintSustainColorTime			=	500	
	EmotionType							=	CHEER
	SelectionDecal
		Texture							=	decal_I_level1
		Texture2						=	decal_evil_CO
		Style							=	SHADOW_MERGE_DECAL
		OpacityMin						=	80%
		OpacityMax						=	100%
		MinRadius						=	HORDE_DECAL_MIN_RADIUS
		MaxRadius						=	200	
		MaxSelectedUnits				=	40
	End	
END

ExperienceLevel	EvilEliteLevel2
	TargetNames							=	EVIL_ELITE
	RequiredExperience					=	EXPERIENCE_REQUIRED_EVIL_ELITE_2
	ExperienceAward						=	EXPERIENCE_AWARD_EVIL_ELITE_2
	AttributeModifiers					=	EvilEliteBonusRank2
	ExperienceAwardOwnGuysDie			= 	0
	LevelUpFx							=	FX:GenericLevelUp2FX	
	ShowLevelUpTint						=	Yes	
	Rank								=	2
        Upgrades                                                  = Upgrade_ObjectLevel2
	LevelUpTintColor					=	R:255 G:255	B:255
	LevelUpTintPreColorTime				=	500	
	LevelUpTintPostColorTime			=	3000
	LevelUpTintSustainColorTime			=	500	
	EmotionType							=	CHEER
	SelectionDecal
		Texture							=	decal_I_level2
		Texture2						=	decal_evil_CO
		Style							=	SHADOW_MERGE_DECAL
		OpacityMin						=	80%
		OpacityMax						=	100%
		MinRadius						=	HORDE_DECAL_MIN_RADIUS
		MaxRadius						=	200	
		MaxSelectedUnits				=	40

	End	
END

ExperienceLevel	EvilEliteLevel3
	TargetNames							=	EVIL_ELITE
	RequiredExperience					=	EXPERIENCE_REQUIRED_EVIL_ELITE_3
	ExperienceAward						=	EXPERIENCE_AWARD_EVIL_ELITE_3
	AttributeModifiers					=	EvilEliteBonusRank3
	ExperienceAwardOwnGuysDie			= 	0
	LevelUpFx							=	FX:GenericLevelUp3FX	
	ShowLevelUpTint						=	Yes	
	Rank								=	3
	LevelUpTintColor					=	R:255 G:255	B:255
	LevelUpTintPreColorTime				=	500	
	LevelUpTintPostColorTime			=	3000
	LevelUpTintSustainColorTime			=	500	
	EmotionType							=	CHEER
	SelectionDecal
		Texture							=	decal_I_level3
		Texture2						=	decal_evil_CO
		Style							=	SHADOW_MERGE_DECAL
		OpacityMin						=	80%
		OpacityMax						=	100%
		MinRadius						=	HORDE_DECAL_MIN_RADIUS
		MaxRadius						=	200	
		MaxSelectedUnits				=	40
	End	
END

ExperienceLevel	EvilEliteLevel4
	TargetNames							=	EVIL_ELITE
	RequiredExperience					=	EXPERIENCE_REQUIRED_EVIL_ELITE_4
	ExperienceAward						=	EXPERIENCE_AWARD_EVIL_ELITE_4
	AttributeModifiers					=	EvilEliteBonusRank4
	ExperienceAwardOwnGuysDie			= 	0
	LevelUpFx							=	FX:GenericLevelUp4FX	
	ShowLevelUpTint						=	Yes	
	Rank								=	4
	LevelUpTintColor					=	R:255 G:255	B:255
	LevelUpTintPreColorTime				=	500	
	LevelUpTintPostColorTime			=	3000
	LevelUpTintSustainColorTime			=	500	
	EmotionType							=	CHEER
	SelectionDecal
		Texture							=	decal_I_level4
		Texture2						=	decal_evil_CO
		Style							=	SHADOW_MERGE_DECAL
		OpacityMin						=	80%
		OpacityMax						=	100%

		MinRadius						=	HORDE_DECAL_MIN_RADIUS
		MaxRadius						=	200	
		MaxSelectedUnits				=	40
	End	
END

ExperienceLevel	EvilEliteLevel5
	TargetNames							=	EVIL_ELITE
	RequiredExperience					=	EXPERIENCE_REQUIRED_EVIL_ELITE_5
	ExperienceAward						=	EXPERIENCE_AWARD_EVIL_ELITE_5
	AttributeModifiers					=	EvilEliteBonusRank5
	ExperienceAwardOwnGuysDie			= 	0
	LevelUpFx							=	FX:GenericLevelUp4FX	
	ShowLevelUpTint						=	Yes	
	Rank								=	5
	LevelUpTintColor					=	R:255 G:255	B:255
	LevelUpTintPreColorTime				=	500	
	LevelUpTintPostColorTime			=	3000
	LevelUpTintSustainColorTime			=	500	
	EmotionType							=	CHEER
	SelectionDecal
		Texture							=	decal_I_level4
		Texture2						=	decal_evil_CO
		Style							=	SHADOW_MERGE_DECAL
		OpacityMin						=	80%
		OpacityMax						=	100%
		MinRadius						=	HORDE_DECAL_MIN_RADIUS
		MaxRadius						=	200	
		MaxSelectedUnits				=	40
	End	
END

SpecialPower SpecialAbilityHaradrimArcherBarbedArrow
	Enum			= SPECIAL_AT_VISIBLE_OBJECT
	ReloadTime		= 20000 ; 6s was too overpowered
; 	UnitSpecificSoundToUseAsInitiateIntendToDoVoice = VoiceInitiateBarbedArrowAttack
End

CommandButton Command_HaradrimArcherBarbedArrowAbility
	Command				= SPECIAL_POWER
	SpecialPower		= SpecialAbilityHaradrimArcherBarbedArrow
	Options				= NEED_TARGET_ENEMY_OBJECT NEED_TARGET_NEUTRAL_OBJECT OK_FOR_MULTI_SELECT OK_FOR_MULTI_EXECUTE ; ;
	ButtonImage			= UCCommon_BarbedArrows
	CursorName			= EvilAbilityObj
	InvalidCursorName	= GenericInvalid
	TextLabel			= CONTROLBAR:BarbedArrows
	DescriptLabel		= CONTROLBAR:ToolTipBarbedArrowsNew
	InPalantir			= Yes	
	ButtonBorderType    = ACTION
	AutoAbility			= Yes
End

CommandSet MordorHaradrimArcherHordeBarbedArrowAndFireArrowCommandSet
	1	= Command_ToggleStance
	2	= Command_ArcherBombard
	3	= Command_HaradrimArcherBarbedArrowAbility
        4       = Command_PurchaseUpgradeMordorFireArrows
	5	= Command_PurchaseUpgradeMordorBasicTraining
	6	= Command_PurchaseUpgradeMordorHeavyArmor
	12	= Command_CaptureBuilding
	13	= Command_AttackMove
	14	= Command_Stop
End

Object MordorHaradrimArcherHorde
CommandSet = MordorHaradrimArcherHordeBarbedArrowAndFireArrowCommandSet
End

;=========================================================================
;                          FREE BANNER CARRIERS
;=========================================================================

CommandButton Command_PurchaseUpgradeGondorBasicTraining
	Command				= OBJECT_UPGRADE
	Options				= OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_GondorBasicTraining 
	TextLabel			= CONTROLBAR:PurchaseUpgradeGondorBasicTraining
	ButtonImage			= BGBlacksmith_SilverTreeBanner
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CONTROLBAR:ToolTipPurchaseUpgradeGondorBasicTraining
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackGondorBasicTraining
End

CommandButton Command_PurchaseUpgradeDwarvenBasicTraining
	Command				= OBJECT_UPGRADE
	Options				= OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_DwarvenBasicTraining 
	NeededUpgrade			= Upgrade_TechnologyDwarvenBasicTraining
	TextLabel			= CONTROLBAR:PurchaseUpgradeDwarvenBasicTraining
	ButtonImage			= BDHallofWarriors_BannerCarrier
	ButtonBorderType		= UPGRADE
	DescriptLabel			= CONTROLBAR:ToolTipPurchaseUpgradeDwarvenTraining
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackDwarvenBasicTraining
End

CommandButton Command_PurchaseUpgradeElvenBasicTraining
	Command				= OBJECT_UPGRADE
	Options				= OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_ElvenBasicTraining 
	TextLabel			= CONTROLBAR:PurchaseUpgradeElderRacesBasicTraining
	ButtonImage			= BEEregionForge_BannerCarrier
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CONTROLBAR:ToolTipPurchaseUpgradeElderRacesBasicTraining
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackElderRacesBasicTraining
End

CommandButton Command_PurchaseUpgradeIsengardBasicTraining
	Command				= OBJECT_UPGRADE
	Options				= OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_IsengardBasicTraining 
	TextLabel			= CONTROLBAR:PurchaseUpgradeIsengardBasicTraining
	ButtonImage			= BIArmory_WhiteHandBanner
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CONTROLBAR:ToolTipPurchaseUpgradeIsengardBasicTraining
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackIsengardBasicTraining
End

CommandButton Command_PurchaseUpgradeMordorBasicTraining
	Command				= OBJECT_UPGRADE
	Options				= OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_MordorBasicTraining 
	TextLabel			= CONTROLBAR:PurchaseUpgradeMordorBasicTraining
	ConflictingLabel	= CONTROLBAR:BatallionAreadyHasUpgrade
	ButtonImage			= BMOrcPit_RedEyeBanner
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CONTROLBAR:ToolTipPurchaseUpgradeMordorBasicTraining
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackMordorBasicTraining
End

CommandButton Command_PurchaseUpgradeWildBasicTraining
	Command				= OBJECT_UPGRADE
	Options				= OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_WildBasicTraining 
	TextLabel			= CONTROLBAR:PurchaseUpgradeWildBasicTraining
	ButtonImage			= BWTreasureTrove_BannerCarrier
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CONTROLBAR:ToolTipPurchaseUpgradeWildBasicTraining
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackWildBasicTraining
End

CommandButton Command_PurchaseUpgradeAngmarBasicTraining
	Command				= OBJECT_UPGRADE
	Options				= OK_FOR_MULTI_SELECT CANCELABLE
	Upgrade				= Upgrade_AngmarBasicTraining 
	TextLabel			= CONTROLBAR:PurchaseUpgradeAngmarBasicTraining
	ButtonImage			= BG_SilverTreeBanner
	ButtonBorderType	= UPGRADE
	DescriptLabel		= CONTROLBAR:ToolTipPurchaseUpgradeAngmarBasicTraining
	InPalantir			= Yes
	LacksPrerequisiteLabel		= TOOLTIP:LackAngmarBasicTraining
End

CommandSet Gate
	1 = Command_ToggleGate
End

Object FornostGate
CommandSet = Gate
End

Object EreborThrone
RadarPriority = NOT_ON_RADAR
End

Weapon CorsairFireBomb
	AttackRange			= 300			; Horde member so it needs to be bigger than the horde weapon attack range.
	WeaponSpeed			= 100										; dist/sec 
	MinWeaponSpeed		= 121
	MaxWeaponSpeed		= 100										; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	FireFX				= FX_FirebombThrow
	HitPercentage		= MORDOR_CORSAIR_FIRE_BOMB_HIT_PERCENTAGE	; When this weapon is used it will hit exactly 50% of the time.
	ScatterRadius		= MORDOR_CORSAIR_FIRE_BOMB_SCATTER_RADIUS	; When this weapon misses it can randomly miss by as much as this distance.
	;NoVictimNeeded		= Yes

	OverrideVoiceAttackSound = CorsairVoiceAttackFirebomb
	OverrideVoiceEnterStateAttackSound = CorsairVoiceEnterStateAttackFirebomb

	AcceptableAimDelta		= 20									; prevent twitchy reaiming in horde on horde
	DelayBetweenShots		= 0
	PreAttackDelay			= MORDOR_CORSAIR_FIRE_BOMB_PREATTACKDELAY
	PreAttackType			= PER_SHOT
	FiringDuration			= MORDOR_CORSAIR_FIRE_BOMB_FIRING_DURATION
	PreAttackRandomAmount	= MORDOR_CORSAIR_FIRE_BOMB_RANDOM_PREATTACK

	ClipSize			= INFINITE_CLIP_SIZE
	AutoReloadsClip		= Yes
	
	ProjectileNugget
		ProjectileTemplateName  = CorsairFireBombProjectile
		WarheadTemplateName     = CorsairFireBombWarhead
	End
End

;------------------------------------------------------------------------------
Weapon CorsairFireBombBombard
	AttackRange			= 300			; Horde member so it needs to be bigger than the horde weapon attack range.
	MinimumAttackRange	= MORDOR_CORSAIR_FIRE_BOMB_MIN_RANGE
	WeaponSpeed			= 100										; dist/sec 
	MinWeaponSpeed		= 121
	MaxWeaponSpeed		= 100										; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	FireFX				= FX_FirebombThrow
	AcceptableAimDelta	= 20										; prevent twitchy reaiming in horde on horde
	DelayBetweenShots	= 0
	PreAttackDelay		= MORDOR_CORSAIR_FIRE_BOMB_PREATTACKDELAY
	PreAttackType		= PER_SHOT
	FiringDuration		= MORDOR_CORSAIR_FIRE_BOMB_FIRING_DURATION
	PreAttackRandomAmount	= MORDOR_CORSAIR_FIRE_BOMB_RANDOM_PREATTACK

	HitPercentage		= 0											; Always scatter
	ScatterRadius		= ARCHER_BOMBARD_SCATTER_RADIUS
	NoVictimNeeded		= Yes
	BombardType			= Yes

	ClipSize			= INFINITE_CLIP_SIZE
	AutoReloadsClip		= Yes
	
	ProjectileNugget
		ProjectileTemplateName  = CorsairFireBombProjectile
		WarheadTemplateName     = CorsairFireBombWarhead
	End
End


;------------------------------------------------------------------------------
Weapon CorsairFireBombMissileHordeRangefinder
	AttackRange				= 200
	DelayBetweenShots		= 1000
	LeechRangeWeapon		= Yes
	AcceptableAimDelta		= 45
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	CanFireWhileMoving		= Yes		; When aboard a mumakil.
	FinishAttackOnceStarted = No
	HordeAttackNugget
	End
End

;------------------------------------------------------------------------------
Weapon CorsairFireBombMissileHordeRangefinderBombard
	AttackRange				= 200
	MinimumAttackRange		= MORDOR_CORSAIR_HORDE_FIRE_BOMB_MIN_RANGE
	DelayBetweenShots		= 1000
	LeechRangeWeapon		= Yes
	AcceptableAimDelta		= 45
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	CanFireWhileMoving		= Yes		; When aboard a mumakil.
	FinishAttackOnceStarted = No
	NoVictimNeeded			= Yes
	BombardType				= Yes	
	ScatterRadius			= ARCHER_BOMBARD_SCATTER_RADIUS
	HordeAttackNugget
	End
End

;----------------------------

ChildObject WildBatCloud MordorMountainTroll
	WeaponSet
		Conditions          	=  None
		Weapon             	=  PRIMARY		Sting
		Weapon              	=  SECONDARY		MordorWorkerAxe
		OnlyAgainst         	=  SECONDARY		STRUCTURE BLOCKING_GATE
		Weapon			=  TERTIARY		Sting
		OnlyInCondition		=  TERTIARY		MOVING
	End
	LocomotorSet
		Locomotor = TrollLocomotor
		Condition = SET_NORMAL
		Speed     = 87
	End
AddModule
	Body = DelayedDeathBody ModuleTag_02_New
		MaxHealth			= 50000
		MaxHealthDamaged		= 30000
		MaxHealthReallyDamaged		= 10000
		DoHealthCheck			= No			;// Don't want to get the delayed death behaviour when we die normally.
		DelayedDeathTime		= 5000
		CanRespawn			= No			;// Unit can't get revived.
	End
End
	Scale 			= 1.75
	BountyValue		= 360
	Geometry		= CYLINDER
	GeometryMajorRadius	= 40.0
	GeometryHeight		= 75.0
	GeometryIsSmall		= No
	Shadow			= SHADOW_VOLUME_NON_SELF_2	;// volumetric shadow that doesn't cast onto all objects using SHADOW_VOLUME_NON_SELF_2
End


FXParticleSystem GaladAura
  System
    Priority = VERY_LOW_OR_ABOVE
    ParticleName = EXBlast.tga
    Lifetime = 100 100
    SortLevel = 1
    Size = 10 10
    BurstDelay = 2 2
    BurstCount = 1 1
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color2 = R:108 G:108 B:108 5
    Color3 = R:0 G:0 B:0 100
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.25 0.3 5
    Alpha3 = 0.0 0 100
  End
  Update = DefaultUpdate
    SizeRate = 1 4
    SizeRateDamping = 0.88 0.99
    AngleZ = 0 7
    AngularRateZ = 0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.5 0.5
  End
  EmissionVelocity = OrthoEmissionVelocity
    X = -1 1
    Y = -1 1
  End
  EmissionVolume = BoxEmissionVolume
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem GaladAura02
  System
    Priority = MEDIUM_OR_ABOVE
    Shader = ALPHA
    ParticleName = EXCloud06HiRes.tga
    Lifetime = 100 100
    SortLevel = 1
    Size = 5 5
    BurstDelay = 1 1
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:115 G:115 B:115 0
    Color2 = R:100 G:100 B:100 5
    Color3 = R:77 G:77 B:77 150
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.5 0.75 5
    Alpha3 = 0.0 0 150
  End
  Update = DefaultUpdate
    SizeRate = 2 2
    SizeRateDamping = 0.9 0.95
    AngleZ = 0 7
    AngularRateZ = -0.05 0.05
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.5 0.5
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    EndPoint = X:0 Y:0 Z:-3
  End
  Draw = DefaultDraw
  End
End

Object ElvenGaladriel
AddModule
	Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
		LevelToGrant	= 10
		MPOnly		= No
	End
End
AddModule
	Behavior = ModelConditionUpgrade ModulTag_RingHeroMC
		TriggeredBy			= Upgrade_ObjectLevel1
		AddConditionFlags		= USER_1
	End
End
AddModule
	Behavior = SpecialPowerModule ModuleTag_GaladrielTerribleFury
		SpecialPowerTemplate		= SpecialAbilityScreech
		UpdateModuleStartsAttack	= Yes
		SetModelCondition 		= ModelConditionState:USER_2
		SetModelConditionTime 		= 3.2
		DisableDuringAnimDuration 	= Yes
	End
End
AddModule
	Behavior = SpecialAbilityUpdate ModuleTag_GaladrielTerribleFuryUpdate  
		SpecialPowerTemplate		= SpecialAbilityScreech
		UnpackTime			= 1
		AwardXPForTriggering		= 0		
		TriggerSound			= GaladrielVoiceTerribleFury
		EffectRange			= 200
		UnpackTime			= 100
		PreparationTime			= 1
		PackTime			= 3000
	End
End
End

Object MordorGrond
ReplaceModule ModuleTag_04
	Body                  = ActiveBody ModuleTag_04_NEW
		CheerRadius 	  = EMOTION_CHEER_RADIUS
		MaxHealth         = 66000
		MaxHealthDamaged  = 10000
	End
End
End

Object MordorBalrog
ReplaceModule ModuleTag_02
  Body            = ActiveBody ModuleTag_02_NEW
    MaxHealth         = 40000
  End
End
RemoveModule ModuleTag_LifetimeUpdate
End

FXParticleSystem SaronRingSpark
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXSparkle.tga
    Lifetime = 4 4
    SortLevel = 1
    Size = 15 15
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:226 G:23 B:23 0
    Color2 = R:226 G:203 B:93 2
    Color3 = R:0 G:0 B:0 4
  End
  Update = DefaultUpdate
    SizeRateDamping = 1 1
    AngleZ = 0 1
    AngularDamping = 0.8 0.9
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:-2 Y:0 Z:0
    EndPoint = X:-2 Y:0 Z:0
  End
  Draw = DefaultDraw
  End
End


Weapon HobbitPunch
	IdleAfterFiringDelay		= 0
	AttackRange			= 120
	MinimumAttackRange		= 0.8
	WeaponSpeed			= 401					; dist/sec 
	MinWeaponSpeed			= 241
	MaxWeaponSpeed			= 601					; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	ScaleWeaponSpeed		= Yes					; Used for lob weapons, scales speed proportional to range
	RadiusDamageAffects		= ALLIES ENEMIES NOT_SIMILAR
	DelayBetweenShots		= 2000					; time between shots, msec
	PreAttackDelay			= 10
	PreAttackType			= PER_ATTACK				; Do the delay each time we attack a new target
	PreAttackFX			= FX_RingHeroPreAttackBlast
	FireFX				= FX_RingHeroBlast
	FiringDuration			= 1000
	
	DamageNugget						
		Damage			= 500000			; Kill all allies
		Radius			= 5000.0			; The whole map
		DamageType		= MAGIC
		DamageFXType		= MAGIC
		DeathType		= EXPLODED
		DamageSpeed		= 750.0				; must match the ShockWaveSpeed below
	    DamageScalar		= 0% ALL ENEMIES		; prevents players 1-4 from being obliterated
	    DamageScalar		= 0% NONE +STRUCTURE		; prevents Orthanc towers from being destroyed
	End

	DamageNugget						
		Damage			= 70			; Damage some nearby enemies
		Radius			= 500.0			
		DamageType		= MAGIC
		DamageFXType		= MAGIC
		DeathType		= EXPLODED
		DamageSpeed		= 750.0			; must match the ShockWaveSpeed below
	End

	MetaImpactNugget					; A Nugget that throws things back with force
		ShockWaveAmount		= 70.0
		ShockWaveRadius		= 3000.0
		ShockWaveTaperOff	= 1.0
		ShockWaveZMult		= 1.000
		ShockWaveSpeed		= 750.0 
	End
End

ChildObject MordorSauron_RingHero MordorSauron
ReplaceModule ModuleTag_01
	Draw = W3DScriptedModelDraw ModuleTag_01_NEW
		OkToChangeModelColor = Yes
		StaticModelLODMode = yes		; Will append M or L to the skin name depending on GameLOD
		DefaultModelConditionState
			Model = MUSauron_SKN
			ParticleSysBone = WEAPON SaronRingSpark FollowBone:Yes
		End

;;================== ANIMATIONS =================================================================

;;------------------ MOVING & DYING ---------------------------

;;======= DYING

	AnimationState						= DYING
		Animation						= DIEB
			AnimationName				= MUSauron_SKL.MUSauron_DIEB
			AnimationMode				= ONCE
		End
		
			
			ParticleSysBone = NONE UltraInitial01
			ParticleSysBone = NONE UltraInitial02
			ParticleSysBone = NONE UltraInitial03
		
		BeginScript
			CurDrawableShowSubObject("SHARD01")
			CurDrawableShowSubObject("SHARD02")
			CurDrawableShowSubObject("SHARD03")
			CurDrawableShowSubObject("SHARD04")
			CurDrawableShowSubObject("SHARD05")
			CurDrawableShowSubObject("SHARD06")
			CurDrawableShowSubObject("SHARD07")
			CurDrawableShowSubObject("SHARD08")
			CurDrawableShowSubObject("SHARD09")
			CurDrawableShowSubObject("SHARD10")
			CurDrawableShowSubObject("SHARD11")
			CurDrawableShowSubObject("SHARD12")
			CurDrawableShowSubObject("SHARD13")
			CurDrawableShowSubObject("SHARD14")
			CurDrawableShowSubObject("SHARD15")
			CurDrawableShowSubObject("SHARD16")
			CurDrawableShowSubObject("SHARD17")
			CurDrawableShowSubObject("SHARD18")
			CurDrawableShowSubObject("SHARD19")
			CurDrawableShowSubObject("SHARD20")
		EndScript
	End
		
	AnimationState						= PARALYZED
		Animation
			AnimationName				= MUSauron_SKL.MUSauron_IDLA
			AnimationMode				= LOOP
		End
	End

;;======= MOVING

    AnimationState						= MOVING FIRING_OR_PREATTACK_A
		StateName						= STATE_Moving
		Animation						= Moving
		    AnimationName				= MUSauron_SKL.MUSauron_WLKB
			AnimationMode				= LOOP
			Distance					= 190
		End
		Flags							= MAINTAIN_FRAME_ACROSS_STATES
    End

	AnimationState						= MOVING TURN_RIGHT_HIGH_SPEED
		StateName						= STATE_Moving
		Animation						= Moving
		    AnimationName				= MUSauron_SKL.MUSauron_WLKA
			AnimationMode				= LOOP
			Distance					= 190
		End
		Animation						= Turning
			AnimationName				= MUSauron_SKL.MUSauron_TRNR
		    AnimationMode				= LOOP
			AnimationBlendTime			= 0
		End
		Flags							= MAINTAIN_FRAME_ACROSS_STATES MAINTAIN_FRAME_ACROSS_STATES2
		BeginScript
			if CurDrawablePrevAnimationState() == "STATE_Turning" then return "Turning" else return "Moving" end
		EndScript
    End
    
    AnimationState						= MOVING TURN_LEFT_HIGH_SPEED
		StateName						= STATE_Moving
		Animation						= Moving
		    AnimationName				= MUSauron_SKL.MUSauron_WLKA
			AnimationMode				= LOOP
			Distance					= 190
		End
		Animation						= Turning
			AnimationName				= MUSauron_SKL.MUSauron_TRNL
			AnimationMode				= LOOP
			AnimationBlendTime			= 0
		End
		Flags							= MAINTAIN_FRAME_ACROSS_STATES MAINTAIN_FRAME_ACROSS_STATES2
		BeginScript
			if CurDrawablePrevAnimationState() == "STATE_Turning" then return "Turning" else return "Moving" end
		EndScript
    End

	AnimationState						= TURN_LEFT
		StateName						= STATE_Turning
		Animation						= Turning
			AnimationName				= MUSauron_SKL.MUSauron_TRNL
			AnimationMode				= LOOP
			AnimationBlendTime			= 5
		End
		Flags							= MAINTAIN_FRAME_ACROSS_STATES2
    End
    
    AnimationState						= TURN_RIGHT
		StateName						= STATE_Turning
		Animation						= Turning
			AnimationName				= MUSauron_SKL.MUSauron_TRNR
		    AnimationMode				= LOOP
		    AnimationBlendTime			= 5
		End
		Flags							= MAINTAIN_FRAME_ACROSS_STATES2
   End

    AnimationState						= MOVING
		StateName						= STATE_Moving
		Animation						= Moving
		    AnimationName				= MUSauron_SKL.MUSauron_WLKA
			AnimationMode				= LOOP
			Distance					= 190
		End
		Flags							= MAINTAIN_FRAME_ACROSS_STATES
    End
 
 ;;------------------ ABILITIES  -------------------------------
 	
	AnimationState						= SPECIAL_WEAPON_ONE					; Fires of doom
		Animation
			AnimationName				= MUSauron_SKL.MUSauron_ATKD
			AnimationMode				= ONCE
		End
	End

 ;;------------------ ATTACKING  -------------------------------

	AnimationState						= FIRING_OR_PREATTACK_A
		StateName						= STATE_Ready
		Animation						= ATKC
			AnimationName				= MUSauron_SKL.MUSauron_ATKC
			AnimationMode				= ONCE
			UseWeaponTiming				= Yes
		End
	End

;;-------------------- HIT REACTIONS --------------------------

	AnimationState						= HIT_REACTION
		StateName						= STATE_Ready
		Animation
			AnimationName				= MUSauron_SKL.MUSauron_HITA
			AnimationMode				= ONCE
		End
	End
		
		AnimationState        = RAISING_FLAG
			Animation
				AnimationName     = MUSauron_SKL.MUSauron_ATKC
				AnimationMode     = ONCE
			End
			Animation
				AnimationName     = MUSauron_SKL.MUSauron_ATKD
				AnimationMode     = ONCE
			End
			Animation
				AnimationName     = MUSauron_SKL.MUSauron_ATKE
				AnimationMode     = ONCE
			End
			Flags					= RESTART_ANIM_WHEN_COMPLETE
		End

;;--------------- IDLE STATES ---------------------------------

	AnimationState						= SELECTED
		StateName						= Idle
		Animation						= IDLA
			AnimationName				= MUSauron_SKL.MUSauron_IDLA
			AnimationMode				= LOOP
		End
	End

	IdleAnimationState
		AllowRepeatInRandomPick			= Yes
		StateName						= Idle
		Animation						= IDLA
			AnimationName				= MUSauron_SKL.MUSauron_IDLA
			AnimationMode				= ONCE
			AnimationPriority			= 20
		End
		Animation						= IDLC
			AnimationName				= MUSauron_SKL.MUSauron_IDLC
			AnimationMode				= ONCE
			AnimationPriority			= 10
			AnimationBlendTime			= 5
			AnimationSpeedFactorRange	= 0.7 1.5
		End
		BeginScript
			Prevs = CurDrawablePrevAnimationState()
			Preva = CurDrawablePrevAnimation()
			if Prevs == "STATE_Moving"
			then
				CurDrawableSetTransitionAnimState("TRANS_SmoothToIdle")
			elseif Prevs == "STATE_Ready"
			then
				CurDrawableSetTransitionAnimState("TRANS_ReallySmoothToIdle")
			end
			if Preva == "IDLC"
			then
				CurDrawableSetTransitionAnimState("TRANS_ReallySmoothToIdle")
			end
		EndScript
	End
;;--------------------- TRANSITIONS ----------------------------------------------------

	TransitionState					= TRANS_SmoothToIdle
		Animation					= IDLA
			AnimationName			= MUSauron_SKL.MUSauron_IDLA
			AnimationMode			= ONCE
			AnimationBlendTime		= 5
		End
	End
	TransitionState					= TRANS_ReallySmoothToIdle
		Animation					= IDLA
			AnimationName			= MUSauron_SKL.MUSauron_IDLA
			AnimationMode			= ONCE
			AnimationBlendTime		= 10
		End
	End
End
End
	WeaponSet
		Conditions			= None 
		Weapon				= PRIMARY HobbitSword
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
ReplaceModule ModuleTag_Body
	Body = ActiveBody ModuleTag_Body_BOSS
		MaxHealth = 77000
	End
End
AddModule
	Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
		LevelToGrant	= 10
		MPOnly		= No
	End
End
AddModule
	Behavior = SlowDeathBehavior ModuleTag_05_SHOCKWAVE
		DeathTypes			= ALL 
		SinkDelay			= 500
		SinkRate			= 1.00
		DestructionDelay		= 4000
        Sound					= INITIAL BalrogVanquished
        Weapon					= FINAL HobbitPunch
	End
End
Scale = 1.7
	LocomotorSet
		Locomotor = BasicSauronLocomotor
		Condition = SET_NORMAL 
		Speed     = 32
	End
	Geometry			= CYLINDER
	GeometryMajorRadius = 21
	GeometryHeight		= 60
	GeometryIsSmall		= Yes
	Shadow				= SHADOW_DECAL
	ShadowSizeX			= 40
	ShadowSizeY			= 40
	ShadowTexture		= ShadowI
End