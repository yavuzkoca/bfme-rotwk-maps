;//////////////////////////////////////////////////////////////////////////////
;The Sanctum Of Insanity o_O THIS IS SPAAAARTAAAA! ////////////////////////////////////////////////////
;//////////////////////////////////////////////////////////////////////////////
;Powers by Alexyz (Moria Rev) and Lord Adunaphel by Beserkidiot(<3 couldn't have done it without you)
;Power
;; -------------------------------------
;; INTRINSIC (Base-Level) Sciences for multiplayer
;; -------------------------------------

Science SCIENCE_MEN
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_ELVES
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_DWARVES
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_ISENGARD
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_MORDOR
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_WILD
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

;; -------------------------------------
;; INTRINSIC (Base-Level) Sciences for single player
;; -------------------------------------

Science SCIENCE_GOOD
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

Science SCIENCE_EVIL
  PrerequisiteSciences = None
  SciencePurchasePointCost = 0  ; note that this means "not purchasable", NOT "free"!
  IsGrantable = No
End

;; -------------------------------------
;; Good Sciences
;; -------------------------------------

Science SCIENCE_ElvenGifts
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_CaveBats
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 12
  IsGrantable = Yes
End

Science SCIENCE_Heal
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ISENGARD OR SCIENCE_WILD OR SCIENCE_MORDOR OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES 
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 7
  IsGrantable = Yes
End

Science SCIENCE_Farsight
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ELVES
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_EnshroudingMistSP
  PrerequisiteSciences = SCIENCE_GOOD
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_RallyingCall
  PrerequisiteSciences = SCIENCE_EnshroudingMistSP
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

;; The MP version of the RallyingCall is available at Level 1.
Science SCIENCE_RallyingCallMP
  PrerequisiteSciences = SCIENCE_DWARVES OR SCIENCE_ELVES OR SCIENCE_MEN
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End
Science SCIENCE_EnshroudingMistMP
  PrerequisiteSciences = SCIENCE_RallyingCallMP
  SciencePurchasePointCost = 5
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End



Science SCIENCE_ElvenWood
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ELVES SCIENCE_Heal OR SCIENCE_ELVES SCIENCE_Farsight
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End


Science SCIENCE_Rebuild
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_Heal OR SCIENCE_ElvenWood OR SCIENCE_MEN OR SCIENCE_DWARVES
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_TomBombadil
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_EnshroudingMistSP OR SCIENCE_GOOD SCIENCE_ElvenGifts OR SCIENCE_ELVES SCIENCE_Farsight OR SCIENCE_MEN SCIENCE_RallyingCallMP OR SCIENCE_MEN SCIENCE_Rebuild
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_HobbitAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_DWARVES SCIENCE_Heal OR SCIENCE_ELVES SCIENCE_Heal OR SCIENCE_MEN SCIENCE_Heal
  SciencePurchasePointCost = 3
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_SpawnLoneTower
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_GOOD SCIENCE_ElvenWood OR SCIENCE_MEN SCIENCE_Rebuild OR SCIENCE_DWARVES SCIENCE_Heal OR SCIENCE_DWARVES SCIENCE_Rebuild
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_ArrowVolleyGood
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Heal OR SCIENCE_Crebain
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 8
  IsGrantable = Yes
End

Science SCIENCE_DwarvenRiches
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_ElvenGifts OR SCIENCE_GOOD SCIENCE_Heal OR SCIENCE_DWARVES SCIENCE_RallyingCallMP OR SCIENCE_DWARVES SCIENCE_Rebuild
  SciencePurchasePointCost = GOOD_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_MenOfDaleAllies
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_RallyingCall OR SCIENCE_GOOD SCIENCE_TomBombadil OR SCIENCE_DWARVES SCIENCE_RallyingCallMP
  SciencePurchasePointCost = GOOD_RANK_3_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_CloudBreak
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_CaveBats
  SciencePurchasePointCost = GOOD_RANK_3_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_RohanAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_MEN SCIENCE_TomBombadil OR SCIENCE_MEN SCIENCE_SpawnLoneTower
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_DunedainAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_MEN SCIENCE_HobbitAllies OR SCIENCE_MEN SCIENCE_ArrowVolleyGood
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_EntAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ELVES SCIENCE_ElvenWood OR SCIENCE_ELVES SCIENCE_TomBombadil
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_EagleAllies
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ELVES SCIENCE_ArrowVolleyGood OR SCIENCE_ELVES SCIENCE_EnshroudingMistMP
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_Undermine
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_DwarvenRiches OR SCIENCE_GOOD SCIENCE_Rebuild OR SCIENCE_DWARVES SCIENCE_HobbitAllies OR SCIENCE_DWARVES SCIENCE_SpawnLoneTower
  SciencePurchasePointCost = GOOD_RANK_3_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_Bombard
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Crebain
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 12
  IsGrantable = Yes
End

Science SCIENCE_ArmyoftheDead
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Flood OR SCIENCE_RainOfFire
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 24
  IsGrantable = Yes
End

Science SCIENCE_Earthquake
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Sunflare OR SCIENCE_RainOfFire
  SciencePurchasePointCost = GOOD_RANK_1_COST
  SciencePurchasePointCostMP = 25
  IsGrantable = Yes
End

Science SCIENCE_Flood
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Bombard OR SCIENCE_ArrowVolleyGood
  SciencePurchasePointCost = GOOD_RANK_4_COST
  SciencePurchasePointCostMP = 17
  IsGrantable = Yes
End

Science SCIENCE_Sunflare
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ElvenGifts OR SCIENCE_ArrowVolleyEvil
  SciencePurchasePointCost = GOOD_RANK_4_COST
  SciencePurchasePointCostMP = 17
  IsGrantable = Yes
End

Science SCIENCE_Citadel
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_DWARVES SCIENCE_Undermine OR SCIENCE_DWARVES SCIENCE_CloudBreak
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 25
  IsGrantable = Yes
End

;; -------------------------------------
;; Evil Sciences
;; -------------------------------------
; This is the shared Mordor and Wild Taint. Isengard has its own.
Science SCIENCE_Taint
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_MORDOR OR SCIENCE_WILD
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_Crebain
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES OR  SCIENCE_WILD OR SCIENCE_MORDOR
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 4
  IsGrantable = Yes
End

Science SCIENCE_CaveBats
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_WILD OR SCIENCE_MORDOR OR SCIENCE_ISENGARD OR SCIENCE_MEN OR SCIENCE_ELVES OR SCIENCE_DWARVES
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 4
  IsGrantable = Yes
End

Science SCIENCE_EyeofSauron
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_MORDOR
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_PalantirVision
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_WarChant
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD OR SCIENCE_WILD OR SCIENCE_MORDOR
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 5
  IsGrantable = Yes
End

Science SCIENCE_WildMenAllies
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD SCIENCE_Crebain OR SCIENCE_ISENGARD SCIENCE_WarChant OR SCIENCE_WILD SCIENCE_WarChant
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_Barricade
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_CaveBats OR SCIENCE_EVIL SCIENCE_WarChant OR SCIENCE_MORDOR SCIENCE_Taint
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

; Mordor's Taint and Isengard's Taint are available at different levels, thus
; their prices are different and so they need separate entries
Science SCIENCE_IsengardTaint
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD SCIENCE_WarChant OR SCIENCE_ISENGARD SCIENCE_PalantirVision
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_Scavenger
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_WILD SCIENCE_Taint OR SCIENCE_WILD SCIENCE_WarChant
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_Devastation
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_WildMenAllies OR SCIENCE_EVIL SCIENCE_Taint OR SCIENCE_ISENGARD SCIENCE_PalantirVision
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_UntamedAllegiance
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_Taint OR SCIENCE_EVIL SCIENCE_Scavenger OR SCIENCE_MORDOR SCIENCE_EyeofSauron OR SCIENCE_MORDOR SCIENCE_Taint OR SCIENCE_WILD SCIENCE_Taint OR SCIENCE_WILD SCIENCE_CaveBats
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_SpiderlingAllies
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_Scavenger OR SCIENCE_WILD SCIENCE_CaveBats
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_EvilEyeofSauron
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_UntamedAllegiance OR SCIENCE_EVIL SCIENCE_SpiderlingAllies
  SciencePurchasePointCost = 15
  SciencePurchasePointCostMP = 1
  IsGrantable = Yes
End

; Mordor's CallTheHorde and Wild's CallTheHorde are available at different levels, thus
; their prices are different and so they need separate entries
Science SCIENCE_CalltheHorde
  PrerequisiteSciences = SCIENCE_WILD SCIENCE_WarChant
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End
Science SCIENCE_EvilCalltheHorde
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_UntamedAllegiance OR SCIENCE_EVIL SCIENCE_SpiderlingAllies
  SciencePurchasePointCost = EVIL_RANK_3_COST
  IsGrantable = Yes
End

Science SCIENCE_Industry
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_UntamedAllegiance OR SCIENCE_EVIL SCIENCE_Devastation OR SCIENCE_MORDOR SCIENCE_EyeofSauron OR SCIENCE_MORDOR SCIENCE_WarChant OR SCIENCE_ISENGARD SCIENCE_Crebain
  SciencePurchasePointCost = EVIL_RANK_3_COST
  SciencePurchasePointCostMP = 10
  IsGrantable = Yes
End

Science SCIENCE_Darkness
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_CaveBats
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 12
  IsGrantable = Yes
End

Science SCIENCE_WatcherAlly
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_CaveBats OR SCIENCE_ISENGARD SCIENCE_Devastation OR SCIENCE_ISENGARD SCIENCE_IsengardTaint OR SCIENCE_WILD SCIENCE_UntamedAllegiance OR SCIENCE_WILD SCIENCE_SpiderlingAllies
  SciencePurchasePointCost = EVIL_RANK_2_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_ArrowVolleyEvil
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_Heal OR SCIENCE_CaveBats
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 8
  IsGrantable = Yes
End

Science SCIENCE_MordorCalltheHorde
  PrerequisiteSciences = SCIENCE_MORDOR SCIENCE_Industry OR SCIENCE_MORDOR SCIENCE_ArrowVolleyEvil
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_EvilBombard
  PrerequisiteSciences = SCIENCE_GOOD SCIENCE_CaveBats
  SciencePurchasePointCost = EVIL_RANK_1_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_AwakenWyrm
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_WatcherAlly OR SCIENCE_EVIL SCIENCE_Barricade OR SCIENCE_MORDOR SCIENCE_UntamedAllegiance OR SCIENCE_MORDOR SCIENCE_Barricade OR SCIENCE_WILD SCIENCE_Scavenger OR SCIENCE_WILD SCIENCE_WildMenAllies
  SciencePurchasePointCost = EVIL_RANK_3_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_FueltheFires
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_Darkness OR SCIENCE_EVIL SCIENCE_Devastation OR SCIENCE_ISENGARD SCIENCE_Industry OR SCIENCE_ISENGARD SCIENCE_WildMenAllies
  SciencePurchasePointCost = EVIL_RANK_3_COST
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_FreezingRain
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_ISENGARD SCIENCE_WildMenAllies OR SCIENCE_ISENGARD SCIENCE_IsengardTaint
  SciencePurchasePointCost = 1
  SciencePurchasePointCostMP = 15
  IsGrantable = Yes
End

Science SCIENCE_BalrogAlly
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_RainOfFire OR SCIENCE_Sunflare
  SciencePurchasePointCost = EVIL_RANK_4_COST
  SciencePurchasePointCostMP = 24
  IsGrantable = Yes
End

Science SCIENCE_RainOfFire
  PrerequisiteSciences = SCIENCE_GOOD OR SCIENCE_ArrowVolleyEvil OR SCIENCE_ArrowVolleyGood
  SciencePurchasePointCost = EVIL_RANK_4_COST
  SciencePurchasePointCostMP = 17
  IsGrantable = Yes
End

Science SCIENCE_DragonAlly
  PrerequisiteSciences = SCIENCE_EVIL SCIENCE_AwakenWyrm OR SCIENCE_EVIL SCIENCE_ArrowVolleyEvil OR SCIENCE_ISENGARD SCIENCE_FreezingRain OR SCIENCE_ISENGARD SCIENCE_WatcherAlly OR SCIENCE_WILD SCIENCE_AwakenWyrm OR SCIENCE_WILD SCIENCE_Darkness
  SciencePurchasePointCost = EVIL_RANK_4_COST
  SciencePurchasePointCostMP = 24
  IsGrantable = Yes
End

Science SCIENCE_DragonStrike
  PrerequisiteSciences = SCIENCE_EVIL OR SCIENCE_RainOfFire OR SCIENCE_Sunflare
  SciencePurchasePointCost = EVIL_RANK_4_COST
  SciencePurchasePointCostMP = 24
  IsGrantable = Yes
End


CommandSet MenSpellBookCommandSet_Override
	1 = Command_SpellBookCrebain
	2 = Command_SpellBookHeal
	3 = Command_SpellBookCaveBats
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookElvenGifts
	8 = Command_SpellBookFlood
	9 = Command_SpellBookRainOfFire
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookArmyoftheDead
	12 = Command_SpellBookBalrogAlly
End


CommandSet MenSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellCrebain
	2 = Command_PurchaseSpellHeal
	3 = Command_PurchaseSpellCaveBats
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellElvenGifts
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellRainOfFire
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellArmyoftheDead
	12 = Command_PurchaseSpellBalrogAlly
End

Object MenSpellBook_Override
	
	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 1.0 = 100% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

     CommandSet = MenSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject MenChildSpellBook_Override MenSpellBook_Override
     CommandSet = MenSpellBookCommandSet_Override
End

PlayerTemplate FactionMen
     PurchaseScienceCommandSetMP = MenSpellStoreCommandSet_Override
     SpellBookMp = MenSpellBook_Override
End


CommandSet ElvenSpellBookCommandSet_Override
	1 = Command_SpellBookCrebain
	2 = Command_SpellBookHeal
	3 = Command_SpellBookCaveBats
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookElvenGifts
	8 = Command_SpellBookFlood
	9 = Command_SpellBookRainOfFire
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookArmyoftheDead
	12 = Command_SpellBookBalrogAlly
End


CommandSet ElvenSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellCrebain
	2 = Command_PurchaseSpellHeal
	3 = Command_PurchaseSpellCaveBats
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellElvenGifts
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellRainOfFire
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellArmyoftheDead
	12 = Command_PurchaseSpellBalrogAlly
End

Object ElvenSpellBook_Override
	
	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 1.0 = 100% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


     CommandSet = ElvenSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject ElvenChildSpellBook_Override ElvenSpellBook_Override
     CommandSet = ElvenSpellBookCommandSet_Override
End

PlayerTemplate FactionElves
     PurchaseScienceCommandSetMP = ElvenSpellStoreCommandSet_Override
     SpellBookMp = ElvenSpellBook_Override
End


CommandSet DwarvenSpellBookCommandSet_Override
	1 = Command_SpellBookCrebain
	2 = Command_SpellBookHeal
	3 = Command_SpellBookCaveBats
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookElvenGifts
	8 = Command_SpellBookFlood
	9 = Command_SpellBookRainOfFire
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookArmyoftheDead
	12 = Command_SpellBookBalrogAlly
End


CommandSet DwarvenSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellCrebain
	2 = Command_PurchaseSpellHeal
	3 = Command_PurchaseSpellCaveBats
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellElvenGifts
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellRainOfFire
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellArmyoftheDead
	12 = Command_PurchaseSpellBalrogAlly
End

Object DwarvenSpellBook_Override
	
	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 1.0 = 100% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

     CommandSet = DwarvenSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject DwarvenChildSpellBook_Override DwarvenSpellBook_Override
     CommandSet = DwarvenSpellBookCommandSet_Override
End

PlayerTemplate FactionDwarves
     PurchaseScienceCommandSetMP = DwarvenSpellStoreCommandSet_Override
     SpellBookMp = DwarvenSpellBook_Override
End


CommandSet IsengardSpellBookCommandSet_Override
	1 = Command_SpellBookCrebain
	2 = Command_SpellBookHeal
	3 = Command_SpellBookCaveBats
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookElvenGifts
	8 = Command_SpellBookFlood
	9 = Command_SpellBookRainOfFire
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookArmyoftheDead
	12 = Command_SpellBookBalrogAlly
End


CommandSet IsengardSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellCrebain
	2 = Command_PurchaseSpellHeal
	3 = Command_PurchaseSpellCaveBats
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellElvenGifts
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellRainOfFire
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellArmyoftheDead
	12 = Command_PurchaseSpellBalrogAlly
End

Object IsengardSpellBook_Override
	
	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 1.0 = 100% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End


     CommandSet = IsengardSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject IsengardChildSpellBook_Override IsengardSpellBook_Override
     CommandSet = IsengardSpellBookCommandSet_Override
End

PlayerTemplate FactionIsengard
     PurchaseScienceCommandSetMP = IsengardSpellStoreCommandSet_Override
     SpellBookMp = IsengardSpellBook_Override
End

CommandSet MordorSpellBookCommandSet_Override
	1 = Command_SpellBookCrebain
	2 = Command_SpellBookHeal
	3 = Command_SpellBookCaveBats
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookElvenGifts
	8 = Command_SpellBookFlood
	9 = Command_SpellBookRainOfFire
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookArmyoftheDead
	12 = Command_SpellBookBalrogAlly
End


CommandSet MordorSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellCrebain
	2 = Command_PurchaseSpellHeal
	3 = Command_PurchaseSpellCaveBats
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellElvenGifts
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellRainOfFire
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellArmyoftheDead
	12 = Command_PurchaseSpellBalrogAlly
End

Object MordorSpellBook_Override
	
	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 1.0 = 100% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ElvenGifts
	Behavior = PlayerUpgradeSpecialPower	SpellBookElvenGifts_ModuleTag
		SpecialPowerTemplate		= SpellBookElvenGifts
		UpgradeName 				= Upgrade_ElvenGift
		UpdateModuleStartsAttack	= No
		AffectAllies				= No ; Should not try to affect ally units
		AvailableAtStart			= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

     CommandSet = MordorSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject MordorChildSpellBook_Override MordorSpellBook_Override
     CommandSet = MordorSpellBookCommandSet_Override
End

PlayerTemplate FactionMordor
     PurchaseScienceCommandSetMP = MordorSpellStoreCommandSet_Override
     SpellBookMp = MordorSpellBook_Override
End

CommandSet WildSpellBookCommandSet_Override
	1 = Command_SpellBookCrebain
	2 = Command_SpellBookHeal
	3 = Command_SpellBookCaveBats
	4 = Command_SpellBookBombard
	5 = Command_SpellBookArrowVolleyGood
	6 = Command_SpellBookArrowVolleyEvil
	7 = Command_SpellBookDarkness
	8 = Command_SpellBookFlood
	9 = Command_SpellBookRainOfFire
	10 = Command_SpellBookSunflare
	11 = Command_SpellBookArmyoftheDead
	12 = Command_SpellBookBalrogAlly
End


CommandSet WildSpellStoreCommandSet_Override
	1 = Command_PurchaseSpellCrebain
	2 = Command_PurchaseSpellHeal
	3 = Command_PurchaseSpellCaveBats
	4 = Command_PurchaseSpellBombard
	5 = Command_PurchaseSpellArrowVolleyGood
	6 = Command_PurchaseSpellArrowVolleyEvil
	7 = Command_PurchaseSpellDarkness
	8 = Command_PurchaseSpellFlood
	9 = Command_PurchaseSpellRainOfFire
	10 = Command_PurchaseSpellSunflare
	11 = Command_PurchaseSpellArmyoftheDead
	12 = Command_PurchaseSpellBalrogAlly
End

Object WildSpellBook_Override
	
	AddModule ModuleTag_Heal_Override
	Behavior = PlayerHealSpecialPower ModuleTag_Heal
		SpecialPowerTemplate  = SpellBookHeal
		HealAffects			  = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER
		HealAmount			  = 1.0	; 1.0 = 100% of maximum health
		HealRadius			  = SPELL_HEAL_RADIUS_UNIT_SCAN
		HealFX				  = FX_SpellHealUnitHealBuff		;FX_DefaultUnitHealBuff
		; To replenish hordes a bit
		HealOCL               = OCL_HealSpellHordeReplenishPing
		AvailableAtStart	  = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_Crebain_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCrebain
		SpecialPowerTemplate	= SpellBookCrebain
		OCL						= SUPERWEAPON_SpawnCrebain
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End	
	End

	AddModule ModuleTag_CaveBats_Override
	Behavior = OCLSpecialPower	ModuleTag_OCLCaveBats
		SpecialPowerTemplate	= SpellBookCaveBats
		OCL						= OCL_SpellBookCaveBats
		CreateLocation			= CREATE_AT_LOCATION
		AvailableAtStart		= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyEvil_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate = SpellBookArrowVolleyEvil
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End
	
	AddModule ModuleTag_RainOfFire_Override
	Behavior = OCLSpecialPower ModuleTag_RainOfFire
		SpecialPowerTemplate = SpellBookRainOfFire
		OCL                  = OCL_SpellBookRainOfFire
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArrowVolleyGood_Override
	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
		SpecialPowerTemplate = SpellBookArrowVolleyGood
		OCL                  = OCL_SpellBookArrowVolley
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Bombard_Override
	Behavior = OCLSpecialPower ModuleTag_Bombard
		SpecialPowerTemplate = SpellBookBombard
		OCL                  = OCL_SpellBookBombardSeed
		CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
		NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP 
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_ArmyoftheDead_Override
	Behavior = OCLSpecialPower ModuleTag_SummonDead
		SpecialPowerTemplate = SpellBookArmyoftheDead
		OCL                  = OCL_GondorArmyofTheDeadEgg
		TriggerFX			 = FX_SummonAOD
		CreateLocation		 = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_SummonBalrog_Override
	Behavior = OCLSpecialPower ModuleTag_SummonBalrog
		SpecialPowerTemplate = SpellBookBalrogAlly
		OCL                  = OCL_BalrogSummoning
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Flood_Override	
	Behavior = OCLSpecialPower ModuleTag_Flood
		SpecialPowerTemplate = SpellBookFlood
		OCL                  = OCL_SpellBookFlood
		CreateLocation       = CREATE_AT_LOCATION
		AvailableAtStart	 = No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule Module_Sunflare_Override
	Behavior = OCLSpecialPower ModuleTag_Sunflare
		SpecialPowerTemplate 			= SpellBookSunflare
		OCL                  			= OCL_SpecialPowerSunflare
		CreateLocation       			= CREATE_AT_LOCATION
		AvailableAtStart	 			= No
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
		ReEnableAntiCategory			= Yes
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_SUNFLARE_DURATION
		ChangeWeather					= SUNNY
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

	AddModule ModuleTag_Darkness_Override
 	Behavior   = DarknessSpecialPower ModuleTag_Darkness
		SpecialPowerTemplate			= SpellBookDarkness
		AttributeModifier				= SpellBookDarkness
		AttributeModifierAffects		= ANY +INFANTRY +CAVALRY +MONSTER -HERO -HORDE ALLIES
		AttributeModifierWeatherBased	= Yes			
		WeatherDuration					= SPELL_DARKNESS_DURATION
		ChangeWeather					= CLOUDY
		AvailableAtStart				= No
		RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
		RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
	End
	End

     CommandSet = WildSpellBookCommandSet_Override
     RadarPriority = NOT_ON_RADAR
     KindOf = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject WildChildSpellBook_Override WildSpellBook_Override
     CommandSet = WildSpellBookCommandSet_Override
End

PlayerTemplate FactionWild
     PurchaseScienceCommandSetMP = WildSpellStoreCommandSet_Override
     SpellBookMp = WildSpellBook_Override
End


SpecialPower SpellBookHeal
	InitiateAtLocationSound 	= SpellHeal
	Enum                		= SPECIAL_SPELL_BOOK_HEAL
	Flags				= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	ReloadTime         		= 120000
	RequiredSciences     		= SCIENCE_Heal
	RadiusCursorRadius  		= SPELL_HEAL_RADIUS_CURSOR	
End


SpecialPower SpellBookCrebain
	Enum			= SPECIAL_SPELL_BOOK_CREBAIN
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	ReloadTime		= 90000
	RadiusCursorRadius	= 75.0
	RequiredSciences		= SCIENCE_Crebain
	InitiateAtLocationSound	= SpellSummonCrebain
End


SpecialPower SpellBookCaveBats
	Enum			= SPECIAL_SPELL_BOOK_CAVE_BATS
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	ReloadTime		= 90000
	RadiusCursorRadius	= 75.0
	RequiredSciences		= SCIENCE_CaveBats
	InitiateAtLocationSound	= SpellCaveBats
End


SpecialPower SpellBookArrowVolleyGood
	Enum				= SPECIAL_SPELL_BOOK_ARROW_VOLLEY_GOOD
	RadiusCursorRadius		= 95
	RequiredSciences			= SCIENCE_ArrowVolleyGood
	ReloadTime			= 90000
	InitiateAtLocationSound		= SpellArrowVolleyMS
	ViewObjectDuration		= 10000
	ViewObjectRange			= 200
	Flags					= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookArrowVolleyEvil
	Enum				= SPECIAL_SPELL_BOOK_ARROW_VOLLEY_EVIL
	RadiusCursorRadius		= 95
	RequiredSciences				= SCIENCE_ArrowVolleyEvil
	ReloadTime			= 90000
	InitiateAtLocationSound		= SpellArrowVolleyMS
	ViewObjectDuration		= 10000
	ViewObjectRange			= 200
	Flags					= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookBombard
	Enum					= SPECIAL_SPELL_BOOK_BOMBARD
	Flags					= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	RadiusCursorRadius		= 200
	RequiredSciences  		= SCIENCE_Bombard
	ReloadTime       		= 150000
	InitiateAtLocationSound	= SpellBarrageStartMS
End


SpecialPower SpellBookArmyoftheDead
	Enum			= SPECIAL_SPELL_BOOK_ARMY_OF_THE_DEAD
	RequiredSciences		= SCIENCE_ArmyoftheDead
	ReloadTime      	= 900000
	InitiateAtLocationSound = ArmyDeadEnterMono		;ArmyDeadEnterStereo	
	RadiusCursorRadius	= 200.0  
	ViewObjectDuration	= 5000
	ViewObjectRange		= 150
	Flags					= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter	= NO_SUMMON_UNDERMINE_NEAR_OBJECT_FILTER
	ForbiddenObjectRange	= 200.0
End


SpecialPower SpellBookEarthquake
	Enum					= SPECIAL_SPELL_BOOK_EARTHQUAKE
	RadiusCursorRadius		= 300
	RequiredSciences		= SCIENCE_Earthquake
	ReloadTime				= 540000
	InitiateAtLocationSound	= SpellEarthquakeMS
	ViewObjectDuration		= 10000
	ViewObjectRange			= 200
	Flags					= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookFlood
	Enum			= SPECIAL_SPELL_BOOK_FLOOD
	RadiusCursorRadius	= 175
	RequiredSciences		= SCIENCE_Flood
	ReloadTime		= 420000
	ViewObjectDuration 	= 10000
	ViewObjectRange	 	= 200
	InitiateAtLocationSound	= SpellFloodMS
	Flags					= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookSunflare
	Enum			= SPECIAL_SPELL_BOOK_SUNFLARE
	Flags			= WATER_OK RESPECT_RECHARGE_TIME_DISCOUNT
	RadiusCursorRadius	= SPELL_SUNFLARE_EFFECT_RADIUS
	RequiredSciences		= SCIENCE_Sunflare
	ReloadTime		= 420000
	ViewObjectDuration	= SPELL_SUNFLARE_VIEW_OBJECT_DURATION
	ViewObjectRange		= SPELL_SUNFLARE_VIEW_OBJECT_RANGE
	InitiateAtLocationSound = SpellSunflareMS
End

SpecialPower SpellBookRainOfFire
	Enum			= SPECIAL_SPELL_BOOK_RAIN_OF_FIRE
	RadiusCursorRadius	= 100
	RequiredSciences		= SCIENCE_RainOfFire
	ReloadTime		= 420000
	InitiateSound = SpellRainOfFireMS
	ViewObjectDuration = 10000
	ViewObjectRange = 200
	Flags			= RESPECT_RECHARGE_TIME_DISCOUNT
End


SpecialPower SpellBookBalrogAlly
	Enum						= SPECIAL_SPELL_BOOK_BALROG_ALLY
	ReloadTime					= 900000
	RadiusCursorRadius			= 75.0 ; Match the radius in FXList SummonBalrogStart
	RequiredSciences				= SCIENCE_BalrogAlly
	ViewObjectDuration = 5000
	ViewObjectRange = 100
	Flags					= NO_FORBIDDEN_OBJECTS RESPECT_RECHARGE_TIME_DISCOUNT
	ForbiddenObjectFilter	= NO_SUMMON_NEAR_OBJECT_FILTER
	ForbiddenObjectRange	= 75.0
End

;-------------------------------------------SPIDERLING DOT----------------------------------------
Weapon WildSpiderlingVenomMandibles				; BALANCE Wild Spiderling Weapon 
  LeechRangeWeapon      = Yes
  AttackRange           = 25.0
  MeleeWeapon           = Yes
  DelayBetweenShots     = 1666				; time between shots, msec
  PreAttackDelay        = 900				; 300 is mace swing delay time before contact with target.
  PreAttackType         = PER_SHOT 			; Do the delay each time we attack
  FireFX                = FX_SpiderStabHit
  FiringDuration        = 766				; Duration of the mace swing 
  RequireFollowThru		= Yes
  
DOTNugget                        ; A basic Nugget that just does damage
	Damage        = 75
	AcceptDamageAdd = No
	Radius        = 0.0
	DelayTime     = 0
	DamageType    = POISON
	DamageFXType  = POISON
	DeathType     = NORMAL
	DamageInterval = 1000
	DamageDuration = 30000
	SpecialObjectFilter = AFFECTED_BY_POISON_OBJECTFILTER 
End

  
  DamageNugget						; A basic Nugget that just does damage
    Damage        = DWARVEN_ZERKER_AXE
    Radius        = 0.0
    DelayTime     = 0
    DamageType    = CAVALRY
    DamageFXType  = SWORD_SLASH
    DeathType     = NORMAL
    FlankingBonus = 50%
    DamageScalar  = 50% NONE +STRUCTURE		; Balance: Spiderlings are fast and versatile against units so must not be so good against structures
  End
End

;--------OMG NO KNOCKBACKDMG FOR ZERKER, NERF NERF NERF------
Weapon DwarvenZerkerAxe
  LeechRangeWeapon      = Yes
  AttackRange           = STANDARD_MELEE_ATTACK_RANGE
  MeleeWeapon           = Yes
  DelayBetweenShots     = DWARVEN_ZERKER_AXE_DELAYBETWEENSHOTS  ; Bad Things happen if delay between shots is less than Preattack+Firing times.  You are ready to fire before you are done firing.
  PreAttackDelay        = DWARVEN_ZERKER_AXE_PREATTACKDELAY             ; 400 is sword swing delay time before contact with target.
  PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
  FireFX                = FX_GondorSwordHit
  FireFlankFX		= FX_Flanking
  FiringDuration        = DWARVEN_ZERKER_AXE_FIRINGDURATION    ; Duration of the sword swing

	; base damage against everything, siegehammer or forgedblades not present
	DamageNugget
		Damage					= DWARVEN_ZERKER_AXE
		Radius					= 0.0
		DelayTime				= 0
		DamageType				= HERO
		DamageFXType			= SWORD_SLASH
		DeathType				= NORMAL
		FlankingBonus			= 50%
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force 
		HeroResist	  = 0.99
		ShockWaveAmount   = 25.0
		ShockWaveRadius   = 10.0
		ShockWaveTaperOff = 0.75
	    	ShockWaveZMult    = 1.2
	End
  
End

;---------------------------------------------
Weapon DwarvenZealotBoomAxeWarhead
  ProjectileCollidesWith = ENEMIES NEUTRAL STRUCTURES WALLS 
  RadiusDamageAffects = ENEMIES NEUTRALS NOT_SIMILAR
  FireFX                = FX_GondorSwordHit
  HitStoredTarget = Yes	; Always hits initial target.
  DamageNugget
    Damage        = 30
    DamageScalar  = 10% NONE +STRUCTURE +MordorCatapult +IsengardBallista +GondorTrebuchet +GondorTrebuchetWall 
    Radius        = 30.0	; HitStoredTarget means we hurt the person we launched at.  And nobody else.  So a miss hurts nobody.
    DelayTime     = 0
    DamageType    = HERO
    DamageFXType  = SWORD_SLASH
    DeathType     = NORMAL
  End
    MetaImpactNugget                    ; A Nugget that throws things back with force
	HeroResist			= .99
    ShockWaveAmount   = 50.0
    ShockWaveRadius   = 30.0
    ShockWaveTaperOff = 0.5
    ShockWaveZMult    = 1.20
  End

End

;---------------------------------------------------------------
Weapon BarrowWightTouch ;BALANCE BarrowWightTouch
	RadiusDamageAffects	= ENEMIES NEUTRALS
	LeechRangeWeapon      = Yes
	AttackRange           = 20.0
	MeleeWeapon           = Yes
	DelayBetweenShots     = BARROWWIGHT_SWORD_DELAYBETWEENSHOTS  ; Bad Things happen if delay between shots is less than Preattack+Firing times.  You are ready to fire before you are done firing.
	PreAttackDelay        = BARROWWIGHT_SWORD_PREATTACKDELAY             ; 400 is sword swing delay time before contact with target.
	PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
	FireFX                = FX_BarrowWightHit	;FX_GondorSwordHit
	FiringDuration        = BARROWWIGHT_SWORD_FIRINGDURATION    ; Duration of the sword swing

	DamageNugget                        ; A basic Nugget that just does damage
		Damage        		= BARROWWIGHT_SWORD
		Radius        		= 10.0
		DelayTime     		= 0
		DamageType    		= MAGIC
		DamageFXType  		= SWORD_SLASH
		DeathType     		= NORMAL
		DrainLife     		= No
		DrainLifeMultiplier	= 0.5
	End
	AttributeModifierNugget
		AttributeModifier	= BarrowWightTouchDebuff
		AntiCategories		= LEADERSHIP BUFF
		SpecialObjectFilter = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End
End

;-------------------------------------------
Weapon KarshWightTouch ;BALANCE BarrowWightTouch
	RadiusDamageAffects	= ENEMIES NEUTRALS
	LeechRangeWeapon      = Yes
	AttackRange           = 20.0
	MeleeWeapon           = Yes
	DelayBetweenShots     = KARSH_SWORD_DELAYBETWEENSHOTS  ; Bad Things happen if delay between shots is less than Preattack+Firing times.  You are ready to fire before you are done firing.
	PreAttackDelay        = KARSH_SWORD_PREATTACKDELAY             ; 400 is sword swing delay time before contact with target.
	PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
	FireFX                = FX_BarrowWightHit	;FX_GondorSwordHit
	FiringDuration        = KARSH_SWORD_FIRINGDURATION    ; Duration of the sword swing

	DOTNugget                        // A basic Nugget that just does damage
		Damage        		= KARSH_SWORD_DAMAGE
		AcceptDamageAdd 	= Yes
		Radius        		= 1.0
		DelayTime     		= 0
		DamageType    		= HERO
		DamageFXType  		= SWORD_SLASH
		DeathType     		= NORMAL
		DamageInterval 		= 500
		DamageDuration 		= 1500
		DrainLife     		= No
		DrainLifeMultiplier	= 0.5
	End
	DamageNugget                        ; A basic Nugget that just does damage
		Damage        		= KARSH_SWORD_DAMAGE
		Radius        		= 10.0
		DelayTime     		= 0
		DamageType    		= MAGIC
		DamageFXType  		= SWORD_SLASH
		DeathType     		= NORMAL
		DrainLife     		= No
		DrainLifeMultiplier	= 0.5
	End
	AttributeModifierNugget
		AttributeModifier	= BarrowWightTouchDebuff
		AntiCategories		= LEADERSHIP BUFF
		SpecialObjectFilter = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End
End
;---------------------------------------------------------------
SpecialPower SpecialAbilityFireDrakeInferno
	Enum			= SPECIAL_BALROG_BREATH
	ReloadTime		= 10000
	RadiusCursorRadius = 80.0
End

;---------------------------------------------------------------
Weapon IsengardBerserkerSword   ; BALANCE Berserker Weapon
  LeechRangeWeapon      = Yes
  AttackRange           = STANDARD_MELEE_ATTACK_RANGE
  MeleeWeapon           = Yes
  DelayBetweenShots     = ISENGARD_BERSERKER_DELAYBETWEENSHOTS            ; time between shots, msec
  PreAttackDelay        = ISENGARD_BERSERKER_PREATTACKDELAY             ; 433 is natural time of the stabbing animation.
  PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
  FiringDuration        = ISENGARD_BERSERKER_FIRINGDURATION            ; min 600 for anim
  FireFX                = FX_GondorSwordHit
  

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        = ISENGARD_BERSERKER_DAMAGE
    Radius        = 40.0
    DelayTime     = 0
    DamageType    = HERO
    DamageFXType  = ELECTRIC
    DeathType     = EXPLODED
    DamageArc	  = ISENGARD_BERSERKER_ARC
  End	

;  MetaImpactNugget      ; A Nugget that throws things back with force
;    ShockWaveAmount   = 20.0
;    ShockWaveRadius   = 10.0
;    ShockWaveTaperOff = 1.0
;    ShockWaveArc      = 90
;    HeroResist		  = 0.90		; 90% resistance to heroes
;  End


End
;--------------------------------------------------------
;>>>>>>>>>>>>>>>>>>FXParticlesystems>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;++++++++++++++++++++++++++++++++++++Adunaphel++++++++++++++++++++++++++++++++++++++++++++
FXParticleSystem BlackBlade
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXsmokeplume.tga
    Lifetime = 10 10
    SortLevel = 1
    Size = 5 10
    BurstCount = 5 5
    InitialDelay = 5 5
    IsParticleUpTowardsEmitter = Yes
  End
  Color = DefaultColor
    Color2 = R:10 G:10 B:10 5
    Color3 = R:15 G:15 B:15 20
    Color3 = R:5 G:5 B:5 30
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.5 0.5 0
    Alpha2 = 0 0 15
  End
  Update = DefaultUpdate
    SizeRate = -0.25 -0.25
    SizeRateDamping = 1 1
    AngleZ = -7 7
    AngularDamping = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    EndPoint = X:0 Y:0 Z:25
  End
  Draw = DefaultDraw
  End
End
;-----------------------------------------------------------------------------------------
FXParticleSystem RedZap
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXLightning01.tga
    Lifetime = 15 15
    SortLevel = 1
    Size = 20 30
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color2 = R:200 G:60 B:30 5
    Color3 = R:0 G:0 B:0 15
    Color4 = R:210 G:120 B:120 0
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 1 1
    AngleZ = 0 7
    AngularRateZ = -0.1 0.1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = -0.01
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = SphereEmissionVolume
    Radius = 10
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem RedZapHit
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXLightning01.tga
    Lifetime = 40 40
    SystemLifetime = 10
    Size = 20 20
    BurstDelay = 1 1
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:225 G:100 B:80 0
    Color2 = R:198 G:79 B:63 15
    Color3 = R:0 G:0 B:0 25
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 0.92 0.92
    AngleZ = -5 5
    AngularDamping = 0.8 0.85
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.5 0.5
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = SphereEmissionVolume
    Radius = 10
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem RedZapBang
  System
    Priority = ALWAYS_RENDER
    ParticleName = EXLightning01.tga
    Lifetime = 65 65
    SystemLifetime = 10
    Size = 120 120
    BurstDelay = 1 1
    BurstCount = 1 1
  End
  Color = DefaultColor
    Color1 = R:225 G:100 B:80 0
    Color2 = R:198 G:79 B:63 15
    Color3 = R:0 G:0 B:0 25
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 0.92 0.92
    AngleZ = -5 5
    AngularDamping = 0.8 0.85
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.5 0.5
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = SphereEmissionVolume
    Radius = 10
  End
  Draw = DefaultDraw
  End
End
;--------------------------------------------------
FXParticleSystem Power7th
  System
    Priority = VERY_LOW_OR_ABOVE
    ParticleName = EXLnzflar6.tga
    Lifetime = 50 50
    SystemLifetime = 10
    Size = 53 53
    BurstCount = 1 1
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color1 = R:255 G:86 B:95 0
    Color2 = R:0 G:0 B:0 25
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = PointEmissionVolume
    IsHollow = Yes
  End
  Draw = DefaultDraw
  End
End

;---------------------------------------------
FXParticleSystem GimliLeapLand1
  System
    Priority = VERY_LOW_OR_ABOVE
    Shader = ALPHA
    ParticleName = EXsmokeplume.tga
    Lifetime = 80 80
    SystemLifetime = 1
    SortLevel = 1
    Size = 18 23
    BurstCount = 40 40
  End
  Color = DefaultColor
    Color1 = R:1 G:1 B:1 0
    Color2 = R:1 G:1 B:1 80
    ColorScale = -20 20
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.8 1 0
    Alpha2 = -0.2 -0.2 80
  End
  Update = DefaultUpdate
    SizeRate = 1 1
    SizeRateDamping = 0.8 0.95
    AngleZ = 0 7
    AngularRateZ = -0.01 0.01
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.8 0.85
    DriftVelocity = X:0 Y:0 Z:0.1
  End
  EmissionVelocity = CylindricalEmissionVelocity
    Radial = 10 15
  End
  EmissionVolume = PointEmissionVolume
  End
  Draw = DefaultDraw
  End
End
;------------------------------------------
FXParticleSystem BlackEffect
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXFireScroll3.tga  ;EXFireScroll2.tga
    Lifetime = 35 35
    SystemLifetime = 1
    SortLevel = 1
    Size = 5 5
    BurstCount = 3 5
  End
  Color = DefaultColor
    Color2 = R:20 G:20 B:20 5
    Color3 = R:20 G:20 B:20 15
    Color4 = R:0 G:0 B:0 25
;    Color2 = R:185 G:106 B:40 5
;    Color3 = R:200 G:95 B:38 15
;    Color4 = R:200 G:90 B:32 25
  End
  Alpha = DefaultAlpha
    Alpha2 = -1.5 -1.7 5
    Alpha3 = -1.2 -1.5 15
    Alpha4 = -1.2 -1.5 25
  End
  Update = DefaultUpdate
    SizeRate = 3 5
    SizeRateDamping = 1 1
    AngleZ = 0 7
    AngularRateZ = -0.1 0.1
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    Gravity = -0.01
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = SphereEmissionVolume
    Radius = 5
  End
  Draw = DefaultDraw
  End
End
;-------------------------------------------------
FXParticleSystem BlackArrowTrail1
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXsmokeplume.tga
    Lifetime = 15 15
    SortLevel = 1
    Size = 25 25
    BurstCount = 2 2
    IsGroundAligned = Yes
    IsParticleUpTowardsEmitter = Yes
  End
  Color = DefaultColor
    Color1 = R:81 G:58 B:28 0
    Color2 = R:0 G:0 B:0 10
  End
  Alpha = DefaultAlpha
    Alpha1 = 0.25 0.25 0
    Alpha2 = 0 0 15
  End
  Update = DefaultUpdate
    SizeRate = -0.25 -0.25
    SizeRateDamping = 1 1
    AngleZ = 0 2
    AngularDamping = 1 1
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OrthoEmissionVelocity
  End
  EmissionVolume = LineEmissionVolume
    StartPoint = X:-5 Y:0 Z:0
    EndPoint = X:-5 Y:0 Z:0
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem BlackDestruction
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXFireScroll3.tga
    Lifetime = 100 100
    SystemLifetime = 50
    Size = 420 420
    StartSizeRate = 1 1
    BurstDelay = 2 2
    BurstCount = 1 1
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color2 = R:55 G:55 B:55 15
  End
  Alpha = DefaultAlpha
    Alpha2 = 0.95 0.8 7
    Alpha3 = -0.2 0 25
  End
  Update = DefaultUpdate
    SizeRate = -22 -22
    SizeRateDamping = 1.05 1.05
    AngleZ = -180 180
    AngularDamping = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 0.75 0.8
  End
  EmissionVelocity = OutwardEmissionVelocity
    Speed = -12 -12
    OtherSpeed = -10 -10
  End
  EmissionVolume = LineEmissionVolume
    IsHollow = Yes
    StartPoint = X:0 Y:0 Z:-8
    EndPoint = X:0 Y:0 Z:10
  End
  Draw = DefaultDraw
  End
End

FXParticleSystem BlackSphere
  System
    Priority = ALWAYS_RENDER
    Shader = ALPHA
    ParticleName = EXWhirlpoolA.tga
    Lifetime = 80 80
    SystemLifetime = 50
    Size = 90 90
    BurstDelay = 2 2
    BurstCount = 1 1
    InitialDelay = 0 0
    IsGroundAligned = Yes
  End
  Color = DefaultColor
    Color1 = R:1 G:1 B:1 0
    Color2 = R:1 G:1 B:1 0
    Color3 = R:1 G:1 B:1 0
  End
  Alpha = DefaultAlpha
    Alpha2 = 2.0 2.0 40
    Alpha3 = 2.0 2.0 100
  End
  Update = DefaultUpdate
    SizeRate = -1 -1.5
    SizeRateDamping = 1 1
    AngleZ = 0 7
    AngularRateZ = -0.025 -0.025
    AngularDamping = 1.025 1.025
    AngularDampingXY = 1 1
  End
  Physics = DefaultPhysics
    VelocityDamping = 1 1
  End
  EmissionVelocity = OutwardEmissionVelocity
  End
  EmissionVolume = CylinderEmissionVolume
    Offset = X:0 Y:0 Z:12.0
  End
  Draw = DefaultDraw
  End
End

;<<<<<<<<<<<<<<<<<<<<<<<<<<<FXLists<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
;---------------adunaphel-----------------------
FXList FX_BlackBoom

  ParticleSystem
    Name = GimliLeapLand1
    OrientToObject = Yes
    Offset = X:0.0 Y:0.0 Z:10
  End

  Sound
    Name = ImpactRock
  End
End

FXList FX_BlackBladeDamage

  ParticleSystem
    Name = BlackEffect
    Offset = X:0.0 Y:0.0 Z:10
  End

  TintDrawable
	Color				= R:-60 G:-60 B:-60
	PreColorTime		= 10
	PostColorTime		= 10
	SustainedColorTime	= 500
	Frequency			= 0
	Amplitude			= 0
  End
End

FXList FX_RedZapBang
  ParticleSystem
    Name = RedZapBang
    Offset = X:0.0 Y:0.0 Z:10
  End
End

FXList FX_RedZapHit
  ParticleSystem
    Name = RedZapHit
    Offset = X:0.0 Y:0.0 Z:10
  End
  Sound
    Name = SarumanLightningMS
  End
End

FXList FX_Power7th
  ParticleSystem
    Name = Power7th
    Offset = X:0.0 Y:0.0 Z:10
  End
  Sound
    Name = SarumanLightningMS
  End
End

FXList FX_BlackDestruction
  ParticleSystem
    Name = BlackDestruction
    Offset = X:0.0 Y:0.0 Z:25.0
  End
  ParticleSystem
    Name = BlackSphere
    Offset = X:0.0 Y:0.0 Z:25.0
  End
  Sound
    Name = GandalfBlastWeapon
  End
End

;>>>>>>>>>>>>>>>>>>>>>>>>>>>dammagefx<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
DamageFX NormalDamageFX
  ThrottleTime = DEFAULT 60

  AmountForMajorFX  = DEFAULT  0.0
  MajorFX           = DEFAULT  FX_NONE

  AmountForMajorFX  = GOOD_ARROW_PIERCE 0.0
  MajorFX           = GOOD_ARROW_PIERCE FX_GoodArrowHit

  AmountForMajorFX  = EVIL_ARROW_PIERCE 0.0
  MajorFX           = EVIL_ARROW_PIERCE FX_EvilArrowHit

  AmountForMajorFX  = SWORD_SLASH  0.0
  MajorFX           = SWORD_SLASH  FX_NONE
  
  AmountForMajorFX	= WITCH_KING_MORGUL_BLADE  0.0
  MajorFX			= WITCH_KING_MORGUL_BLADE  FX_BlackBladeDamage
  
  AmountForMajorFX	= REFLECTED  0.0
  MajorFX			= REFLECTED  FX_WitchKingCursed
  
  AmountForMajorFX  = MAGIC  0.0
  MajorFX           = MAGIC  FX_MagicHit

  AmountForMajorFX  = BALROG_SWORD  0.0
  MajorFX           = BALROG_SWORD  FX_BalrogWeaponHit

  AmountForMajorFX  = BALROG_WHIP  0.0
  MajorFX           = BALROG_WHIP   FX_BalrogWhipHit
  
  AmountForMajorFX  = ELECTRIC  0.0
  MajorFX           = ELECTRIC   FX_ElectricityHit

  AmountForMajorFX  = BOLT  0.0
 MajorFX           = BOLT FX_BoltHit

  AmountForMajorFX  = TORNADO 0.0
  MajorFX           = TORNADO   FX_HawkStrikeHit
  
  AmountForMajorFX  = GIMLI_LEAP 0.0
  MajorFX           = GIMLI_LEAP   FX_GimliLeapNoVoice
  
  AmountForMajorFX	= FLOOD_HORSE 1.0
  MajorFX			= FLOOD_HORSE FX_RedZapHit
  
  AmountForMajorFX  = POISON  0.0
  MajorFX           = POISON  FX_PoisonDOT
  
  AmountForMajorFX  = FIRE3 0.0
  MajorFX           = FIRE3   FX_LurtzDeathBlow
  
End

;+++++++++++++++++++++++++++Adunaphel+++++++++++++++++++++++++++++++++++
Weapon FaramirBow       
    AttackRange			= FARAMIR_BOW_RANGE
    
    RangeBonusMinHeight	= 7
	RangeBonus		= 1
	RangeBonusPerFoot	= #MULTIPLY( FARAMIR_BOW_RANGE .01 )
    				
    LeechRangeWeapon    = Yes
    WeaponSpeed			= 752         ; dist/sec 
    MinWeaponSpeed		= 722
    MaxWeaponSpeed		= 800      ; dist/sec Upper limit on scaling, when attacking past nominal "max" range
    FireFX				= FX_RohanArcherBowWeapon
    ScaleWeaponSpeed	= Yes ; Used for lob weapons, scales speed proportional to range
    HitPercentage		= 100     ;When this weapon is used it will hit exactly 75% of the time.
    ScatterRadius		= 0.0     ;When this weapon misses it can randomly miss by as much as this distance.
   
    DelayBetweenShots	= 200        ; time between shots, msec
    PreAttackDelay		= 200            ; 1467 is the prep time for archer.
    PreAttackType		= PER_POSITION
    FiringDuration		= 210  ; Duration of the archer firing shot is 500ms.
 
    ClipSize			= 1
    AutoReloadsClip		= Yes
    AutoReloadWhenIdle	= 1	
    ClipReloadTime		= Min:115 Max:115
    ContinuousFireOne	= 0
    ContinuousFireCoast	= 115
   	
    AntiAirborneVehicle	= Yes
    AntiAirborneMonster	= Yes  
    
    CanFireWhileMoving		= Yes
   
    ProjectileNugget                    ; Default arrow
       ProjectileTemplateName    = GoodFactionArrow
       WarheadTemplateName       = FaramirBowWarhead
    End
End
;------------------------------------------------------------------------------
Weapon FaramirSword
  LeechRangeWeapon      = Yes
  AttackRange           = STANDARD_MELEE_ATTACK_RANGE
  MeleeWeapon           = Yes
  FireFX                = FX_GondorSwordHit
  DelayBetweenShots     = FARAMIR_DELAYBETWEENSHOTS 			; time between shots, msec
  PreAttackDelay        = FARAMIR_PREATTACKDELAY 	; 400 is sword swing delay time before contact with target.
  PreAttackType         = PER_SHOT ; Do the delay each time we attack a new target
  FiringDuration        = FARAMIR_FIRINGDURATION 	; Duration of the sword swing

  RadiusDamageAffects = ENEMIES NOT_SIMILAR

  DamageNugget                        ; A basic Nugget that just does damage
    Damage        = 375
    Radius        = 35.0
    DelayTime     = 0
    DamageType    = HERO
    DamageFXType  = WITCH_KING_MORGUL_BLADE
    DeathType     = EXPLODED
  End
End
;------------------------------------------------------------------------------
Weapon RohanGimliAxeThrown
	AttackRange				= FARAMIR_WOUNDING_ARROW_RANGE
	LeechRangeWeapon			= Yes
	WeaponSpeed				= 100				 ; dist/sec 
	MinWeaponSpeed			= 100
	MaxWeaponSpeed			= 240			; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	ScaleWeaponSpeed			= Yes ; Used for lob weapons, scales speed proportional to range
	HitPercentage			= 100		 ;When this weapon is used it will hit exactly 75% of the time.
	ScatterRadius			= 0.0		 ;When this weapon misses it can randomly miss by as much as this distance.
	DelayBetweenShots			= 15000									; time between shots, msec
	PreAttackDelay			= 1										; we want isntant
	PreAttackType			= PER_POSITION
	FiringDuration			= 1										; Duration of the archer firing shot is 500ms.
	ClipSize				= 1
	AutoReloadsClip			= Yes
	AutoReloadWhenIdle		= 1	
	ClipReloadTime			= Min:FARAMIR_BOW_RELOADTIME_MIN Max:FARAMIR_BOW_RELOADTIME_MAX
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	PreferredTargetBone		= B_LLLID ; Likes to shoot things in their left eye.

	ProjectileNugget
		ProjectileTemplateName = GimliAxeProjectile
		WarheadTemplateName = RohanGimliAxeThrownWarhead
	End
End

;-------------------------------------------------------------------------------------
Weapon BlackBoom 
	RadiusDamageAffects = ENEMIES NOT_SIMILAR
	FireFX                = FX_BlackBoom

	DamageNugget                        ; A basic Nugget that just does damage
		Damage			= 320
		Radius			= 40.0
		DamageType		= Hero
		DamageFXType	= WITCH_KING_MORGUL_BLADE
		DeathType		= EXPLODED
		DamageScalar  = 80% NONE +MordorBalrog +HERO
		DamageSpeed		= 700.0 ; must match the ShockWaveSpeed below
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .75
		ShockWaveAmount   = 30.0
		ShockWaveRadius   = 40.0
		ShockWaveTaperOff = 1.0
		ShockWaveZMult    = 1.000
		ShockWaveSpeed	  = 700.0 
	End
End
;-------------------------------------------------------------------------------------------
Weapon RedZapBang
	RadiusDamageAffects = ENEMIES NOT_SIMILAR
	FireFX                = FX_RedZapBang

	DamageNugget                        ; A basic Nugget that just does damage
		Damage			= 375
		Radius			= 70.0
		DamageType		= Hero
		DamageFXType	= FLOOD_HORSE
		DeathType		= EXPLODED
		DamageSpeed		= 700.0 ; must match the ShockWaveSpeed below
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .75
		ShockWaveAmount   = 30.0
		ShockWaveRadius   = 70.0
		ShockWaveTaperOff = 1.0
		ShockWaveZMult    = 1.000
		ShockWaveSpeed	  = 700.0 
	End
End
;---------------------------------------------------------------------------------------------
Weapon Power7th
	IdleAfterFiringDelay = 0
	RadiusDamageAffects = ENEMIES NOT_SIMILAR
	DelayBetweenShots = 5000               ; time between shots, msec
	PreAttackDelay        = 2600
	PreAttackType         = PER_ATTACK ; Do the delay each time we attack a new target
	FireFX                = FX_Power7th
	FiringDuration      = 1400
	DamageNugget                        ; A basic Nugget that just does damage
		Damage			= 1400
		Radius			= 110.0
		DamageType		= MAGIC
		DamageFXType	= FLOOD_HORSE
		DeathType		= EXPLODED
		DamageSpeed		= 700.0 ; must match the ShockWaveSpeed below
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
		HeroResist			= 1.0
		ShockWaveAmount   = 60.0
		ShockWaveRadius   = 110.0
		ShockWaveTaperOff = 1.0
		ShockWaveZMult    = 1.000
		ShockWaveSpeed	  = 700.0 
	End
End
;//-----------------------------------
Weapon DwarvenMenOfDaleBlackArrows
	AttackRange				= FARAMIR_WOUNDING_ARROW_RANGE
	LeechRangeWeapon			= Yes
	WeaponSpeed				= 150				 ; dist/sec 
	MinWeaponSpeed			= 100
	MaxWeaponSpeed			= 240			; dist/sec Upper limit on scaling, when attacking past nominal "max" range
	ScaleWeaponSpeed			= Yes ; Used for lob weapons, scales speed proportional to range
	HitPercentage			= 100		 ;When this weapon is used it will hit exactly 75% of the time.
	ScatterRadius			= 0.0		 ;When this weapon misses it can randomly miss by as much as this distance.
	DelayBetweenShots			= 15000									; time between shots, msec
	PreAttackDelay			= 1										; we want isntant
	PreAttackType			= PER_POSITION
	FiringDuration			= 1										; Duration of the archer firing shot is 500ms.
	ClipSize				= 1
	AutoReloadsClip			= Yes
	AutoReloadWhenIdle		= 1	
	ClipReloadTime			= Min:FARAMIR_BOW_RELOADTIME_MIN Max:FARAMIR_BOW_RELOADTIME_MAX
	AntiAirborneVehicle		= Yes
	AntiAirborneMonster		= Yes
	PreferredTargetBone		= B_LLLID ; Likes to shoot things in their left eye.

	ProjectileNugget	; Default arrow
		ProjectileTemplateName  = BlackArrowsProjectile
		WarheadTemplateName     = DwarvenMenOfDaleBlackArrowWarhead
	End
End

;----------------------------------------------------------------------------------------------
Weapon BlackDestruction
	RadiusDamageAffects = ENEMIES NOT_SIMILAR
      	FireFX					= FX_BlackDestruction
      
	DamageNugget
		Damage			= 900
		Radius			= 500.0
		DeathType		= EXPLODED
	End

	MetaImpactNugget
		InvertShockWave		= Yes
		ShockWaveAmount   = 100.0
		ShockWaveRadius   = 550.0
		ShockWaveTaperOff	= 1.0
		ShockWaveZMult    = 0.3
	End  
End

;_____________________________________________________________________________
SpecialPower SpecialAbilityThunderBolt
	Enum						   = SPECIAL_SARUMAN_FIRE_BALL
	ReloadTime					   = 35000
End
;------------------------------------------------------------------------------
SpecialPower SpecialAbilityPower7th
	Enum						   = SPECIAL_WORD_OF_POWER
	ReloadTime					   = 80000
End
;------------------------------------------------------------------------------
SpecialPower SpecialAbilityBlackWind
  Enum              = SPECIAL_ARROW_STORM
  ReloadTime        = 100000 ; in milliseconds
  RadiusCursorRadius = 300.0 
	ViewObjectDuration = 5000
	ViewObjectRange = 320
End
;------------------------------------------------------------------------------
SpecialPower SpecialAbilityBlackDestruction
  Enum                = SPECIAL_WOUND_ARROW
  ReloadTime          = 100000
  ObjectFilter = ALL -BASE_FOUNDATION -INERT -IGNORED_IN_GUI -WALK_ON_TOP_OF_WALL -BLOCKING_GATE -WALL_UPGRADE -UNATTACKABLE -MOVE_ONLY
End

Object FaramirSpecialArrow
	ReplaceModule ModuleTag_Draw
	Draw = W3DScriptedModelDraw ModuleTag_Draw_black
      DefaultModelConditionState		 
      Model = EXBlack_AROW
      ParticleSysBone = NONE BlackArrowTrail FOLLOWBONE:YES
    End
End
End
  AddModule
  Behavior = FireWeaponWhenDeadBehavior ModuleTag_DIELIKETHIS
    StartsActive = Yes
    DeathWeapon = BlackBoom
  End
End
End
Object GimliAxeProjectile
	ReplaceModule ModuleTag_Draw
	Draw = W3DScriptedModelDraw ModuleTag_Draw_thunder
		DefaultModelConditionState 
		Model = NONE
			ParticleSysBone = NONE RedZap FOLLOWBONE:YES
		End
End
End
  AddModule
  Behavior = FireWeaponWhenDeadBehavior ModuleTag_DIELIKETHIS
    StartsActive = Yes
    DeathWeapon = RedZapBang
  End
End
End
Object BlackArrowsProjectile
ReplaceModule ModuleTag_Draw
  Draw = W3DScriptedModelDraw ModuleTag_Draw_new
    DefaultModelConditionState     
      Model = EXBlack_AROW
      ParticleSysBone = NONE BlackArrowTrail1 FOLLOWBONE:YES
    End
  End
End
  RemoveModule ModuleTag_Draw2
   ReplaceModule ModuleTag_04
 Behavior = BezierProjectileBehavior ModuleTag_04_new
    DetonateCallsKill = Yes
    FirstHeight = 9  ; Height of Bezier control points above highest intervening terrain
    SecondHeight = 9
    FirstPercentIndent = 20% ; Percentage of shot distance control points are placed
    SecondPercentIndent = 90%
    FlightPathAdjustDistPerSecond = 50 ; Can allow a max speed this can attempt to follow a target. Units are their velocity we can tag. (45 is default human speed)
    GroundHitFX = FX_GondorArrowDeath
    CurveFlattenMinDist = 100.0
  End
End
  AddModule
  Behavior = FireWeaponWhenDeadBehavior ModuleTag_DIELIKETHIS
    StartsActive = Yes
    DeathWeapon = BlackDestruction
  End
End
End
;--------------------
Object GondorFaramir

	DisplayName = Draenor

	AddModule
	Behavior = GrantUpgradeCreate ModuleTag_1
		UpgradeToGrant = Upgrade_GandalfWhite  ;
	End 
	End
	AddModule
	Behavior = SubObjectsUpgrade Costume_3
		TriggeredBy		= Upgrade_GandalfWhite ; muwtchkng_mace.tga
		UpgradeTexture	= gufaramir_m.tga 0 musauron.tga  ;mubalrogwingsash.tga  ;mubalrogwings.tga  ;mubalrogash.tga  ;fire.tga  ;
		UpgradeTexture	= gufaramir.tga 0 musauron.tga 
				RecolorHouse	= No
	End
	End
	; *** ART Parameters ***

	SelectPortrait         = HPBlackRider

	ButtonImage = HPBlackRider
	
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_BlackRider
    	ReplaceModule ModuleTag_DRAW
	Draw = W3DScriptedModelDraw ModuleTag_DRAW_new
	
	OkToChangeModelColor = Yes
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

	ExtraPublicBone = arrow

;--------------------
DefaultModelConditionState
			Model               = GUFaramir_SKN
			ParticleSysBone     = B_SWORDBONE BlackBlade FollowBone:yes
			WeaponLaunchBone    = PRIMARY arrow
		End

;;------------------  DYING -------------------------------------------------------------

; --- Flying through the air.
		AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_FLYB
				AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
				AnimationMode     = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags               = RANDOMSTART
		End
		
		AnimationState        = STUNNED_FLAILING 
			StateName           = STATE_Bow
			Animation           = GUFaramir_FLYA
				AnimationName     = GUFaramir_SKL.GUFaramir_FLYA
				AnimationMode     = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
			Flags               = RANDOMSTART
		End
		
; --- Dying anims
		AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_LNDB
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode     = ONCE
			End
		End

		AnimationState        = DYING SPLATTED
			StateName           = STATE_Bow
			Animation           = GUFaramir_LNDA
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode     = ONCE
			End
		End
		
		; with sword
		AnimationState        = DYING WEAPONSET_TOGGLE_1	;WEAPONSTATE_CLOSE_RANGE
			StateName           = STATE_Sword

			Animation           = GUFaramir_DIEA
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
				AnimationMode     = ONCE
			End
			
			Animation           = GUFaramir_DIEB
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
				AnimationMode     = ONCE
			End
		End
		
		; with bow
		AnimationState        = DYING
			StateName           = STATE_Bow
			Animation           = GUFaramir_DIEC
				AnimationName     = GUFaramir_SKL.GUFaramir_DIEC
				AnimationMode     = ONCE
			End
		End

		AnimationState						= PARALYZED
			Animation
				AnimationName				= GUFaramir_IDLC
				AnimationMode				= LOOP
			End
		End


; --- Stunned anims


		AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = GUFaramir_GTPB
				AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End
		
		AnimationState        = STUNNED_STANDING_UP
			StateName           = STATE_Bow
			Animation           = GUFaramir_GTPA
				AnimationName     = GUFaramir_SKL.GUFaramir_GTPA
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End

		AnimationState        = STUNNED WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			
			Animation           = GUFaramir_LNDB
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
				AnimationMode     = ONCE
			End
		End

		AnimationState        = STUNNED 
			StateName           = STATE_Bow
			
			Animation           = GUFaramir_LNDA
				AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
				AnimationMode     = ONCE
			End
		End				

;;----------- pose 		

		;--------------------- Wound Arrow anim
		AnimationState        =  SPECIAL_WEAPON_ONE
			StateName = STATE_Bow
			Animation
				AnimationName           = GUFaramir_SKL.GUFaramir_ATKC
				AnimationMode       = ONCE
			End
			FrameForPristineBonePositions = 59
			BeginScript
				CurDrawableShowSubObject("arrow")
			EndScript
		End
		AnimationState        =  SPECIAL_WEAPON_TWO
			StateName = STATE_Sword
			Animation
				AnimationName           = GUFaramir_SKL.GUFaramir_ATKE
				AnimationMode       = ONCE
			End
			FrameForPristineBonePositions = 59
		End
		AnimationState        =  SPECIAL_WEAPON_THREE
			StateName = STATE_Sword
			Animation
				AnimationName           = GUFaramir_SKL.GUFaramir_ATKF
				AnimationMode       = ONCE
			End
			FrameForPristineBonePositions = 59
		End

		AnimationState        = UNPACKING PACKING_TYPE_1
			Animation           = ATKA1
				AnimationName     = GUFaramir_SKL.GUFaramir_ATKA1
				AnimationMode     = ONCE
			End
			StateName           = STATE_Bow
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToBow") end
				CurDrawableHideSubObject("arrow") ;Circumvents blend issues when the arrow is being shown...
			EndScript
		End
	
	
		AnimationState        = PREPARING PACKING_TYPE_1
			Animation           = ATKA2
				AnimationName     = GUFaramir_SKL.GUFaramir_ATKA2
				AnimationMode     = LOOP
				AnimationSpeedFactorRange = 1.328 1.328
			End
			StateName           = STATE_Bow
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToBow") end
				CurDrawableHideSubObject("arrow") ;Circumvents blend issues when the arrow is being shown...
			EndScript
		End
		
		AnimationState        = PACKING PACKING_TYPE_1
			Animation           = ATKA3
				AnimationName     = GUFaramir_SKL.GUFaramir_ATKC
				AnimationMode     = LOOP
			End
			StateName           = STATE_Bow
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToBow") end
				CurDrawableHideSubObject("arrow") ;Circumvents blend issues when the arrow is being shown...
			EndScript
		End

;;------------------ ATTACKING --------------------------------------------------------------------
		; Attacking Anims [Weapon_A]
		
		
		
		AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
			Animation           = TrotAndFire
				AnimationName       = GUFaramir_SKL.GUFaramir_ATRA
				AnimationMode       = LOOP
			End
			Flags               = RANDOMSTART
			StateName = RunAndSwing
		End
		
		AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			
			Animation           = ATKD
				AnimationName     = GUFaramir_SKL.GUFaramir_ATKD
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
				AnimationSpeedFactorRange = 1.149 1.149
			End
			
			Animation           = ATKE
				AnimationName    = GUFaramir_SKL.GUFaramir_ATKE
				AnimationMode     = ONCE
				UseWeaponTiming		= Yes
				AnimationSpeedFactorRange = 1.149 1.149
			End
			
			Animation           = ATKF
				AnimationName    = GUFaramir_SKL.GUFaramir_ATKF
				AnimationMode     = ONCE
				AnimationSpeedFactorRange = 1.47 1.47
			End
			Flags				=	RESTART_ANIM_WHEN_COMPLETE
			;	FrameForPristineBonePositions = 59
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
			EndScript
		End

;;------------------ MOVING -------------------------------------------------------------

		AnimationState        = MOVING USER_4                 ; Moving slaughter
			StateName           = Slaughter
			Flags               = RANDOMSTART
			;ParticleSysBone     = None InfantryDustTrails
			Animation           = GUFaramir_ATKE
				AnimationName     = GUFaramir_SKL.GUFaramir_ATKE
				AnimationMode     = LOOP
			End
			StateName           = NoSword
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
			EndScript
		End

		;--- Running with sword
		AnimationState			= MOVING WEAPONSET_TOGGLE_1		;WEAPONSTATE_CLOSE_RANGE
			StateName           = STATE_RunningSword
			Flags               = RANDOMSTART
			;ParticleSysBone    = None InfantryDustTrails
			
			Animation           = GUFaramir_RUNB
				AnimationName   = GUFaramir_SKL.GUFaramir_RUNB
;				AnimationMode   = LOOP
				AnimationSpeedFactorRange = 0.85 0.85
				Distance		= 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
			EndScript
		End

;;------------------- ATTACKING IDLE with sword ------------------------------------------------------------

		AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
			StateName           = STATE_Sword
			Animation           = ATKD
				AnimationName     = GUFaramir_SKL.GUFaramir_IDLA
				AnimationMode     = MANUAL
			End			
		End


		;--- Running with bow
		AnimationState			= MOVING
			StateName           = STATE_RunningBow
			Flags               = RANDOMSTART
			;ParticleSysBone    = None InfantryDustTrails
			
			Animation           = GUFaramir_RUNA
				AnimationName   = GUFaramir_SKL.GUFaramir_RUNA
;				AnimationMode   = LOOP
				AnimationSpeedFactorRange = 0.85 0.85
				Distance = 28
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
			EndScript
		End

		;---------------------------------------------------
		;New style firing with bow
		AnimationState					=	PREATTACK_A 
			StateName					=	STATE_Firing
			Animation					=	ReadyToDrawn
				AnimationName			=	GUFaramir_SKL.GUFaramir_ATKA1
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	Yes			; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				;AnimationBlendTime		=	10
			End
		End

		AnimationState					=	FIRING_OR_RELOADING_A 
			StateName					=	STATE_Firing
			Animation					=	LooseReloadDraw
				AnimationName			=	GUFaramir_SKL.GUFaramir_ATKA2
				AnimationMode			=	ONCE
;				UseWeaponTiming			=	Yes			; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
				AnimationSpeedFactorRange = 1.1 1.1		; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
				;AnimationBlendTime		=	10
			End
		End
		;---------------------End New style firing

		AnimationState					=	CONTINUOUS_FIRE_MEAN
			Animation					=	HangFrameWhileCoasting
				AnimationName			=	GUFaramir_SKL.GUFaramir_ATKA2
				AnimationMode			=	MANUAL
			End
		End
		
		AnimationState						= CONTINUOUS_FIRE_SLOW
			;StateName						= STATE_Idle_Bow
			Animation						= PutAwayArrow
				AnimationName				= GUFaramir_SKL.GUFaramir_ATKA3
				AnimationMode				= ONCE
			End
		End
				
		;End New style firing
		;---------------------------------------------------


		
;;-------------------- HIT REACTIONS -----------------------------------------------------------

; this hit animation attack stance
		AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
			Animation = Hit_Level_1_d
				AnimationName = GUFaramir_SKL.GUFaramir_HITD
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
			Animation = Hit_Level_1_b
				AnimationName = GUFaramir_SKL.GUFaramir_HITB
				AnimationMode = ONCE
			End
		End

		AnimationState = HIT_REACTION
			Animation = Hit_Level_1_c
				AnimationName = GUFaramir_SKL.GUFaramir_HITC
				AnimationMode = ONCE
			End
		End

;;------------ EMOTIONS ------------------------------------------------------------------		


;;====== LEVELED
		AnimationState				= LEVELED WEAPONSET_TOGGLE_1	; This state clears itself in 3 seconds
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRC
				AnimationMode		= ONCE
			End
		End

		AnimationState				= LEVELED 						; This state clears itself in 3 seconds
			Animation				= LevelUp
				AnimationName		= GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode		= ONCE
			End
		End

;;====== CELEBRATING	

		AnimationState				=	EMOTION_CELEBRATING WEAPONSET_TOGGLE_1		; sword cheer
			Animation
				AnimationName		=	GUFaramir_SKL.GUFaramir_CHRC
				AnimationMode		=	LOOP
			End
		End

		AnimationState				=	EMOTION_CELEBRATING							; bow cheer
			Animation
				AnimationName		=	GUFaramir_SKL.GUFaramir_CHRD
				AnimationMode		=	LOOP
			End
		End


;;------------------- SELECTED STATES ------------------------------------------------------------

		AnimationState					= SELECTED WEAPONSET_TOGGLE_1
			StateName					= STATE_Selected_Sword
			
			Animation					= ATNE
				AnimationName			= GUFaramir_SKL.GUFaramir_ATNE
				AnimationMode			= LOOP
				AnimationBlendTime		= 15
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
			EndScript
		End
		
;;====== ALERT
		AnimationState				=	EMOTION_ALERT WEAPONSET_TOGGLE_1
			StateName				=	STATE_READY
			Animation				=	ready
				AnimationName		=	GUFaramir_SKL.GUFaramir_IDLA
				AnimationMode		=	LOOP
				AnimationBlendTime	=	20
			End
		End

		AnimationState				=	SELECTED 
			StateName				=	STATE_Selected_Bow
			
			Animation				=	ATNB
				AnimationName		=	GUFaramir_SKL.GUFaramir_ATNB
				AnimationMode		=	LOOP
				AnimationBlendTime  = 15
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_Idle_Bow"	then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
				if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
			EndScript
		End
	


;;--------------- IDLE STATES -----------------------------------------------------------------	
		
		AnimationState					= WEAPONSET_TOGGLE_1
			StateName					= STATE_Idle_Sword	

			Animation           		= IDLE
				AnimationName       	= GUFaramir_SKL.GUFaramir_IDLE
				AnimationMode       	= LOOP
				AnimationPriority	    = 20
				AnimationBlendTime  = 15
			End
			
			Animation           		= IDLF
				AnimationName       	= GUFaramir_SKL.GUFaramir_IDLF
				AnimationMode       	= LOOP
				AnimationPriority	    = 1
			End

			Animation           		= IDLG
				AnimationName       	= GUFaramir_SKL.GUFaramir_IDLG
				AnimationMode       	= LOOP
				AnimationPriority	    = 1
			End
			
			BeginScript
				CurDrawableHideSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
				if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
			EndScript
		End
		
		IdleAnimationState
			StateName           = STATE_Idle_Bow
			
			Animation           = IdleBow
				AnimationName     = GUFaramir_SKL.GUFaramir_IDLC
				AnimationMode     = ONCE
				AnimationBlendTime  = 15
			End
			BeginScript
				CurDrawableShowSubObject("arrow")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
				if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredBow") end
			EndScript
		End

	;---transitions--------------------------------------------

		TransitionState = TRANS_BoredToSelectedSword
			Animation = ANTD
				AnimationName		= GUFaramir_SKL.GUFaramir_ANTD
				AnimationMode		= ONCE
			End		
		End
		
		TransitionState = TRANS_SelectedToBoredSword
			Animation			= ATNF
				AnimationName	= GUFaramir_SKL.GUFaramir_ATNF
				AnimationMode	= ONCE
			End		
		End	

		TransitionState = TRANS_BoredToSelectedBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.GUFaramir_ATNC
				AnimationMode		= ONCE
			End		
		End
		
		TransitionState = TRANS_CaptainBowToSelectedBow
			Animation = ATNC
				AnimationName		= GUFaramir_SKL.GUFaramir_ATNC
				AnimationMode		= ONCE
				AnimationBlendTime	= 10
				AnimationSpeedFactorRange = 1.5 1.5
			End		
		End
		
		TransitionState = TRANS_SelectedToBoredBow
			Animation			= ATNA
;				AnimationName	= GUFaramir_SKL.GUFaramir_ATNA
				AnimationName	= GUFaramir_SKL.GUFaramir_ATND
				AnimationMode	= ONCE
			End		
		End	


		TransitionState       = TRANS_BowToSword
			Animation           = GUFaramir_STHA
				AnimationName     = GUFaramir_SKL.GUFaramir_STHA 
				AnimationMode     = ONCE
			End
		End

		TransitionState       = TRANS_SwordToBow
			Animation           = GUFaramir_STHB
				AnimationName     = GUFaramir_SKL.GUFaramir_STHB 
				AnimationMode     = ONCE
			End
		End	

		TransitionState       		= TRANS_BowToSword_Running
			Animation           	= DrawSwords
				AnimationName       = GUFaramir_SKL.GUFaramir_STHD
				AnimationMode       = ONCE
			End
		End
		
		TransitionState       		= TRANS_SwordToBow_Running
			Animation           	= DrawBow
				AnimationName       = GUFaramir_SKL.GUFaramir_STHC
				AnimationMode       = ONCE
			End
		End		

	End
End
	; *** AUDIO Parameters ***;

	VoiceAttack				= FellBeastVoiceAttack
	VoiceAttackAir				= FellBeastVoiceAttack
	VoiceAttackCharge			= FellBeastVoiceAttack
	VoiceAttackMachine		= FellBeastVoiceAttack
	VoiceMoveWhileAttacking		= FellBeastVoiceMove
	VoiceMove				= FellBeastVoiceMove
	VoicePriority			= 82
	VoiceSelect				= FellBeastVoiceSelect
	VoiceSelectBattle 		= FellBeastVoiceSelect
	VoiceGuard				= FellBeastVoiceMove
	ArmorSet
		Conditions      = None
		Armor           = HeroArmor
		DamageFX        = NormalDamageFX
	End

	ReplaceModule ModuleTag_RespawnBody
	Body = RespawnBody ModuleTag_RespawnBody1
		CheerRadius 			= EMOTION_CHEER_RADIUS
		MaxHealth         		= 175000	;BALANCE Faramir Health
		PermanentlyKilledByFilter	= NONE		;Who kills me permanently?
   		DodgePercent      		= HERO_DODGE_PERCENT
	End
End
	ReplaceModule ModuleTag_WoundArrow			
	Behavior = SpecialPowerModule ModuleTag_WoundArrow1
		SpecialPowerTemplate		= SpecialAbilityWoundArrow
		UpdateModuleStartsAttack	= Yes
    	InitiateSound				= FellBeastVoiceAttack
    	StartsPaused				= Yes
	End
End
	;;;	ThunderBolt ;;;
	AddModule
 	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FireballEnabler
		SpecialPowerTemplate	= SpecialAbilityThunderBolt
		TriggeredBy				= Upgrade_SarumanFireBall
	End
End
	AddModule
	Behavior = SpecialPowerModule ModuleTag_FireballStarter                      
		SpecialPowerTemplate		= SpecialAbilityThunderBolt
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= Yes
		InitiateSound			= FellBeastVoiceAttack
	End
End
	AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate   
		SpecialPowerTemplate    = SpecialAbilityThunderBolt
		WhichSpecialWeapon		= 3
		SkipContinue			= Yes

		UnpackTime             	= 500
		PreparationTime			= 1   
		PersistentPrepTime		= 1000 
		PackTime				= 100
		
		AwardXPForTriggering    = 0
		
		StartAbilityRange		= FARAMIR_WOUNDING_ARROW_RANGE
		MustFinishAbility		= Yes
		SpecialWeapon			= RohanGimliAxeThrown
	End
End
	;;; Black Arrow Wind ;;;
	AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ArrowWindEnabler
		SpecialPowerTemplate = SpecialAbilityBlackWind
		TriggeredBy = Upgrade_LegolasArrowWind
	End
End
	AddModule
	Behavior = SpecialPowerModule ModuleTag_ArrowWindStarter                      
		SpecialPowerTemplate		= SpecialAbilityBlackWind
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= Yes
		InitiateSound			= FellBeastVoiceAttack		;this plays when he targets, not when he fires
	End
End
	AddModule
	Behavior = ArrowStormUpdate ModuleTag_ArrowWindUpdate                
		SpecialPowerTemplate    = SpecialAbilityBlackWind
		StartAbilityRange       = FARAMIR_WOUNDING_ARROW_RANGE
		
		UnpackTime              = 1000	; Pull out arrow
		PreparationTime         = 200	; Quick shot
		PersistentPrepTime      = 600	; looping the quick shot
		PackTime                = 1200	; back to idle
		UnpackingVariation		= 1		; Use custom variation to not interfere with Archer Training ability.
		ParalyzeDurationWhenCompleted = 600	;Once the unit SUCCESSFULLY COMPLETES an ability, paralyze unit briefly to deal with animation transitions.
		ParalyzeDurationWhenAborted = 800	;If the unit ABORTS the ability, paralyze the unit briefly to deal with animation transitions.

		ApproachRequiresLOS     = Yes ; required so that it doesn't shoot through walls

		AwardXPForTriggering    = 0

		;Specific to ArrowStorm
		WeaponTemplate  = FaramirWoundArrow
		TargetRadius    = 200	
		ShotsPerTarget  = 1
		ShotsPerBurst   = 5
		MaxShots        = 50  ; can end sooner if no targets
  		CanShootEmptyGround = Yes ; ...unless this is set
	End
End	
	;------- Power of the 7th --------------------------------------------------------------------------------
	AddModule
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
		SpecialPowerTemplate = SpecialAbilityPower7th
		TriggeredBy = Upgrade_GandalfWordOfPower
	End
End
	AddModule
	Behavior = SpecialPowerModule ModuleTag_WordStarter       
		SpecialPowerTemplate      = SpecialAbilityPower7th
		UpdateModuleStartsAttack  = Yes
		StartsPaused		  	  = Yes
	End
End
	AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate   
		SpecialPowerTemplate    = SpecialAbilityPower7th
		WhichSpecialWeapon		= 2
		SkipContinue			= Yes

		UnpackTime              = 1100 
		PackTime                = 1	
		FreezeAfterTriggerDuration = 2500 ; Hold AI for this long after we fire.
		
		AwardXPForTriggering    = 0		
		StartAbilityRange		= 80.0
		
		SpecialWeapon			= Power7th
	End
End
	;;;	Black Arrow of Destruction  ;;;
	AddModule
 	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FireballEnabler1
		SpecialPowerTemplate	= SpecialAbilityBlackDestruction
		TriggeredBy				= Upgrade_ObjectLevel10
	End
End
	AddModule
	Behavior = SpecialPowerModule ModuleTag_FireballStarter1                      
		SpecialPowerTemplate		= SpecialAbilityBlackDestruction
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= Yes
		InitiateSound			= FellBeastVoiceAttack
	End
End
	AddModule
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate1  
		SpecialPowerTemplate    = SpecialAbilityBlackDestruction
		WhichSpecialWeapon		= 1
		SkipContinue			= Yes

		UnpackTime             	= 1000
		PreparationTime			= 1   
		PersistentPrepTime		= 1000 
		PackTime				= 100
		
		AwardXPForTriggering    = 0
		
		StartAbilityRange		= FARAMIR_WOUNDING_ARROW_RANGE
		MustFinishAbility		= Yes
		SpecialWeapon			= DwarvenMenOfDaleBlackArrows
	End
End
	AddModule
	Behavior = AISpecialPowerUpdate ThunderAoE
		CommandButtonName = Command_SarumanFireball
		SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
	End
End
	AddModule
	Behavior = AISpecialPowerUpdate BlackAoE
		CommandButtonName = Command_SpecialAbilityThornofVengeance
		SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
	End
End
End

;------------------------------------
;----------------------	FARAMIR	-------------------------------------

ExperienceLevel	FaramirLevel4
	TargetNames						=	GondorFaramir GondorFaramirCavalry	
	RequiredExperience				=	FARAMIR_LVL4_EXP_NEEDED
	ExperienceAward					=	FARAMIR_LVL4_EXP_AWARD 	
	LevelUpFx						=	FX:GandalfLevelUp1FX
	Rank							=	4
	AttributeModifiers				=	HeroLevelUpDamage3
	Upgrades						=	Upgrade_SarumanFireBall
	SelectionDecal
		Texture						=	decal_hero_good
		Style						=	SHADOW_ALPHA_DECAL
		OpacityMin					=	50%	
		OpacityMax					=	100%
		MinRadius					=	40
		MaxRadius					=	200
		MaxSelectedUnits			=	40
	End	
End	


ExperienceLevel	FaramirLevel6
	TargetNames						=	GondorFaramir GondorFaramirCavalry	
	RequiredExperience				=	FARAMIR_LVL6_EXP_NEEDED
	ExperienceAward					=	FARAMIR_LVL6_EXP_AWARD 	
	LevelUpFx						=	FX:GandalfLevelUp1FX
	Rank							=	6
	AttributeModifiers				=	HeroLevelUpDamage5
	Upgrades						=	Upgrade_GandalfWordOfPower
	SelectionDecal
		Texture						=	decal_hero_good
		Style						=	SHADOW_ALPHA_DECAL
		OpacityMin					=	50%
		OpacityMax					=	100%
		MinRadius					=	40
		MaxRadius					=	200
		MaxSelectedUnits			=	40
	End	
End	

ExperienceLevel	FaramirLevel8
	TargetNames						=	GondorFaramir GondorFaramirCavalry	
	RequiredExperience				=	FARAMIR_LVL8_EXP_NEEDED
	ExperienceAward					=	FARAMIR_LVL8_EXP_AWARD 	
	LevelUpFx						=	FX:GandalfLevelUp1FX
	Rank							=	8
	AttributeModifiers				=	HeroLevelUpDamage7
	Upgrades						=	Upgrade_LegolasArrowWind
	SelectionDecal
		Texture						=	decal_hero_good
		Style						=	SHADOW_ALPHA_DECAL
		OpacityMin					=	50%	
		OpacityMax					=	100%
		MinRadius					=	40
		MaxRadius					=	200
		MaxSelectedUnits			=	40
	End	
End	


ExperienceLevel	FaramirLevel10
	TargetNames						=	GondorFaramir GondorFaramirCavalry	
	RequiredExperience				=	FARAMIR_LVL10_EXP_NEEDED
	ExperienceAward					=	FARAMIR_LVL10_EXP_AWARD 	
	LevelUpFx						=	FX:GandalfLevelUp1FX
	Rank							=	10
	AttributeModifiers				=	HeroLevelUpDamage9
	Upgrades						=	Upgrade_ObjectLevel10

	SelectionDecal
		Texture						=	decal_hero_good
		Style						=	SHADOW_ALPHA_DECAL
		OpacityMin					=	50%	
		OpacityMax					=	100%
		MinRadius					=	40
		MaxRadius					=	200
		MaxSelectedUnits			=	40
	End	
End	

;+++++++++++++++++++++++++++++++++++Adunaphel++++++++++++++++++++++++++++++++==
CommandButton Command_SarumanFireball
  Command                 = SPECIAL_POWER 
  SpecialPower            = SpecialAbilityThunderBolt
  Options                 = NEED_TARGET_ENEMY_OBJECT NEED_TARGET_ALLY_OBJECT NEED_TARGET_NEUTRAL_OBJECT ; CONTEXTMODE_COMMAND
  TextLabel               = CONTROLBAR:SpecialAbilityThunderBolt
  ButtonImage             = HSSarumanFireBallAttack
  ButtonBorderType        = ACTION 
  DescriptLabel           = CONTROLBAR:ToolTipSpecialAbilityThunderBolt
  CursorName              = EvilAbilityObj
  InvalidCursorName       = GenericInvalid
  InPalantir			  = Yes
  AutoAbility			  = Yes
  PresetRange			  = 200.0
  EnableOnModelCondition  = WEAPONSET_TOGGLE_1
End
CommandButton Command_SpecialAbilityDainMightyRage
  Command                 = SPECIAL_POWER 
  SpecialPower            = SpecialAbilityPower7th
  Options                 = NONE
  TextLabel               = CONTROLBAR:Power7th
  ButtonImage             = Gandolf_radcircle;HSGandalfWordOfPower
  ButtonBorderType        = ACTION 
  DescriptLabel           = CONTROLBAR:ToolTipPower7th
  AutoAbility			  = Yes
  PresetRange			  = 120.0
  InPalantir			  = Yes
  EnableOnModelCondition  = WEAPONSET_TOGGLE_1
End
CommandButton Command_SpecialAbilityArrowStorm
  Command                 = SPECIAL_POWER 
  SpecialPower            = SpecialAbilityBlackWind
  Options                 = NEED_TARGET_POS CONTEXTMODE_COMMAND
  TextLabel               = CONTROLBAR:BlackWind
  ButtonImage             = HSLegolasArrowWind
  CursorName              = Bombard
  RadiusCursorType        = ArrowStormRadiusCursor
  InvalidCursorName       = GenericInvalid
  ButtonBorderType        = ACTION 
  DescriptLabel           = CONTROLBAR:ToolTipBlackWind
  InPalantir			  = Yes
  AutoAbility			  = No
  DisableOnModelCondition = WEAPONSET_TOGGLE_1
End
CommandButton Command_SpecialAbilityWoundArrow
  Command                 = SPECIAL_POWER
  WeaponSlot              = SECONDARY
  SpecialPower            = SpecialAbilityWoundArrow
  Options                 = NEED_TARGET_ENEMY_OBJECT UNMOUNTED_ONLY
  TextLabel               = CONTROLBAR:BlackArrow
  ButtonImage             = HSFaramirWoundingArrow
  CursorName              = Bombard
  InvalidCursorName       = GenericInvalid
  ButtonBorderType        = ACTION
  DescriptLabel           = CONTROLBAR:ToolTipBlackArrow
  InPalantir			  = Yes
  AutoAbility			  = Yes
  DisableOnModelCondition = WEAPONSET_TOGGLE_1
End
CommandButton Command_SpecialAbilityThornofVengeance
	Command                 = SPECIAL_POWER
	WeaponSlot              = SECONDARY
	SpecialPower            = SpecialAbilityBlackDestruction
	Options                 = NEED_TARGET_ENEMY_OBJECT
	TextLabel               = CONTROLBAR:BlackDestruction
	ButtonImage             = HSThranduilThornofVengeance
	CursorName              = Bombard
	InvalidCursorName       = GenericInvalid
	ButtonBorderType        = ACTION
	DescriptLabel           = CONTROLBAR:ToolTipBlackDestruction
	DisableOnModelCondition = WEAPONSET_TOGGLE_1		
	InPalantir			  = Yes
	AutoAbility			  = Yes
End
;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
CommandSet NewGondorFaramirCommandSet
	6	= Command_SpecialAbilityThornofVengeance
	1	= Command_ToggleFaramirWeapon
	2	= Command_SpecialAbilityWoundArrow
	3	= Command_SarumanFireball
	4	= Command_SpecialAbilityDainMightyRage
	5	= Command_SpecialAbilityArrowStorm
	12 = Command_CaptureBuilding
	13 = Command_AttackMove
	14 = Command_Stop
	15 = Command_ToggleStance
End

Object GondorFaramir
	CommandSet = NewGondorFaramirCommandSet
End

;--------------------------DRAGON NO TIMER
Object SummonedDragon
	
	ReplaceModule ModuleTag_Body
	Body = ActiveBody ModuleTag_Body1
		MaxHealth = 18000
	End
	End

	LocomotorSet
		Locomotor     = SummonedDragonLocomotor
		Condition     = SET_NORMAL
		Speed         = 48
	End

	RemoveModule ModuleTag_LifetimeUpdate

	ArmorSet
		Conditions      = None
		Armor           = NewSummonedDragonArmor
		DamageFX        = FellBeastDamageFX
	End
End

ChildObject SummonedDragonJH1 SummonedDragon

	RemoveModule ModuleTag_LifetimeUpdate

	ArmorSet
		Conditions      = None
		Armor           = NewSummonedDragonArmor
		DamageFX        = FellBeastDamageFX
	End
End

;------------------------------------------------
Weapon RainOfFirePhaseInitialWeapon
	RadiusDamageAffects = ENEMIES NEUTRALS ALLIES
	FireFX = FX_RainOfFirePhaseInitialWeapon
	LuaEventNugget                        ; Sends a lua script event out
		LuaEvent		= BeUncontrollablyAfraid
		Radius			= 200
		SendToEnemies	= Yes
		SendToAllies	= No
		SendToNeutral	= Yes
	End
End

;------------------------------------------------------------------------------
Weapon RainOfFirePhaseInitialWeapon02
	RadiusDamageAffects = ENEMIES NEUTRALS ALLIES
	FireFX = FX_RainOfFirePhaseInitialWeapon02
	LuaEventNugget                        ; Sends a lua script event out
		LuaEvent		= BeUncontrollablyAfraid
		Radius			= 200
		SendToEnemies	= Yes
		SendToAllies	= No
		SendToNeutral	= Yes
	End
End

;------------------------------------------------------------------------------
Weapon RainOfFirePhaseOneWeapon
	RadiusDamageAffects = ENEMIES NEUTRALS
	FireFX = FX_RainOfFirePhaseOne
	DamageNugget                        ; A basic Nugget that just does damage
		Damage        = 3500
		DamageScalar  = 50% NONE +COMMANDCENTER
		DamageTaperOff = 200
		Radius        = 200
		DamageMaxHeightAboveTerrain = 1
		DelayTime     = 0
		DamageType    = SIEGE
		DeathType     = NORMAL
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .99
		ShockWaveAmount		= 50.0
		ShockWaveTaperOff	= 1.0
		ShockWaveRadius		= 50
	End
	;FireLogicNugget						; Increase the fuel where it hits
	;	LogicType		= INCREASE_FUEL
	;	Radius			= 150
	;	Damage			= 25
	;	MinMaxBurnRate	= 10
	;	MaxResistance	= 5
	;End
	;FireLogicNugget						; Light everything on fire
	;	LogicType		= INCREASE_BURN_RATE
	;	Radius			= 150
	;	Damage			= 100
	;End
End

;------------------------------------------------------------------------------
Weapon RainOfFirePhaseOneWeapon02
	RadiusDamageAffects = ENEMIES NEUTRALS
	FireFX = FX_RainOfFirePhaseOne02
	DamageNugget                        ; A basic Nugget that just does damage
		Damage        = 3500
		DamageScalar  = 50% NONE +COMMANDCENTER
		DamageTaperOff = 200
		Radius        = 200
		DamageMaxHeightAboveTerrain = 1
		DelayTime     = 0
		DamageType    = SIEGE
		DeathType     = NORMAL
	End
	MetaImpactNugget                    ; A Nugget that throws things back with force
;		HeroResist			= .99
		ShockWaveAmount		= 50.0
		ShockWaveTaperOff	= 1.0
		ShockWaveRadius		= 50
	End
	;FireLogicNugget						; Increase the fuel where it hits
	;	LogicType		= INCREASE_FUEL
	;	Radius			= 150
	;	Damage			= 25
	;	MinMaxBurnRate	= 10
	;	MaxResistance	= 5
	;End
	;FireLogicNugget						; Light everything on fire
	;	LogicType		= INCREASE_BURN_RATE
	;	Radius			= 150
	;	Damage			= 100
	;End
End


